From dotslash at berlios.de  Fri Jun  2 19:51:09 2006
From: dotslash at berlios.de (dotslash at BerliOS)
Date: Fri, 2 Jun 2006 19:51:09 +0200
Subject: [S3d-svn] r312 - trunk
Message-ID: <200606021751.k52Hp9QR025414@sheep.berlios.de>

Author: dotslash
Date: 2006-06-02 19:51:08 +0200 (Fri, 02 Jun 2006)
New Revision: 312

Added:
   trunk/config.h.in
Modified:
   trunk/
Log:
 r669 at balthasar:  dotslash | 2006-06-02 19:50:24 +0200
 - config.h.in :D



Property changes on: trunk
___________________________________________________________________
Name: svk:merge
   - bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:663
   + bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:669

Added: trunk/config.h.in
===================================================================
--- trunk/config.h.in	2006-05-31 18:24:09 UTC (rev 311)
+++ trunk/config.h.in	2006-06-02 17:51:08 UTC (rev 312)
@@ -0,0 +1,141 @@
+/* config.h.in.  Generated from configure.ac by autoheader.  */
+
+/* Use GLUT */
+#undef G_GLUT
+
+/* Use SDL */
+#undef G_SDL
+
+/* Define to 1 if you have the <dirent.h> header file, and it defines `DIR'.
+   */
+#undef HAVE_DIRENT_H
+
+/* Define to 1 if you have the <dlfcn.h> header file. */
+#undef HAVE_DLFCN_H
+
+/* Define to 1 if you have the <fcntl.h> header file. */
+#undef HAVE_FCNTL_H
+
+/* Define to 1 if you have the <inttypes.h> header file. */
+#undef HAVE_INTTYPES_H
+
+/* Define to 1 if you have the <memory.h> header file. */
+#undef HAVE_MEMORY_H
+
+/* Define to 1 if you have the <ndir.h> header file, and it defines `DIR'. */
+#undef HAVE_NDIR_H
+
+/* Define to 1 if you have the `select' function. */
+#undef HAVE_SELECT
+
+/* Define to 1 if you have the `shmget' function. */
+#undef HAVE_SHMGET
+
+/* Define to 1 if you have the `signal' function. */
+#undef HAVE_SIGNAL
+
+/* Define to 1 if you have the `socket' function. */
+#undef HAVE_SOCKET
+
+/* Define to 1 if you have the <stdint.h> header file. */
+#undef HAVE_STDINT_H
+
+/* Define to 1 if you have the <stdlib.h> header file. */
+#undef HAVE_STDLIB_H
+
+/* Define to 1 if you have the `strerror' function. */
+#undef HAVE_STRERROR
+
+/* Define to 1 if you have the <strings.h> header file. */
+#undef HAVE_STRINGS_H
+
+/* Define to 1 if you have the <string.h> header file. */
+#undef HAVE_STRING_H
+
+/* Define to 1 if you have the `strtod' function. */
+#undef HAVE_STRTOD
+
+/* Define to 1 if you have the `strtol' function. */
+#undef HAVE_STRTOL
+
+/* Define to 1 if you have the <sys/dir.h> header file, and it defines `DIR'.
+   */
+#undef HAVE_SYS_DIR_H
+
+/* Define to 1 if you have the <sys/ioctl.h> header file. */
+#undef HAVE_SYS_IOCTL_H
+
+/* Define to 1 if you have the <sys/ndir.h> header file, and it defines `DIR'.
+   */
+#undef HAVE_SYS_NDIR_H
+
+/* Define to 1 if you have the <sys/stat.h> header file. */
+#undef HAVE_SYS_STAT_H
+
+/* Define to 1 if you have the <sys/time.h> header file. */
+#undef HAVE_SYS_TIME_H
+
+/* Define to 1 if you have the <sys/types.h> header file. */
+#undef HAVE_SYS_TYPES_H
+
+/* Define to 1 if you have the <unistd.h> header file. */
+#undef HAVE_UNISTD_H
+
+/* Name of package */
+#undef PACKAGE
+
+/* Define to the address where bug reports for this package should be sent. */
+#undef PACKAGE_BUGREPORT
+
+/* Define to the full name of this package. */
+#undef PACKAGE_NAME
+
+/* Define to the full name and version of this package. */
+#undef PACKAGE_STRING
+
+/* Define to the one symbol short name of this package. */
+#undef PACKAGE_TARNAME
+
+/* Define to the version of this package. */
+#undef PACKAGE_VERSION
+
+/* Define to 1 if the C compiler supports function prototypes. */
+#undef PROTOTYPES
+
+/* Define as the return type of signal handlers (`int' or `void'). */
+#undef RETSIGTYPE
+
+/* Define to 1 if the `setvbuf' function takes the buffering type as its
+   second argument and the buffer pointer as the third, as on System V before
+   release 3. */
+#undef SETVBUF_REVERSED
+
+/* Define if shared memory networking code should be compiled */
+#undef SHM
+
+/* Define if signal code should be compiled */
+#undef SIGS
+
+/* Define to 1 if you have the ANSI C header files. */
+#undef STDC_HEADERS
+
+/* Define if TCP/IP network code should be compiled */
+#undef TCP
+
+/* Define to 1 if you can safely include both <sys/time.h> and <time.h>. */
+#undef TIME_WITH_SYS_TIME
+
+/* Define to 1 if your <sys/time.h> declares `struct tm'. */
+#undef TM_IN_SYS_TIME
+
+/* Version number of package */
+#undef VERSION
+
+/* Define to 1 if the X Window System is missing or not being used. */
+#undef X_DISPLAY_MISSING
+
+/* Define like PROTOTYPES; this can be used by system headers. */
+#undef __PROTOTYPES
+
+/* Define to empty if `const' does not conform to ANSI C. */
+#undef const



From dotslash at berlios.de  Fri Jun  2 20:01:53 2006
From: dotslash at berlios.de (dotslash at BerliOS)
Date: Fri, 2 Jun 2006 20:01:53 +0200
Subject: [S3d-svn] r313 - in trunk: . libs3d/libg3d/plugins/image libs3d/libg3d/plugins/import
Message-ID: <200606021801.k52I1rdF030004@sheep.berlios.de>

Author: dotslash
Date: 2006-06-02 20:01:51 +0200 (Fri, 02 Jun 2006)
New Revision: 313

Modified:
   trunk/
   trunk/configure.ac
   trunk/libs3d/libg3d/plugins/image/Makefile.am
   trunk/libs3d/libg3d/plugins/import/imp_vrml_v1.c
Log:
 r671 at balthasar:  dotslash | 2006-06-02 20:01:43 +0200
 - remove gtk/gdk bindings



Property changes on: trunk
___________________________________________________________________
Name: svk:merge
   - bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:669
   + bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:671

Modified: trunk/configure.ac
===================================================================
--- trunk/configure.ac	2006-06-02 17:51:08 UTC (rev 312)
+++ trunk/configure.ac	2006-06-02 18:01:51 UTC (rev 313)
@@ -155,14 +155,14 @@
 AM_PATH_GLIB_2_0(2.0.0,,AC_MSG_ERROR([glib >= 2.0 is needed]), gmodule gobject)
 
 # gdk-pixbuf
-AM_PATH_GTK_2_0(2.0.0, have_gtk2=true)
-if test "x$have_gtk2" = "xtrue" ; then
-GDKPIXBUF_CFLAGS=$GTK_CFLAGS
-GDKPIXBUF_LIBS=$GTK_LIBS
-AC_SUBST(GDKPIXBUF_CFLAGS)
-AC_SUBST(GDKPIXBUF_LIBS)
-fi
-AM_CONDITIONAL([HAVE_GDKPIXBUF], test "x$have_gtk2" = "xtrue")
+#AM_PATH_GTK_2_0(2.0.0, have_gtk2=true)
+#if test "x$have_gtk2" = "xtrue" ; then
+#GDKPIXBUF_CFLAGS=$GTK_CFLAGS
+#GDKPIXBUF_LIBS=$GTK_LIBS
+#AC_SUBST(GDKPIXBUF_CFLAGS)
+#AC_SUBST(GDKPIXBUF_LIBS)
+#fi
+#AM_CONDITIONAL([HAVE_GDKPIXBUF], test "x$have_gtk2" = "xtrue")
 
 # AC_DEFINE_DIR(PLUGIN_DIR, libdir/$PACKAGE/plugins, [Plugin directory])
 

Modified: trunk/libs3d/libg3d/plugins/image/Makefile.am
===================================================================
--- trunk/libs3d/libg3d/plugins/image/Makefile.am	2006-06-02 17:51:08 UTC (rev 312)
+++ trunk/libs3d/libg3d/plugins/image/Makefile.am	2006-06-02 18:01:51 UTC (rev 313)
@@ -4,9 +4,9 @@
 	img_bmp.la \
 	img_sgi.la
 
-if HAVE_GDKPIXBUF
-pluginimg_LTLIBRARIES += img_gdkpixbuf.la
-endif
+#if HAVE_GDKPIXBUF
+#pluginimg_LTLIBRARIES += img_gdkpixbuf.la
+#endif
 
 AM_CFLAGS = \
 	-Wall -ansi -pedantic \
@@ -27,7 +27,7 @@
 img_bmp_la_SOURCES = img_bmp.c
 img_sgi_la_SOURCES = img_sgi.c
 
-img_gdkpixbuf_la_CFLAGS = ${AM_CFLAGS} @GDKPIXBUF_CFLAGS@
-img_gdkpixbuf_la_SOURCES = img_gdkpixbuf.c
-img_gdkpixbuf_la_LIBADD = @GDKPIXBUF_LIBS@
+#img_gdkpixbuf_la_CFLAGS = ${AM_CFLAGS} @GDKPIXBUF_CFLAGS@
+#img_gdkpixbuf_la_SOURCES = img_gdkpixbuf.c
+#img_gdkpixbuf_la_LIBADD = @GDKPIXBUF_LIBS@
 

Modified: trunk/libs3d/libg3d/plugins/import/imp_vrml_v1.c
===================================================================
--- trunk/libs3d/libg3d/plugins/import/imp_vrml_v1.c	2006-06-02 17:51:08 UTC (rev 312)
+++ trunk/libs3d/libg3d/plugins/import/imp_vrml_v1.c	2006-06-02 18:01:51 UTC (rev 313)
@@ -999,7 +999,7 @@
 #endif
 
         if ( ! yyg->yy_state_buf )
-            yyg->yy_state_buf = (yy_state_type *)vrml_v1_yyalloc(YY_BUF_SIZE + 2  ,yyscanner);
+            yyg->yy_state_buf = (yy_state_type *)vrml_v1_yyalloc(((YY_BUF_SIZE + 2) * sizeof(yy_state_type))  ,yyscanner);
 
 		if ( ! yyg->yy_start )
 			yyg->yy_start = 1;	/* first start state */
@@ -2333,7 +2333,6 @@
 /** Setup the input buffer state to scan a string. The next call to vrml_v1_yylex() will
  * scan from a @e copy of @a str.
  * @param str a NUL-terminated string to scan
- * @param yy_str a NUL-terminated string to scan
  * @param yyscanner The scanner object.
  * @return the newly allocated buffer state object.
  * @note If you want to scan bytes that may contain NUL values, then use



From dotslash at berlios.de  Fri Jun  2 20:16:00 2006
From: dotslash at berlios.de (dotslash at BerliOS)
Date: Fri, 2 Jun 2006 20:16:00 +0200
Subject: [S3d-svn] r314 - in trunk: . libs3dw
Message-ID: <200606021816.k52IG0Xu002170@sheep.berlios.de>

Author: dotslash
Date: 2006-06-02 20:15:57 +0200 (Fri, 02 Jun 2006)
New Revision: 314

Added:
   trunk/libs3dw/input.c
   trunk/libs3dw/label.c
   trunk/libs3dw/widget.c
Removed:
   trunk/libs3dw/object.c
Modified:
   trunk/
   trunk/libs3dw/Makefile.am
   trunk/libs3dw/animate.c
   trunk/libs3dw/button.c
   trunk/libs3dw/s3dw.h
   trunk/libs3dw/s3dw_int.h
   trunk/libs3dw/surface.c
Log:
 r673 at balthasar:  dotslash | 2006-06-02 20:15:53 +0200
 - object -> widget
 - add label.c, input.c



Property changes on: trunk
___________________________________________________________________
Name: svk:merge
   - bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:671
   + bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:673

Modified: trunk/libs3dw/Makefile.am
===================================================================
--- trunk/libs3dw/Makefile.am	2006-06-02 18:01:51 UTC (rev 313)
+++ trunk/libs3dw/Makefile.am	2006-06-02 18:15:57 UTC (rev 314)
@@ -1,6 +1,6 @@
 lib_LTLIBRARIES=	libs3dw.la
 
-libs3dw_la_SOURCES=	button.c surface.c object.c style.c event.c animate.c label.c input.c
+libs3dw_la_SOURCES=	button.c surface.c widget.c style.c event.c animate.c label.c input.c
 			
 include_HEADERS= 	s3dw.h
 noinst_HEADERS=		s3dw_int.h

Modified: trunk/libs3dw/animate.c
===================================================================
--- trunk/libs3dw/animate.c	2006-06-02 18:01:51 UTC (rev 313)
+++ trunk/libs3dw/animate.c	2006-06-02 18:15:57 UTC (rev 314)
@@ -27,12 +27,12 @@
 #include <math.h>
 
 /* the animation stack */
-static struct s3dw_object *ani_s[MAXANI];
+static struct s3dw_widget *ani_s[MAXANI];
 static int ani_n=0;
 int moveon=1;
 
 /* is item f already on stack? */
-int _s3dw_ani_onstack(struct s3dw_object *f)
+int _s3dw_ani_onstack(struct s3dw_widget *f)
 {
 	int i;
 	for (i=0;i<ani_n;i++)
@@ -42,7 +42,7 @@
 
 }
 /* add an item on the animation stack */
-void _s3dw_ani_add(struct s3dw_object *f)
+void _s3dw_ani_add(struct s3dw_widget *f)
 {
 	if (ani_n<MAXANI)
 	{
@@ -68,14 +68,14 @@
 	}
 }
 /* well ... */
-void _s3dw_ani_doit(struct s3dw_object *f)
+void _s3dw_ani_doit(struct s3dw_widget *f)
 {
 	s3d_translate(	*(f->_o), f->_dx,f->_dy,f->_dz);
 	s3d_scale(		*(f->_o), f->_ds);
 }
 
 /* finish an animation on the stack, stack index i */
-void _s3dw_ani_finish(struct s3dw_object *f, int i)
+void _s3dw_ani_finish(struct s3dw_widget *f, int i)
 {
 	f->_dx= f->_x;
 	f->_dy= f->_y;
@@ -85,7 +85,7 @@
 	if (i!=-1)
 		_s3dw_ani_del(i);
 }
-void _s3dw_ani_iterate(struct s3dw_object *f)
+void _s3dw_ani_iterate(struct s3dw_widget *f)
 {
 	f->_dx=(f->_x + f->_dx*ZOOMS)/(ZOOMS+1);
 	f->_dy=(f->_y + f->_dy*ZOOMS)/(ZOOMS+1);
@@ -95,7 +95,7 @@
 }
 
 /* checks if f is good enough */
-int _s3dw_ani_check(struct s3dw_object *f)
+int _s3dw_ani_check(struct s3dw_widget *f)
 {
 	float x,y,z;
 	x=f->_dx - f->_x;
@@ -109,7 +109,7 @@
 void s3dw_ani_mate()
 {
 	int i;
-	struct s3dw_object *f;
+	struct s3dw_widget *f;
 	for (i=0;i<ani_n;i++)
 	{
 		f=ani_s[i];
@@ -117,7 +117,7 @@
 		if (_s3dw_ani_check(f))
 		{
 			_s3dw_ani_finish(f,i);
-			i--; /* a new object is here now, take care in the next iteration */
+			i--; /* a new widget is here now, take care in the next iteration */
 		} else {
 			_s3dw_ani_doit(f);
 		}

Modified: trunk/libs3dw/button.c
===================================================================
--- trunk/libs3dw/button.c	2006-06-02 18:01:51 UTC (rev 313)
+++ trunk/libs3dw/button.c	2006-06-02 18:15:57 UTC (rev 314)
@@ -28,9 +28,9 @@
 #include <string.h> /* strdup() */
 
 /* draw and setup the button */
-void s3dw_button_draw(struct s3dw_object *object)
+void s3dw_button_draw(struct s3dw_widget *widget)
 {
-	struct s3dw_button *button=object->data.button;
+	struct s3dw_button *button=widget->data.button;
 	float length;
 	float vertices[8*3];
 	unsigned long polygons[10*4]={
@@ -47,7 +47,7 @@
 	};
 
 	button->_oid_text=s3d_draw_string(button->_text,&length);
-	s3d_pep_materials_a(button->_oid_text,object->_surface->_style->text_mat,1);
+	s3d_pep_materials_a(button->_oid_text,widget->_surface->_style->text_mat,1);
 
 	/* width of the button depends on the length of the text */
 	vertices[0*3+0]=0.0;			vertices[0*3+1]=0.0;		vertices[0*3+2]=0.0;	
@@ -58,44 +58,44 @@
 	vertices[5*3+0]=0.25;			vertices[5*3+1]=-1.75;		vertices[5*3+2]=0.25;	
 	vertices[6*3+0]=length+0.75;	vertices[6*3+1]=-1.75;		vertices[6*3+2]=0.25;	
 	vertices[7*3+0]=length+0.75;	vertices[7*3+1]=-0.25;		vertices[7*3+2]=0.25;	
-	button->_oid_box=s3d_new_object();
-	s3d_push_materials_a(button->_oid_box,object->_surface->_style->input_mat,1);
+	button->_oid_box=s3d_new_widget();
+	s3d_push_materials_a(button->_oid_box,widget->_surface->_style->input_mat,1);
 	s3d_push_vertices   (button->_oid_box,vertices,8);
 	s3d_push_polygons   (button->_oid_box,polygons,10);
-	s3d_link(		   button->_oid_box,object->_surface->oid);
+	s3d_link(		   button->_oid_box,widget->_surface->oid);
 	s3d_link(		   button->_oid_text,button->_oid_box);
 	s3d_translate(button->_oid_text,0.5,-1.5,0.30);
-	s3d_translate(button->_oid_box,object->_x,-object->_y,0);
-	object->_o=&(button->_oid_box);
-	object->_width=length+1;
-	object->_height=2;
+	s3d_translate(button->_oid_box,widget->_x,-widget->_y,0);
+	widget->_o=&(button->_oid_box);
+	widget->_width=length+1;
+	widget->_height=2;
     s3d_flags_on(button->_oid_box,S3D_OF_VISIBLE|S3D_OF_SELECTABLE);
     s3d_flags_on(button->_oid_text,S3D_OF_VISIBLE|S3D_OF_SELECTABLE);
 
 }
 
 /* create a new button in the surface */
-struct s3dw_object *s3dw_button_new(struct s3dw_surface *surface, char *text, float posx, float posy)
+struct s3dw_widget *s3dw_button_new(struct s3dw_surface *surface, char *text, float posx, float posy)
 {
 	struct s3dw_button *button;
-	struct s3dw_object *object;
+	struct s3dw_widget *widget;
 	button=(struct s3dw_button *)malloc(sizeof(struct s3dw_button));
-	object=s3dw_object_new();
-	object->type=S3DW_TBUTTON;
+	widget=s3dw_widget_new();
+	widget->type=S3DW_TBUTTON;
 	/* draw button */
 	button->_text=strdup(text);
 	button->onclick=NULL;
-	object->_x=posx;
-	object->_y=posy;
-	object->data.button=button;
-	s3dw_button_draw(object);
-	s3dw_surface_append_obj(surface, object);
-	return(object);
+	widget->_x=posx;
+	widget->_y=posy;
+	widget->data.button=button;
+	s3dw_button_draw(widget);
+	s3dw_surface_append_obj(surface, widget);
+	return(widget);
 }
 void s3dw_button_erase(struct s3dw_button *button)
 {
-	s3d_del_object(button->_oid_text);
-	s3d_del_object(button->_oid_box);
+	s3d_del_widget(button->_oid_text);
+	s3d_del_widget(button->_oid_box);
 
 }
 
@@ -108,12 +108,12 @@
 }
 
 
-void s3dw_button_event_click(struct s3dw_object *object, unsigned long oid)
+void s3dw_button_event_click(struct s3dw_widget *widget, unsigned long oid)
 {
-	if ((object->data.button->_oid_text==oid) || (object->data.button->_oid_box==oid))
+	if ((widget->data.button->_oid_text==oid) || (widget->data.button->_oid_box==oid))
 	{
-		if (object->data.button->onclick!=NULL)
-			object->data.button->onclick(object);
+		if (widget->data.button->onclick!=NULL)
+			widget->data.button->onclick(widget);
 	}
 	
 }

Added: trunk/libs3dw/input.c
===================================================================
--- trunk/libs3dw/input.c	2006-06-02 18:01:51 UTC (rev 313)
+++ trunk/libs3dw/input.c	2006-06-02 18:15:57 UTC (rev 314)
@@ -0,0 +1,117 @@
+/*
+ * input.c
+ *
+ * Copyright (C) 2006 Simon Wunderlich <dotslash at packetmixer.de>
+ *
+ * This file is part of the s3d Widgets, a Widget Library for s3d.
+ * See http://s3d.berlios.de/ for more updates.
+ * 
+ * s3d Widgets is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU Lesser General Public License as published by
+ * the Free Software Foundation; either version 2.1 of the License, or
+ * (at your option) any later version.
+ * 
+ * s3d Widgets is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU Lesser General Public License for more details.
+ * 
+ * You should have received a copy of the GNU Lesser General Public License
+ * along with the s3d Widgets; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
+ */
+
+
+#include <s3d.h>
+#include <s3dw.h>
+#include <s3dw_int.h>
+#include <stdlib.h> /* malloc() */
+#include <string.h> /* strdup() */
+
+void s3dw_input_draw(struct s3dw_widget *widget)
+{
+	struct s3dw_input *input=widget->data.input;
+	float length;
+	float vertices[8*3];
+	unsigned long polygons[10*4]={
+			0,4,5,0,
+			0,5,1,0,
+			1,5,6,0,
+			1,6,2,0,
+			2,6,7,0,
+			2,7,3,0,
+			3,7,4,0,
+			3,4,0,0,
+			4,7,6,0,
+			4,6,5,0
+	};
+	input->_oid_text=s3d_draw_string(input->_text,&length);
+	s3d_pep_materials_a(input->_oid_text,widget->_surface->_style->text_mat,1);
+	/* width of the input depends on the length of the text */
+	vertices[0*3+0]=0.0;			vertices[0*3+1]=0.0;		vertices[0*3+2]=0.0;	
+	vertices[1*3+0]=0.0;			vertices[1*3+1]=-2.0;		vertices[1*3+2]=0.0;	
+	vertices[2*3+0]=length+1;		vertices[2*3+1]=-2.0;		vertices[2*3+2]=0.0;	
+	vertices[3*3+0]=length+1;		vertices[3*3+1]=0.0;		vertices[3*3+2]=0.0;	
+	vertices[4*3+0]=0.25;			vertices[4*3+1]=-0.25;		vertices[4*3+2]=0.25;	
+	vertices[5*3+0]=0.25;			vertices[5*3+1]=-1.75;		vertices[5*3+2]=0.25;	
+	vertices[6*3+0]=length+0.75;	vertices[6*3+1]=-1.75;		vertices[6*3+2]=0.25;	
+	vertices[7*3+0]=length+0.75;	vertices[7*3+1]=-0.25;		vertices[7*3+2]=0.25;	
+	input->_oid_box=s3d_new_widget();
+	s3d_push_materials_a(input->_oid_box,widget->_surface->_style->input_mat,1);
+	s3d_push_vertices   (input->_oid_box,vertices,8);
+	s3d_push_polygons   (input->_oid_box,polygons,10);
+	s3d_link(		   input->_oid_box,widget->_surface->oid);
+	s3d_link(		   input->_oid_text,input->_oid_box);
+	s3d_translate(input->_oid_text,0.5,-1.5,0.30);
+	s3d_translate(input->_oid_box,widget->_x,-widget->_y,0);
+	widget->_width=length+1;
+	widget->_height=2;
+	widget->_o=&(input->_oid_box);
+    s3d_flags_on(input->_oid_box,S3D_OF_VISIBLE|S3D_OF_SELECTABLE);
+    s3d_flags_on(input->_oid_text,S3D_OF_VISIBLE|S3D_OF_SELECTABLE);
+
+
+}
+/* create a new input in the surface */
+struct s3dw_widget *s3dw_input_new(struct s3dw_surface *surface, char *text, float posx, float posy)
+{
+	struct s3dw_input *input;
+	struct s3dw_widget *widget;
+	input=(struct s3dw_input *)malloc(sizeof(struct s3dw_input));
+	widget=s3dw_widget_new();
+	widget->type=S3DW_TBUTTON;
+	/* draw input */
+	input->_text=strdup(text);
+	input->onclick=NULL;
+	widget->_x=posx;
+	widget->_y=posy;
+	widget->data.input=input;
+
+	s3dw_input_draw(widget);
+	s3dw_surface_append_obj(surface, widget);
+	return(widget);
+}
+void s3dw_input_erase(struct s3dw_input *input)
+{
+	s3d_del_widget(input->_oid_text);
+	s3d_del_widget(input->_oid_box);
+
+}
+/* destroy the input */
+void s3dw_input_destroy(struct s3dw_input *input)
+{
+    s3dw_input_erase(input);
+	free(input->_text);
+	free(input);
+}
+
+
+void s3dw_input_event_click(struct s3dw_widget *widget, unsigned long oid)
+{
+	if ((widget->data.input->_oid_text==oid) || (widget->data.input->_oid_box==oid))
+	{
+		if (widget->data.input->onclick!=NULL)
+			widget->data.input->onclick(widget);
+	}
+	
+}

Added: trunk/libs3dw/label.c
===================================================================
--- trunk/libs3dw/label.c	2006-06-02 18:01:51 UTC (rev 313)
+++ trunk/libs3dw/label.c	2006-06-02 18:15:57 UTC (rev 314)
@@ -0,0 +1,86 @@
+/*
+ * label.c
+ *
+ * Copyright (C) 2006 Simon Wunderlich <dotslash at packetmixer.de>
+ *
+ * This file is part of the s3d Widgets, a Widget Library for s3d.
+ * See http://s3d.berlios.de/ for more updates.
+ * 
+ * s3d Widgets is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU Lesser General Public License as published by
+ * the Free Software Foundation; either version 2.1 of the License, or
+ * (at your option) any later version.
+ * 
+ * s3d Widgets is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU Lesser General Public License for more details.
+ * 
+ * You should have received a copy of the GNU Lesser General Public License
+ * along with the s3d Widgets; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
+ */
+
+
+#include <s3d.h>
+#include <s3dw.h>
+#include <s3dw_int.h>
+#include <stdlib.h> /* malloc() */
+#include <string.h> /* strdup() */
+
+void s3dw_label_draw(struct s3dw_widget *widget)
+{
+	struct s3dw_label *label=widget->data.label;
+	float length;
+	label->_oid_text=s3d_draw_string(label->_text,&length);
+	s3d_pep_materials_a(label->_oid_text,widget->_surface->_style->text_mat,1);
+	s3d_link(label->_oid_text,widget->_surface->oid);
+	s3d_translate(label->_oid_text,widget->_x,-widget->_y,0.1);
+	widget->_width=length+1;
+	widget->_height=2;
+
+    s3d_flags_on(label->_oid_text,S3D_OF_VISIBLE|S3D_OF_SELECTABLE);
+
+}
+/* create a new label in the surface */
+struct s3dw_widget *s3dw_label_new(struct s3dw_surface *surface, char *text, float posx, float posy)
+{
+	struct s3dw_label *label;
+	struct s3dw_widget *widget;
+	label=(struct s3dw_label *)malloc(sizeof(struct s3dw_label));
+	widget=s3dw_widget_new();
+	widget->type=S3DW_TBUTTON;
+	/* draw label */
+	label->_text=strdup(text);
+	label->onclick=NULL;
+	widget->_x=posx;
+	widget->_y=posy;
+	widget->data.label=label;
+	widget->_o=&(label->_oid_text);
+	s3dw_label_draw(widget);
+	s3dw_surface_append_obj(surface, widget);
+	return(widget);
+}
+
+void s3dw_label_erase(struct s3dw_label *label)
+{
+	s3d_del_widget(label->_oid_text);
+}
+/* destroy the label */
+void s3dw_label_destroy(struct s3dw_label *label)
+{
+	s3dw_label_erase(label);
+	free(label->_text);
+	free(label);
+}
+
+
+void s3dw_label_event_click(struct s3dw_widget *widget, unsigned long oid)
+{
+	if (widget->data.label->_oid_text==oid)
+	{
+		if (widget->data.label->onclick!=NULL)
+			widget->data.label->onclick(widget);
+	}
+	
+}

Deleted: trunk/libs3dw/object.c
===================================================================
--- trunk/libs3dw/object.c	2006-06-02 18:01:51 UTC (rev 313)
+++ trunk/libs3dw/object.c	2006-06-02 18:15:57 UTC (rev 314)
@@ -1,77 +0,0 @@
-/*
- * object.c
- *
- * Copyright (C) 2006 Simon Wunderlich <dotslash at packetmixer.de>
- *
- * This file is part of the s3d Widgets, a Widget Library for s3d.
- * See http://s3d.berlios.de/ for more updates.
- * 
- * s3d Widgets is free software; you can redistribute it and/or modify
- * it under the terms of the GNU Lesser General Public License as published by
- * the Free Software Foundation; either version 2.1 of the License, or
- * (at your option) any later version.
- * 
- * s3d Widgets is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU Lesser General Public License for more details.
- * 
- * You should have received a copy of the GNU Lesser General Public License
- * along with the s3d Widgets; if not, write to the Free Software
- * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
- */
-
-#include <s3d.h>
-#include <s3dw.h>
-#include <s3dw_int.h>
-#include <stdlib.h> /* malloc() */
-#include <string.h> /* strdup() */
-
-struct s3dw_object *s3dw_object_new()
-{
-	struct s3dw_object *object=malloc(sizeof(struct s3dw_object));
-	object->type=-1;
-	object->_x=object->_dx=0;
-	object->_y=object->_dy=0;
-	object->_z=object->_dz=0;
-	object->_rx=object->_drx=0;
-	object->_ry=object->_dry=0;
-	object->_rz=object->_drz=0;
-	object->_s=object->_ds=1;
-	object->_o=NULL;
-	object->_width=0;
-	object->_height=0;
-	object->_surface=NULL;
-	object->data.surface=NULL;
-	return(object);
-}
-void s3dw_object_destroy(struct s3dw_object *object)
-{
-	switch (object->type)
-		{
-			case S3DW_TBUTTON:		s3dw_button_destroy(object->data.button);			break;
-			case S3DW_TSURFACE:		s3dw_surface_destroy(object->data.surface);			break;
-			case S3DW_TLABEL:		s3dw_label_destroy(object->data.label);				break;
-			case S3DW_TINPUT:		s3dw_input_destroy(object->data.input);				break;
-			default:
-					dprintf(MED,"can't free this type (yet) - memory leak\n");
-		}
-	free(object);
-}
-void s3dw_object_event_click(struct s3dw_object *object, unsigned long oid)
-{
-	switch (object->type)
-		{
-			case S3DW_TBUTTON:
-					s3dw_button_event_click(object,oid);
-					break;
-			case S3DW_TLABEL:
-					s3dw_label_event_click(object,oid);
-					break;
-			case S3DW_TINPUT:
-					s3dw_input_event_click(object,oid);
-					break;
-
-		}
-
-}

Modified: trunk/libs3dw/s3dw.h
===================================================================
--- trunk/libs3dw/s3dw.h	2006-06-02 18:01:51 UTC (rev 313)
+++ trunk/libs3dw/s3dw.h	2006-06-02 18:15:57 UTC (rev 314)
@@ -33,7 +33,7 @@
 	S3DW_TINPUT
 };
 
-struct s3dw_object {
+struct s3dw_widget {
 	int type;
 	int   _flags;
 	struct s3dw_surface *_surface;
@@ -50,7 +50,7 @@
 	unsigned long *_o;
 };
 
-typedef void (*s3dw_callback)(struct s3dw_object *);
+typedef void (*s3dw_callback)(struct s3dw_widget *);
 
 struct s3dw_button {
 	char *_text;
@@ -80,7 +80,7 @@
 	unsigned long		  _oid_tbar;
 	int 				  _nobj;
 	char				 *title;
-	struct s3dw_object 	**_pobj;
+	struct s3dw_widget 	**_pobj;
 	struct s3dw_style 	 *_style;
 };
 
@@ -94,16 +94,16 @@
 	float title_text_mat[12];
 };
 /* button.c */
-struct s3dw_object *s3dw_button_new(struct s3dw_surface *surface, char *text, float posx, float posy);
+struct s3dw_widget *s3dw_button_new(struct s3dw_surface *surface, char *text, float posx, float posy);
 /* label.c */
-struct s3dw_object *s3dw_label_new(struct s3dw_surface *surface, char *text, float posx, float posy);
+struct s3dw_widget *s3dw_label_new(struct s3dw_surface *surface, char *text, float posx, float posy);
 /* input.c */
-struct s3dw_object *s3dw_input_new(struct s3dw_surface *surface, char *text, float posx, float posy);
+struct s3dw_widget *s3dw_input_new(struct s3dw_surface *surface, char *text, float posx, float posy);
 /* surface.c */
-struct s3dw_object *s3dw_surface_new(char *title, float width, float height);
+struct s3dw_widget *s3dw_surface_new(char *title, float width, float height);
 void s3dw_surface_delete(struct s3dw_surface *surface);
-/* object.c */
-void s3dw_object_destroy(struct s3dw_object *object);
+/* widget.c */
+void s3dw_widget_destroy(struct s3dw_widget *widget);
 /* event.c */
 void s3dw_click_event(struct s3d_evt *evt);
 /* animate.c */

Modified: trunk/libs3dw/s3dw_int.h
===================================================================
--- trunk/libs3dw/s3dw_int.h	2006-06-02 18:01:51 UTC (rev 313)
+++ trunk/libs3dw/s3dw_int.h	2006-06-02 18:15:57 UTC (rev 314)
@@ -24,40 +24,40 @@
 #include <s3dlib.h> /* dprintf() */
 #define MAXANI		16
 #define ZOOMS		5
-extern	struct s3dw_object  **psurf;
+extern	struct s3dw_widget  **psurf;
 extern	int					  nsurf;
 
-/* object.c */
-struct s3dw_object *s3dw_object_new();
-void s3dw_object_event_click(struct s3dw_object *object, unsigned long oid);
+/* widget.c */
+struct s3dw_widget *s3dw_widget_new();
+void s3dw_widget_event_click(struct s3dw_widget *widget, unsigned long oid);
 /* surface.c */
 void s3dw_surface_destroy(struct s3dw_surface *surface);
-void s3dw_surface_append_obj(struct s3dw_surface *surface, struct s3dw_object *object);
-void s3dw_surface_event_click(struct s3dw_object *object, unsigned long oid);
-void s3dw_surface_draw(struct s3dw_object *object);
+void s3dw_surface_append_obj(struct s3dw_surface *surface, struct s3dw_widget *widget);
+void s3dw_surface_event_click(struct s3dw_widget *widget, unsigned long oid);
+void s3dw_surface_draw(struct s3dw_widget *widget);
 /* button.c */
 void s3dw_button_destroy(struct s3dw_button *button);
-void s3dw_button_event_click(struct s3dw_object *object, unsigned long oid);
-void s3dw_button_draw(struct s3dw_object *object);
+void s3dw_button_event_click(struct s3dw_widget *widget, unsigned long oid);
+void s3dw_button_draw(struct s3dw_widget *widget);
 void s3dw_button_erase(struct s3dw_button *button);
 /* label.c */
 void s3dw_label_destroy(struct s3dw_label *label);
-void s3dw_label_event_click(struct s3dw_object *object, unsigned long oid);
-void s3dw_label_draw(struct s3dw_object *object);
+void s3dw_label_event_click(struct s3dw_widget *widget, unsigned long oid);
+void s3dw_label_draw(struct s3dw_widget *widget);
 /* input.c */
 void s3dw_input_destroy(struct s3dw_input *input);
-void s3dw_input_event_click(struct s3dw_object *object, unsigned long oid);
-void s3dw_input_draw(struct s3dw_object *object);
+void s3dw_input_event_click(struct s3dw_widget *widget, unsigned long oid);
+void s3dw_input_draw(struct s3dw_widget *widget);
 void s3dw_input_erase(struct s3dw_input *input);
 
 
 /* style.c */
 extern struct s3dw_style def_style;
 /* animate.c */
-int  _s3dw_ani_onstack(struct s3dw_object *f);
-void _s3dw_ani_add(struct s3dw_object *f);
+int  _s3dw_ani_onstack(struct s3dw_widget *f);
+void _s3dw_ani_add(struct s3dw_widget *f);
 void _s3dw_ani_del(int i);
-void _s3dw_ani_doit(struct s3dw_object *f);
-void _s3dw_ani_finish(struct s3dw_object *f, int i);
-void _s3dw_ani_iterate(struct s3dw_object *f);
-int  _s3dw_ani_check(struct s3dw_object *f);
+void _s3dw_ani_doit(struct s3dw_widget *f);
+void _s3dw_ani_finish(struct s3dw_widget *f, int i);
+void _s3dw_ani_iterate(struct s3dw_widget *f);
+int  _s3dw_ani_check(struct s3dw_widget *f);

Modified: trunk/libs3dw/surface.c
===================================================================
--- trunk/libs3dw/surface.c	2006-06-02 18:01:51 UTC (rev 313)
+++ trunk/libs3dw/surface.c	2006-06-02 18:15:57 UTC (rev 314)
@@ -27,12 +27,12 @@
 #include <stdlib.h> /* malloc() */
 #include <string.h> /* strdup() */
 
-struct s3dw_object **psurf=NULL;
+struct s3dw_widget **psurf=NULL;
 int					  nsurf=0;
 
-void s3dw_surface_draw(struct s3dw_object *object)
+void s3dw_surface_draw(struct s3dw_widget *widget)
 {
-	struct s3dw_surface *surface=object->data.surface;
+	struct s3dw_surface *surface=widget->data.surface;
 	int textlen;
 	float length;
 	float vertices[8*3]={
@@ -61,22 +61,22 @@
 	unsigned long tpol[10*4];
 	int i;
 
-	surface->oid=s3d_new_object();
-	surface->_oid_tbar=s3d_new_object();
+	surface->oid=s3d_new_widget();
+	surface->_oid_tbar=s3d_new_widget();
 	s3d_select_font("vera");
 	surface->_oid_title=s3d_draw_string(surface->title,&length);
-	while (length > (object->_width+1))
+	while (length > (widget->_width+1))
 	{
-		dprintf(HIGH,"%f > %f",length,object->_width+1);
+		dprintf(HIGH,"%f > %f",length,widget->_width+1);
 		textlen=strlen(surface->title);
-		if (length>((object->_width+1)*1.3))
-			textlen=textlen*((object->_width+1)*1.1/length);
+		if (length>((widget->_width+1)*1.3))
+			textlen=textlen*((widget->_width+1)*1.1/length);
 		if (textlen>4)
 		{
 			surface->title[textlen-2]=0;
 			surface->title[textlen-3]='.';
 			surface->title[textlen-4]='.';
-			s3d_del_object(surface->_oid_title);
+			s3d_del_widget(surface->_oid_title);
 			surface->_oid_title=s3d_draw_string(surface->title,&length);
 		} else {
 			break;
@@ -85,10 +85,10 @@
  	/* prepare vertices */
 	for (i=0;i<8;i++)
 	{
-		sver[i*3 + 0]=vertices[i*3+0] * object->_width;
-		sver[i*3 + 1]=vertices[i*3+1] * -object->_height;
+		sver[i*3 + 0]=vertices[i*3+0] * widget->_width;
+		sver[i*3 + 1]=vertices[i*3+1] * -widget->_height;
 		sver[i*3 + 2]=vertices[i*3+2] * -1;
-		tver[i*3 + 0]=vertices[i*3+0] * object->_width;
+		tver[i*3 + 0]=vertices[i*3+0] * widget->_width;
 		tver[i*3 + 1]=vertices[i*3+1];
 		tver[i*3 + 2]=vertices[i*3+2] * -1;
 	}
@@ -100,7 +100,7 @@
 	   tpol[i*4 + 2]=polygon[i*4 + 2];
 	   tpol[i*4 + 3]=polygon[i*4 + 3];
 	}
-	object->_o=&(surface->oid);
+	widget->_o=&(surface->oid);
 	s3d_push_vertices(surface->oid,sver,8);
 	s3d_push_vertices(surface->_oid_tbar,tver,8);
 	s3d_push_materials_a(surface->oid      ,surface->_style->surface_mat,1);
@@ -118,10 +118,10 @@
 
 }
 /* create a new surface */
-struct s3dw_object *s3dw_surface_new(char *title, float width, float height)
+struct s3dw_widget *s3dw_surface_new(char *title, float width, float height)
 {
 	struct s3dw_surface *surface;
-	struct s3dw_object  *object;
+	struct s3dw_widget  *widget;
 			
 	surface=(struct s3dw_surface *)malloc(sizeof(struct s3dw_surface));
 	surface->_nobj=0;
@@ -130,21 +130,21 @@
 	surface->title=strdup(title);
 
 	nsurf++;
-	psurf=realloc(psurf,sizeof(struct s3dw_object **)*nsurf);
-	object=s3dw_object_new();
-	object->type=S3DW_TSURFACE;
-	object->data.surface=surface;
-	object->_width=width;
-	object->_height=height;
-	psurf[nsurf-1]=object;
-	s3dw_surface_draw(object);
-	return(object);
+	psurf=realloc(psurf,sizeof(struct s3dw_widget **)*nsurf);
+	widget=s3dw_widget_new();
+	widget->type=S3DW_TSURFACE;
+	widget->data.surface=surface;
+	widget->_width=width;
+	widget->_height=height;
+	psurf[nsurf-1]=widget;
+	s3dw_surface_draw(widget);
+	return(widget);
 }
 void s3dw_surface_erase(struct s3dw_surface *surface)
 {
-	s3d_del_object(surface->oid);
-	s3d_del_object(surface->_oid_tbar);
-	s3d_del_object(surface->_oid_title);
+	s3d_del_widget(surface->oid);
+	s3d_del_widget(surface->_oid_tbar);
+	s3d_del_widget(surface->_oid_title);
 }
 /* destroy the surface */
 void s3dw_surface_destroy(struct s3dw_surface *surface)
@@ -154,7 +154,7 @@
 	{
 		for (i=0;i<surface->_nobj;i++)
 		{
-			s3dw_object_destroy(surface->_pobj[i]);
+			s3dw_widget_destroy(surface->_pobj[i]);
 		}
 		free(surface->_pobj);
 	}
@@ -177,27 +177,27 @@
 			break;
 		}
 }
-/* append an object */
-void s3dw_surface_append_obj(struct s3dw_surface *surface, struct s3dw_object *object)
+/* append an widget */
+void s3dw_surface_append_obj(struct s3dw_surface *surface, struct s3dw_widget *widget)
 {
 	surface->_nobj++;
-	surface->_pobj=realloc(surface->_pobj,sizeof(struct s3dw_object *)*surface->_nobj);
-	surface->_pobj[surface->_nobj-1]=object;
-	object->_surface=surface;
+	surface->_pobj=realloc(surface->_pobj,sizeof(struct s3dw_widget *)*surface->_nobj);
+	surface->_pobj[surface->_nobj-1]=widget;
+	widget->_surface=surface;
 }
-/* test objects of the surface for clicks */
-void s3dw_surface_event_click(struct s3dw_object *object, unsigned long oid)
+/* test widgets of the surface for clicks */
+void s3dw_surface_event_click(struct s3dw_widget *widget, unsigned long oid)
 {
 	int i;
-	if (object->data.surface->oid==oid)
+	if (widget->data.surface->oid==oid)
 	{
-		dprintf(MED,"body %s clicked",object->data.surface->title);
+		dprintf(MED,"body %s clicked",widget->data.surface->title);
 	}
-	if ((object->data.surface->_oid_tbar==oid) || (object->data.surface->_oid_title==oid))
+	if ((widget->data.surface->_oid_tbar==oid) || (widget->data.surface->_oid_title==oid))
 	{
-		dprintf(MED,"title %s clicked",object->data.surface->title);
+		dprintf(MED,"title %s clicked",widget->data.surface->title);
 	}
-	for (i=0;i<object->data.surface->_nobj;i++)
-		s3dw_object_event_click(object->data.surface->_pobj[i],oid);
+	for (i=0;i<widget->data.surface->_nobj;i++)
+		s3dw_widget_event_click(widget->data.surface->_pobj[i],oid);
 }
 

Added: trunk/libs3dw/widget.c
===================================================================
--- trunk/libs3dw/widget.c	2006-06-02 18:01:51 UTC (rev 313)
+++ trunk/libs3dw/widget.c	2006-06-02 18:15:57 UTC (rev 314)
@@ -0,0 +1,77 @@
+/*
+ * widget.c
+ *
+ * Copyright (C) 2006 Simon Wunderlich <dotslash at packetmixer.de>
+ *
+ * This file is part of the s3d Widgets, a Widget Library for s3d.
+ * See http://s3d.berlios.de/ for more updates.
+ * 
+ * s3d Widgets is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU Lesser General Public License as published by
+ * the Free Software Foundation; either version 2.1 of the License, or
+ * (at your option) any later version.
+ * 
+ * s3d Widgets is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU Lesser General Public License for more details.
+ * 
+ * You should have received a copy of the GNU Lesser General Public License
+ * along with the s3d Widgets; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
+ */
+
+#include <s3d.h>
+#include <s3dw.h>
+#include <s3dw_int.h>
+#include <stdlib.h> /* malloc() */
+#include <string.h> /* strdup() */
+
+struct s3dw_widget *s3dw_widget_new()
+{
+	struct s3dw_widget *widget=malloc(sizeof(struct s3dw_widget));
+	widget->type=-1;
+	widget->_x=widget->_dx=0;
+	widget->_y=widget->_dy=0;
+	widget->_z=widget->_dz=0;
+	widget->_rx=widget->_drx=0;
+	widget->_ry=widget->_dry=0;
+	widget->_rz=widget->_drz=0;
+	widget->_s=widget->_ds=1;
+	widget->_o=NULL;
+	widget->_width=0;
+	widget->_height=0;
+	widget->_surface=NULL;
+	widget->data.surface=NULL;
+	return(widget);
+}
+void s3dw_widget_destroy(struct s3dw_widget *widget)
+{
+	switch (widget->type)
+		{
+			case S3DW_TBUTTON:		s3dw_button_destroy(widget->data.button);			break;
+			case S3DW_TSURFACE:		s3dw_surface_destroy(widget->data.surface);			break;
+			case S3DW_TLABEL:		s3dw_label_destroy(widget->data.label);				break;
+			case S3DW_TINPUT:		s3dw_input_destroy(widget->data.input);				break;
+			default:
+					dprintf(MED,"can't free this type (yet) - memory leak\n");
+		}
+	free(widget);
+}
+void s3dw_widget_event_click(struct s3dw_widget *widget, unsigned long oid)
+{
+	switch (widget->type)
+		{
+			case S3DW_TBUTTON:
+					s3dw_button_event_click(widget,oid);
+					break;
+			case S3DW_TLABEL:
+					s3dw_label_event_click(widget,oid);
+					break;
+			case S3DW_TINPUT:
+					s3dw_input_event_click(widget,oid);
+					break;
+
+		}
+
+}



From dotslash at berlios.de  Fri Jun  2 20:52:40 2006
From: dotslash at berlios.de (dotslash at BerliOS)
Date: Fri, 2 Jun 2006 20:52:40 +0200
Subject: [S3d-svn] r315 - in trunk: . example libs3dw
Message-ID: <200606021852.k52Iqeqt013492@sheep.berlios.de>

Author: dotslash
Date: 2006-06-02 20:52:36 +0200 (Fri, 02 Jun 2006)
New Revision: 315

Modified:
   trunk/
   trunk/example/widgets.c
   trunk/libs3dw/button.c
   trunk/libs3dw/input.c
   trunk/libs3dw/label.c
   trunk/libs3dw/surface.c
Log:
 r675 at balthasar:  dotslash | 2006-06-02 20:52:21 +0200
 - too much substitution. should compile now ^^;



Property changes on: trunk
___________________________________________________________________
Name: svk:merge
   - bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:673
   + bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:675

Modified: trunk/example/widgets.c
===================================================================
--- trunk/example/widgets.c	2006-06-02 18:15:57 UTC (rev 314)
+++ trunk/example/widgets.c	2006-06-02 18:52:36 UTC (rev 315)
@@ -29,36 +29,36 @@
 #include <stdio.h>  /* NULL */
 #include <time.h>	/* nanosleep() */
 
-struct s3dw_object *surface;
+struct s3dw_widget *surface;
 static struct timespec t={0,100*1000*1000}; /* 100 mili seconds */
 void mainloop()
 {
 	nanosleep(&t,NULL); 
 }
-void object_click(struct s3d_evt *evt)
+void widget_click(struct s3d_evt *evt)
 {
 	s3dw_click_event(evt);
 /*	s3d_quit();*/
 }
-void okay_button(struct s3dw_object *dummy)
+void okay_button(struct s3dw_widget *dummy)
 {
 	s3d_quit();
 }
 
-void forward_button(struct s3dw_object *dummy)
+void forward_button(struct s3dw_widget *dummy)
 {
-	struct s3dw_object *o;
-	s3dw_object_destroy(surface);
+	struct s3dw_widget *o;
+	s3dw_widget_destroy(surface);
 	surface=s3dw_surface_new("Let's go",10,7);
 	s3dw_label_new(surface->data.surface,"Fast Forward!!",1,2);
 	o=s3dw_button_new(surface->data.surface,"Okay",4,4);
 	o->data.button->onclick=okay_button;
 
 }
-void high_button(struct s3dw_object *dummy)
+void high_button(struct s3dw_widget *dummy)
 {
-	struct s3dw_object *o;
-	s3dw_object_destroy(surface);
+	struct s3dw_widget *o;
+	s3dw_widget_destroy(surface);
 	surface=s3dw_surface_new("Up Up'n Away!",10,7);
 	s3dw_label_new(surface->data.surface,"Fly away ...",1,2);
 	o=s3dw_button_new(surface->data.surface,"Okay",4,4);
@@ -68,10 +68,10 @@
 
 int main (int argc, char **argv)
 {
-	struct s3dw_object *o;
+	struct s3dw_widget *o;
 	if (!s3d_init(&argc,&argv,"widgettest"))
 	{
-		s3d_set_callback(S3D_EVENT_OBJ_CLICK,object_click);
+		s3d_set_callback(S3D_EVENT_OBJ_CLICK,widget_click);
 
 		surface=s3dw_surface_new("Hello World",20,10);
 		s3dw_label_new(surface->data.surface,"Where do you want to fly today?",1,2);

Modified: trunk/libs3dw/button.c
===================================================================
--- trunk/libs3dw/button.c	2006-06-02 18:15:57 UTC (rev 314)
+++ trunk/libs3dw/button.c	2006-06-02 18:52:36 UTC (rev 315)
@@ -58,7 +58,7 @@
 	vertices[5*3+0]=0.25;			vertices[5*3+1]=-1.75;		vertices[5*3+2]=0.25;	
 	vertices[6*3+0]=length+0.75;	vertices[6*3+1]=-1.75;		vertices[6*3+2]=0.25;	
 	vertices[7*3+0]=length+0.75;	vertices[7*3+1]=-0.25;		vertices[7*3+2]=0.25;	
-	button->_oid_box=s3d_new_widget();
+	button->_oid_box=s3d_new_object();
 	s3d_push_materials_a(button->_oid_box,widget->_surface->_style->input_mat,1);
 	s3d_push_vertices   (button->_oid_box,vertices,8);
 	s3d_push_polygons   (button->_oid_box,polygons,10);
@@ -94,8 +94,8 @@
 }
 void s3dw_button_erase(struct s3dw_button *button)
 {
-	s3d_del_widget(button->_oid_text);
-	s3d_del_widget(button->_oid_box);
+	s3d_del_object(button->_oid_text);
+	s3d_del_object(button->_oid_box);
 
 }
 

Modified: trunk/libs3dw/input.c
===================================================================
--- trunk/libs3dw/input.c	2006-06-02 18:15:57 UTC (rev 314)
+++ trunk/libs3dw/input.c	2006-06-02 18:52:36 UTC (rev 315)
@@ -56,7 +56,7 @@
 	vertices[5*3+0]=0.25;			vertices[5*3+1]=-1.75;		vertices[5*3+2]=0.25;	
 	vertices[6*3+0]=length+0.75;	vertices[6*3+1]=-1.75;		vertices[6*3+2]=0.25;	
 	vertices[7*3+0]=length+0.75;	vertices[7*3+1]=-0.25;		vertices[7*3+2]=0.25;	
-	input->_oid_box=s3d_new_widget();
+	input->_oid_box=s3d_new_object();
 	s3d_push_materials_a(input->_oid_box,widget->_surface->_style->input_mat,1);
 	s3d_push_vertices   (input->_oid_box,vertices,8);
 	s3d_push_polygons   (input->_oid_box,polygons,10);
@@ -93,8 +93,8 @@
 }
 void s3dw_input_erase(struct s3dw_input *input)
 {
-	s3d_del_widget(input->_oid_text);
-	s3d_del_widget(input->_oid_box);
+	s3d_del_object(input->_oid_text);
+	s3d_del_object(input->_oid_box);
 
 }
 /* destroy the input */

Modified: trunk/libs3dw/label.c
===================================================================
--- trunk/libs3dw/label.c	2006-06-02 18:15:57 UTC (rev 314)
+++ trunk/libs3dw/label.c	2006-06-02 18:52:36 UTC (rev 315)
@@ -64,7 +64,7 @@
 
 void s3dw_label_erase(struct s3dw_label *label)
 {
-	s3d_del_widget(label->_oid_text);
+	s3d_del_object(label->_oid_text);
 }
 /* destroy the label */
 void s3dw_label_destroy(struct s3dw_label *label)

Modified: trunk/libs3dw/surface.c
===================================================================
--- trunk/libs3dw/surface.c	2006-06-02 18:15:57 UTC (rev 314)
+++ trunk/libs3dw/surface.c	2006-06-02 18:52:36 UTC (rev 315)
@@ -61,8 +61,8 @@
 	unsigned long tpol[10*4];
 	int i;
 
-	surface->oid=s3d_new_widget();
-	surface->_oid_tbar=s3d_new_widget();
+	surface->oid=s3d_new_object();
+	surface->_oid_tbar=s3d_new_object();
 	s3d_select_font("vera");
 	surface->_oid_title=s3d_draw_string(surface->title,&length);
 	while (length > (widget->_width+1))
@@ -76,7 +76,7 @@
 			surface->title[textlen-2]=0;
 			surface->title[textlen-3]='.';
 			surface->title[textlen-4]='.';
-			s3d_del_widget(surface->_oid_title);
+			s3d_del_object(surface->_oid_title);
 			surface->_oid_title=s3d_draw_string(surface->title,&length);
 		} else {
 			break;
@@ -142,9 +142,9 @@
 }
 void s3dw_surface_erase(struct s3dw_surface *surface)
 {
-	s3d_del_widget(surface->oid);
-	s3d_del_widget(surface->_oid_tbar);
-	s3d_del_widget(surface->_oid_title);
+	s3d_del_object(surface->oid);
+	s3d_del_object(surface->_oid_tbar);
+	s3d_del_object(surface->_oid_title);
 }
 /* destroy the surface */
 void s3dw_surface_destroy(struct s3dw_surface *surface)



From dotslash at berlios.de  Fri Jun  2 21:50:52 2006
From: dotslash at berlios.de (dotslash at BerliOS)
Date: Fri, 2 Jun 2006 21:50:52 +0200
Subject: [S3d-svn] r316 - trunk/example
Message-ID: <200606021950.k52JoqPj016143@sheep.berlios.de>

Author: dotslash
Date: 2006-06-02 21:50:51 +0200 (Fri, 02 Jun 2006)
New Revision: 316

Modified:
   trunk/example/Makefile.am
Log:
- flags for 3dsloader_g3d

Modified: trunk/example/Makefile.am
===================================================================
--- trunk/example/Makefile.am	2006-06-02 18:52:36 UTC (rev 315)
+++ trunk/example/Makefile.am	2006-06-02 19:50:51 UTC (rev 316)
@@ -19,9 +19,9 @@
 3dsloader_g3d_SOURCES=	3dsloader_g3d.c
 
 CPPFLAGS=		-I$(top_srcdir)/server -I$(top_srcdir)/libs3d 
-3dsloader_g3d_CFLAGS=	-I$(top_srcdir)/libs3d/libg3d/include
+LIBS=			$(top_builddir)/libs3d/libs3d.la  
+3dsloader_g3d_CFLAGS=	-I$(top_srcdir)/libs3d/libg3d/include @GLIB_CFLAGS@
 widgets_CFLAGS=			-I$(top_srcdir)/libs3dw 
-LIBS=			$(top_builddir)/libs3d/libs3d.la  
 widgets_LDFLAGS=		$(top_builddir)/libs3dw/libs3dw.la
 3dsloader_g3d_LDFLAGS=	$(top_builddir)/libs3d/libg3d/src/libg3d.la
 



From nichtsnutz at berlios.de  Sat Jun  3 13:48:03 2006
From: nichtsnutz at berlios.de (nichtsnutz at BerliOS)
Date: Sat, 3 Jun 2006 13:48:03 +0200
Subject: [S3d-svn] r317 - trunk/example
Message-ID: <200606031148.k53Bm36Q001593@sheep.berlios.de>

Author: nichtsnutz
Date: 2006-06-03 13:48:00 +0200 (Sat, 03 Jun 2006)
New Revision: 317

Added:
   trunk/example/nichtsnutz.c
Modified:
   trunk/example/Makefile.am
Log:
nichtsnutz testing



Modified: trunk/example/Makefile.am
===================================================================
--- trunk/example/Makefile.am	2006-06-02 19:50:51 UTC (rev 316)
+++ trunk/example/Makefile.am	2006-06-03 11:48:00 UTC (rev 317)
@@ -1,7 +1,7 @@
 noinst_PROGRAMS=	hudtest katze \
 			ptrtest radius_test s3dclock snowman \
 			strtest texturetest linetest widgets \
-			3dsloader_g3d
+			3dsloader_g3d nichtsnutz
 bin_PROGRAMS= filebrowser 3dsloader
 			
 3dsloader_SOURCES=		3dsloader.c
@@ -17,6 +17,7 @@
 texturetest_SOURCES=	texturetest.c
 ptrtest_SOURCES=		ptrtest.c
 3dsloader_g3d_SOURCES=	3dsloader_g3d.c
+nichtsnutz_SOURCES=		nichtsnutz.c
 
 CPPFLAGS=		-I$(top_srcdir)/server -I$(top_srcdir)/libs3d 
 LIBS=			$(top_builddir)/libs3d/libs3d.la  

Added: trunk/example/nichtsnutz.c
===================================================================
--- trunk/example/nichtsnutz.c	2006-06-02 19:50:51 UTC (rev 316)
+++ trunk/example/nichtsnutz.c	2006-06-03 11:48:00 UTC (rev 317)
@@ -0,0 +1,144 @@
+/*
+ * nichtsnutz.c
+ * 
+ * Copyright (C) 2004-2006 Simon Wunderlich <dotslash at packetmixer.de>
+ *
+ * This file is part of s3d, a 3d network display server.
+ * See http://s3d.berlios.de/ for more updates.
+ * 
+ * s3d is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2 of the License, or
+ * (at your option) any later version.
+ * 
+ * s3d is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ * 
+ * You should have received a copy of the GNU General Public License
+ * along with s3d; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
+ */
+
+
+
+
+#include <s3d.h>
+#include <s3d_keysym.h>
+#include <stdio.h>
+#include <math.h>
+#include <time.h>	
+
+static struct timespec t={0,10*1000*1000}; /* 10 mili seconds */
+
+int object,foll;
+float al, r, rc, alpha,Asp,Bottom,Left,angle;
+float CamPosition[2][3],
+	  TmpCam[2][3],
+	  RotCam[2][3],
+	  CatPos[3];
+
+void mainloop()
+{
+	
+	al=(alpha*M_PI/180);
+    r = 5.0;
+	rc = 10.0;
+	
+	CatPos[0] = sin(al)*r;
+	CatPos[1] = 0;
+	CatPos[2] = cos(al)*r;
+	
+	RotCam[0][0] = sin(al)*rc;
+	RotCam[0][1] = 0;
+	RotCam[0][2] = cos(al)*rc;
+	
+	s3d_translate(object,CatPos[0] ,CatPos[1], CatPos[2]);
+	s3d_rotate(object, 0, alpha, 0);
+	alpha = alpha+0.1;
+	if (alpha>360.0) alpha=0.0;
+
+	if( foll )
+	{
+		
+		CamPosition[0][0] = ((CamPosition[0][0]*4 + RotCam[0][0])/5);
+		CamPosition[0][1] = ((CamPosition[0][1]*4 + RotCam[0][1])/5);
+		CamPosition[0][2] = ((CamPosition[0][2]*4 + RotCam[0][2])/5);
+		s3d_translate(0,CamPosition[0][0],CamPosition[0][1],CamPosition[0][2]);
+	
+		angle = s3d_vector_angle(CatPos,CamPosition[0]);
+		angle = (CatPos[0] > 0)?(180-(180 / M_PI * angle)):(180+(180 / M_PI * angle));
+
+		CamPosition[1][1] = (CamPosition[1][1]*4 + angle)/5;
+		s3d_rotate(0,CamPosition[1][0], CamPosition[1][1], CamPosition[1][2]);
+		/*printf("angle %f\n",angle);*/
+	}
+	nanosleep(&t,NULL); 
+}
+
+void object_info(struct s3d_evt *hrmz)
+{
+	struct s3d_obj_info *inf;
+	inf=(struct s3d_obj_info *)hrmz->buf;
+	
+	if (inf->object==0)
+	{
+		CamPosition[0][0] = inf->trans_x;
+		CamPosition[0][1] = inf->trans_y;
+		CamPosition[0][2] = inf->trans_z;
+		CamPosition[1][0] = inf->rot_x;
+		CamPosition[1][1] = inf->rot_y;
+		CamPosition[1][2] = inf->rot_z;
+
+		Asp=inf->scale;
+		if (Asp>1.0) /* wide screen */
+		{
+			Bottom=-1.0;
+			Left=-Asp;
+		} else {  /* high screen */
+			Bottom=(-1.0/Asp);
+			Left=-1.0;
+		}
+	}
+}
+
+
+
+void keypress(struct s3d_evt *event)
+{
+	int key;
+	key=*((unsigned short *)event->buf);
+	switch(key)
+	{
+		case 'f':
+				foll = foll ? 0 : 1;
+				if( foll )
+				{
+					TmpCam[0][0] = CamPosition[0][0];
+					TmpCam[0][1] = CamPosition[0][1];
+					TmpCam[0][2] = CamPosition[0][2];
+					TmpCam[1][0] = CamPosition[1][0];
+					TmpCam[1][1] = CamPosition[1][1];
+					TmpCam[1][2] = CamPosition[1][2];
+				}
+				break;
+	}
+}
+
+
+int main(int argc, char **argv)
+{
+	
+	if (!s3d_init(&argc,&argv,"running cat"))
+	{
+		s3d_set_callback(S3D_EVENT_KEY,keypress);
+		s3d_set_callback(S3D_EVENT_OBJ_INFO,object_info);
+		
+		object = s3d_import_3ds_file("objs/katze_body.3ds");
+		s3d_flags_on(object, S3D_OF_VISIBLE);
+		s3d_mainloop(mainloop);
+		s3d_quit();
+	}
+	return(0);
+}



From dotslash at berlios.de  Sat Jun  3 23:48:07 2006
From: dotslash at berlios.de (dotslash at BerliOS)
Date: Sat, 3 Jun 2006 23:48:07 +0200
Subject: [S3d-svn] r318 - in trunk: . example libs3dw
Message-ID: <200606032148.k53Lm78q007412@sheep.berlios.de>

Author: dotslash
Date: 2006-06-03 23:48:05 +0200 (Sat, 03 Jun 2006)
New Revision: 318

Added:
   trunk/libs3dw/root.c
Modified:
   trunk/
   trunk/example/widgets.c
   trunk/libs3dw/Makefile.am
   trunk/libs3dw/animate.c
   trunk/libs3dw/button.c
   trunk/libs3dw/event.c
   trunk/libs3dw/input.c
   trunk/libs3dw/label.c
   trunk/libs3dw/s3dw.h
   trunk/libs3dw/s3dw_int.h
   trunk/libs3dw/style.c
   trunk/libs3dw/surface.c
   trunk/libs3dw/widget.c
Log:
 r680 at balthasar:  dotslash | 2006-06-03 23:47:36 +0200
 - cleaned up libs3dw, parent-objects can be typecasted like in gtk
 - add input support
 - heavily documented widgets example



Property changes on: trunk
___________________________________________________________________
Name: svk:merge
   - bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:675
   + bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:680

Modified: trunk/example/widgets.c
===================================================================
--- trunk/example/widgets.c	2006-06-03 11:48:00 UTC (rev 317)
+++ trunk/example/widgets.c	2006-06-03 21:48:05 UTC (rev 318)
@@ -1,7 +1,7 @@
 /*
  * widgets.c
  * 
- * Copyright (C) 2004-2006 Simon Wunderlich <dotslash at packetmixer.de>
+ * Copyright (C) 2006 Simon Wunderlich <dotslash at packetmixer.de>
  *
  * This file is part of s3d, a 3d network display server.
  * See http://s3d.berlios.de/ for more updates.
@@ -28,61 +28,122 @@
 #include <s3dw.h>
 #include <stdio.h>  /* NULL */
 #include <time.h>	/* nanosleep() */
+#include <stdlib.h>	/* free() */
+#include <string.h> /* strlen() */
 
-struct s3dw_widget *surface;
+s3dw_surface *surface;
+s3dw_input *input;
 static struct timespec t={0,100*1000*1000}; /* 100 mili seconds */
 void mainloop()
 {
+	/* keep this in your mainloop. this will do smooth animations for you ... */
+	s3dw_ani_mate();
 	nanosleep(&t,NULL); 
 }
-void widget_click(struct s3d_evt *evt)
+/* you should always put the s3dw-handler in your own event handler,
+ * if you want s3dw to react on clicks or keys ... and i'm sure you
+ * want that ... */
+void click(struct s3d_evt *evt)
 {
-	s3dw_click_event(evt);
-/*	s3d_quit();*/
+	s3dw_handle_click(evt);
 }
-void okay_button(struct s3dw_widget *dummy)
+void key(struct s3d_evt *evt)
 {
+	s3dw_handle_key(evt);
+}
+
+void done_button(s3dw_widget *dummy)
+{
 	s3d_quit();
 }
 
-void forward_button(struct s3dw_widget *dummy)
+void okay_button(s3dw_widget *dummy)
 {
-	struct s3dw_widget *o;
-	s3dw_widget_destroy(surface);
-	surface=s3dw_surface_new("Let's go",10,7);
-	s3dw_label_new(surface->data.surface,"Fast Forward!!",1,2);
-	o=s3dw_button_new(surface->data.surface,"Okay",4,4);
-	o->data.button->onclick=okay_button;
+	s3dw_button *button;
+	char string[32];
+	char *age;
 
+	/* get the input of the text ... before its destroyed, of course*/
+	age=s3dw_input_gettext(input);
+
+	/* delete the old surface with it subwidgets */
+	s3dw_delete(S3DWIDGET(surface));
+	
+	/* and create a new one ... */
+	surface=s3dw_surface_new("Ah!",10,7);
+	
+	/* just cutting the string if it's too long */
+	if (strlen(age)>8) age[8]=0;
+	
+	/* assemble the string ..*/
+	sprintf(string,"I see, %s!!",age);
+
+	s3dw_label_new(surface,string,1,2);
+	button=s3dw_button_new(surface,"Great",4,4);
+	/* clicking on the button will exit ... */
+	button->onclick=done_button;
+	
+	/* of couse, show it */
+	s3dw_show(S3DWIDGET(surface));
+
+	/* we don't need it anymore. always free strings, don't leak around */
+	free(age); 
 }
-void high_button(struct s3dw_widget *dummy)
+void no_button(s3dw_widget *dummy)
 {
-	struct s3dw_widget *o;
-	s3dw_widget_destroy(surface);
-	surface=s3dw_surface_new("Up Up'n Away!",10,7);
-	s3dw_label_new(surface->data.surface,"Fly away ...",1,2);
-	o=s3dw_button_new(surface->data.surface,"Okay",4,4);
-	o->data.button->onclick=okay_button;
-
+	s3dw_button *button;
+	s3dw_delete(S3DWIDGET(surface));
+	surface=s3dw_surface_new("Well ...",10,7);
+	s3dw_label_new(surface,"If you don't want to tell me ...",1,2);
+	button=s3dw_button_new(surface,"Bye",4,4);
+	/* clicking on the button will exit ... */
+	
+	button->onclick=done_button;
+	/* of couse, show it */
+	
+	s3dw_show(S3DWIDGET(surface));
 }
 
 int main (int argc, char **argv)
 {
-	struct s3dw_widget *o;
+	s3dw_button *button;
 	if (!s3d_init(&argc,&argv,"widgettest"))
 	{
-		s3d_set_callback(S3D_EVENT_OBJ_CLICK,widget_click);
+		s3d_set_callback(S3D_EVENT_OBJ_CLICK,click);
+		s3d_set_callback(S3D_EVENT_KEY,key);
+		/* this creates the "window" */
+		surface=s3dw_surface_new("Hello World",20,10);
+		
+		/* put a label (which is simply text) at position x=1, y=2 */
+		s3dw_label_new(surface,"How old are you?",1,2);
 
-		surface=s3dw_surface_new("Hello World",20,10);
-		s3dw_label_new(surface->data.surface,"Where do you want to fly today?",1,2);
-		o=s3dw_button_new(surface->data.surface,"Forward",1,7);
-		o->data.button->onclick=forward_button;
-		o=s3dw_button_new(surface->data.surface,"Into the Sky",10,7);
-		o->data.button->onclick=high_button;
+		/* put an input box right below. we grab the pointer because we want to focus it (need for reference) */
+		input=s3dw_input_new(surface,8,1,4);
+		
+		/* we want the input-field be focused on our widget */
+		s3dw_focus(S3DWIDGET(input));
+
+		/* create the okay button */
+		button=s3dw_button_new(surface,"OK",1,7);
+
+		/* define the callback when the button is clicked. in our case, okay_button() will handle the event */
+		button->onclick=okay_button;
+
+		/* another button  */
+		button=s3dw_button_new(surface,"Won't tell you",10,7);
+
+		/* we will tell him how sad we are ... */
+		button->onclick=no_button;
+
+		/* this widget is focused (of course, it's our only one ... */
+		s3dw_focus(S3DWIDGET(surface));
+
+		/* show it. without showing, things would be boring... */
+		s3dw_show(S3DWIDGET(surface));
+
 		s3d_mainloop(mainloop);
 		s3d_quit();
 	}
-
 	return(0);
 }
 

Modified: trunk/libs3dw/Makefile.am
===================================================================
--- trunk/libs3dw/Makefile.am	2006-06-03 11:48:00 UTC (rev 317)
+++ trunk/libs3dw/Makefile.am	2006-06-03 21:48:05 UTC (rev 318)
@@ -1,6 +1,6 @@
 lib_LTLIBRARIES=	libs3dw.la
 
-libs3dw_la_SOURCES=	button.c surface.c widget.c style.c event.c animate.c label.c input.c
+libs3dw_la_SOURCES=	button.c surface.c widget.c style.c event.c animate.c label.c input.c root.c
 			
 include_HEADERS= 	s3dw.h
 noinst_HEADERS=		s3dw_int.h

Modified: trunk/libs3dw/animate.c
===================================================================
--- trunk/libs3dw/animate.c	2006-06-03 11:48:00 UTC (rev 317)
+++ trunk/libs3dw/animate.c	2006-06-03 21:48:05 UTC (rev 318)
@@ -27,12 +27,12 @@
 #include <math.h>
 
 /* the animation stack */
-static struct s3dw_widget *ani_s[MAXANI];
+static s3dw_widget *ani_s[MAXANI];
 static int ani_n=0;
 int moveon=1;
 
 /* is item f already on stack? */
-int _s3dw_ani_onstack(struct s3dw_widget *f)
+int _s3dw_ani_onstack(s3dw_widget *f)
 {
 	int i;
 	for (i=0;i<ani_n;i++)
@@ -42,7 +42,7 @@
 
 }
 /* add an item on the animation stack */
-void _s3dw_ani_add(struct s3dw_widget *f)
+void _s3dw_ani_add(s3dw_widget *f)
 {
 	if (ani_n<MAXANI)
 	{
@@ -68,40 +68,41 @@
 	}
 }
 /* well ... */
-void _s3dw_ani_doit(struct s3dw_widget *f)
+void _s3dw_ani_doit(s3dw_widget *f)
 {
-	s3d_translate(	*(f->_o), f->_dx,f->_dy,f->_dz);
-	s3d_scale(		*(f->_o), f->_ds);
+	s3d_translate(	f->oid, f->ax,f->ay,f->az);
+	s3d_rotate(		f->oid, f->arx,f->ary,f->arz);
+	s3d_scale(		f->oid, f->as);
 }
 
 /* finish an animation on the stack, stack index i */
-void _s3dw_ani_finish(struct s3dw_widget *f, int i)
+void _s3dw_ani_finish(s3dw_widget *f, int i)
 {
-	f->_dx= f->_x;
-	f->_dy= f->_y;
-	f->_dz= f->_z;
-	f->_ds= f->_s;
+	f->ax= f->x;
+	f->ay= f->y;
+	f->az= f->z;
+	f->as= f->s;
 	_s3dw_ani_doit(f);
 	if (i!=-1)
 		_s3dw_ani_del(i);
 }
-void _s3dw_ani_iterate(struct s3dw_widget *f)
+void _s3dw_ani_iterate(s3dw_widget *f)
 {
-	f->_dx=(f->_x + f->_dx*ZOOMS)/(ZOOMS+1);
-	f->_dy=(f->_y + f->_dy*ZOOMS)/(ZOOMS+1);
-	f->_dz=(f->_z + f->_dz*ZOOMS)/(ZOOMS+1);
-	f->_ds=(f->_s + f->_ds*ZOOMS)/(ZOOMS+1);
+	f->ax=(f->x + f->ax*ZOOMS)/(ZOOMS+1);
+	f->ay=(f->y + f->ay*ZOOMS)/(ZOOMS+1);
+	f->az=(f->z + f->az*ZOOMS)/(ZOOMS+1);
+	f->as=(f->s + f->as*ZOOMS)/(ZOOMS+1);
 
 }
 
 /* checks if f is good enough */
-int _s3dw_ani_check(struct s3dw_widget *f)
+int _s3dw_ani_check(s3dw_widget *f)
 {
 	float x,y,z;
-	x=f->_dx - f->_x;
-	y=f->_dy - f->_y;
-	z=f->_dz - f->_z;
-	if (((fabs(f->_ds - f->_s)/f->_s)>0.01) || (sqrt(x*x+y*y+z*z) > 0.01))
+	x=f->ax - f->x;
+	y=f->ay - f->y;
+	z=f->az - f->z;
+	if (((fabs(f->as - f->s)/f->s)>0.01) || (sqrt(x*x+y*y+z*z) > 0.01))
 		return(0);
 	return(1);
 }
@@ -109,7 +110,7 @@
 void s3dw_ani_mate()
 {
 	int i;
-	struct s3dw_widget *f;
+	s3dw_widget *f;
 	for (i=0;i<ani_n;i++)
 	{
 		f=ani_s[i];

Modified: trunk/libs3dw/button.c
===================================================================
--- trunk/libs3dw/button.c	2006-06-03 11:48:00 UTC (rev 317)
+++ trunk/libs3dw/button.c	2006-06-03 21:48:05 UTC (rev 318)
@@ -28,9 +28,9 @@
 #include <string.h> /* strdup() */
 
 /* draw and setup the button */
-void s3dw_button_draw(struct s3dw_widget *widget)
+void s3dw_button_draw(s3dw_widget *widget)
 {
-	struct s3dw_button *button=widget->data.button;
+	s3dw_button *button=(s3dw_button *)widget;
 	float length;
 	float vertices[8*3];
 	unsigned long polygons[10*4]={
@@ -46,8 +46,8 @@
 			4,6,5,0
 	};
 
-	button->_oid_text=s3d_draw_string(button->_text,&length);
-	s3d_pep_materials_a(button->_oid_text,widget->_surface->_style->text_mat,1);
+	button->oid_text=s3d_draw_string(button->text,&length);
+	s3d_pep_materials_a(button->oid_text,widget->style->text_mat,1);
 
 	/* width of the button depends on the length of the text */
 	vertices[0*3+0]=0.0;			vertices[0*3+1]=0.0;		vertices[0*3+2]=0.0;	
@@ -58,62 +58,80 @@
 	vertices[5*3+0]=0.25;			vertices[5*3+1]=-1.75;		vertices[5*3+2]=0.25;	
 	vertices[6*3+0]=length+0.75;	vertices[6*3+1]=-1.75;		vertices[6*3+2]=0.25;	
 	vertices[7*3+0]=length+0.75;	vertices[7*3+1]=-0.25;		vertices[7*3+2]=0.25;	
-	button->_oid_box=s3d_new_object();
-	s3d_push_materials_a(button->_oid_box,widget->_surface->_style->input_mat,1);
-	s3d_push_vertices   (button->_oid_box,vertices,8);
-	s3d_push_polygons   (button->_oid_box,polygons,10);
-	s3d_link(		   button->_oid_box,widget->_surface->oid);
-	s3d_link(		   button->_oid_text,button->_oid_box);
-	s3d_translate(button->_oid_text,0.5,-1.5,0.30);
-	s3d_translate(button->_oid_box,widget->_x,-widget->_y,0);
-	widget->_o=&(button->_oid_box);
-	widget->_width=length+1;
-	widget->_height=2;
-    s3d_flags_on(button->_oid_box,S3D_OF_VISIBLE|S3D_OF_SELECTABLE);
-    s3d_flags_on(button->_oid_text,S3D_OF_VISIBLE|S3D_OF_SELECTABLE);
-
+	widget->oid=s3d_new_object();
+	s3d_push_materials_a(widget->oid,widget->style->input_mat,1);
+	s3d_push_vertices   (widget->oid,vertices,8);
+	s3d_push_polygons   (widget->oid,polygons,10);
+	s3d_link(		   widget->oid,widget->parent->oid);
+	s3d_link(		   button->oid_text,widget->oid);
+	s3d_translate(button->oid_text,0.5,-1.5,0.30);
+	s3d_translate(widget->oid,widget->x,-widget->y,0);
+	widget->width=length+1;
+	widget->height=2;
 }
 
 /* create a new button in the surface */
-struct s3dw_widget *s3dw_button_new(struct s3dw_surface *surface, char *text, float posx, float posy)
+s3dw_button *s3dw_button_new(s3dw_surface *surface, char *text, float posx, float posy)
 {
-	struct s3dw_button *button;
-	struct s3dw_widget *widget;
-	button=(struct s3dw_button *)malloc(sizeof(struct s3dw_button));
-	widget=s3dw_widget_new();
+	s3dw_button *button;
+	s3dw_widget *widget;
+	button=(s3dw_button *)malloc(sizeof(s3dw_button));
+	button->text=strdup(text);
+	button->onclick=s3dw_nothing;
+	widget=s3dw_widget_new((s3dw_widget *)button);
 	widget->type=S3DW_TBUTTON;
-	/* draw button */
-	button->_text=strdup(text);
-	button->onclick=NULL;
-	widget->_x=posx;
-	widget->_y=posy;
-	widget->data.button=button;
+	widget->x=posx;
+	widget->y=posy;
+	widget->style=((s3dw_widget *)surface)->style;
+
+	s3dw_widget_append((s3dw_widget *)surface, widget);
 	s3dw_button_draw(widget);
-	s3dw_surface_append_obj(surface, widget);
-	return(widget);
+	return(button);
 }
-void s3dw_button_erase(struct s3dw_button *button)
+/* show, make visible */
+void s3dw_button_show(s3dw_widget *widget)
 {
-	s3d_del_object(button->_oid_text);
-	s3d_del_object(button->_oid_box);
-
+	s3dw_button *button=(s3dw_button *)widget;
+    s3d_flags_on(widget->oid,S3D_OF_VISIBLE|S3D_OF_SELECTABLE);
+    s3d_flags_on(button->oid_text,S3D_OF_VISIBLE|S3D_OF_SELECTABLE);
 }
+/* hide */
+void s3dw_button_hide(s3dw_widget *widget)
+{
+	s3dw_button *button=(s3dw_button *)widget;
+    s3d_flags_off(widget->oid,S3D_OF_VISIBLE|S3D_OF_SELECTABLE);
+    s3d_flags_off(button->oid_text,S3D_OF_VISIBLE|S3D_OF_SELECTABLE);
+}
+/* destroy s3d structures of the button */
+void s3dw_button_erase(s3dw_widget *widget)
+{
+	s3dw_button *button=(s3dw_button *)widget;
+	s3d_del_object(button->oid_text);
+	s3d_del_object(widget->oid);
+}
 
 /* destroy the button */
-void s3dw_button_destroy(struct s3dw_button *button)
+void s3dw_button_destroy(s3dw_widget *widget)
 {
-	s3dw_button_erase(button);
-	free(button->_text);
+	s3dw_button *button=(s3dw_button *)widget;
+	s3dw_button_erase(widget);
+	free(button->text);
 	free(button);
 }
+/* handle key events */
+int s3dw_button_event_key(s3dw_widget *widget, unsigned short oid)
+{
+	return(0);
+}
 
-
-void s3dw_button_event_click(struct s3dw_widget *widget, unsigned long oid)
+/* handle click on a button */
+int s3dw_button_event_click(s3dw_widget *widget, unsigned long oid)
 {
-	if ((widget->data.button->_oid_text==oid) || (widget->data.button->_oid_box==oid))
+	s3dw_button *button=(s3dw_button *)widget;
+	if ((button->oid_text==oid) || (widget->oid==oid))
 	{
-		if (widget->data.button->onclick!=NULL)
-			widget->data.button->onclick(widget);
+		button->onclick(widget);
+		return(1);
 	}
-	
+	return(0);
 }

Modified: trunk/libs3dw/event.c
===================================================================
--- trunk/libs3dw/event.c	2006-06-03 11:48:00 UTC (rev 317)
+++ trunk/libs3dw/event.c	2006-06-03 21:48:05 UTC (rev 318)
@@ -24,11 +24,15 @@
 #include <s3d.h>
 #include <s3dw.h>
 #include <s3dw_int.h>
+int modkey;
 
-void s3dw_click_event(struct s3d_evt *evt)
+void s3dw_handle_click(struct s3d_evt *evt)
 {
-	int i;
 	unsigned long oid=*((unsigned long *)evt->buf);
-	for (i=0;i<nsurf;i++)
-		s3dw_surface_event_click(psurf[i],oid);
+	s3dw_widget_event_click(s3dw_getroot(),oid);
 }
+void s3dw_handle_key(struct s3d_evt *evt)
+{
+	unsigned short key=*((unsigned short *)evt->buf);
+	s3dw_widget_event_key(s3dw_getroot(),key);
+}

Modified: trunk/libs3dw/input.c
===================================================================
--- trunk/libs3dw/input.c	2006-06-03 11:48:00 UTC (rev 317)
+++ trunk/libs3dw/input.c	2006-06-03 21:48:05 UTC (rev 318)
@@ -23,95 +23,195 @@
 
 
 #include <s3d.h>
+#include <s3d_keysym.h>
 #include <s3dw.h>
 #include <s3dw_int.h>
 #include <stdlib.h> /* malloc() */
-#include <string.h> /* strdup() */
+#include <string.h> /* strdup(),strlen() */
+#include <ctype.h>	/* isprint */
 
-void s3dw_input_draw(struct s3dw_widget *widget)
+unsigned long s3dw_input_draw_string(s3dw_widget *widget)
 {
-	struct s3dw_input *input=widget->data.input;
+	s3dw_input *input=(s3dw_input *)widget;
+	unsigned long oid_text;
+	int i;
+	float tlen;
+	if (widget->width<1) return(-1);
+	i=0;
+	do 
+	{
+		oid_text=s3d_draw_string(input->text+i,&tlen);
+		i++;
+	} while (tlen>(widget->width-1));
+	s3d_pep_materials_a(oid_text,widget->style->text_mat,1);
+	s3d_translate( oid_text,0.5,-1.5,0.30);
+	s3d_link(	   oid_text,widget->oid);
+	return (oid_text);
+}
+void s3dw_input_draw(s3dw_widget *widget)
+{
+	s3dw_input *input=(s3dw_input *)widget;
 	float length;
-	float vertices[8*3];
-	unsigned long polygons[10*4]={
-			0,4,5,0,
-			0,5,1,0,
-			1,5,6,0,
-			1,6,2,0,
-			2,6,7,0,
-			2,7,3,0,
-			3,7,4,0,
-			3,4,0,0,
-			4,7,6,0,
-			4,6,5,0
+	float vertices[12*3];
+	unsigned long polygons[18*4]={
+			0,4,5,1,
+			0,5,1,1,
+			1,5,6,1,
+			1,6,2,1,
+			2,6,7,1,
+			2,7,3,1,
+			3,7,4,1,
+			3,4,0,1,
+
+			4,8, 9, 1,
+			4,9, 5, 1,
+			5,9, 10,1,
+			5,10,6, 1,
+			6,10,11,1,
+			6,11,7, 1,
+			7,11,8, 1,
+			7,8, 4, 1,
+
+
+			8,11,10,0,
+			8,10,9, 0
 	};
-	input->_oid_text=s3d_draw_string(input->_text,&length);
-	s3d_pep_materials_a(input->_oid_text,widget->_surface->_style->text_mat,1);
+	length=widget->width-1;
+	if (widget->width<1) return;
+	widget->height=2;
 	/* width of the input depends on the length of the text */
 	vertices[0*3+0]=0.0;			vertices[0*3+1]=0.0;		vertices[0*3+2]=0.0;	
 	vertices[1*3+0]=0.0;			vertices[1*3+1]=-2.0;		vertices[1*3+2]=0.0;	
 	vertices[2*3+0]=length+1;		vertices[2*3+1]=-2.0;		vertices[2*3+2]=0.0;	
 	vertices[3*3+0]=length+1;		vertices[3*3+1]=0.0;		vertices[3*3+2]=0.0;	
-	vertices[4*3+0]=0.25;			vertices[4*3+1]=-0.25;		vertices[4*3+2]=0.25;	
-	vertices[5*3+0]=0.25;			vertices[5*3+1]=-1.75;		vertices[5*3+2]=0.25;	
-	vertices[6*3+0]=length+0.75;	vertices[6*3+1]=-1.75;		vertices[6*3+2]=0.25;	
-	vertices[7*3+0]=length+0.75;	vertices[7*3+1]=-0.25;		vertices[7*3+2]=0.25;	
-	input->_oid_box=s3d_new_object();
-	s3d_push_materials_a(input->_oid_box,widget->_surface->_style->input_mat,1);
-	s3d_push_vertices   (input->_oid_box,vertices,8);
-	s3d_push_polygons   (input->_oid_box,polygons,10);
-	s3d_link(		   input->_oid_box,widget->_surface->oid);
-	s3d_link(		   input->_oid_text,input->_oid_box);
-	s3d_translate(input->_oid_text,0.5,-1.5,0.30);
-	s3d_translate(input->_oid_box,widget->_x,-widget->_y,0);
-	widget->_width=length+1;
-	widget->_height=2;
-	widget->_o=&(input->_oid_box);
-    s3d_flags_on(input->_oid_box,S3D_OF_VISIBLE|S3D_OF_SELECTABLE);
-    s3d_flags_on(input->_oid_text,S3D_OF_VISIBLE|S3D_OF_SELECTABLE);
+	vertices[4*3+0]=0.125;			vertices[4*3+1]=-0.125;		vertices[4*3+2]=0.25;	
+	vertices[5*3+0]=0.125;			vertices[5*3+1]=-1.875;		vertices[5*3+2]=0.25;	
+	vertices[6*3+0]=length+0.875;	vertices[6*3+1]=-1.875;		vertices[6*3+2]=0.25;	
+	vertices[7*3+0]=length+0.875;	vertices[7*3+1]=-0.125;		vertices[7*3+2]=0.25;	
+	vertices[8*3+0]=0.25;			vertices[8*3+1]=-0.25;		vertices[8*3+2]=0.125;	
+	vertices[9*3+0]=0.25;			vertices[9*3+1]=-1.75;		vertices[9*3+2]=0.125;	
+	vertices[10*3+0]=length+0.75;	vertices[10*3+1]=-1.75;		vertices[10*3+2]=0.125;	
+	vertices[11*3+0]=length+0.75;	vertices[11*3+1]=-0.25;		vertices[11*3+2]=0.125;	
+	widget->oid=s3d_new_object();
+	s3d_push_materials_a(widget->oid,widget->style->inputback_mat,1);
+	s3d_push_materials_a(widget->oid,widget->style->input_mat,1);
+	s3d_push_vertices   (widget->oid,vertices,12);
+	s3d_push_polygons   (widget->oid,polygons,18);
+	s3d_link(		   widget->oid,widget->parent->oid);
+	s3d_translate(widget->oid,widget->x,-widget->y,0);
 
-
+	input->oid_text=s3dw_input_draw_string(widget);
 }
+/* show the input */
+void s3dw_input_show(s3dw_widget *widget)
+{
+	s3dw_input *input=(s3dw_input *)widget;
+    s3d_flags_on(widget->oid,S3D_OF_VISIBLE|S3D_OF_SELECTABLE);
+    s3d_flags_on(input->oid_text,S3D_OF_VISIBLE|S3D_OF_SELECTABLE);
+}
+/* hides the input */
+void s3dw_input_hide(s3dw_widget *widget)
+{
+	s3dw_input *input=(s3dw_input *)widget;
+    s3d_flags_off(widget->oid,S3D_OF_VISIBLE|S3D_OF_SELECTABLE);
+    s3d_flags_off(input->oid_text,S3D_OF_VISIBLE|S3D_OF_SELECTABLE);
+}
 /* create a new input in the surface */
-struct s3dw_widget *s3dw_input_new(struct s3dw_surface *surface, char *text, float posx, float posy)
+s3dw_input *s3dw_input_new(s3dw_surface *surface, float width, float posx, float posy)
 {
-	struct s3dw_input *input;
-	struct s3dw_widget *widget;
-	input=(struct s3dw_input *)malloc(sizeof(struct s3dw_input));
-	widget=s3dw_widget_new();
-	widget->type=S3DW_TBUTTON;
-	/* draw input */
-	input->_text=strdup(text);
-	input->onclick=NULL;
-	widget->_x=posx;
-	widget->_y=posy;
-	widget->data.input=input;
+	s3dw_input *input;
+	s3dw_widget *widget;
+	input=(s3dw_input *)malloc(sizeof(s3dw_input));
+	input->text=strdup("");
+	input->onclick=s3dw_nothing;
+	input->onedit=s3dw_nothing;
+	widget=s3dw_widget_new((s3dw_widget *)input);
+	widget->type=S3DW_TINPUT;
+	widget->x=posx;
+	widget->y=posy;
+	widget->width=width;
+	widget->height=2;
 
+	s3dw_widget_append((s3dw_widget *)surface, widget);
 	s3dw_input_draw(widget);
-	s3dw_surface_append_obj(surface, widget);
-	return(widget);
+	return(input);
 }
-void s3dw_input_erase(struct s3dw_input *input)
+void s3dw_input_erase(s3dw_widget *widget)
 {
-	s3d_del_object(input->_oid_text);
-	s3d_del_object(input->_oid_box);
+	s3dw_input *input=(s3dw_input *)widget;
+	s3d_del_object(input->oid_text);
+	s3d_del_object(widget->oid);
 
 }
 /* destroy the input */
-void s3dw_input_destroy(struct s3dw_input *input)
+void s3dw_input_destroy(s3dw_widget *widget)
 {
-    s3dw_input_erase(input);
-	free(input->_text);
+	s3dw_input *input=(s3dw_input *)widget;
+    s3dw_input_erase(widget);
+	free(input->text);
 	free(input);
 }
+/* changes the text of the input */
+void s3dw_input_change_text(s3dw_input *input, char *text)
+{
+	s3dw_widget *widget=(s3dw_widget *)input;
+	unsigned long oid_text;
+	/* redraw the text ... */
+	free(input->text);
+	input->text=strdup(text);
+	oid_text=s3dw_input_draw_string(widget);
+	if (widget->flags&S3DW_ONSCREEN)
+		s3d_flags_on(oid_text,S3D_OF_VISIBLE|S3D_OF_SELECTABLE);
+	s3d_del_object(input->oid_text);
+	input->oid_text=oid_text;
+}
+/* handle key events */
+int s3dw_input_event_key(s3dw_widget *widget, unsigned short key)
+{
+	s3dw_input *input=(s3dw_input *)widget;
+	char *newtext;
+	int len;
+	dprintf(MED,"edit field got key %d!!",key);
+	if (isprint(key))
+	{
+		len=strlen(input->text);
+		newtext=malloc(len + 2); /* +1 for the terminating byte, +1 for the new character */
+		strcpy(newtext,input->text);
+		newtext[len]=key;
+		newtext[len+1]=0;
+		s3dw_input_change_text(input,newtext);
+		free(newtext);
+		return(1);
+	} 
+	if (key==S3DK_BACKSPACE)
+	{
+		len=strlen(input->text);
+		if ((len=strlen(input->text))>0)
+		{
+			newtext=malloc(len + 0); /* +1 for the terminating byte, -1 for the deleted character */
+			strncpy(newtext,input->text,len);
+			newtext[len-1]=0;
+			s3dw_input_change_text(input,newtext);
+			free(newtext);
+		}
+	}
+	
+	return(0);
+}
 
 
-void s3dw_input_event_click(struct s3dw_widget *widget, unsigned long oid)
+int s3dw_input_event_click(s3dw_widget *widget, unsigned long oid)
 {
-	if ((widget->data.input->_oid_text==oid) || (widget->data.input->_oid_box==oid))
+	s3dw_input *input=(s3dw_input *)widget;
+	if ((input->oid_text==oid) || (widget->oid==oid))
 	{
-		if (widget->data.input->onclick!=NULL)
-			widget->data.input->onclick(widget);
+		s3dw_focus(widget);
+		input->onclick(widget);
+		return(1);
 	}
-	
+	return(0);
 }
+char *s3dw_input_gettext(s3dw_input *input)
+{
+	return(strdup(input->text));
+}

Modified: trunk/libs3dw/label.c
===================================================================
--- trunk/libs3dw/label.c	2006-06-03 11:48:00 UTC (rev 317)
+++ trunk/libs3dw/label.c	2006-06-03 21:48:05 UTC (rev 318)
@@ -28,59 +28,70 @@
 #include <stdlib.h> /* malloc() */
 #include <string.h> /* strdup() */
 
-void s3dw_label_draw(struct s3dw_widget *widget)
+void s3dw_label_draw(s3dw_widget *widget)
 {
-	struct s3dw_label *label=widget->data.label;
+	s3dw_label *label=(s3dw_label *)widget;
 	float length;
-	label->_oid_text=s3d_draw_string(label->_text,&length);
-	s3d_pep_materials_a(label->_oid_text,widget->_surface->_style->text_mat,1);
-	s3d_link(label->_oid_text,widget->_surface->oid);
-	s3d_translate(label->_oid_text,widget->_x,-widget->_y,0.1);
-	widget->_width=length+1;
-	widget->_height=2;
+	widget->oid=s3d_draw_string(label->text,&length);
+	s3d_pep_materials_a(widget->oid,widget->style->text_mat,1);
+	s3d_link(widget->oid,widget->parent->oid);
+	s3d_translate(widget->oid,widget->x,-widget->y,0.1);
+	widget->width=length+1;
+	widget->height=2;
+}
+/* show the label */
+void s3dw_label_show(s3dw_widget *widget)
+{
+    s3d_flags_on(widget->oid,S3D_OF_VISIBLE|S3D_OF_SELECTABLE);
+}
+/* hides the label */
+void s3dw_label_hide(s3dw_widget *widget)
+{
+    s3d_flags_off(widget->oid,S3D_OF_VISIBLE|S3D_OF_SELECTABLE);
+}
 
-    s3d_flags_on(label->_oid_text,S3D_OF_VISIBLE|S3D_OF_SELECTABLE);
-
-}
 /* create a new label in the surface */
-struct s3dw_widget *s3dw_label_new(struct s3dw_surface *surface, char *text, float posx, float posy)
+s3dw_label *s3dw_label_new(s3dw_surface *surface, char *text, float posx, float posy)
 {
-	struct s3dw_label *label;
-	struct s3dw_widget *widget;
-	label=(struct s3dw_label *)malloc(sizeof(struct s3dw_label));
-	widget=s3dw_widget_new();
+	s3dw_label *label;
+	s3dw_widget *widget;
+	label=(s3dw_label *)malloc(sizeof(s3dw_label));
+	widget=s3dw_widget_new((s3dw_widget *)label);
 	widget->type=S3DW_TBUTTON;
-	/* draw label */
-	label->_text=strdup(text);
-	label->onclick=NULL;
-	widget->_x=posx;
-	widget->_y=posy;
-	widget->data.label=label;
-	widget->_o=&(label->_oid_text);
+	widget->x=posx;
+	widget->y=posy;
+	label->text=strdup(text);
+	label->onclick=s3dw_nothing;
+	s3dw_widget_append((s3dw_widget *)surface, widget);
 	s3dw_label_draw(widget);
-	s3dw_surface_append_obj(surface, widget);
-	return(widget);
+	return(label);
 }
 
-void s3dw_label_erase(struct s3dw_label *label)
+void s3dw_label_erase(s3dw_widget *widget)
 {
-	s3d_del_object(label->_oid_text);
+	s3d_del_object(widget->oid);
 }
 /* destroy the label */
-void s3dw_label_destroy(struct s3dw_label *label)
+void s3dw_label_destroy(s3dw_widget *widget)
 {
-	s3dw_label_erase(label);
-	free(label->_text);
+	s3dw_label *label=(s3dw_label *)widget;
+	s3dw_label_erase(widget);
+	free(label->text);
 	free(label);
 }
-
-
-void s3dw_label_event_click(struct s3dw_widget *widget, unsigned long oid)
+/* handle key events */
+int s3dw_label_event_key(s3dw_widget *widget, unsigned short oid)
 {
-	if (widget->data.label->_oid_text==oid)
+	return(0);
+}
+/* handle click events */
+int s3dw_label_event_click(s3dw_widget *widget, unsigned long oid)
+{
+	s3dw_label *label=(s3dw_label *)widget;
+	if (widget->oid==oid)
 	{
-		if (widget->data.label->onclick!=NULL)
-			widget->data.label->onclick(widget);
+		label->onclick(widget);
+		return(1);
 	}
-	
+	return(0);
 }

Added: trunk/libs3dw/root.c
===================================================================
--- trunk/libs3dw/root.c	2006-06-03 11:48:00 UTC (rev 317)
+++ trunk/libs3dw/root.c	2006-06-03 21:48:05 UTC (rev 318)
@@ -0,0 +1,93 @@
+/*
+ * root.c
+ *
+ * Copyright (C) 2006 Simon Wunderlich <dotslash at packetmixer.de>
+ *
+ * This file is part of the s3d Widgets, a Widget Library for s3d.
+ * See http://s3d.berlios.de/ for more updates.
+ * 
+ * s3d Widgets is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU Lesser General Public License as published by
+ * the Free Software Foundation; either version 2.1 of the License, or
+ * (at your option) any later version.
+ * 
+ * s3d Widgets is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU Lesser General Public License for more details.
+ * 
+ * You should have received a copy of the GNU Lesser General Public License
+ * along with the s3d Widgets; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
+ */
+
+#include <s3d.h>
+#include <s3dw.h>
+#include <s3dw_int.h>
+#include <stdlib.h> /* malloc() */
+static s3dw_widget *root;
+
+/* just destroy the widget */
+void s3dw_root_destroy(s3dw_widget *widget)
+{
+	free(widget);
+}
+/*  do plain nothing. interesting, isn't it? ;) */
+void s3dw_nothing(s3dw_widget *widget)
+{
+}
+/* dummy handler */
+int s3dw_root_event_click(s3dw_widget *widget,unsigned long oid)
+{
+	return(0);
+}
+/* dummy handler */
+int s3dw_root_event_key(s3dw_widget *widget,unsigned short key)
+{
+	return(0);
+}
+/* get the root .... if it's NULL, the lib is not initialized, so do this too ... */
+s3dw_widget *s3dw_getroot()
+{
+	if (root==NULL)
+	{
+		root=(s3dw_widget *)malloc(sizeof(s3dw_widget));
+		root=s3dw_widget_new(root);
+		root->type=S3DW_TROOT;
+		root->oid=s3d_new_object();
+		root->style=&def_style;
+		root->flags=S3DW_VISIBLE|S3DW_ACTIVE;
+		/* setup callback tables */
+		s3dwcb_show[S3DW_TROOT]=		s3dw_nothing;
+		s3dwcb_show[S3DW_TSURFACE]=		s3dw_surface_show;
+		s3dwcb_show[S3DW_TBUTTON]=		s3dw_button_show;
+		s3dwcb_show[S3DW_TLABEL]=		s3dw_label_show;
+		s3dwcb_show[S3DW_TINPUT]=		s3dw_input_show;
+		s3dwcb_hide[S3DW_TROOT]=		s3dw_nothing;
+		s3dwcb_hide[S3DW_TSURFACE]=		s3dw_surface_hide;
+		s3dwcb_hide[S3DW_TBUTTON]=		s3dw_button_hide;
+		s3dwcb_hide[S3DW_TLABEL]=		s3dw_label_hide;
+		s3dwcb_hide[S3DW_TINPUT]=		s3dw_input_hide;
+		
+		s3dwcb_destroy[S3DW_TROOT]=		s3dw_root_destroy;
+		s3dwcb_destroy[S3DW_TSURFACE]=	s3dw_surface_destroy;
+		s3dwcb_destroy[S3DW_TBUTTON]=	s3dw_button_destroy;
+		s3dwcb_destroy[S3DW_TLABEL]=	s3dw_label_destroy;
+		s3dwcb_destroy[S3DW_TINPUT]=	s3dw_input_destroy;
+
+		s3dwcb_click[S3DW_TROOT]=		s3dw_root_event_click;
+		s3dwcb_click[S3DW_TSURFACE]=	s3dw_surface_event_click;
+		s3dwcb_click[S3DW_TBUTTON]=		s3dw_button_event_click;
+		s3dwcb_click[S3DW_TLABEL]=		s3dw_label_event_click;
+		s3dwcb_click[S3DW_TINPUT]=		s3dw_input_event_click;
+
+		s3dwcb_key[S3DW_TROOT]=			s3dw_root_event_key;
+		s3dwcb_key[S3DW_TSURFACE]=		s3dw_surface_event_key;
+		s3dwcb_key[S3DW_TBUTTON]=		s3dw_button_event_key;
+		s3dwcb_key[S3DW_TLABEL]=		s3dw_label_event_key;
+		s3dwcb_key[S3DW_TINPUT]=		s3dw_input_event_key;
+
+	} 
+	return root;
+}
+

Modified: trunk/libs3dw/s3dw.h
===================================================================
--- trunk/libs3dw/s3dw.h	2006-06-03 11:48:00 UTC (rev 317)
+++ trunk/libs3dw/s3dw.h	2006-06-03 21:48:05 UTC (rev 318)
@@ -22,89 +22,113 @@
  */
 
 
-
+/* we want this widget visible, as long as the widgets below are also visible. 
+ * on for all widgets, except surfaces which have to be switched visible 
+ * with s3dw_show() */
 #define		S3DW_VISIBLE	1
-#define 	S3DW_CLICKABLE	2
+/* widget should accept input. that's on by default. */
+#define 	S3DW_ACTIVE		2
+/* tells us if the widget is currently displayed */
+#define		S3DW_ONSCREEN	256
+/* just a typecaster to beatify code. use it if you like */
+#define 	S3DWIDGET(x)	(s3dw_widget *)x
 
 enum {
+	S3DW_TROOT,
 	S3DW_TSURFACE,
 	S3DW_TBUTTON,
 	S3DW_TLABEL,
-	S3DW_TINPUT
+	S3DW_TINPUT,
+	S3DW_NTYPES
 };
+typedef struct _s3dw_widget 	s3dw_widget;
+typedef struct _s3dw_button 	s3dw_button;
+typedef struct _s3dw_label  	s3dw_label;
+typedef struct _s3dw_input  	s3dw_input;
+typedef struct _s3dw_surface  	s3dw_surface;
+typedef struct _s3dw_style  	s3dw_style;
+typedef void (*s3dw_callback)(s3dw_widget *);
 
-struct s3dw_widget {
-	int type;
-	int   _flags;
-	struct s3dw_surface *_surface;
-	union {
-		struct s3dw_label 	*label;
-		struct s3dw_button  *button;
-		struct s3dw_input   *input;
-		struct s3dw_surface *surface;
-	} data;
 
-	float _x,_y,_z,_s,_rx,_ry,_rz;
-	float _dx,_dy,_dz,_ds,_drx,_dry,_drz;
-	float _width,_height;
-	unsigned long *_o;
+struct _s3dw_widget {
+	/* it's all private .. */
+	int   		 type;
+	s3dw_widget *parent; 
+	s3dw_style  *style;
+	int 				  nobj; /* number of children objects */
+	s3dw_widget		 	**pobj; /* pointer to list of children objects */
+	int 		 focus;			/* index of the widget focused in pobj */
+	int   		 flags;			/* flags like visibility */
+	float 		 x,y,z;			/* position, relative to the surface usually */
+	float 		 ax,ay,az;		/* current position for animation */
+	float 		 s;				/* scale factor */
+	float 		 as;			/* current scale factor */
+	float 		 rx,ry,rz;		/* rotation around the axis */
+	float 		 arx,ary,arz;   /* current rotation */
+	float 		 width,height;	/* width and height of the widget, outer size */
+	unsigned long oid;			/* the main object which is used for transformations etc ...*/
 };
 
-typedef void (*s3dw_callback)(struct s3dw_widget *);
 
-struct s3dw_button {
-	char *_text;
-	s3dw_callback onclick;
-	unsigned long   _oid_text;
-	unsigned long   _oid_box;
-	
+struct _s3dw_button {
+	/* private */
+	s3dw_widget 	 widget;
+	char 			*text;
+	unsigned long    oid_text;
+	/* public */
+	s3dw_callback 	 onclick;
 };
-struct s3dw_label {
-	char *_text;
-	s3dw_callback onclick;
-	unsigned long   _oid_text;
+struct _s3dw_label {
+	/* private */
+	s3dw_widget 	 widget;
+	char 			*text;
+	unsigned long    oid_text;
+	/* public */
+	s3dw_callback 	 onclick;
 	
 };
-struct s3dw_input {
-	char *_text;
-	s3dw_callback onclick;
-	s3dw_callback onedit;
-	unsigned long   _oid_text;
-	unsigned long   _oid_box;
-	
+struct _s3dw_input {
+	/* private */
+	s3dw_widget 	 widget;
+	char 			*text;
+	unsigned long    oid_text;
+	/* public */
+	s3dw_callback 	 onclick;
+	s3dw_callback 	 onedit;
 };
 
-struct s3dw_surface {
-	unsigned long		  oid;
-	unsigned long		  _oid_title;
-	unsigned long		  _oid_tbar;
-	int 				  _nobj;
+struct _s3dw_surface {
+	/* private */
+	s3dw_widget 		  widget;
+	unsigned long		  oid_title;
+	unsigned long		  oid_tbar;
 	char				 *title;
-	struct s3dw_widget 	**_pobj;
-	struct s3dw_style 	 *_style;
 };
 
 /* style */
-struct s3dw_style {
-	char *name;
-	float surface_mat[12];
-	float input_mat[12];
-	float text_mat[12];
-	float title_mat[12];
-	float title_text_mat[12];
+struct _s3dw_style {
+	char *name;					/* name of the style ... kind of redundant */
+	char *fontface;				/* font face for all used fonts */
+	float surface_mat[12];		/* material for the surface background */
+	float input_mat[12];		/* material for buttonboxes and other widgets */
+	float inputback_mat[12];	/* material for inputfield background */
+	float text_mat[12];			/* material for the text on buttons and inputs */
+	float title_mat[12];		/* material for the title bar */
+	float title_text_mat[12];	/* material for the text on the title bar */
 };
 /* button.c */
-struct s3dw_widget *s3dw_button_new(struct s3dw_surface *surface, char *text, float posx, float posy);
-/* label.c */
-struct s3dw_widget *s3dw_label_new(struct s3dw_surface *surface, char *text, float posx, float posy);
-/* input.c */
-struct s3dw_widget *s3dw_input_new(struct s3dw_surface *surface, char *text, float posx, float posy);
-/* surface.c */
-struct s3dw_widget *s3dw_surface_new(char *title, float width, float height);
-void s3dw_surface_delete(struct s3dw_surface *surface);
-/* widget.c */
-void s3dw_widget_destroy(struct s3dw_widget *widget);
-/* event.c */
-void s3dw_click_event(struct s3d_evt *evt);
-/* animate.c */
+s3dw_button 		*s3dw_button_new(s3dw_surface *surface, char *text, float posx, float posy);
+s3dw_label	 		*s3dw_label_new(s3dw_surface *surface, char *text, float posx, float posy);
+s3dw_input 			*s3dw_input_new(s3dw_surface *surface, float width, float posx, float posy);
+char 				*s3dw_input_gettext(s3dw_input *input);
+void 				 s3dw_input_change_text(s3dw_input *input, char *text);
+s3dw_surface 		*s3dw_surface_new(char *title, float width, float height);
+
+void s3dw_delete(s3dw_widget *widget);
+void s3dw_show(s3dw_widget *widget);
+void s3dw_focus(s3dw_widget *focus);
+
+void s3dw_handle_click(struct s3d_evt *evt);
+void s3dw_handle_key(struct s3d_evt *evt);
+
 void s3dw_ani_mate();

Modified: trunk/libs3dw/s3dw_int.h
===================================================================
--- trunk/libs3dw/s3dw_int.h	2006-06-03 11:48:00 UTC (rev 317)
+++ trunk/libs3dw/s3dw_int.h	2006-06-03 21:48:05 UTC (rev 318)
@@ -24,40 +24,70 @@
 #include <s3dlib.h> /* dprintf() */
 #define MAXANI		16
 #define ZOOMS		5
-extern	struct s3dw_widget  **psurf;
-extern	int					  nsurf;
+/* constructor and handler callbacks */
+typedef int (*s3dw_click_callback)(s3dw_widget *, unsigned long);
+typedef int (*s3dw_key_callback)(  s3dw_widget *, unsigned short);
+s3dw_callback 		s3dwcb_show[S3DW_NTYPES];
+s3dw_callback 		s3dwcb_hide[S3DW_NTYPES];
+s3dw_callback 		s3dwcb_destroy[S3DW_NTYPES];
+s3dw_click_callback s3dwcb_click[S3DW_NTYPES];
+s3dw_key_callback	s3dwcb_key[S3DW_NTYPES];
 
+/* root.c */
+s3dw_widget *s3dw_getroot();
+void s3dw_nothing(s3dw_widget *widget);
+void s3dw_root_destroy(s3dw_widget *widget);
+int s3dw_root_event_click(s3dw_widget *widget, unsigned long oid);
+int s3dw_root_event_key(s3dw_widget *widget, unsigned short key);
 /* widget.c */
-struct s3dw_widget *s3dw_widget_new();
-void s3dw_widget_event_click(struct s3dw_widget *widget, unsigned long oid);
+s3dw_widget *s3dw_widget_new();
+void s3dw_widget_append(s3dw_widget *parent, s3dw_widget *widget);
+void s3dw_widget_visible(s3dw_widget *widget);
+int s3dw_widget_event_click(s3dw_widget *widget, unsigned long oid);
+int s3dw_widget_event_key(s3dw_widget *widget, unsigned short key);
 /* surface.c */
-void s3dw_surface_destroy(struct s3dw_surface *surface);
-void s3dw_surface_append_obj(struct s3dw_surface *surface, struct s3dw_widget *widget);
-void s3dw_surface_event_click(struct s3dw_widget *widget, unsigned long oid);
-void s3dw_surface_draw(struct s3dw_widget *widget);
+void s3dw_surface_destroy(s3dw_widget *widget);
+void s3dw_surface_draw(s3dw_widget *widget);
+void s3dw_surface_erase(s3dw_widget *widget);
+void s3dw_surface_show(s3dw_widget *widget);
+void s3dw_surface_hide(s3dw_widget *widget);
+int s3dw_surface_event_click(s3dw_widget *widget, unsigned long oid);
+int s3dw_surface_event_key(s3dw_widget *widget, unsigned short key);
 /* button.c */
-void s3dw_button_destroy(struct s3dw_button *button);
-void s3dw_button_event_click(struct s3dw_widget *widget, unsigned long oid);
-void s3dw_button_draw(struct s3dw_widget *widget);
-void s3dw_button_erase(struct s3dw_button *button);
+void s3dw_button_destroy(s3dw_widget *widget);
+void s3dw_button_draw(s3dw_widget *widget);
+void s3dw_button_erase(s3dw_widget *widget);
+void s3dw_button_show(s3dw_widget *widget);
+void s3dw_button_hide(s3dw_widget *widget);
+int s3dw_button_event_key(s3dw_widget *widget, unsigned short key);
+int s3dw_button_event_click(s3dw_widget *widget, unsigned long oid);
+
 /* label.c */
-void s3dw_label_destroy(struct s3dw_label *label);
-void s3dw_label_event_click(struct s3dw_widget *widget, unsigned long oid);
-void s3dw_label_draw(struct s3dw_widget *widget);
+void s3dw_label_destroy(s3dw_widget *widget);
+void s3dw_label_draw(s3dw_widget *widget);
+void s3dw_label_erase(s3dw_widget *widget);
+void s3dw_label_show(s3dw_widget *widget);
+void s3dw_label_hide(s3dw_widget *widget);
+int s3dw_label_event_click(s3dw_widget *widget, unsigned long oid);
+int s3dw_label_event_key(s3dw_widget *widget, unsigned short key);
+
 /* input.c */
-void s3dw_input_destroy(struct s3dw_input *input);
-void s3dw_input_event_click(struct s3dw_widget *widget, unsigned long oid);
-void s3dw_input_draw(struct s3dw_widget *widget);
-void s3dw_input_erase(struct s3dw_input *input);
+void s3dw_input_destroy(s3dw_widget *widget);
+void s3dw_input_draw(s3dw_widget *widget);
+void s3dw_input_erase(s3dw_widget *widget);
+void s3dw_input_show(s3dw_widget *widget);
+void s3dw_input_hide(s3dw_widget *widget);
+unsigned long s3dw_input_draw_string(s3dw_widget *widget);
+int s3dw_input_event_click(s3dw_widget *widget, unsigned long oid);
+int s3dw_input_event_key(s3dw_widget *widget, unsigned short key);
 
-
 /* style.c */
-extern struct s3dw_style def_style;
+extern s3dw_style def_style;
 /* animate.c */
-int  _s3dw_ani_onstack(struct s3dw_widget *f);
-void _s3dw_ani_add(struct s3dw_widget *f);
+int  _s3dw_ani_onstack(s3dw_widget *f);
+void _s3dw_ani_add(s3dw_widget *f);
 void _s3dw_ani_del(int i);
-void _s3dw_ani_doit(struct s3dw_widget *f);
-void _s3dw_ani_finish(struct s3dw_widget *f, int i);
-void _s3dw_ani_iterate(struct s3dw_widget *f);
-int  _s3dw_ani_check(struct s3dw_widget *f);
+void _s3dw_ani_doit(s3dw_widget *f);
+void _s3dw_ani_finish(s3dw_widget *f, int i);
+void _s3dw_ani_iterate(s3dw_widget *f);
+int  _s3dw_ani_check(s3dw_widget *f);

Modified: trunk/libs3dw/style.c
===================================================================
--- trunk/libs3dw/style.c	2006-06-03 11:48:00 UTC (rev 317)
+++ trunk/libs3dw/style.c	2006-06-03 21:48:05 UTC (rev 318)
@@ -28,17 +28,27 @@
 
 
 /* default style */
-struct s3dw_style def_style={"default",
+s3dw_style def_style={
+/* name */
+"default",
+/* font face */
+"vera",
 /* surface_mat */
 {0.7,0.7,0.7,1.0, 
  0.7,0.7,0.7,1.0, 
- 0.7,0.7,0.7,1.0}
-,
+ 0.7,0.7,0.7,1.0
+},
 /* input_mat */
 {0.7,0.7,0.7,1.0,
  0.7,0.7,0.7,1.0,
  0.7,0.7,0.7,1.0
 },
+/* inputback_mat */
+{0.9,0.9,0.9,1.0,
+ 0.9,0.9,0.9,1.0,
+ 0.9,0.9,0.9,1.0
+},
+
 /* text_mat */
 {
  0.0,0.0,0.0,1.0,

Modified: trunk/libs3dw/surface.c
===================================================================
--- trunk/libs3dw/surface.c	2006-06-03 11:48:00 UTC (rev 317)
+++ trunk/libs3dw/surface.c	2006-06-03 21:48:05 UTC (rev 318)
@@ -27,12 +27,9 @@
 #include <stdlib.h> /* malloc() */
 #include <string.h> /* strdup() */
 
-struct s3dw_widget **psurf=NULL;
-int					  nsurf=0;
-
-void s3dw_surface_draw(struct s3dw_widget *widget)
+void s3dw_surface_draw(s3dw_widget *widget)
 {
-	struct s3dw_surface *surface=widget->data.surface;
+	s3dw_surface *surface=(s3dw_surface *)widget;
 	int textlen;
 	float length;
 	float vertices[8*3]={
@@ -61,23 +58,23 @@
 	unsigned long tpol[10*4];
 	int i;
 
-	surface->oid=s3d_new_object();
-	surface->_oid_tbar=s3d_new_object();
+	widget->oid=s3d_new_object();
+	surface->oid_tbar=s3d_new_object();
 	s3d_select_font("vera");
-	surface->_oid_title=s3d_draw_string(surface->title,&length);
-	while (length > (widget->_width+1))
+	surface->oid_title=s3d_draw_string(surface->title,&length);
+	while (length > (widget->width+1))
 	{
-		dprintf(HIGH,"%f > %f",length,widget->_width+1);
+		dprintf(HIGH,"%f > %f",length,widget->width+1);
 		textlen=strlen(surface->title);
-		if (length>((widget->_width+1)*1.3))
-			textlen=textlen*((widget->_width+1)*1.1/length);
+		if (length>((widget->width+1)*1.3))
+			textlen=textlen*((widget->width+1)*1.1/length);
 		if (textlen>4)
 		{
 			surface->title[textlen-2]=0;
 			surface->title[textlen-3]='.';
 			surface->title[textlen-4]='.';
-			s3d_del_object(surface->_oid_title);
-			surface->_oid_title=s3d_draw_string(surface->title,&length);
+			s3d_del_object(surface->oid_title);
+			surface->oid_title=s3d_draw_string(surface->title,&length);
 		} else {
 			break;
 		}
@@ -85,10 +82,10 @@
  	/* prepare vertices */
 	for (i=0;i<8;i++)
 	{
-		sver[i*3 + 0]=vertices[i*3+0] * widget->_width;
-		sver[i*3 + 1]=vertices[i*3+1] * -widget->_height;
+		sver[i*3 + 0]=vertices[i*3+0] * widget->width;
+		sver[i*3 + 1]=vertices[i*3+1] * -widget->height;
 		sver[i*3 + 2]=vertices[i*3+2] * -1;
-		tver[i*3 + 0]=vertices[i*3+0] * widget->_width;
+		tver[i*3 + 0]=vertices[i*3+0] * widget->width;
 		tver[i*3 + 1]=vertices[i*3+1];
 		tver[i*3 + 2]=vertices[i*3+2] * -1;
 	}
@@ -100,104 +97,87 @@
 	   tpol[i*4 + 2]=polygon[i*4 + 2];
 	   tpol[i*4 + 3]=polygon[i*4 + 3];
 	}
-	widget->_o=&(surface->oid);
-	s3d_push_vertices(surface->oid,sver,8);
-	s3d_push_vertices(surface->_oid_tbar,tver,8);
-	s3d_push_materials_a(surface->oid      ,surface->_style->surface_mat,1);
-	s3d_push_materials_a(surface->_oid_tbar,surface->_style->title_mat,1);
-	s3d_pep_materials_a(surface->_oid_title,surface->_style->title_text_mat,1);
-	s3d_push_polygons(surface->oid,polygon,10);
-	s3d_push_polygons(surface->_oid_tbar,tpol,10);
-	s3d_link(surface->_oid_tbar,surface->oid);
-	s3d_link(surface->_oid_title,surface->_oid_tbar);
-	s3d_translate(surface->_oid_title,0.5,0.2,0.1);
-    s3d_flags_on(surface->oid,S3D_OF_VISIBLE|S3D_OF_SELECTABLE);
-    s3d_flags_on(surface->_oid_title,S3D_OF_VISIBLE|S3D_OF_SELECTABLE);
-    s3d_flags_on(surface->_oid_tbar,S3D_OF_VISIBLE|S3D_OF_SELECTABLE);
-
-
+	s3d_push_vertices(widget->oid,sver,8);
+	s3d_push_vertices(surface->oid_tbar,tver,8);
+	s3d_push_materials_a(widget->oid      ,widget->style->surface_mat,1);
+	s3d_push_materials_a(surface->oid_tbar,widget->style->title_mat,1);
+	s3d_pep_materials_a(surface->oid_title,widget->style->title_text_mat,1);
+	s3d_push_polygons(widget->oid,polygon,10);
+	s3d_push_polygons(surface->oid_tbar,tpol,10);
+	s3d_link(surface->oid_tbar,widget->oid);
+	s3d_link(surface->oid_title,surface->oid_tbar);
+	s3d_link(widget->oid,widget->parent->oid);
+	s3d_translate(surface->oid_title,0.5,0.2,0.1);
 }
+/* show the surface */
+void s3dw_surface_show(s3dw_widget *widget)
+{
+	s3dw_surface *surface=(s3dw_surface *)widget;
+    s3d_flags_on(widget->oid,S3D_OF_VISIBLE|S3D_OF_SELECTABLE);
+    s3d_flags_on(surface->oid_title,S3D_OF_VISIBLE|S3D_OF_SELECTABLE);
+    s3d_flags_on(surface->oid_tbar,S3D_OF_VISIBLE|S3D_OF_SELECTABLE);
+}
+/* hides the surface */
+void s3dw_surface_hide(s3dw_widget *widget)
+{
+	s3dw_surface *surface=(s3dw_surface *)widget;
+    s3d_flags_off(widget->oid,S3D_OF_VISIBLE|S3D_OF_SELECTABLE);
+    s3d_flags_off(surface->oid_title,S3D_OF_VISIBLE|S3D_OF_SELECTABLE);
+    s3d_flags_off(surface->oid_tbar,S3D_OF_VISIBLE|S3D_OF_SELECTABLE);
+}
 /* create a new surface */
-struct s3dw_widget *s3dw_surface_new(char *title, float width, float height)
+s3dw_surface *s3dw_surface_new(char *title, float width, float height)
 {
-	struct s3dw_surface *surface;
-	struct s3dw_widget  *widget;
+	s3dw_surface *surface;
+	s3dw_widget  *widget;
 			
-	surface=(struct s3dw_surface *)malloc(sizeof(struct s3dw_surface));
-	surface->_nobj=0;
-	surface->_pobj=NULL;
-	surface->_style=&def_style;
+	surface=(s3dw_surface *)malloc(sizeof(s3dw_surface));
 	surface->title=strdup(title);
-
-	nsurf++;
-	psurf=realloc(psurf,sizeof(struct s3dw_widget **)*nsurf);
-	widget=s3dw_widget_new();
+	widget=s3dw_widget_new((s3dw_widget *)surface);
 	widget->type=S3DW_TSURFACE;
-	widget->data.surface=surface;
-	widget->_width=width;
-	widget->_height=height;
-	psurf[nsurf-1]=widget;
+	widget->width=width;
+	widget->height=height;
+	s3dw_widget_append(s3dw_getroot(),widget);
 	s3dw_surface_draw(widget);
-	return(widget);
+	return(surface);
 }
-void s3dw_surface_erase(struct s3dw_surface *surface)
+/* delete objects in the s3d context */
+void s3dw_surface_erase(s3dw_widget *widget)
 {
-	s3d_del_object(surface->oid);
-	s3d_del_object(surface->_oid_tbar);
-	s3d_del_object(surface->_oid_title);
+	s3dw_surface *surface=(s3dw_surface *)widget;
+	s3d_del_object(widget->oid);
+	s3d_del_object(surface->oid_tbar);
+	s3d_del_object(surface->oid_title);
 }
 /* destroy the surface */
-void s3dw_surface_destroy(struct s3dw_surface *surface)
+void s3dw_surface_destroy(s3dw_widget *widget)
 {
-	int i;
-	if (surface->_nobj>0)
-	{
-		for (i=0;i<surface->_nobj;i++)
-		{
-			s3dw_widget_destroy(surface->_pobj[i]);
-		}
-		free(surface->_pobj);
-	}
-
-	s3dw_surface_erase(surface);
+	s3dw_surface *surface=(s3dw_surface *)widget;
+	s3dw_surface_erase(widget);
 	free(surface->title);
 	free(surface);
 }
-/* properly delete, take care of the carrying structure ... */
-void s3dw_surface_delete(struct s3dw_surface *surface)
+/* handle key events */
+int s3dw_surface_event_key(s3dw_widget *widget, unsigned short oid)
 {
-	int i;
-	for (i=0;i<nsurf;i++) /* search ... */
-		if (psurf[i]->data.surface==surface) /* ... and destroy */
-		{
-			s3dw_surface_erase(surface);
-			free(psurf[i]);
-			psurf[i]=psurf[nsurf-1]; /* swap last element to the to be deleted one */
-			nsurf--;
-			break;
-		}
+	return(0);
 }
-/* append an widget */
-void s3dw_surface_append_obj(struct s3dw_surface *surface, struct s3dw_widget *widget)
-{
-	surface->_nobj++;
-	surface->_pobj=realloc(surface->_pobj,sizeof(struct s3dw_widget *)*surface->_nobj);
-	surface->_pobj[surface->_nobj-1]=widget;
-	widget->_surface=surface;
-}
 /* test widgets of the surface for clicks */
-void s3dw_surface_event_click(struct s3dw_widget *widget, unsigned long oid)
+int s3dw_surface_event_click(s3dw_widget *widget, unsigned long oid)
 {
-	int i;
-	if (widget->data.surface->oid==oid)
+	s3dw_surface *surface=(s3dw_surface *)widget;
+	if (widget->oid==oid)
 	{
-		dprintf(MED,"body %s clicked",widget->data.surface->title);
+		s3dw_focus(widget);
+		dprintf(MED,"body %s clicked",surface->title);
+		return(1);
 	}
-	if ((widget->data.surface->_oid_tbar==oid) || (widget->data.surface->_oid_title==oid))
+	if ((surface->oid_tbar==oid) || (surface->oid_title==oid))
 	{
-		dprintf(MED,"title %s clicked",widget->data.surface->title);
+		s3dw_focus(widget);
+		dprintf(MED,"title %s clicked",surface->title);
+		return(1);
 	}
-	for (i=0;i<widget->data.surface->_nobj;i++)
-		s3dw_widget_event_click(widget->data.surface->_pobj[i],oid);
+	return(0);
 }
 

Modified: trunk/libs3dw/widget.c
===================================================================
--- trunk/libs3dw/widget.c	2006-06-03 11:48:00 UTC (rev 317)
+++ trunk/libs3dw/widget.c	2006-06-03 21:48:05 UTC (rev 318)
@@ -26,52 +26,110 @@
 #include <s3dw_int.h>
 #include <stdlib.h> /* malloc() */
 #include <string.h> /* strdup() */
-
-struct s3dw_widget *s3dw_widget_new()
+s3dw_widget *s3dw_widget_new(s3dw_widget *widget)
 {
-	struct s3dw_widget *widget=malloc(sizeof(struct s3dw_widget));
 	widget->type=-1;
-	widget->_x=widget->_dx=0;
-	widget->_y=widget->_dy=0;
-	widget->_z=widget->_dz=0;
-	widget->_rx=widget->_drx=0;
-	widget->_ry=widget->_dry=0;
-	widget->_rz=widget->_drz=0;
-	widget->_s=widget->_ds=1;
-	widget->_o=NULL;
-	widget->_width=0;
-	widget->_height=0;
-	widget->_surface=NULL;
-	widget->data.surface=NULL;
+	widget->x=widget->ax=0;
+	widget->y=widget->ay=0;
+	widget->z=widget->az=0;
+	widget->rx=widget->arx=0;
+	widget->ry=widget->ary=0;
+	widget->rz=widget->arz=0;
+	widget->s=widget->as=1;
+	widget->width=0;
+	widget->height=0;
+	widget->nobj=0;
+	widget->pobj=NULL;
+	widget->parent=NULL;
+	widget->focus=-1;
+	widget->flags=S3DW_ACTIVE;
+	widget->oid=-1;
 	return(widget);
 }
-void s3dw_widget_destroy(struct s3dw_widget *widget)
+/* widget clicked, call specific function and check kids */
+int s3dw_widget_event_click(s3dw_widget *widget, unsigned long oid)
 {
-	switch (widget->type)
+	int i;
+	if (s3dwcb_click[widget->type](widget,oid)) return(1);
+	for (i=0;i<widget->nobj;i++)
+		if (s3dw_widget_event_click(widget->pobj[i],oid)) return(1);
+	return(0);
+}
+/* widget received key,,call specific function and check (focused) kids */
+int s3dw_widget_event_key(s3dw_widget *widget, unsigned short key)
+{
+	if (s3dwcb_key[widget->type](widget,key)) return(1);
+	if (widget->focus!=-1)
+		if (s3dw_widget_event_key(widget->pobj[widget->focus],key)) return(1);
+	return(0);
+}
+
+
+/* append an widget */
+void s3dw_widget_append(s3dw_widget *parent, s3dw_widget *widget)
+{
+	parent->nobj++;
+	parent->pobj=realloc(parent->pobj,sizeof(s3dw_widget **) * (parent->nobj));
+	parent->pobj[parent->nobj-1]=widget;
+	widget->parent=parent;
+	widget->style=parent->style;
+	if (!(parent->flags&S3DW_VISIBLE))
+		widget->flags|=S3DW_VISIBLE;
+}
+/* removes an widget from it's parent, should have been appended before */
+void s3dw_widget_remove(s3dw_widget *widget)
+{
+	s3dw_widget *parent=widget->parent;
+	int i;
+	if (parent==NULL) return;
+
+	for (i=0;i<parent->nobj;i++) /* search ... */
+		if (parent->pobj[i]==widget) /* ... and destroy */
 		{
-			case S3DW_TBUTTON:		s3dw_button_destroy(widget->data.button);			break;
-			case S3DW_TSURFACE:		s3dw_surface_destroy(widget->data.surface);			break;
-			case S3DW_TLABEL:		s3dw_label_destroy(widget->data.label);				break;
-			case S3DW_TINPUT:		s3dw_input_destroy(widget->data.input);				break;
-			default:
-					dprintf(MED,"can't free this type (yet) - memory leak\n");
+			if (parent->focus==i)					parent->focus=-1;
+			if (parent->focus==(parent->nobj-1))	parent->focus=i;
+			parent->pobj[i]=parent->pobj[parent->nobj-1]; /* swap last element to the to be deleted one */
+			parent->nobj--;
 		}
-	free(widget);
 }
-void s3dw_widget_event_click(struct s3dw_widget *widget, unsigned long oid)
+/* properly delete the object, removing kids, own structure and link from parent. */
+void s3dw_delete(s3dw_widget *widget)
 {
-	switch (widget->type)
+	s3dw_widget_remove(widget);
+	/* remove kids */
+	while (widget->nobj>0) /* will decrease as child-delete will call s3dw_widget_remove() */
+		s3dw_delete(widget->pobj[0]);
+	free(widget->pobj);
+	s3dwcb_destroy[widget->type](widget);	/* type-specific destroy */
+}
+/* toggle a widget visible and show it */
+void s3dw_show(s3dw_widget *widget)
+{
+	widget->flags|=S3DW_VISIBLE;
+	s3dw_widget_visible(widget);
+}
+void s3dw_focus(s3dw_widget *focus)
+{
+	int i;
+	for (i=0;i<focus->parent->nobj;i++)
+		if (focus->parent->pobj[i]==focus)
 		{
-			case S3DW_TBUTTON:
-					s3dw_button_event_click(widget,oid);
-					break;
-			case S3DW_TLABEL:
-					s3dw_label_event_click(widget,oid);
-					break;
-			case S3DW_TINPUT:
-					s3dw_input_event_click(widget,oid);
-					break;
-
+			focus->parent->focus=i;
+			return;
 		}
+}
 
+/* show visible kids */
+void s3dw_widget_visible(s3dw_widget *widget)
+{
+	int i;
+	s3dw_widget *kid;
+	for (i=0;i<widget->nobj;i++)
+	{
+		kid=widget->pobj[i];
+		if (widget->flags&S3DW_VISIBLE)
+			s3dw_widget_visible(kid);
+	}
+	widget->flags|=S3DW_ONSCREEN;
+	s3dwcb_show[widget->type](widget);
 }



From nichtsnutz at berlios.de  Sun Jun  4 12:11:15 2006
From: nichtsnutz at berlios.de (nichtsnutz at BerliOS)
Date: Sun, 4 Jun 2006 12:11:15 +0200
Subject: [S3d-svn] r319 - trunk/example
Message-ID: <200606041011.k54ABF34006745@sheep.berlios.de>

Author: nichtsnutz
Date: 2006-06-04 12:11:15 +0200 (Sun, 04 Jun 2006)
New Revision: 319

Modified:
   trunk/example/nichtsnutz.c
Log:
testing


Modified: trunk/example/nichtsnutz.c
===================================================================
--- trunk/example/nichtsnutz.c	2006-06-03 21:48:05 UTC (rev 318)
+++ trunk/example/nichtsnutz.c	2006-06-04 10:11:15 UTC (rev 319)
@@ -33,32 +33,37 @@
 static struct timespec t={0,10*1000*1000}; /* 10 mili seconds */
 
 int object,foll;
-float al, r, rc, alpha,Asp,Bottom,Left,angle;
+float al, r, alpha, Asp, Bottom, Left, angle;
 float CamPosition[2][3],
+	  TmpMove[3],
 	  TmpCam[2][3],
 	  RotCam[2][3],
 	  CatPos[3];
 
+float length;
+
 void mainloop()
 {
 	
 	al=(alpha*M_PI/180);
     r = 5.0;
-	rc = 10.0;
 	
 	CatPos[0] = sin(al)*r;
 	CatPos[1] = 0;
 	CatPos[2] = cos(al)*r;
 	
-	RotCam[0][0] = sin(al)*rc;
-	RotCam[0][1] = 0;
-	RotCam[0][2] = cos(al)*rc;
-	
 	s3d_translate(object,CatPos[0] ,CatPos[1], CatPos[2]);
 	s3d_rotate(object, 0, alpha, 0);
 	alpha = alpha+0.1;
 	if (alpha>360.0) alpha=0.0;
+	
+	length = s3d_vector_length(CatPos);
 
+	RotCam[0][0] = ( CatPos[0] * 12.0 ) / length;
+	RotCam[0][1] = CatPos[1];
+	RotCam[0][2] = ( CatPos[2] * RotCam[0][0] ) / CatPos[0];
+	
+	
 	if( foll )
 	{
 		
@@ -66,14 +71,28 @@
 		CamPosition[0][1] = ((CamPosition[0][1]*4 + RotCam[0][1])/5);
 		CamPosition[0][2] = ((CamPosition[0][2]*4 + RotCam[0][2])/5);
 		s3d_translate(0,CamPosition[0][0],CamPosition[0][1],CamPosition[0][2]);
+
+		TmpMove[0] = CamPosition[0][0];
+		TmpMove[1] = CamPosition[0][1];
+		TmpMove[2] = CamPosition[0][2];
+		
+		TmpMove[0] += sin( ( CamPosition[1][1] * M_PI ) / 180 );
+		TmpMove[2] += cos( ( CamPosition[1][1] * M_PI ) / 180 );
+		TmpMove[0] += cos( (-CamPosition[1][1] * M_PI ) / 180 );
+		TmpMove[2] += sin( (-CamPosition[1][1] * M_PI ) / 180 );
+		TmpMove[1] += sin( (-CamPosition[1][0] * M_PI ) / 180 );
+						 
+	/*	
+		angle = s3d_vector_angle(CatPos,TmpMove);
+		angle = (CatPos[0] > 0)?(180-(180 / M_PI * angle)):(180+(180 / M_PI * angle));
+		printf("%f %f\n",angle,al);
+	*/
+	//	CamPosition[1][1] = (CamPosition[1][1]*4 + angle)/5;
+	//	s3d_rotate(0,CamPosition[1][0], CamPosition[1][1], CamPosition[1][2]);
+	}
 	
-		angle = s3d_vector_angle(CatPos,CamPosition[0]);
-		angle = (CatPos[0] > 0)?(180-(180 / M_PI * angle)):(180+(180 / M_PI * angle));
 
-		CamPosition[1][1] = (CamPosition[1][1]*4 + angle)/5;
-		s3d_rotate(0,CamPosition[1][0], CamPosition[1][1], CamPosition[1][2]);
-		/*printf("angle %f\n",angle);*/
-	}
+	
 	nanosleep(&t,NULL); 
 }
 



From nichtsnutz at berlios.de  Sun Jun  4 12:32:29 2006
From: nichtsnutz at berlios.de (nichtsnutz at BerliOS)
Date: Sun, 4 Jun 2006 12:32:29 +0200
Subject: [S3d-svn] r320 - trunk/example
Message-ID: <200606041032.k54AWThc011051@sheep.berlios.de>

Author: nichtsnutz
Date: 2006-06-04 12:32:18 +0200 (Sun, 04 Jun 2006)
New Revision: 320

Modified:
   trunk/example/nichtsnutz.c
Log:
testing


Modified: trunk/example/nichtsnutz.c
===================================================================
--- trunk/example/nichtsnutz.c	2006-06-04 10:11:15 UTC (rev 319)
+++ trunk/example/nichtsnutz.c	2006-06-04 10:32:18 UTC (rev 320)
@@ -60,7 +60,7 @@
 	length = s3d_vector_length(CatPos);
 
 	RotCam[0][0] = ( CatPos[0] * 12.0 ) / length;
-	RotCam[0][1] = CatPos[1];
+	RotCam[0][1] = ( CatPos[1] != 0 ) ?(( CatPos[1] * 12 ) / length):0;
 	RotCam[0][2] = ( CatPos[2] * RotCam[0][0] ) / CatPos[0];
 	
 	
@@ -76,11 +76,9 @@
 		TmpMove[1] = CamPosition[0][1];
 		TmpMove[2] = CamPosition[0][2];
 		
-		TmpMove[0] += sin( ( CamPosition[1][1] * M_PI ) / 180 );
-		TmpMove[2] += cos( ( CamPosition[1][1] * M_PI ) / 180 );
-		TmpMove[0] += cos( (-CamPosition[1][1] * M_PI ) / 180 );
-		TmpMove[2] += sin( (-CamPosition[1][1] * M_PI ) / 180 );
-		TmpMove[1] += sin( (-CamPosition[1][0] * M_PI ) / 180 );
+		TmpMove[0] += 2 * sin( ( CamPosition[1][1] * M_PI ) / 180 );
+		TmpMove[2] += 2 * cos( ( CamPosition[1][1] * M_PI ) / 180 );
+		TmpMove[1] += 2 * sin( (-CamPosition[1][0] * M_PI ) / 180 );
 						 
 	/*	
 		angle = s3d_vector_angle(CatPos,TmpMove);



From nichtsnutz at berlios.de  Sun Jun  4 13:16:27 2006
From: nichtsnutz at berlios.de (nichtsnutz at BerliOS)
Date: Sun, 4 Jun 2006 13:16:27 +0200
Subject: [S3d-svn] r321 - trunk/example
Message-ID: <200606041116.k54BGRHS025980@sheep.berlios.de>

Author: nichtsnutz
Date: 2006-06-04 13:16:26 +0200 (Sun, 04 Jun 2006)
New Revision: 321

Modified:
   trunk/example/nichtsnutz.c
Log:
testing


Modified: trunk/example/nichtsnutz.c
===================================================================
--- trunk/example/nichtsnutz.c	2006-06-04 10:32:18 UTC (rev 320)
+++ trunk/example/nichtsnutz.c	2006-06-04 11:16:26 UTC (rev 321)
@@ -33,9 +33,10 @@
 static struct timespec t={0,10*1000*1000}; /* 10 mili seconds */
 
 int object,foll;
-float al, r, alpha, Asp, Bottom, Left, angle;
+float al, r, alpha=0.0, Asp, Bottom, Left, angle;
 float CamPosition[2][3],
 	  TmpMove[3],
+	  Tmp[3],
 	  TmpCam[2][3],
 	  RotCam[2][3],
 	  CatPos[3];
@@ -72,21 +73,20 @@
 		CamPosition[0][2] = ((CamPosition[0][2]*4 + RotCam[0][2])/5);
 		s3d_translate(0,CamPosition[0][0],CamPosition[0][1],CamPosition[0][2]);
 
-		TmpMove[0] = CamPosition[0][0];
-		TmpMove[1] = CamPosition[0][1];
-		TmpMove[2] = CamPosition[0][2];
+		TmpMove[0] = 0.0;
+		TmpMove[1] = 0.0;
+		TmpMove[2] = 1.0;
+
+		Tmp[0] = CamPosition[0][0] - CatPos[0];
+		Tmp[1] = 0.0;
+		Tmp[2] = CamPosition[0][2] - CatPos[2];
 		
-		TmpMove[0] += 2 * sin( ( CamPosition[1][1] * M_PI ) / 180 );
-		TmpMove[2] += 2 * cos( ( CamPosition[1][1] * M_PI ) / 180 );
-		TmpMove[1] += 2 * sin( (-CamPosition[1][0] * M_PI ) / 180 );
-						 
-	/*	
-		angle = s3d_vector_angle(CatPos,TmpMove);
-		angle = (CatPos[0] > 0)?(180-(180 / M_PI * angle)):(180+(180 / M_PI * angle));
+		angle = s3d_vector_angle(Tmp,TmpMove);
+		angle = (CatPos[0] > 0)?(180-(180 / M_PI * -angle)):(180+(180 / M_PI * -angle));
 		printf("%f %f\n",angle,al);
-	*/
-	//	CamPosition[1][1] = (CamPosition[1][1]*4 + angle)/5;
-	//	s3d_rotate(0,CamPosition[1][0], CamPosition[1][1], CamPosition[1][2]);
+	
+		CamPosition[1][1] = (CamPosition[1][1]*4 + angle)/5;
+		s3d_rotate(0,CamPosition[1][0], CamPosition[1][1], CamPosition[1][2]);
 	}
 	
 



From nichtsnutz at berlios.de  Sun Jun  4 13:39:39 2006
From: nichtsnutz at berlios.de (nichtsnutz at BerliOS)
Date: Sun, 4 Jun 2006 13:39:39 +0200
Subject: [S3d-svn] r322 - trunk/example
Message-ID: <200606041139.k54Bdd9s000620@sheep.berlios.de>

Author: nichtsnutz
Date: 2006-06-04 13:39:38 +0200 (Sun, 04 Jun 2006)
New Revision: 322

Modified:
   trunk/example/nichtsnutz.c
Log:
testing


Modified: trunk/example/nichtsnutz.c
===================================================================
--- trunk/example/nichtsnutz.c	2006-06-04 11:16:26 UTC (rev 321)
+++ trunk/example/nichtsnutz.c	2006-06-04 11:39:38 UTC (rev 322)
@@ -33,7 +33,7 @@
 static struct timespec t={0,10*1000*1000}; /* 10 mili seconds */
 
 int object,foll;
-float al, r, alpha=0.0, Asp, Bottom, Left, angle;
+float al, r, rc ,alpha=0.0, Asp, Bottom, Left, angle;
 float CamPosition[2][3],
 	  TmpMove[3],
 	  Tmp[3],
@@ -48,21 +48,27 @@
 	
 	al=(alpha*M_PI/180);
     r = 5.0;
+	rc = 12.0;
 	
 	CatPos[0] = sin(al)*r;
 	CatPos[1] = 0;
 	CatPos[2] = cos(al)*r;
-	
+	/*
+	RotCam[0][0] = sin(al) * rc;
+	RotCam[0][1] = 0.0;
+	RotCam[0][2] = cos(al) * rc;
+	*/
 	s3d_translate(object,CatPos[0] ,CatPos[1], CatPos[2]);
 	s3d_rotate(object, 0, alpha, 0);
 	alpha = alpha+0.1;
 	if (alpha>360.0) alpha=0.0;
 	
-	length = s3d_vector_length(CatPos);
+	/* length = s3d_vector_length(CatPos); */
 
+
 	RotCam[0][0] = ( CatPos[0] * 12.0 ) / length;
-	RotCam[0][1] = ( CatPos[1] != 0 ) ?(( CatPos[1] * 12 ) / length):0;
-	RotCam[0][2] = ( CatPos[2] * RotCam[0][0] ) / CatPos[0];
+	RotCam[0][1] = ( CatPos[1] * 12.0 ) / length;
+	RotCam[0][2] = ( CatPos[2] * 12.0 ) / length;
 	
 	
 	if( foll )
@@ -75,14 +81,14 @@
 
 		TmpMove[0] = 0.0;
 		TmpMove[1] = 0.0;
-		TmpMove[2] = 1.0;
+		TmpMove[2] = -1.0;
 
 		Tmp[0] = CamPosition[0][0] - CatPos[0];
 		Tmp[1] = 0.0;
 		Tmp[2] = CamPosition[0][2] - CatPos[2];
 		
 		angle = s3d_vector_angle(Tmp,TmpMove);
-		angle = (CatPos[0] > 0)?(180-(180 / M_PI * -angle)):(180+(180 / M_PI * -angle));
+		angle = (CatPos[0] > 0)?(180-(180 / M_PI * angle)):(180+(180 / M_PI * angle));
 		printf("%f %f\n",angle,al);
 	
 		CamPosition[1][1] = (CamPosition[1][1]*4 + angle)/5;



From nichtsnutz at berlios.de  Sun Jun  4 13:44:19 2006
From: nichtsnutz at berlios.de (nichtsnutz at BerliOS)
Date: Sun, 4 Jun 2006 13:44:19 +0200
Subject: [S3d-svn] r323 - trunk/example
Message-ID: <200606041144.k54BiJsX001607@sheep.berlios.de>

Author: nichtsnutz
Date: 2006-06-04 13:44:18 +0200 (Sun, 04 Jun 2006)
New Revision: 323

Modified:
   trunk/example/nichtsnutz.c
Log:
finish testing


Modified: trunk/example/nichtsnutz.c
===================================================================
--- trunk/example/nichtsnutz.c	2006-06-04 11:39:38 UTC (rev 322)
+++ trunk/example/nichtsnutz.c	2006-06-04 11:44:18 UTC (rev 323)
@@ -63,7 +63,7 @@
 	alpha = alpha+0.1;
 	if (alpha>360.0) alpha=0.0;
 	
-	/* length = s3d_vector_length(CatPos); */
+	length = s3d_vector_length(CatPos);
 
 
 	RotCam[0][0] = ( CatPos[0] * 12.0 ) / length;



From dotslash at berlios.de  Sun Jun  4 13:49:25 2006
From: dotslash at berlios.de (dotslash at BerliOS)
Date: Sun, 4 Jun 2006 13:49:25 +0200
Subject: [S3d-svn] r324 - in trunk: . server
Message-ID: <200606041149.k54BnPQQ003112@sheep.berlios.de>

Author: dotslash
Date: 2006-06-04 13:49:14 +0200 (Sun, 04 Jun 2006)
New Revision: 324

Modified:
   trunk/
   trunk/server/matrix.c
   trunk/server/object.c
Log:
 r688 at balthasar:  dotslash | 2006-06-04 13:48:54 +0200
 - ignore inf/nan numbers



Property changes on: trunk
___________________________________________________________________
Name: svk:merge
   - bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:680
   + bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:688

Modified: trunk/server/matrix.c
===================================================================
--- trunk/server/matrix.c	2006-06-04 11:44:18 UTC (rev 323)
+++ trunk/server/matrix.c	2006-06-04 11:49:14 UTC (rev 324)
@@ -163,6 +163,7 @@
 					goto check;
 				}
 			dprintf(MED,"nothing to swap, can't reverse this matrix! returning ... ");
+			mat_debug(Mm);
 			return(-1); /* the dead end!! */
 		}
 	}

Modified: trunk/server/object.c
===================================================================
--- trunk/server/object.c	2006-06-04 11:44:18 UTC (rev 323)
+++ trunk/server/object.c	2006-06-04 11:49:14 UTC (rev 324)
@@ -1187,7 +1187,9 @@
 	float v[3];
 	if (obj_valid(p,oid,obj))
 	{
-		dprintf(VLOW,"[translate|pid %d] %d: %3.3f %3.3f %3.3f",p->id,oid,obj->translate.x,obj->translate.y,obj->translate.z);
+		if (isnan(transv[0])||isinf(transv[0])) return(-1);
+		if (isnan(transv[1])||isinf(transv[1])) return(-1);
+		if (isnan(transv[2])||isinf(transv[2])) return(-1);
 		if ((p->id!=MCP) && (obj->oflags&OF_SYSTEM))
 		{
 			if (focus_oid==p->mcp_oid)
@@ -1209,7 +1211,7 @@
 			obj->translate.z=*(transv+2);
 			obj_pos_update(p,oid,oid);
 		}
-
+		dprintf(LOW,"[translate|pid %d] %d: %3.3f %3.3f %3.3f",p->id,oid,obj->translate.x,obj->translate.y,obj->translate.z);
 	}
 	return(0);
 }
@@ -1222,7 +1224,9 @@
 	float f;
 	if (obj_valid(p,oid,obj))
 	{
-		dprintf(VLOW,"[rotate|pid %d] %d: %3.3f %3.3f %3.3f",p->id,oid,obj->rotate.x,obj->rotate.y,obj->rotate.z);
+		if (isnan(rotv[0])||isinf(rotv[0])) return(-1);
+		if (isnan(rotv[1])||isinf(rotv[1])) return(-1);
+		if (isnan(rotv[2])||isinf(rotv[2])) return(-1);
 		if ((p->id!=MCP) && (obj->oflags&OF_SYSTEM))
 		{
 			if (focus_oid==p->mcp_oid)
@@ -1247,6 +1251,7 @@
 			obj->rotate.z=f;
 			obj_pos_update(p,oid,oid);
 		}
+		dprintf(LOW,"[rotate|pid %d] %d: %3.3f %3.3f %3.3f",p->id,oid,obj->rotate.x,obj->rotate.y,obj->rotate.z);
 	}
 	return(0);
 }
@@ -1456,7 +1461,7 @@
 	}
 	/* reverse in the application space */
 	mySetMatrix(mcp_p->object[p->mcp_oid]->m);
-	myInvert();
+	if (myInvert()) return; /* we don't bother if the matrix doesn't work. */
 	myTransform3f(v);
 
 	p->object[oid]->rotate.x=fs.x-fa.x;



From nichtsnutz at berlios.de  Sun Jun  4 16:00:19 2006
From: nichtsnutz at berlios.de (nichtsnutz at BerliOS)
Date: Sun, 4 Jun 2006 16:00:19 +0200
Subject: [S3d-svn] r325 - trunk/apps/olsrs3d
Message-ID: <200606041400.k54E0JIJ032377@sheep.berlios.de>

Author: nichtsnutz
Date: 2006-06-04 16:00:18 +0200 (Sun, 04 Jun 2006)
New Revision: 325

Modified:
   trunk/apps/olsrs3d/main.c
Log:
fix node search


Modified: trunk/apps/olsrs3d/main.c
===================================================================
--- trunk/apps/olsrs3d/main.c	2006-06-04 11:49:14 UTC (rev 324)
+++ trunk/apps/olsrs3d/main.c	2006-06-04 14:00:18 UTC (rev 325)
@@ -648,8 +648,9 @@
 
 	int net_result;   /* result of function net_main */
 	char nc_str[20];
-	float strLen;
-	float target,current,diff[3],tmp_mov_vec[3],angle,angle_rad;
+	float strLen,node_length;
+	float target,current,diff[3],tmp_mov_vec[3],angle;
+	float tmpVec[3], diffVec[3], np[3];
 	int i;
 	/* calculate new movement vector */
 	calc_olsr_node_mov();
@@ -725,54 +726,40 @@
 			move_cam_to = -1;
 		}
 	} else if ( move_cam_to != -2 && move_cam_to != -1 ) {
+	
 		Oid_focus = -1;
+				
+		diff[0] =  search_node->pos_vec[0]*cos(Zp_rotate*M_PI/180.0) - search_node->pos_vec[2] * -sin (Zp_rotate*M_PI/180.0);
+		diff[1] =  search_node->pos_vec[1];
+		diff[2] =  search_node->pos_vec[0]*-sin(Zp_rotate*M_PI/180.0) + search_node->pos_vec[2] * cos (Zp_rotate*M_PI/180.0);
+
+		node_length = s3d_vector_length(diff);
 		
-		/* s3d_vector_substract(CamPosition2[0], CamPosition[0], diff); */
+		np[0] = ( diff[0] + 7);
+		np[1] = diff[1];
+		np[2] = ( diff[2] + 7);
 		
-		diff[0]=  search_node->pos_vec[0]*cos(Zp_rotate*M_PI/180.0) - search_node->pos_vec[2] * -sin (Zp_rotate*M_PI/180.0);
-		diff[1]=  search_node->pos_vec[1];
-		diff[2]=  search_node->pos_vec[0]*-sin(Zp_rotate*M_PI/180.0) + search_node->pos_vec[2] * cos (Zp_rotate*M_PI/180.0);
-
+		CamPosition[0][0]=( CamPosition[0][0] * 4 + np[0] ) / 5;
+		CamPosition[0][1]=( CamPosition[0][1] * 4 + np[1] ) / 5;
+		CamPosition[0][2]=( CamPosition[0][2] * 4 + np[2] ) / 5;
 		
-		CamPosition[0][0]=(CamPosition[0][0]*4+diff[0])/5;
-		CamPosition[0][1]=(CamPosition[0][1]*4+(diff[1])+2)/5;
-		CamPosition[0][2]=(CamPosition[0][2]*4+(diff[2]+10))/5;
+		tmpVec[0] = 0.0;
+		tmpVec[1] = 0.0;
+		tmpVec[2] = -1.0;
 		
-		/*
-		CamPosition[0][0]=((CamPosition[0][0]*4+search_node->pos_vec[0])/5)+diff[0];
-		CamPosition[0][1]=((CamPosition[0][1]*4+(search_node->pos_vec[1])+2)/5)+diff[1];
-		CamPosition[0][2]=((CamPosition[0][2]*4+(search_node->pos_vec[2]+10))/5)+diff[2];
-		*/	
-		for( i=0; i<3; i++)
-		{
-			target = 0.0;
-			current = CamPosition[1][i];
-
-			if( 0 - CamPosition[1][i] > 180 )
-				target = 0 - 360;
-			if( 0 - CamPosition[1][i] < -180 )
-				current = CamPosition[1][i] - 360;
-			CamPosition[1][i]=(CamPosition[1][i]*4+target)/5;
-		}
-		/*
-		tmp_mov_vec[0] = diff[0] - search_node->pos_vec[0];
-		tmp_mov_vec[1] = 0; 
-		tmp_mov_vec[2] = diff[2] - search_node->pos_vec[2];
-
-		angle = s3d_vector_angle( CamPosition[1], tmp_mov_vec );
-
+		diffVec[0] = CamPosition[0][0] - diff[0];
+		diffVec[1] = 0.0;
+		diffVec[2] = CamPosition[0][2] - diff[2];
 		
-		if ( tmp_mov_vec[0] > 0 ) {
-			angle_rad = 90.0/M_PI - angle;
-			angle = 180 - ( 180.0/M_PI * angle );
-		} else {
-			angle_rad = 90.0/M_PI + angle;
-			angle = 180 + ( 180.0/M_PI * angle );
-		}
-		*/
+		angle = s3d_vector_angle( diffVec, tmpVec );
+		angle = (diff[0] > 0)?(180-(180 / M_PI * angle)):(180+(180 / M_PI * angle));
+		
+		CamPosition[1][1] = (CamPosition[1][1]*4 + angle)/5;
+		
 		s3d_translate(0,CamPosition[0][0],CamPosition[0][1],CamPosition[0][2]);
 		s3d_rotate(0,CamPosition[1][0],CamPosition[1][1],CamPosition[1][2]);
 
+		
 		if(Btn_follow_mode_id == -1)
 		{
 			Btn_follow_mode_id = s3d_clone( Btn_follow_mode_obj );
@@ -784,12 +771,6 @@
 		
 		Rotate_follow_button = (Rotate_follow_button + 50)%360;
 		s3d_rotate(Btn_follow_mode_id,0,Rotate_follow_button,0);
-/*		if (dist(CamPosition[0],search_node->pos_vec) < 6)
-		{
-			s3d_translate(0,search_node->pos_vec[0],search_node->pos_vec[1],(search_node->pos_vec[2]+5));
-			s3d_rotate(0,0,0,0);
-			move_cam_to = -1;
-		}*/
 	}
 	
 	/* move back to returnPoint */



From nichtsnutz at berlios.de  Sun Jun  4 16:59:20 2006
From: nichtsnutz at berlios.de (nichtsnutz at BerliOS)
Date: Sun, 4 Jun 2006 16:59:20 +0200
Subject: [S3d-svn] r326 - trunk/apps/olsrs3d
Message-ID: <200606041459.k54ExKE2009040@sheep.berlios.de>

Author: nichtsnutz
Date: 2006-06-04 16:59:18 +0200 (Sun, 04 Jun 2006)
New Revision: 326

Modified:
   trunk/apps/olsrs3d/main.c
Log:
fix rotation:
- add numpad plus and minus
- slower rotation 



Modified: trunk/apps/olsrs3d/main.c
===================================================================
--- trunk/apps/olsrs3d/main.c	2006-06-04 14:00:18 UTC (rev 325)
+++ trunk/apps/olsrs3d/main.c	2006-06-04 14:59:18 UTC (rev 326)
@@ -72,10 +72,10 @@
 float ReturnPoint[2][3];	/* return point to move back from terminal */
 
 int ZeroPoint;   /* object zeropoint */
-int Zp_rotate = 0;
+float Zp_rotate = 0.0;
 int ColorSwitch = 0;   /* enable/disable colored olsr connections */
 int RotateSwitch = 0;
-int RotateSpeed = 2;
+float RotateSpeed = 0.5;
 float Factor = 0.6;	/* Factor in calc_olsr_node_mov */
 struct olsr_node *Olsr_node_pEtx;
 
@@ -649,7 +649,7 @@
 	int net_result;   /* result of function net_main */
 	char nc_str[20];
 	float strLen,node_length;
-	float target,current,diff[3],tmp_mov_vec[3],angle;
+	float target,current,diff[3],angle;
 	float tmpVec[3], diffVec[3], np[3];
 	int i;
 	/* calculate new movement vector */
@@ -692,7 +692,7 @@
 	}
 	
 	if(RotateSwitch) {
-		Zp_rotate = (Zp_rotate+RotateSpeed)%360;
+		Zp_rotate = ( Zp_rotate + RotateSpeed ) > 360 ? 0.0 : ( Zp_rotate + RotateSpeed );	
 		s3d_rotate(ZeroPoint,0,Zp_rotate,0);
 	}
 	CamPosition2[0][0]=  CamPosition[0][0]*cos(Zp_rotate*M_PI/180.0) - CamPosition[0][2] * sin (Zp_rotate*M_PI/180.0);
@@ -849,25 +849,45 @@
 				stop();
 				break;
 			case 'c': /* c -> color on/off */
-				if(ColorSwitch) ColorSwitch = 0;
-				else ColorSwitch = 1;
+				ColorSwitch =  ColorSwitch ? 0 : 1;
 				break;
 			case 'r': /* r -> rotate start/stop*/
-				if(RotateSwitch) RotateSwitch = 0;
-				else RotateSwitch = 1;
+				RotateSwitch = RotateSwitch ? 0 : 1;
 				break;
+			case S3DK_KP_PLUS:
 			case '+': /* + -> rotate speed increase*/
-				if(RotateSwitch && RotateSpeed < 10)
-					RotateSpeed++;
+				
+				if(RotateSwitch && RotateSpeed < 5)
+				{
+					if(RotateSpeed >= 1.0)
+						RotateSpeed += 1.0;
+					else
+						RotateSpeed += 0.1;
+					printf("%f,\n",RotateSpeed);
+				}
 				break;
+				
+			case S3DK_KP_MINUS:
 			case '-': /* - -> rotate speed decrease*/
-				if(RotateSwitch && RotateSpeed > 1)
-					RotateSpeed--;
+				
+				if(RotateSwitch)
+				{
+					if( RotateSpeed >= 2.0 )
+						RotateSpeed -= 1.0;
+					else {
+						if(RotateSpeed > 0.2)
+							RotateSpeed -= 0.1;
+					}
+					printf("%f,\n",RotateSpeed);
+				}
 				break;
+				
 			case 16: /* strg + p -> reset nodes ( zeroPoint to 0,0,0 ) */
-				s3d_translate(ZeroPoint,0.0,0.0,0.0);
-				ZeroPosition[0] = ZeroPosition[1] = ZeroPosition[2] = 0.0;
-				break;
+				{
+					s3d_translate(ZeroPoint,0.0,0.0,0.0);
+					ZeroPosition[0] = ZeroPosition[1] = ZeroPosition[2] = 0.0;
+					break;
+				}
 			case S3DK_PAGEUP: /* page up -> change factor in calc_olsr_node_mov */
 				if(Factor < 0.9)
 					Factor += 0.1;



From dotslash at berlios.de  Sun Jun  4 17:33:07 2006
From: dotslash at berlios.de (dotslash at BerliOS)
Date: Sun, 4 Jun 2006 17:33:07 +0200
Subject: [S3d-svn] r327 - in trunk: . libs3d server
Message-ID: <200606041533.k54FX75Q012930@sheep.berlios.de>

Author: dotslash
Date: 2006-06-04 17:33:07 +0200 (Sun, 04 Jun 2006)
New Revision: 327

Modified:
   trunk/
   trunk/libs3d/freetype.c
   trunk/libs3d/proto_in.c
   trunk/libs3d/s3d.h
   trunk/server/event.c
   trunk/server/global.h
   trunk/server/object.c
   trunk/server/proto.h
   trunk/server/user.c
   trunk/server/user_glut.c
   trunk/server/user_sdl.c
Log:
 r693 at balthasar:  dotslash | 2006-06-04 17:32:49 +0200
 - freetype typebla compiler warnings eliminated
 - keysyms and more



Property changes on: trunk
___________________________________________________________________
Name: svk:merge
   - bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:688
   + bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:693

Modified: trunk/libs3d/freetype.c
===================================================================
--- trunk/libs3d/freetype.c	2006-06-04 14:59:18 UTC (rev 326)
+++ trunk/libs3d/freetype.c	2006-06-04 15:33:07 UTC (rev 327)
@@ -36,7 +36,7 @@
 /*  bad global vars ... */
 static FT_Library 	library;
 static FT_Face		face;
-static unsigned char *memory_font=NULL;		 /*  the font file in memory */
+static char *memory_font=NULL;		 /*  the font file in memory */
 static int memory_font_size=0;	 /*  and it's size, to reduce load times. */
 static int ft_init=0;
 static int face_init=0;
@@ -74,7 +74,7 @@
 		return(-1);
 	}
 	face_init=0;
-	error= FT_New_Memory_Face(library,memory_font,memory_font_size,0,&face);
+	error= FT_New_Memory_Face(library,(unsigned char *)memory_font,memory_font_size,0,&face);
 	switch (error)
 	{
 		case 0:
@@ -315,7 +315,7 @@
 }
 int s3d_select_font(char *path)
 {
-	unsigned char 	*oldfont=memory_font;
+	char		 	*oldfont=memory_font;
 	int 			 oldsize=memory_font_size;
 	char *c;
 	char **p;

Modified: trunk/libs3d/proto_in.c
===================================================================
--- trunk/libs3d/proto_in.c	2006-06-04 14:59:18 UTC (rev 326)
+++ trunk/libs3d/proto_in.c	2006-06-04 15:33:07 UTC (rev 327)
@@ -74,15 +74,19 @@
 			}
 			break;
 		case S3D_P_S_KEY:
-			if (length==2)
+			if (length==8)
 			{
 				if (NULL!=(s3devt=malloc(sizeof(struct s3d_evt))))
 				{
-					s3devt->event=S3D_EVENT_KEY;
+					struct s3d_key_event *keyevent;
 					s3devt->length=2;
-					*((uint16_t *)buf)=
-							ntohs(*((uint16_t *)buf));
+					keyevent=(struct s3d_key_event *)buf;
+					keyevent->keysym=ntohs(keyevent->keysym);
+					keyevent->unicode=ntohs(keyevent->unicode);
+					keyevent->modifier=ntohs(keyevent->modifier);
+					keyevent->state=ntohs(keyevent->state);
 					s3devt->buf=buf;
+					s3devt->event=(keyevent->state==0)?S3D_EVENT_KEYDOWN:S3D_EVENT_KEYUP;
 				}
 				dprintf(VLOW,"S3D_P_S_KEY: key %d hit!!",*((uint16_t *)s3devt->buf));
 			}

Modified: trunk/libs3d/s3d.h
===================================================================
--- trunk/libs3d/s3d.h	2006-06-04 14:59:18 UTC (rev 326)
+++ trunk/libs3d/s3d.h	2006-06-04 15:33:07 UTC (rev 327)
@@ -33,7 +33,9 @@
 
 #define S3D_EVENT_OBJ_CLICK		1
 #define S3D_EVENT_KEY			2
+#define S3D_EVENT_KEYDOWN		2
 #define S3D_EVENT_MBUTTON		3
+#define S3D_EVENT_KEYUP			4
 #define S3D_EVENT_NEW_OBJECT	16
 #define S3D_EVENT_OBJ_INFO		17
 
@@ -70,6 +72,13 @@
 {
 	unsigned char button, state;
 };
+struct s3d_key_event
+{
+	unsigned short keysym;		/* the symbol, use this with s3d_keysym.h */
+	unsigned short unicode;		/* the unicode or "actually typed" character */
+	unsigned short modifier;	/* any modifiers involved */
+	unsigned short state;		/* 0 = pressed, 1 = released */
+};
 /* framework functions */
 void s3d_usage();
 int s3d_init(int *argc, char ***argv, char *name);

Modified: trunk/server/event.c
===================================================================
--- trunk/server/event.c	2006-06-04 14:59:18 UTC (rev 326)
+++ trunk/server/event.c	2006-06-04 15:33:07 UTC (rev 327)
@@ -44,16 +44,22 @@
 }
 /*  this functions sends keystroke events to the focused program. */
 /*  maybe mcp-keystrokes should be catched here. */
-int event_key_pressed(uint16_t key)
+/*  state = 0 -> pressed, 1 -> released */
+int event_key_pressed(uint16_t key, uint16_t uni, uint16_t mod,int state)
 {
-	uint16_t k;
+	uint16_t k[4];
 	struct t_obj *o;
-	k=htons(key);
+	k[0]=htons(key);
+	k[1]=htons(uni);
+	k[2]=htons(mod);
+	k[3]=htons(state);
 	if (obj_valid(get_proc_by_pid(MCP),focus_oid,o))
-		prot_com_out(get_proc_by_pid(o->n_mat), S3D_P_S_KEY, (uint8_t *)&k, 2);
-	prot_com_out(get_proc_by_pid(MCP),S3D_P_S_KEY,(uint8_t *)&k, 2); /* mcp always gets a copy */
+		prot_com_out(get_proc_by_pid(o->n_mat), S3D_P_S_KEY, (uint8_t *)k, 8);
+	prot_com_out(get_proc_by_pid(MCP),S3D_P_S_KEY,(uint8_t *)k, 8); /* mcp always gets a copy */
 	return(0);
 }
+
+
 /* mouse button changes are sent to the client */
 int event_mbutton_clicked(uint8_t button, uint8_t state)
 {

Modified: trunk/server/global.h
===================================================================
--- trunk/server/global.h	2006-06-04 14:59:18 UTC (rev 326)
+++ trunk/server/global.h	2006-06-04 15:33:07 UTC (rev 327)
@@ -237,7 +237,7 @@
 /* event.c */
 int event_obj_info(struct t_process *p, uint32_t oid);
 int event_obj_click(struct t_process *p, uint32_t oid);
-int event_key_pressed(uint16_t key);
+int event_key_pressed(uint16_t key, uint16_t uni, uint16_t mod, int state);
 int event_mbutton_clicked(uint8_t button, uint8_t state);
 int event_cam_changed(void);
 int event_ptr_changed(void);
@@ -258,7 +258,7 @@
 int user_main_sdl(void);
 #endif
 void user_mouse(int button, int state, int x, int y);
-void user_key(unsigned short key,int state);
+void user_key(unsigned short key, unsigned short unicode, unsigned short mod, int state);
 
 /*  error.c */
 void errn(char *func, int en);

Modified: trunk/server/object.c
===================================================================
--- trunk/server/object.c	2006-06-04 14:59:18 UTC (rev 326)
+++ trunk/server/object.c	2006-06-04 15:33:07 UTC (rev 327)
@@ -1211,7 +1211,7 @@
 			obj->translate.z=*(transv+2);
 			obj_pos_update(p,oid,oid);
 		}
-		dprintf(LOW,"[translate|pid %d] %d: %3.3f %3.3f %3.3f",p->id,oid,obj->translate.x,obj->translate.y,obj->translate.z);
+		dprintf(VLOW,"[translate|pid %d] %d: %3.3f %3.3f %3.3f",p->id,oid,obj->translate.x,obj->translate.y,obj->translate.z);
 	}
 	return(0);
 }
@@ -1251,7 +1251,7 @@
 			obj->rotate.z=f;
 			obj_pos_update(p,oid,oid);
 		}
-		dprintf(LOW,"[rotate|pid %d] %d: %3.3f %3.3f %3.3f",p->id,oid,obj->rotate.x,obj->rotate.y,obj->rotate.z);
+		dprintf(VLOW,"[rotate|pid %d] %d: %3.3f %3.3f %3.3f",p->id,oid,obj->rotate.x,obj->rotate.y,obj->rotate.z);
 	}
 	return(0);
 }

Modified: trunk/server/proto.h
===================================================================
--- trunk/server/proto.h	2006-06-04 14:59:18 UTC (rev 326)
+++ trunk/server/proto.h	2006-06-04 15:33:07 UTC (rev 327)
@@ -166,6 +166,9 @@
 			 /*  4b: oid */
 #define	S3D_P_S_KEY		4
 			 /*  2b: button */
+			 /*  2b: unicode translation */
+			 /*  2b: modifier information */
+			 /*  2b: state */
 #define S3D_P_S_MBUTTON	5
              /*  1b: button number */
              /*  2b: butotn state */

Modified: trunk/server/user.c
===================================================================
--- trunk/server/user.c	2006-06-04 14:59:18 UTC (rev 326)
+++ trunk/server/user.c	2006-06-04 15:33:07 UTC (rev 327)
@@ -55,13 +55,9 @@
 	}
 	return(0);
 }
-void user_key(unsigned short key,int state)
+void user_key(unsigned short key, unsigned short unicode, unsigned short mod, int state)
 {
-	if (state==0)  /*  down */
-	{
-		dprintf(LOW, "got key %d!!",key);
-		event_key_pressed(key);
-	}
+	event_key_pressed(key,unicode,mod,state);
 }
 void user_mouse(int button, int state, int x, int y) 
 {

Modified: trunk/server/user_glut.c
===================================================================
--- trunk/server/user_glut.c	2006-06-04 14:59:18 UTC (rev 326)
+++ trunk/server/user_glut.c	2006-06-04 15:33:07 UTC (rev 327)
@@ -45,7 +45,8 @@
 
 void keyboard(unsigned char key, int x, int y)
 {
-	user_key(key,0);
+	user_key(key,key,0,0);
+	user_key(key,key,0,1);
 }
 void special(int skey, int x, int y)
 {
@@ -76,7 +77,8 @@
 		default: 				mkey=skey; break;
 	}
 	dprintf(MED,"special(): %d -> %d",skey,mkey);
-	user_key(mkey,0);
+	user_key(mkey,0,0,0);
+	user_key(mkey,0,0,1);
 }
 void mouse_motion(int x, int y)
 {

Modified: trunk/server/user_sdl.c
===================================================================
--- trunk/server/user_sdl.c	2006-06-04 14:59:18 UTC (rev 326)
+++ trunk/server/user_sdl.c	2006-06-04 15:33:07 UTC (rev 327)
@@ -29,6 +29,7 @@
 
 extern int SDLFlags;
 int user_init_sdl() {
+	SDL_EnableUNICODE(1);
 	return(0);
 }
 int user_main_sdl() {
@@ -98,15 +99,17 @@
 			 break;
 
 		case SDL_KEYDOWN:
-			user_key(event.key.keysym.sym,0);
+			user_key(event.key.keysym.sym,event.key.keysym.unicode,event.key.keysym.mod,0);
 			break;
+		case SDL_KEYUP:
+			user_key(event.key.keysym.sym,event.key.keysym.unicode,event.key.keysym.mod,1);
+			break;
 		case SDL_QUIT:
 			dprintf(HIGH,"SDL_QUIT");
 			quit();
 			break;
 		 /*  these events are not processed right now ... */
 		case SDL_ACTIVEEVENT:		dprintf(VLOW,"SDL_ACTIVEEVENT");break;
-		case SDL_KEYUP:				dprintf(VLOW,"SDL_KEYUP");break;
 		case SDL_SYSWMEVENT:		dprintf(VLOW,"SDL_SYSWMEVENT");break;
 		case SDL_VIDEORESIZE:		if ((GLwin = SDL_SetVideoMode(event.resize.w,event.resize.h,16,SDLFlags))==NULL) 
 										errsf("SDL_SetVideoMode()",SDL_GetError());



From dotslash at berlios.de  Sun Jun  4 19:57:49 2006
From: dotslash at berlios.de (dotslash at BerliOS)
Date: Sun, 4 Jun 2006 19:57:49 +0200
Subject: [S3d-svn] r328 - in trunk: . apps/s3dvt example libs3d libs3dw
Message-ID: <200606041757.k54Hvn3X016820@sheep.berlios.de>

Author: dotslash
Date: 2006-06-04 19:57:33 +0200 (Sun, 04 Jun 2006)
New Revision: 328

Added:
   trunk/libs3dw/TODO
Modified:
   trunk/
   trunk/apps/s3dvt/main.c
   trunk/example/widgets.c
   trunk/libs3d/TODO
   trunk/libs3dw/Makefile.am
   trunk/libs3dw/animate.c
   trunk/libs3dw/button.c
   trunk/libs3dw/event.c
   trunk/libs3dw/input.c
   trunk/libs3dw/label.c
   trunk/libs3dw/root.c
   trunk/libs3dw/s3dw.h
   trunk/libs3dw/s3dw_int.h
   trunk/libs3dw/surface.c
   trunk/libs3dw/widget.c
Log:
 r697 at balthasar:  dotslash | 2006-06-04 19:57:17 +0200
 - repair s3dvt for new keycode managing
 - widgets auto arrangement :D
 - proper keycode use in libs3dw



Property changes on: trunk
___________________________________________________________________
Name: svk:merge
   - bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:693
   + bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:697

Modified: trunk/apps/s3dvt/main.c
===================================================================
--- trunk/apps/s3dvt/main.c	2006-06-04 15:33:07 UTC (rev 327)
+++ trunk/apps/s3dvt/main.c	2006-06-04 17:57:33 UTC (rev 328)
@@ -397,10 +397,10 @@
 }*/
 void keypress(struct s3d_evt *event)
 {
+	struct s3d_key_event *keys=(struct s3d_key_event *)event->buf;
 	int key;
-	key=*((unsigned short *)event->buf);
 /*	printf("received key: %d\n",key);*/
-	switch (key)
+	switch (key=keys->keysym)
 	{
 		case S3DK_F1:
 		case S3DK_F2:
@@ -482,8 +482,8 @@
 			term_addchar(10);
 			break;
 		default:
-			if ((char)key)  /*  \0 is no good idea .. */
-				term_addchar((char)key);
+			if ((char)keys->unicode)  /*  \0 is no good idea .. */
+				term_addchar((char)keys->unicode);
 	}
 
 }

Modified: trunk/example/widgets.c
===================================================================
--- trunk/example/widgets.c	2006-06-04 15:33:07 UTC (rev 327)
+++ trunk/example/widgets.c	2006-06-04 17:57:33 UTC (rev 328)
@@ -33,7 +33,7 @@
 
 s3dw_surface *surface;
 s3dw_input *input;
-static struct timespec t={0,100*1000*1000}; /* 100 mili seconds */
+static struct timespec t={0,33*1000*1000}; /* 33 mili seconds */
 void mainloop()
 {
 	/* keep this in your mainloop. this will do smooth animations for you ... */
@@ -47,9 +47,30 @@
 {
 	s3dw_handle_click(evt);
 }
+void key_button(s3dw_widget *button)
+{
+	s3dw_delete(button->parent); /* parent =surface. this means close containing window */
+}
 void key(struct s3d_evt *evt)
 {
+	struct s3d_key_event *key=(struct s3d_key_event *)evt->buf;
+	char string[8];
+	s3dw_surface *miniwin;
+	s3dw_button  *button;
+	
 	s3dw_handle_key(evt);
+	/* okay, that's a little bit insane ... ;) 
+	 * we create some little windows with the actual key pressed. */
+
+	miniwin=s3dw_surface_new("Key",6,6);
+	sprintf(string,"%c",key->unicode);
+	s3dw_label_new(miniwin,string,1,2);
+	button=s3dw_button_new(miniwin,"OK",2,4);
+	/* clicking on the button will exit ... */
+	button->onclick=key_button;
+	/* of couse, show it */
+	s3dw_show(S3DWIDGET(miniwin));
+
 }
 
 void done_button(s3dw_widget *dummy)

Modified: trunk/libs3d/TODO
===================================================================
--- trunk/libs3d/TODO	2006-06-04 15:33:07 UTC (rev 327)
+++ trunk/libs3d/TODO	2006-06-04 17:57:33 UTC (rev 328)
@@ -1,4 +1,5 @@
 TODO:
+- key repeation
 - texture support for 3ds
 - shmat() return (char *) -1 or NULL?! data_ctos/data_stoc should
   really not be 0x0

Modified: trunk/libs3dw/Makefile.am
===================================================================
--- trunk/libs3dw/Makefile.am	2006-06-04 15:33:07 UTC (rev 327)
+++ trunk/libs3dw/Makefile.am	2006-06-04 17:57:33 UTC (rev 328)
@@ -1,6 +1,6 @@
 lib_LTLIBRARIES=	libs3dw.la
 
-libs3dw_la_SOURCES=	button.c surface.c widget.c style.c event.c animate.c label.c input.c root.c
+libs3dw_la_SOURCES=	button.c surface.c widget.c style.c event.c animate.c label.c input.c root.c arrange.c
 			
 include_HEADERS= 	s3dw.h
 noinst_HEADERS=		s3dw_int.h

Added: trunk/libs3dw/TODO
===================================================================
--- trunk/libs3dw/TODO	2006-06-04 15:33:07 UTC (rev 327)
+++ trunk/libs3dw/TODO	2006-06-04 17:57:33 UTC (rev 328)
@@ -0,0 +1 @@
+- focus colors, focus cycling

Modified: trunk/libs3dw/animate.c
===================================================================
--- trunk/libs3dw/animate.c	2006-06-04 15:33:07 UTC (rev 327)
+++ trunk/libs3dw/animate.c	2006-06-04 17:57:33 UTC (rev 328)
@@ -29,10 +29,10 @@
 /* the animation stack */
 static s3dw_widget *ani_s[MAXANI];
 static int ani_n=0;
-int moveon=1;
+static int animation_on=0;
 
 /* is item f already on stack? */
-int _s3dw_ani_onstack(s3dw_widget *f)
+int s3dw_ani_onstack(s3dw_widget *f)
 {
 	int i;
 	for (i=0;i<ani_n;i++)
@@ -42,21 +42,21 @@
 
 }
 /* add an item on the animation stack */
-void _s3dw_ani_add(s3dw_widget *f)
+void s3dw_ani_add(s3dw_widget *f)
 {
-	if (ani_n<MAXANI)
+	if ((ani_n<MAXANI) && (animation_on))
 	{
-		if (_s3dw_ani_onstack(f))
+		if (s3dw_ani_onstack(f))
 			return;		/* already in list */
 		ani_s[ani_n]=f;
-		_s3dw_ani_iterate(f);
+		s3dw_ani_iterate(f);
 		ani_n++;
 	}
 	else /* no place, finish now */
-		_s3dw_ani_finish(f,-1);
+		s3dw_ani_finish(f,-1);
 }
 /* delete an item from the animation stack */
-void _s3dw_ani_del(int i)
+void s3dw_ani_del(int i)
 {
 	if ((i>=0) && (i<ani_n))
 	{
@@ -68,7 +68,7 @@
 	}
 }
 /* well ... */
-void _s3dw_ani_doit(s3dw_widget *f)
+void s3dw_ani_doit(s3dw_widget *f)
 {
 	s3d_translate(	f->oid, f->ax,f->ay,f->az);
 	s3d_rotate(		f->oid, f->arx,f->ary,f->arz);
@@ -76,17 +76,17 @@
 }
 
 /* finish an animation on the stack, stack index i */
-void _s3dw_ani_finish(s3dw_widget *f, int i)
+void s3dw_ani_finish(s3dw_widget *f, int i)
 {
 	f->ax= f->x;
 	f->ay= f->y;
 	f->az= f->z;
 	f->as= f->s;
-	_s3dw_ani_doit(f);
+	s3dw_ani_doit(f);
 	if (i!=-1)
-		_s3dw_ani_del(i);
+		s3dw_ani_del(i);
 }
-void _s3dw_ani_iterate(s3dw_widget *f)
+void s3dw_ani_iterate(s3dw_widget *f)
 {
 	f->ax=(f->x + f->ax*ZOOMS)/(ZOOMS+1);
 	f->ay=(f->y + f->ay*ZOOMS)/(ZOOMS+1);
@@ -96,7 +96,7 @@
 }
 
 /* checks if f is good enough */
-int _s3dw_ani_check(s3dw_widget *f)
+int s3dw_ani_check(s3dw_widget *f)
 {
 	float x,y,z;
 	x=f->ax - f->x;
@@ -111,16 +111,17 @@
 {
 	int i;
 	s3dw_widget *f;
+	animation_on=1;			/* animation is activated */
 	for (i=0;i<ani_n;i++)
 	{
 		f=ani_s[i];
-		_s3dw_ani_iterate(f);
-		if (_s3dw_ani_check(f))
+		s3dw_ani_iterate(f);
+		if (s3dw_ani_check(f))
 		{
-			_s3dw_ani_finish(f,i);
+			s3dw_ani_finish(f,i);
 			i--; /* a new widget is here now, take care in the next iteration */
 		} else {
-			_s3dw_ani_doit(f);
+			s3dw_ani_doit(f);
 		}
 	}
 }

Modified: trunk/libs3dw/button.c
===================================================================
--- trunk/libs3dw/button.c	2006-06-04 15:33:07 UTC (rev 327)
+++ trunk/libs3dw/button.c	2006-06-04 17:57:33 UTC (rev 328)
@@ -119,7 +119,7 @@
 	free(button);
 }
 /* handle key events */
-int s3dw_button_event_key(s3dw_widget *widget, unsigned short oid)
+int s3dw_button_event_key(s3dw_widget *widget, struct s3d_key_event *keys)
 {
 	return(0);
 }

Modified: trunk/libs3dw/event.c
===================================================================
--- trunk/libs3dw/event.c	2006-06-04 15:33:07 UTC (rev 327)
+++ trunk/libs3dw/event.c	2006-06-04 17:57:33 UTC (rev 328)
@@ -33,6 +33,6 @@
 }
 void s3dw_handle_key(struct s3d_evt *evt)
 {
-	unsigned short key=*((unsigned short *)evt->buf);
-	s3dw_widget_event_key(s3dw_getroot(),key);
+	struct s3d_key_event *keys=(struct s3d_key_event *)evt->buf;
+	s3dw_widget_event_key(s3dw_getroot(),keys);
 }

Modified: trunk/libs3dw/input.c
===================================================================
--- trunk/libs3dw/input.c	2006-06-04 15:33:07 UTC (rev 327)
+++ trunk/libs3dw/input.c	2006-06-04 17:57:33 UTC (rev 328)
@@ -166,34 +166,39 @@
 	input->oid_text=oid_text;
 }
 /* handle key events */
-int s3dw_input_event_key(s3dw_widget *widget, unsigned short key)
+int s3dw_input_event_key(s3dw_widget *widget, struct s3d_key_event *keys)
 {
 	s3dw_input *input=(s3dw_input *)widget;
 	char *newtext;
+	char key=keys->unicode; /* unicode support so far ... :/ */
 	int len;
 	dprintf(MED,"edit field got key %d!!",key);
-	if (isprint(key))
+	switch (keys->keysym)
 	{
-		len=strlen(input->text);
-		newtext=malloc(len + 2); /* +1 for the terminating byte, +1 for the new character */
-		strcpy(newtext,input->text);
-		newtext[len]=key;
-		newtext[len+1]=0;
-		s3dw_input_change_text(input,newtext);
-		free(newtext);
-		return(1);
-	} 
-	if (key==S3DK_BACKSPACE)
-	{
-		len=strlen(input->text);
-		if ((len=strlen(input->text))>0)
-		{
-			newtext=malloc(len + 0); /* +1 for the terminating byte, -1 for the deleted character */
-			strncpy(newtext,input->text,len);
-			newtext[len-1]=0;
-			s3dw_input_change_text(input,newtext);
-			free(newtext);
-		}
+		case S3DK_BACKSPACE:
+			len=strlen(input->text);
+			if ((len=strlen(input->text))>0)
+			{
+				newtext=malloc(len + 0); /* +1 for the terminating byte, -1 for the deleted character */
+				strncpy(newtext,input->text,len);
+				newtext[len-1]=0;
+				s3dw_input_change_text(input,newtext);
+				free(newtext);
+				return(1);
+			}
+			break;
+		default:
+			if (isprint(key))
+			{
+				len=strlen(input->text);
+				newtext=malloc(len + 2); /* +1 for the terminating byte, +1 for the new character */
+				strcpy(newtext,input->text);
+				newtext[len]=key;
+				newtext[len+1]=0;
+				s3dw_input_change_text(input,newtext);
+				free(newtext);
+				return(1);
+			} 
 	}
 	
 	return(0);

Modified: trunk/libs3dw/label.c
===================================================================
--- trunk/libs3dw/label.c	2006-06-04 15:33:07 UTC (rev 327)
+++ trunk/libs3dw/label.c	2006-06-04 17:57:33 UTC (rev 328)
@@ -80,7 +80,7 @@
 	free(label);
 }
 /* handle key events */
-int s3dw_label_event_key(s3dw_widget *widget, unsigned short oid)
+int s3dw_label_event_key(s3dw_widget *widget, struct s3d_key_event *keys)
 {
 	return(0);
 }

Modified: trunk/libs3dw/root.c
===================================================================
--- trunk/libs3dw/root.c	2006-06-04 15:33:07 UTC (rev 327)
+++ trunk/libs3dw/root.c	2006-06-04 17:57:33 UTC (rev 328)
@@ -42,7 +42,7 @@
 	return(0);
 }
 /* dummy handler */
-int s3dw_root_event_key(s3dw_widget *widget,unsigned short key)
+int s3dw_root_event_key(s3dw_widget *widget,struct s3d_key_event *keys)
 {
 	return(0);
 }

Modified: trunk/libs3dw/s3dw.h
===================================================================
--- trunk/libs3dw/s3dw.h	2006-06-04 15:33:07 UTC (rev 327)
+++ trunk/libs3dw/s3dw.h	2006-06-04 17:57:33 UTC (rev 328)
@@ -30,6 +30,8 @@
 #define 	S3DW_ACTIVE		2
 /* tells us if the widget is currently displayed */
 #define		S3DW_ONSCREEN	256
+/* if the surface (or widget) is already properly arranged */
+#define 	S3DW_ARRANGED	512
 /* just a typecaster to beatify code. use it if you like */
 #define 	S3DWIDGET(x)	(s3dw_widget *)x
 

Modified: trunk/libs3dw/s3dw_int.h
===================================================================
--- trunk/libs3dw/s3dw_int.h	2006-06-04 15:33:07 UTC (rev 327)
+++ trunk/libs3dw/s3dw_int.h	2006-06-04 17:57:33 UTC (rev 328)
@@ -22,11 +22,11 @@
  */
 
 #include <s3dlib.h> /* dprintf() */
-#define MAXANI		16
+#define MAXANI		128
 #define ZOOMS		5
 /* constructor and handler callbacks */
 typedef int (*s3dw_click_callback)(s3dw_widget *, unsigned long);
-typedef int (*s3dw_key_callback)(  s3dw_widget *, unsigned short);
+typedef int (*s3dw_key_callback)(  s3dw_widget *, struct s3d_key_event *);
 s3dw_callback 		s3dwcb_show[S3DW_NTYPES];
 s3dw_callback 		s3dwcb_hide[S3DW_NTYPES];
 s3dw_callback 		s3dwcb_destroy[S3DW_NTYPES];
@@ -38,13 +38,13 @@
 void s3dw_nothing(s3dw_widget *widget);
 void s3dw_root_destroy(s3dw_widget *widget);
 int s3dw_root_event_click(s3dw_widget *widget, unsigned long oid);
-int s3dw_root_event_key(s3dw_widget *widget, unsigned short key);
+int s3dw_root_event_key(s3dw_widget *widget, struct s3d_key_event *keys);
 /* widget.c */
 s3dw_widget *s3dw_widget_new();
 void s3dw_widget_append(s3dw_widget *parent, s3dw_widget *widget);
 void s3dw_widget_visible(s3dw_widget *widget);
 int s3dw_widget_event_click(s3dw_widget *widget, unsigned long oid);
-int s3dw_widget_event_key(s3dw_widget *widget, unsigned short key);
+int s3dw_widget_event_key(s3dw_widget *widget, struct s3d_key_event *keys);
 /* surface.c */
 void s3dw_surface_destroy(s3dw_widget *widget);
 void s3dw_surface_draw(s3dw_widget *widget);
@@ -52,15 +52,15 @@
 void s3dw_surface_show(s3dw_widget *widget);
 void s3dw_surface_hide(s3dw_widget *widget);
 int s3dw_surface_event_click(s3dw_widget *widget, unsigned long oid);
-int s3dw_surface_event_key(s3dw_widget *widget, unsigned short key);
+int s3dw_surface_event_key(s3dw_widget *widget, struct s3d_key_event *keys);
 /* button.c */
 void s3dw_button_destroy(s3dw_widget *widget);
 void s3dw_button_draw(s3dw_widget *widget);
 void s3dw_button_erase(s3dw_widget *widget);
 void s3dw_button_show(s3dw_widget *widget);
 void s3dw_button_hide(s3dw_widget *widget);
-int s3dw_button_event_key(s3dw_widget *widget, unsigned short key);
 int s3dw_button_event_click(s3dw_widget *widget, unsigned long oid);
+int s3dw_button_event_key(s3dw_widget *widget, struct s3d_key_event *keys);
 
 /* label.c */
 void s3dw_label_destroy(s3dw_widget *widget);
@@ -69,7 +69,7 @@
 void s3dw_label_show(s3dw_widget *widget);
 void s3dw_label_hide(s3dw_widget *widget);
 int s3dw_label_event_click(s3dw_widget *widget, unsigned long oid);
-int s3dw_label_event_key(s3dw_widget *widget, unsigned short key);
+int s3dw_label_event_key(s3dw_widget *widget, struct s3d_key_event *keys);
 
 /* input.c */
 void s3dw_input_destroy(s3dw_widget *widget);
@@ -79,15 +79,19 @@
 void s3dw_input_hide(s3dw_widget *widget);
 unsigned long s3dw_input_draw_string(s3dw_widget *widget);
 int s3dw_input_event_click(s3dw_widget *widget, unsigned long oid);
-int s3dw_input_event_key(s3dw_widget *widget, unsigned short key);
+int s3dw_input_event_key(s3dw_widget *widget, struct s3d_key_event *keys);
 
 /* style.c */
 extern s3dw_style def_style;
 /* animate.c */
-int  _s3dw_ani_onstack(s3dw_widget *f);
-void _s3dw_ani_add(s3dw_widget *f);
-void _s3dw_ani_del(int i);
-void _s3dw_ani_doit(s3dw_widget *f);
-void _s3dw_ani_finish(s3dw_widget *f, int i);
-void _s3dw_ani_iterate(s3dw_widget *f);
-int  _s3dw_ani_check(s3dw_widget *f);
+int  s3dw_ani_onstack(s3dw_widget *f);
+void s3dw_ani_add(s3dw_widget *f);
+void s3dw_ani_del(int i);
+void s3dw_ani_doit(s3dw_widget *f);
+void s3dw_ani_finish(s3dw_widget *f, int i);
+void s3dw_ani_iterate(s3dw_widget *f);
+int  s3dw_ani_check(s3dw_widget *f);
+/* arrange.c */
+void s3dw_arrange();
+void s3dw_arr_widgetcenter(s3dw_widget *widget, float *center);
+void s3dw_arr_normdir(float *dir);

Modified: trunk/libs3dw/surface.c
===================================================================
--- trunk/libs3dw/surface.c	2006-06-04 15:33:07 UTC (rev 327)
+++ trunk/libs3dw/surface.c	2006-06-04 17:57:33 UTC (rev 328)
@@ -130,6 +130,7 @@
 {
 	s3dw_surface *surface;
 	s3dw_widget  *widget;
+	float f1[3];
 			
 	surface=(s3dw_surface *)malloc(sizeof(s3dw_surface));
 	surface->title=strdup(title);
@@ -137,8 +138,15 @@
 	widget->type=S3DW_TSURFACE;
 	widget->width=width;
 	widget->height=height;
+	widget->as=0.01;
+	s3dw_arr_widgetcenter(widget,f1);
+	widget->x=-f1[0];
+	widget->y=-f1[1];
+	widget->z=-f1[2];
 	s3dw_widget_append(s3dw_getroot(),widget);
 	s3dw_surface_draw(widget);
+	s3dw_arrange();
+	s3dw_ani_add(widget);
 	return(surface);
 }
 /* delete objects in the s3d context */
@@ -158,7 +166,7 @@
 	free(surface);
 }
 /* handle key events */
-int s3dw_surface_event_key(s3dw_widget *widget, unsigned short oid)
+int s3dw_surface_event_key(s3dw_widget *widget, struct s3d_key_event *keys)
 {
 	return(0);
 }

Modified: trunk/libs3dw/widget.c
===================================================================
--- trunk/libs3dw/widget.c	2006-06-04 15:33:07 UTC (rev 327)
+++ trunk/libs3dw/widget.c	2006-06-04 17:57:33 UTC (rev 328)
@@ -56,11 +56,11 @@
 	return(0);
 }
 /* widget received key,,call specific function and check (focused) kids */
-int s3dw_widget_event_key(s3dw_widget *widget, unsigned short key)
+int s3dw_widget_event_key(s3dw_widget *widget, struct s3d_key_event *keys)
 {
-	if (s3dwcb_key[widget->type](widget,key)) return(1);
+	if (s3dwcb_key[widget->type](widget,keys)) return(1);
 	if (widget->focus!=-1)
-		if (s3dw_widget_event_key(widget->pobj[widget->focus],key)) return(1);
+		if (s3dw_widget_event_key(widget->pobj[widget->focus],keys)) return(1);
 	return(0);
 }
 



From dotslash at berlios.de  Sun Jun  4 20:55:55 2006
From: dotslash at berlios.de (dotslash at BerliOS)
Date: Sun, 4 Jun 2006 20:55:55 +0200
Subject: [S3d-svn] r329 - in trunk: . libs3dw
Message-ID: <200606041855.k54IttTc002512@sheep.berlios.de>

Author: dotslash
Date: 2006-06-04 20:55:53 +0200 (Sun, 04 Jun 2006)
New Revision: 329

Added:
   trunk/libs3dw/arrange.c
Modified:
   trunk/
Log:
 r699 at balthasar:  dotslash | 2006-06-04 20:54:59 +0200
 - forgot to version arrange.c



Property changes on: trunk
___________________________________________________________________
Name: svk:merge
   - bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:697
   + bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:699

Added: trunk/libs3dw/arrange.c
===================================================================
--- trunk/libs3dw/arrange.c	2006-06-04 17:57:33 UTC (rev 328)
+++ trunk/libs3dw/arrange.c	2006-06-04 18:55:53 UTC (rev 329)
@@ -0,0 +1,109 @@
+/*
+ * arrange.c
+ *
+ * Copyright (C) 2006 Simon Wunderlich <dotslash at packetmixer.de>
+ *
+ * This file is part of the s3d Widgets, a Widget Library for s3d.
+ * See http://s3d.berlios.de/ for more updates.
+ * 
+ * s3d Widgets is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU Lesser General Public License as published by
+ * the Free Software Foundation; either version 2.1 of the License, or
+ * (at your option) any later version.
+ * 
+ * s3d Widgets is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU Lesser General Public License for more details.
+ * 
+ * You should have received a copy of the GNU Lesser General Public License
+ * along with the s3d Widgets; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
+ */
+
+#include <s3d.h>
+#include <s3dw.h>
+#include <s3dw_int.h>
+#include <stdlib.h> /* rand(), RAND_MAX */
+
+void s3dw_arr_widgetcenter(s3dw_widget *widget, float *center)
+{
+	center[0]=widget->width/2;
+	center[1]=-widget->height/2+0.5;
+	center[2]=0.5;
+	
+}
+void s3dw_arr_normdir(float *dir)
+{
+	float dirlen=s3d_vector_length(dir);
+	while ((dirlen=s3d_vector_length(dir))==0)
+	{
+		/* make up some random direction if they're exactly the same position */
+		dir[0]=((float)rand() - RAND_MAX/2.0)/RAND_MAX;
+		dir[1]=((float)rand() - RAND_MAX/2.0)/RAND_MAX;
+		dir[2]=((float)rand() - RAND_MAX/2.0)/RAND_MAX;
+	}
+	dir[0]/=dirlen;
+	dir[1]/=dirlen;
+	dir[2]/=dirlen;
+}
+void s3dw_arrange()
+{
+	s3dw_widget *w1,*w2,*root=s3dw_getroot();
+	int i,j,arranged;
+	float len1,len2, dirlen;
+	float tomove, move1, move2;
+	float f1[3],f2[3],dir[3];
+
+	/* test if there is anything to arrange ... */
+	arranged=1;
+	for (i=0;i<root->nobj;i++)
+		if (!(root->pobj[i]->flags&S3DW_ARRANGED)) arranged=0;
+	if (arranged) return; /* no arrangement necceasary .... */
+
+	if (root->nobj==1)
+	{
+		w1=root->pobj[0];
+		w1->flags|=S3DW_ARRANGED; /* done */
+	}
+	for (i=0;i<root->nobj;i++)
+	{
+		w1=root->pobj[i];
+		arranged=1;
+		for (j=0;j<root->nobj;j++)
+			if (i!=j)
+			{
+				w2=root->pobj[j];
+				s3dw_arr_widgetcenter(w1,f1);
+				s3dw_arr_widgetcenter(w2,f2);
+				len1=s3d_vector_length(f1);
+				len2=s3d_vector_length(f2);
+				dir[0]=(w1->x+f1[0]) - (w2->x+f2[0]);
+				dir[1]=(w1->y+f1[1]) - (w2->y+f2[1]);
+				dir[2]=(w1->z+f1[2]) - (w2->z+f2[2]);
+				dirlen=s3d_vector_length(dir);
+				if (dirlen<(len1+len2))
+				{
+					arranged=0;
+					w1->flags&=~S3DW_ARRANGED;
+					w2->flags&=~S3DW_ARRANGED;
+					/* it's not arranged, turn the flags off! */
+					s3dw_arr_normdir(dir);
+					tomove=((len1+len2+1)-dirlen);
+					move1=len1/(len1+len2);
+					move2=len2/(len1+len2);
+					w1->x += tomove * move1 *  dir[0];
+					w1->y += tomove * move1 *  dir[1];
+					w1->z += tomove * move1 *  dir[2];
+					w2->x += tomove * move2 * -dir[0];
+					w2->y += tomove * move2 * -dir[1];
+					w2->z += tomove * move2 * -dir[2];
+
+					s3dw_ani_add(w1);
+					s3dw_ani_add(w2);
+				}
+			}
+		if (arranged)
+			w1->flags|=S3DW_ARRANGED;
+	}
+}



From dotslash at berlios.de  Sun Jun  4 22:27:37 2006
From: dotslash at berlios.de (dotslash at BerliOS)
Date: Sun, 4 Jun 2006 22:27:37 +0200
Subject: [S3d-svn] r330 - in trunk: . libs3d libs3dw server
Message-ID: <200606042027.k54KRbjs018143@sheep.berlios.de>

Author: dotslash
Date: 2006-06-04 22:27:36 +0200 (Sun, 04 Jun 2006)
New Revision: 330

Modified:
   trunk/
   trunk/libs3d/3dsread.c
   trunk/libs3d/error.c
   trunk/libs3d/freetype.c
   trunk/libs3d/io.c
   trunk/libs3d/object_queue.c
   trunk/libs3d/proto_in.c
   trunk/libs3d/proto_out.c
   trunk/libs3d/s3dlib.h
   trunk/libs3d/shm.c
   trunk/libs3d/shm_ringbuf.c
   trunk/libs3d/tcp.c
   trunk/libs3dw/animate.c
   trunk/libs3dw/input.c
   trunk/libs3dw/s3dw_int.h
   trunk/libs3dw/surface.c
   trunk/server/config.h
   trunk/server/cull.c
   trunk/server/error.c
   trunk/server/event.c
   trunk/server/global.h
   trunk/server/graphics.c
   trunk/server/graphics_glut.c
   trunk/server/graphics_sdl.c
   trunk/server/main.c
   trunk/server/matrix.c
   trunk/server/mcp.c
   trunk/server/object.c
   trunk/server/process.c
   trunk/server/proto.c
   trunk/server/shm.c
   trunk/server/tcp.c
   trunk/server/user.c
   trunk/server/user_glut.c
   trunk/server/user_sdl.c
Log:
 r701 at balthasar:  dotslash | 2006-06-04 22:27:31 +0200
 - dprintf -> s3dprintf, dprintf conflicts with glibc ... :(



Property changes on: trunk
___________________________________________________________________
Name: svk:merge
   - bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:699
   + bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:701

Modified: trunk/libs3d/3dsread.c
===================================================================
--- trunk/libs3d/3dsread.c	2006-06-04 18:55:53 UTC (rev 329)
+++ trunk/libs3d/3dsread.c	2006-06-04 20:27:36 UTC (rev 330)
@@ -85,7 +85,7 @@
 		r[1]=n[1]/len;
 		r[2]=n[2]/len;
 	} else {
-		dprintf(VLOW,"normal(): couldn't calc normal");
+		s3dprintf(VLOW,"normal(): couldn't calc normal");
 		r[0]=r[1]=r[2]=0.0F;
 	}
 }
@@ -223,7 +223,7 @@
 				return(NULL);
 			}
 		}
-		 /* dprintf(LOW,"polygon [%d/%d]: %d %d %d is in smoothlist %d",i,polynum,v[0],v[1],v[2],g); */
+		 /* s3dprintf(LOW,"polygon [%d/%d]: %d %d %d is in smoothlist %d",i,polynum,v[0],v[1],v[2],g); */
 		
 		normal(	vertex_buf+v[0]*3,
 				vertex_buf+v[1]*3,
@@ -235,12 +235,12 @@
 
 
 
-	 /* dprintf(MED,"processing the final group ... %d (%d members)",g,n); */
+	 /* s3dprintf(MED,"processing the final group ... %d (%d members)",g,n); */
 	smooth(vertex_buf,voff,poly_buf+(i-n)*4,pnormal_list+(i-n)*3, nbuf+(i-n)*9,v_t_buf,n,g);
 /*	for (i=0;i<polynum;i++)
 	{
 		for (j=0;j<3;j++)
-			dprintf(MED,"poly[%d/%d],point[%d/3]: %f %f %f",i,polynum,j,
+			s3dprintf(MED,"poly[%d/%d],point[%d/3]: %f %f %f",i,polynum,j,
 							nbuf[i*9+j*3],
 							nbuf[i*9+j*3+1],
 							nbuf[i*9+j*3+2]);
@@ -295,7 +295,7 @@
 		cid=gints(ptr);
 		clen=gintl(ptr+2);
 		
-		dprintf (VLOW,"[pos %x]: \t%04x [len:%d]",(ptr-buf),cid,(clen-6));
+		s3dprintf (VLOW,"[pos %x]: \t%04x [len:%d]",(ptr-buf),cid,(clen-6));
 		if ((ptr==buf) && (cid!=0x4d4d))
 		{
 			errs("3d_import_3ds()","file doesn't start with 0x4d4d, maybe file corrupt?");
@@ -305,7 +305,7 @@
 		switch (cid)
 		{
 		  case 0x4d4d: 
-			  dprintf(VLOW,"-- the main chunk!!");
+			  s3dprintf(VLOW,"-- the main chunk!!");
 			  filesize=clen;
 			  if (cur_oid==-1)
 			  {
@@ -317,24 +317,24 @@
 
            	  break;
 		  case 0x3D3D:
-			  dprintf(VLOW,"-- the 3d editor chunk!");
+			  s3dprintf(VLOW,"-- the 3d editor chunk!");
 			  break;
 		  case 0x4000:
-			  dprintf(VLOW,"-- an object block. let's see ...");
+			  s3dprintf(VLOW,"-- an object block. let's see ...");
 			  strncpy((char *)ostr,(char *)ptr,MAXSTRN);
 			  vertex_offset+=v;
 			  v=0;
 			  ptr=(ptr+strlen(ostr)+1);
 			  break;
 		  case 0x4100:
-			  dprintf(VLOW,"-- Triangular mesh");
+			  s3dprintf(VLOW,"-- Triangular mesh");
 			  smooth_list=NULL;
 			  mesh_end=ptr+(clen-6);
 			  break;
 		  case 0x4110: 
 			  vertexnum=gints(ptr);
 			  ptr+=sizeof(unsigned short);
-			  dprintf(VLOW,"-- vertices list!! number of vertices: %d",vertexnum);
+			  s3dprintf(VLOW,"-- vertices list!! number of vertices: %d",vertexnum);
 			  vertex_buf=malloc(sizeof(float)*3*vertexnum);
 			  if (vertex_buf==NULL) break;
 /* 			  memcpy(vertex_buf,ptr,sizeof(float)*3*i); */
@@ -350,7 +350,7 @@
 		  case 0x4120:
 			polynum=gints(ptr);
 			ptr+=sizeof(unsigned short);
-			dprintf(VLOW,"-- polygon list!! number of polygons: %d",polynum);
+			s3dprintf(VLOW,"-- polygon list!! number of polygons: %d",polynum);
 			poly_buf=malloc(sizeof(unsigned long)*4*polynum);
 			if (poly_buf==NULL) break;
 		    for (j=0; j<polynum; j++)
@@ -364,10 +364,10 @@
 			break;
 		  case 0x4130:
 			ptr2=(char *)ptr+(clen-6);  /*  backup our endpointer ... */
-			dprintf(VLOW,"-- material information for faces .....");
+			s3dprintf(VLOW,"-- material information for faces .....");
 			strncpy((char *)ostr,(char *)ptr,MAXSTRN);
 			ptr+=strlen(ptr)+1;
-			dprintf(VLOW,".. material string name is %s",ostr);
+			s3dprintf(VLOW,".. material string name is %s",ostr);
 			col_obj=0;
 			while (col_obj<256 && (strncmp(ostr,materials[col_obj],MAXSTRN)!=0)) col_obj++;
 			if (col_obj>=256)
@@ -389,7 +389,7 @@
 			ptr=ptr2;
 			break;
 		  case 0x4150:
-			dprintf(VLOW,"-- smoothing group information (length %d [%d])", clen,clen/4);
+			s3dprintf(VLOW,"-- smoothing group information (length %d [%d])", clen,clen/4);
 			smooth_list=(unsigned long *)ptr;
 			for (j=0;j<(clen/4);j++)
 			{
@@ -399,10 +399,10 @@
 			ptr=(char *)ptr+(clen-6);
 			break;
 		  case 0x4160:
-			  dprintf(VLOW,"-- translation matrix");
+			  s3dprintf(VLOW,"-- translation matrix");
 			  for (j=0; j<4; j++)
 		 	  {
-				dprintf(VLOW,"[%f:%f:%f:%f]",
+				s3dprintf(VLOW,"[%f:%f:%f:%f]",
 								*((float *)ptr),
 								*((float *)ptr+1),
 								*((float *)ptr+2),
@@ -412,11 +412,11 @@
 			  }
 			  break;
 		  case 0xafff:
-			  dprintf(VLOW,"-- material chunk O_o");
+			  s3dprintf(VLOW,"-- material chunk O_o");
 			  break;
 		  case 0xa000:
 			  strncpy((char *)ostr,(char *)ptr,MAXSTRN);
-			  dprintf(VLOW,"-- material string name is %s",ostr);
+			  s3dprintf(VLOW,"-- material string name is %s",ostr);
 			  ptr=(char *)ptr+(clen-6);
 			  color|=8;
 			  break;
@@ -430,7 +430,7 @@
 			  r3=(unsigned char)*(ptr+6);
 			  g3=(unsigned char)*(ptr+7);
 			  b3=(unsigned char)*(ptr+8);
-			  dprintf(VLOW,"-- ambient color 3:>> [rgb] [%x %x %x]",r3,g3,b3);
+			  s3dprintf(VLOW,"-- ambient color 3:>> [rgb] [%x %x %x]",r3,g3,b3);
 			  r_amb=r3;g_amb=g3;b_amb=b3;
 			  color=color|1;
 			  ptr=(char *)ptr+(clen-6);
@@ -445,7 +445,7 @@
 			  r3=(unsigned char)*(ptr+6);
 			  g3=(unsigned char)*(ptr+7);
 			  b3=(unsigned char)*(ptr+8);
-			  dprintf(VLOW,"-- diffuse color 3:>> [rgb] [%x %x %x]",r3,g3,b3);
+			  s3dprintf(VLOW,"-- diffuse color 3:>> [rgb] [%x %x %x]",r3,g3,b3);
 			  r_diff=r3;g_diff=g3;b_diff=b3;
 			  color=color|2;
 			  ptr=(char *)ptr+(clen-6);
@@ -460,7 +460,7 @@
 			  r3=(unsigned char)*(ptr+6);
 			  g3=(unsigned char)*(ptr+7);
 			  b3=(unsigned char)*(ptr+8);
-			  dprintf(VLOW,"-- spec color 3:>> [rgb] [%x %x %x]",r3,g3,b3);
+			  s3dprintf(VLOW,"-- spec color 3:>> [rgb] [%x %x %x]",r3,g3,b3);
 			  r_spec=r3;g_spec=g3;b_spec=b3;
 			  color=color|4;
 			  ptr=(char *)ptr+(clen-6);
@@ -477,10 +477,10 @@
 							  /*  that's just because i'm lazy */
 			{
 				strncpy(materials[col_obj],ostr,MAXSTRN);
-				dprintf(VLOW,"assigned material %s on position %d",
+				s3dprintf(VLOW,"assigned material %s on position %d",
 								materials[col_obj],col_obj);
 			}
-			dprintf(VLOW,"-- [%d]colors... amb: %d %d %d, spec %d %d %d, diff %d %d %d",col_obj,
+			s3dprintf(VLOW,"-- [%d]colors... amb: %d %d %d, spec %d %d %d, diff %d %d %d",col_obj,
 							r_amb,g_amb,b_amb,
 							r_spec,g_spec,b_spec,
 							r_diff,g_diff,b_diff
@@ -503,7 +503,7 @@
 					nbuf=calc_normals(vertex_buf,vertexnum,poly_buf,polynum,vertex_offset,smooth_list);
 
 				 /*  do in 1000 chunks */
-				dprintf(LOW,"committing %d polys",polynum);
+				s3dprintf(LOW,"committing %d polys",polynum);
 				tnbuf=nbuf;
 				tpbuf=poly_buf;
 #define CSIZE	1000
@@ -541,7 +541,7 @@
 			}
 		}
 	}
-	dprintf(VLOW,"-- done [ptr:%010p,buf:%010p]...",ptr,buf);
+	s3dprintf(VLOW,"-- done [ptr:%010p,buf:%010p]...",ptr,buf);
 	free(buf);
 	return(cur_oid);
 }

Modified: trunk/libs3d/error.c
===================================================================
--- trunk/libs3d/error.c	2006-06-04 18:55:53 UTC (rev 329)
+++ trunk/libs3d/error.c	2006-06-04 20:27:36 UTC (rev 330)
@@ -27,9 +27,9 @@
 #include <stdarg.h>		 /*  va_list */
 #include <stdio.h> 		 /*  perror(),fprintf() */
 #include <string.h> 	 /*  sterror */
-/*  dprintf is only for internal use. */
+/*  s3dprintf is only for internal use. */
 #ifdef DEBUG
-void dprintf(int relevance, const char *fmt, ...) {
+void s3dprintf(int relevance, const char *fmt, ...) {
 	char dbm[DBM_MAX];
 	va_list args;
 	if (relevance >= DEBUG )

Modified: trunk/libs3d/freetype.c
===================================================================
--- trunk/libs3d/freetype.c	2006-06-04 18:55:53 UTC (rev 329)
+++ trunk/libs3d/freetype.c	2006-06-04 20:27:36 UTC (rev 330)
@@ -133,7 +133,7 @@
 		errds(VHIGH,"s3d_add_tessbuf():FT_Load_Char()","can't load character");
 		return(-1);
 	} 
-	dprintf(VLOW,"[T]riangulating character %c",a);
+	s3dprintf(VLOW,"[T]riangulating character %c",a);
 	norm=1.0/face->glyph->metrics.vertAdvance;
 	ch=a;
 	v_off=0;
@@ -167,7 +167,7 @@
 				i++;
 			}
 			ar=0.5f*norm*norm*ar;
-			dprintf(VLOW,"contour %d has area of %3.3f, cntr is %d, contour starts at %d, ncon %d",c,ar,cntr[c], csta[c], ncon);
+			s3dprintf(VLOW,"contour %d has area of %3.3f, cntr is %d, contour starts at %d, ncon %d",c,ar,cntr[c], csta[c], ncon);
 			area[c]=ar; /* save the area */
 		}
 		/* now as we have the areas and sizes of the contours, we need to order our contours so that 
@@ -187,7 +187,7 @@
 				}
 			if (outl==-1)
 			{
-				dprintf(HIGH,"hole without outline found, exiting ... %c",a);
+				s3dprintf(HIGH,"hole without outline found, exiting ... %c",a);
 				return(-1);
 			}
 			for (i=0;i<n;i++)
@@ -211,7 +211,7 @@
 					if (fabsf(ar)>1)						/* if ar = 0.0, it's outside, elseway it's a multiple of pi. this check should be
 															 * very generous to roundoff errors */
 					{
-						dprintf(VLOW,"hole %d (%d) in %d (%d): interior angle sum %f (n=%d)",i,perm[i],outl, perm[outl],ar,n);
+						s3dprintf(VLOW,"hole %d (%d) in %d (%d): interior angle sum %f (n=%d)",i,perm[i],outl, perm[outl],ar,n);
 						j=perm[n-1];	/* swap our hole to the end */
 						perm[n-1]=perm[i];
 						perm[i]=j;
@@ -253,7 +253,7 @@
 			n++;				 /* count out and inlines ... */
 			if (area[perm[c]]>0) /* outline? start! */
 			{
-				dprintf(VLOW,"[T]riangulation from outline %d (%d contours, area = %f)",perm[c],n,area[perm[c]]);
+				s3dprintf(VLOW,"[T]riangulation from outline %d (%d contours, area = %f)",perm[c],n,area[perm[c]]);
 				np=sei_triangulate_polygon(n, ncntr+c, nvertices+(ncsta[c]), triangles);
 				for (i=0;i<np;i++)
 				{
@@ -284,11 +284,11 @@
 	memcpy(vbuf,tess_buf[a].vbuf,sizeof(float)*3*tess_buf[a].vn);
 	memcpy(pbuf,tess_buf[a].pbuf,sizeof(unsigned long)*4*tess_buf[a].pn);
 	 /*  prepare the buffs ... */
-/* 	dprintf(LOW,"drawing [%c] (%d vertices, %d polys",a,tess_buf[a].vn,tess_buf[a].pn); */
+/* 	s3dprintf(LOW,"drawing [%c] (%d vertices, %d polys",a,tess_buf[a].vn,tess_buf[a].pn); */
 	for (i=0;i<tess_buf[a].vn;i++)
 	{
 		vbuf[i*3]+=*xoff;
-/*		dprintf(LOW,"vertex [%c:%d] %f %f %f",a,i,
+/*		s3dprintf(LOW,"vertex [%c:%d] %f %f %f",a,i,
 						vbuf[i*3],
 						vbuf[i*3+1],
 						vbuf[i*3+2]);*/
@@ -298,13 +298,13 @@
 		pbuf[i*4]+=*voff;
 		pbuf[i*4+1]+=*voff;
 		pbuf[i*4+2]+=*voff;
-/*		dprintf(LOW,"poly [%c:%d] %d %d %d | %d (voff %d)",a,i,
+/*		s3dprintf(LOW,"poly [%c:%d] %d %d %d | %d (voff %d)",a,i,
 						pbuf[i*4],
 						pbuf[i*4+1],
 						pbuf[i*4+2],
 						pbuf[i*4+3],*voff);*/
 	}
-	dprintf(VLOW,"commiting %d vertices, %d polygons",tess_buf[a].vn,tess_buf[a].pn);
+	s3dprintf(VLOW,"commiting %d vertices, %d polygons",tess_buf[a].vn,tess_buf[a].pn);
 	s3d_push_vertices(oid,vbuf,tess_buf[a].vn);
 	s3d_push_polygons(oid,pbuf,tess_buf[a].pn);
 	*xoff+=tess_buf[a].xoff;  /*  xoffset */

Modified: trunk/libs3d/io.c
===================================================================
--- trunk/libs3d/io.c	2006-06-04 18:55:53 UTC (rev 329)
+++ trunk/libs3d/io.c	2006-06-04 20:27:36 UTC (rev 330)
@@ -90,7 +90,7 @@
 				if (optarg)
 				{
 					url=optarg;
-					dprintf(HIGH,"connecting to %s",url);
+					s3dprintf(HIGH,"connecting to %s",url);
 				}
 			}
 			break;
@@ -130,7 +130,7 @@
 */
 	if (NULL!=(s=getenv("S3D")))
 	{
-		dprintf(VLOW,"at least we have the enviroment variable ... %s",s);
+		s3dprintf(VLOW,"at least we have the enviroment variable ... %s",s);
 		url=s;
 	}
 	parse_args(argc,argv);
@@ -226,7 +226,7 @@
 	if (fstat(fileno(fp),&bf))
 	{ errdn(VLOW,"s3d_open_file():fstat()",errno); return(-1);}
 	filesize=bf.st_size;
-	dprintf(VLOW, "opening %s, filesize is %d",fname, filesize);
+	s3dprintf(VLOW, "opening %s, filesize is %d",fname, filesize);
 	if ((buf=malloc(filesize))==NULL)
 	{
 		errn("s3d_open_3ds_file():malloc()",errno);

Modified: trunk/libs3d/object_queue.c
===================================================================
--- trunk/libs3d/object_queue.c	2006-06-04 18:55:53 UTC (rev 329)
+++ trunk/libs3d/object_queue.c	2006-06-04 20:27:36 UTC (rev 330)
@@ -65,17 +65,17 @@
 int _queue_new_object(unsigned int oid)
 {
 	int i;
-/* 	dprintf(LOW,"having a new object (%d) in the queue!!",oid); */
+/* 	s3dprintf(LOW,"having a new object (%d) in the queue!!",oid); */
 	for (i=0;i<queue_size;i++)
 		if (queue[i]==Q_UNUSED)
 		{
-/* 			dprintf(LOW,"placing it at position %d",i); */
+/* 			s3dprintf(LOW,"placing it at position %d",i); */
 			queue[i]=oid;
 			return(0);
 		}
 	if (queue_size==0) return(-1);  /*  already quit. */
 	 /*  if we reach here, all slots all taken.  */
-/* 	dprintf(LOW,"no place for object, resizing stack.",i); */
+/* 	s3dprintf(LOW,"no place for object, resizing stack.",i); */
 	queue=realloc(queue,sizeof(unsigned int)*(queue_size+1));
 	queue_size+=1;
 	queue[queue_size-1]=oid;

Modified: trunk/libs3d/proto_in.c
===================================================================
--- trunk/libs3d/proto_in.c	2006-06-04 18:55:53 UTC (rev 329)
+++ trunk/libs3d/proto_in.c	2006-06-04 20:27:36 UTC (rev 330)
@@ -39,10 +39,10 @@
 	switch (opcode)
 	{
 		case S3D_P_S_INIT:
-			dprintf(MED,"S3D_P_S_INIT: init!!");
+			s3dprintf(MED,"S3D_P_S_INIT: init!!");
 			break;
 		case S3D_P_S_QUIT:
-			dprintf(MED,"S3D_P_S_QUIT: server wants us to go. well ...");
+			s3dprintf(MED,"S3D_P_S_QUIT: server wants us to go. well ...");
 			s3d_quit();
 			break;	
 		case S3D_P_S_CLICK:
@@ -56,7 +56,7 @@
 					s3devt->length=4;
 					s3devt->buf=buf;
 				}
-				dprintf(MED,"S3D_P_S_CLICK: %d got clicked ....",oid);
+				s3dprintf(MED,"S3D_P_S_CLICK: %d got clicked ....",oid);
 			}
 			break;
 		case S3D_P_S_NEWOBJ:
@@ -70,7 +70,7 @@
 					s3devt->length=4;
 					s3devt->buf=buf;
 				}
-				dprintf(VLOW,"S3D_P_S_NEWOBJ: new object %d",oid);
+				s3dprintf(VLOW,"S3D_P_S_NEWOBJ: new object %d",oid);
 			}
 			break;
 		case S3D_P_S_KEY:
@@ -88,7 +88,7 @@
 					s3devt->buf=buf;
 					s3devt->event=(keyevent->state==0)?S3D_EVENT_KEYDOWN:S3D_EVENT_KEYUP;
 				}
-				dprintf(VLOW,"S3D_P_S_KEY: key %d hit!!",*((uint16_t *)s3devt->buf));
+				s3dprintf(VLOW,"S3D_P_S_KEY: key %d hit!!",*((uint16_t *)s3devt->buf));
 			}
 			break;
 		case S3D_P_S_MBUTTON:
@@ -100,7 +100,7 @@
 					s3devt->length=2;
 					s3devt->buf=buf;
 				}
-				dprintf(VLOW,"S3D_P_S_MBUTTON: mbutton %d, state %d !!",*((uint8_t *)s3devt->buf), *(1+(uint8_t *)s3devt->buf));
+				s3dprintf(VLOW,"S3D_P_S_MBUTTON: mbutton %d, state %d !!",*((uint8_t *)s3devt->buf), *(1+(uint8_t *)s3devt->buf));
 			}
 			break;
 		case S3D_P_MCP_OBJECT:
@@ -118,10 +118,10 @@
 					buf[length-1]='\0';  /*  put a null byte at the end  */
 										 /*  for the not so careful users */
 					s3devt->buf=buf;
-					dprintf(VLOW,"S3D_P_MCP_OBEJCT: something is happening to object %d, name %s", 	mo->object, mo->name);
+					s3dprintf(VLOW,"S3D_P_MCP_OBEJCT: something is happening to object %d, name %s", 	mo->object, mo->name);
 
 				}
-			} else dprintf(MED,"wrong length for S3D_P_MCP_OBJECT length %d != %d",length,sizeof(struct mcp_object));
+			} else s3dprintf(MED,"wrong length for S3D_P_MCP_OBJECT length %d != %d",length,sizeof(struct mcp_object));
 			break;
 		case S3D_P_S_OINFO:
 			if (length==sizeof(struct s3d_obj_info))
@@ -139,13 +139,13 @@
 					buf[length-1]='\0';  /*  put a null byte at the end  */
 										 /*  for the not so careful users */
 					s3devt->buf=buf;
-					dprintf(VLOW,"S3D_P_S_OINFO: something is happening to object %d, name %s", 
+					s3dprintf(VLOW,"S3D_P_S_OINFO: something is happening to object %d, name %s", 
 								oi->object,
 								oi->name
 								);
 
 				}
-			} else dprintf(MED,"wrong length for S3D_P_S_OINFO length %d != %d",length,sizeof(struct s3d_obj_info));
+			} else s3dprintf(MED,"wrong length for S3D_P_S_OINFO length %d != %d",length,sizeof(struct s3d_obj_info));
 			break;
 
 		case S3D_P_MCP_DEL_OBJECT:
@@ -156,13 +156,13 @@
 					s3devt->event=S3D_MCP_DEL_OBJECT;
 					s3devt->length=length;
 					*((uint32_t *)buf)=ntohl(*((uint32_t *)buf));  /*  revert oid */
-					dprintf(MED,"S3D_P_MCP_DEL_OBEJCT: deleting object %d",*((uint32_t *)buf));
+					s3dprintf(MED,"S3D_P_MCP_DEL_OBEJCT: deleting object %d",*((uint32_t *)buf));
 					s3devt->buf=buf;
 				}
 			}
 			break;
 		default:
-			dprintf(MED,"don't know command %d",opcode);
+			s3dprintf(MED,"don't know command %d",opcode);
 			if (buf!=NULL) free(buf);
 	}
 	if (s3devt!=NULL)

Modified: trunk/libs3d/proto_out.c
===================================================================
--- trunk/libs3d/proto_out.c	2006-06-04 18:55:53 UTC (rev 329)
+++ trunk/libs3d/proto_out.c	2006-06-04 20:27:36 UTC (rev 330)
@@ -58,7 +58,7 @@
 	buf[0]=htonl(oid);
 	buf[1]=htonl(toid);
 	net_send(S3D_P_C_CLONE,(char *)&buf,8);
-/* 	dprintf(MED,"... changed clone-target of object %d to %d", oid, toid); */
+/* 	s3dprintf(MED,"... changed clone-target of object %d to %d", oid, toid); */
 	return oid;
 }
 /*  deletes an object */
@@ -140,7 +140,7 @@
 	char				buf[4+4*12];
 	char				*ptr;
 	int					len=4+4*12;
-/* 	dprintf(LOW, "adding a new material..."); */
+/* 	s3dprintf(LOW, "adding a new material..."); */
 	ptr=buf;
 	*((uint32_t *)ptr)=htonl(object);	ptr+=sizeof(uint32_t);		  /*  object id */
 	*((float *)ptr)=amb_r;				ptr+=sizeof(float);
@@ -169,7 +169,7 @@
 	char				buf[4+4*12];
 	char				*ptr;
 	int					len=4+4*12;
-/* 	dprintf(LOW, "adding a new material..."); */
+/* 	s3dprintf(LOW, "adding a new material..."); */
 	ptr=buf;
 	*((uint32_t *)ptr)=htonl(object);	ptr+=sizeof(uint32_t);		  /*  object id */
 	*((float *)ptr)=amb_r;				ptr+=sizeof(float);
@@ -398,7 +398,7 @@
 	char				buf[4+4*12];
 	char				*ptr;
 	int					len=4+4*12;
-/* 	dprintf(LOW, "adding a new material..."); */
+/* 	s3dprintf(LOW, "adding a new material..."); */
 	ptr=buf;
 	*((uint32_t *)ptr)=htonl(object);	ptr+=sizeof(uint32_t);		  /*  object id */
 	*((float *)ptr)=amb_r;				ptr+=sizeof(float);
@@ -427,7 +427,7 @@
 	char				buf[4+4*12];
 	char				*ptr;
 	int					len=4+4*12;
-/* 	dprintf(LOW, "adding a new material..."); */
+/* 	s3dprintf(LOW, "adding a new material..."); */
 	ptr=buf;
 	*((uint32_t *)ptr)=htonl(object);	ptr+=sizeof(uint32_t);		  /*  object id */
 	*((float *)ptr)=amb_r;				ptr+=sizeof(float);
@@ -727,7 +727,7 @@
 	char				buf[4+1+4],*ptr;
 	int					len=4+1+4;
 	ptr=buf;
-/* 	dprintf(VLOW, "toggling flags on .. %010x", flags); */
+/* 	s3dprintf(VLOW, "toggling flags on .. %010x", flags); */
 	*((uint32_t *)ptr)=htonl(object);			ptr+=4;
 	*ptr=OF_TURN_ON;							ptr+=1;
 	*((uint32_t *)ptr)=htonl(flags);			ptr+=4;		
@@ -739,7 +739,7 @@
 	char				buf[4+1+4],*ptr;
 	int					len=4+1+4;
 	ptr=buf;
-/* 	dprintf(VLOW, "toggling flags off .. %010x", flags); */
+/* 	s3dprintf(VLOW, "toggling flags off .. %010x", flags); */
 	*((uint32_t *)ptr)=htonl(object);			ptr+=4;
 	*ptr=OF_TURN_OFF;							ptr+=1;
 	*((uint32_t *)ptr)=htonl(flags);			ptr+=4;		 
@@ -751,7 +751,7 @@
 	char				buf[4+4*3],*ptr;
 	int					len=4+4*3;
 	ptr=buf;
-/* 	dprintf(VLOW, "translating object to  .. %f, %f, %f", x,y,z); */
+/* 	s3dprintf(VLOW, "translating object to  .. %f, %f, %f", x,y,z); */
 	*((uint32_t *)ptr)=htonl(object);			ptr+=4;
 	*((float *)ptr)=x;							ptr+=4;
 	*((float *)ptr)=y;							ptr+=4;
@@ -766,7 +766,7 @@
 	char				buf[4+4*3],*ptr;
 	int					len=4+4*3;
 	ptr=buf;
-/* 	dprintf(VLOW, "rotating object to  .. %f, %f, %f", x,y,z); */
+/* 	s3dprintf(VLOW, "rotating object to  .. %f, %f, %f", x,y,z); */
 	*((uint32_t *)ptr)=htonl(object);			ptr+=4;
 	*((float *)ptr)=x;							ptr+=4;
 	*((float *)ptr)=y;							ptr+=4;

Modified: trunk/libs3d/s3dlib.h
===================================================================
--- trunk/libs3d/s3dlib.h	2006-06-04 18:55:53 UTC (rev 329)
+++ trunk/libs3d/s3dlib.h	2006-06-04 20:27:36 UTC (rev 330)
@@ -51,7 +51,7 @@
 /*  some local prototypes: */
 /*  char *s3d_open_file(char *fname); */
 int net_prot_in(uint8_t opcode, uint16_t length, char *buf);
-void dprintf(int relevance, const char *fmt, ...);
+void s3dprintf(int relevance, const char *fmt, ...);
 void errn(char *func,int en);
 void errs(char *func, char *msg);
 void errdn(int relevance, char *func,int en); 
@@ -109,7 +109,7 @@
 
 #include "config.h"
 #ifndef DEBUG
-#define dprintf(...) /* nothing */
+#define s3dprintf(...) /* nothing */
 #define errdn(...) /* nothing */
 #define errds(...) /* nothing */
 #endif

Modified: trunk/libs3d/shm.c
===================================================================
--- trunk/libs3d/shm.c	2006-06-04 18:55:53 UTC (rev 329)
+++ trunk/libs3d/shm.c	2006-06-04 20:27:36 UTC (rev 330)
@@ -50,13 +50,13 @@
 /*	struct shmid_ds *buf; */
 	key_t key,key_out,key_in;
 	
-	dprintf(MED,"connecting to shm token %s",ftoken);
+	s3dprintf(MED,"connecting to shm token %s",ftoken);
 	/* make the key: */
 	if ((key = ftok(ftoken, 'R')) == -1) {
 		errn("shm_init():ftok()",errno);
 		return(1);
 	}
-	dprintf(MED,"init key is 0x%08x",key);
+	s3dprintf(MED,"init key is 0x%08x",key);
 	
 	/* connect to the segment: */
 	if ((shmid = shmget(key, SHM_SIZE, 0644 )) == -1) {
@@ -70,10 +70,10 @@
 		errn("shm_init():shmat()",errno);
 		return(1);
 	}
-	dprintf(MED,"right now, next_keys are: %08x, %08x",next_key[0],next_key[1]);
+	s3dprintf(MED,"right now, next_keys are: %08x, %08x",next_key[0],next_key[1]);
 	while ((0==(key_in=next_key[1])) || (0==(key_out=next_key[0])));
 	next_key[0]=next_key[1]=0;
-	dprintf(MED,"right now, next_keys are: %08x, %08x",key_in,key_out);
+	s3dprintf(MED,"right now, next_keys are: %08x, %08x",key_in,key_out);
 	/* as we have the new key, we  can detach here now. */
 	if (shmdt(next_key) == -1) { 
 		errn("shm_init():shmdt()",errno);
@@ -130,7 +130,7 @@
 		str += no_written;
 		if (wait++>SHM_MAXLOOP) 
 		{
-			dprintf(HIGH,"shm_writen():waited too long ...");
+			s3dprintf(HIGH,"shm_writen():waited too long ...");
 			return(-1);
 		}
 		if (wait>10)
@@ -153,7 +153,7 @@
 		str += no_read;
 		if (wait++>SHM_MAXLOOP) 
 		{
-			dprintf(HIGH,"shm_readn():waited too long ...");
+			s3dprintf(HIGH,"shm_readn():waited too long ...");
 			return(-1);
 		}
 		if (wait>10)
@@ -181,7 +181,7 @@
 			net_prot_in(opcode,length,buf);
 			found=1;
 		} else {
-			dprintf(HIGH,"socket seems to be dead ...");
+			s3dprintf(HIGH,"socket seems to be dead ...");
 			s3d_quit();
 		}
 	} else {
@@ -190,7 +190,7 @@
 			shmctl(shmid_in,IPC_STAT,&d);
 			if (d.shm_nattch==1) /* we're all alone ... remove it!! */
 			{
-				dprintf(MED,"server vanished ... ");
+				s3dprintf(MED,"server vanished ... ");
 				s3d_quit();
 			} else 
 				shm_idle=0;

Modified: trunk/libs3d/shm_ringbuf.c
===================================================================
--- trunk/libs3d/shm_ringbuf.c	2006-06-04 18:55:53 UTC (rev 329)
+++ trunk/libs3d/shm_ringbuf.c	2006-06-04 20:27:36 UTC (rev 330)
@@ -45,7 +45,7 @@
 	{
 		if /*((size*2)>RB_MAX_SIZE)*/ (1)
 		{
-	/*		dprintf(MED,"buffer reached maxsize, no resizing possible");*/
+	/*		s3dprintf(MED,"buffer reached maxsize, no resizing possible");*/
 			return(0);
 		}
 /*		printf("buffer full!! resizing ... (to size %d)",(int)size*2);

Modified: trunk/libs3d/tcp.c
===================================================================
--- trunk/libs3d/tcp.c	2006-06-04 18:55:53 UTC (rev 329)
+++ trunk/libs3d/tcp.c	2006-06-04 20:27:36 UTC (rev 330)
@@ -88,14 +88,14 @@
 		errn("_tcp_init():signal()",errno);
 #endif
 	s3d_socket=sd;
-	dprintf(MED,"connection to %s:%d established", sv, pn);
+	s3dprintf(MED,"connection to %s:%d established", sv, pn);
 	return(0);
 }
 int _tcp_quit()
 {
 	if (s3d_socket)
 	{
-		dprintf(MED,"closing socket %d",s3d_socket);
+		s3dprintf(MED,"closing socket %d",s3d_socket);
 		close(s3d_socket);
 		s3d_socket=0;
 	}
@@ -139,7 +139,7 @@
 		tv.tv_sec=tv.tv_usec=0;
 		FD_SET(s3d_socket,&fs_proc);
 	
-		 /* dprintf(LOW,"Added %d procceses into file descriptor ...", n); */
+		 /* s3dprintf(LOW,"Added %d procceses into file descriptor ...", n); */
 		if (select(FD_SETSIZE, &fs_proc, NULL,NULL,&tv) ==-1) 
 		{
 			errn("select()",errno); 
@@ -156,7 +156,7 @@
 					net_prot_in(opcode,length,buf);
 					found=1;
 				} else {
-					dprintf(HIGH,"socket seems to be dead ...");
+					s3dprintf(HIGH,"socket seems to be dead ...");
 					s3d_quit();
 				}
 			}

Modified: trunk/libs3dw/animate.c
===================================================================
--- trunk/libs3dw/animate.c	2006-06-04 18:55:53 UTC (rev 329)
+++ trunk/libs3dw/animate.c	2006-06-04 20:27:36 UTC (rev 330)
@@ -64,7 +64,7 @@
 		ani_n--;
 		ani_s[i]=ani_s[ani_n]; /* that should also work if i is the last one */
 	} else {
-		dprintf(MED,"[F]ATAL: can't delete animation!\n");
+		s3dprintf(MED,"[F]ATAL: can't delete animation!\n");
 	}
 }
 /* well ... */

Modified: trunk/libs3dw/input.c
===================================================================
--- trunk/libs3dw/input.c	2006-06-04 18:55:53 UTC (rev 329)
+++ trunk/libs3dw/input.c	2006-06-04 20:27:36 UTC (rev 330)
@@ -172,7 +172,7 @@
 	char *newtext;
 	char key=keys->unicode; /* unicode support so far ... :/ */
 	int len;
-	dprintf(MED,"edit field got key %d!!",key);
+	s3dprintf(MED,"edit field got key %d!!",key);
 	switch (keys->keysym)
 	{
 		case S3DK_BACKSPACE:

Modified: trunk/libs3dw/s3dw_int.h
===================================================================
--- trunk/libs3dw/s3dw_int.h	2006-06-04 18:55:53 UTC (rev 329)
+++ trunk/libs3dw/s3dw_int.h	2006-06-04 20:27:36 UTC (rev 330)
@@ -21,7 +21,7 @@
  * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
  */
 
-#include <s3dlib.h> /* dprintf() */
+#include <s3dlib.h> /* s3dprintf() */
 #define MAXANI		128
 #define ZOOMS		5
 /* constructor and handler callbacks */

Modified: trunk/libs3dw/surface.c
===================================================================
--- trunk/libs3dw/surface.c	2006-06-04 18:55:53 UTC (rev 329)
+++ trunk/libs3dw/surface.c	2006-06-04 20:27:36 UTC (rev 330)
@@ -64,7 +64,7 @@
 	surface->oid_title=s3d_draw_string(surface->title,&length);
 	while (length > (widget->width+1))
 	{
-		dprintf(HIGH,"%f > %f",length,widget->width+1);
+		s3dprintf(HIGH,"%f > %f",length,widget->width+1);
 		textlen=strlen(surface->title);
 		if (length>((widget->width+1)*1.3))
 			textlen=textlen*((widget->width+1)*1.1/length);
@@ -177,13 +177,13 @@
 	if (widget->oid==oid)
 	{
 		s3dw_focus(widget);
-		dprintf(MED,"body %s clicked",surface->title);
+		s3dprintf(MED,"body %s clicked",surface->title);
 		return(1);
 	}
 	if ((surface->oid_tbar==oid) || (surface->oid_title==oid))
 	{
 		s3dw_focus(widget);
-		dprintf(MED,"title %s clicked",surface->title);
+		s3dprintf(MED,"title %s clicked",surface->title);
 		return(1);
 	}
 	return(0);

Modified: trunk/server/config.h
===================================================================
--- trunk/server/config.h	2006-06-04 18:55:53 UTC (rev 329)
+++ trunk/server/config.h	2006-06-04 20:27:36 UTC (rev 330)
@@ -43,7 +43,7 @@
 #define DEBUG	LOW
 #ifndef DEBUG
 #define errds(...) /* nothing */
-#define dprintf(...) /* nothing */
+#define s3dprintf(...) /* nothing */
 #endif
 
 

Modified: trunk/server/cull.c
===================================================================
--- trunk/server/cull.c	2006-06-04 18:55:53 UTC (rev 329)
+++ trunk/server/cull.c	2006-06-04 20:27:36 UTC (rev 330)
@@ -114,7 +114,7 @@
 		p=&frustumPlane[i];
 		if (p->n.x*center->x+p->n.y*center->y+p->n.z*center->z+p->d <= -radius)
 		{
-/*			dprintf(MED,"out of %d plane (n %f %f %f |d %f)",i,p->n.x,p->n.y,p->n.z,p->d);*/
+/*			s3dprintf(MED,"out of %d plane (n %f %f %f |d %f)",i,p->n.x,p->n.y,p->n.z,p->d);*/
 			 return 0; /* sorry, no ... */
 		}
 	}

Modified: trunk/server/error.c
===================================================================
--- trunk/server/error.c	2006-06-04 18:55:53 UTC (rev 329)
+++ trunk/server/error.c	2006-06-04 20:27:36 UTC (rev 330)
@@ -67,7 +67,7 @@
 }
 /*  printing debug message */
 
-void dprintf(int relevance, const char *fmt, ...) {
+void s3dprintf(int relevance, const char *fmt, ...) {
 	char dbm[DBM_MAX];
 	va_list args;
 	if (relevance >= DEBUG )

Modified: trunk/server/event.c
===================================================================
--- trunk/server/event.c	2006-06-04 18:55:53 UTC (rev 329)
+++ trunk/server/event.c	2006-06-04 20:27:36 UTC (rev 330)
@@ -38,7 +38,7 @@
 int event_obj_click(struct t_process *p, uint32_t oid)
 {
 	uint32_t moid=htonl(oid);
-	dprintf(MED,"telling client that oid %d got clicked",oid);
+	s3dprintf(MED,"telling client that oid %d got clicked",oid);
 	prot_com_out(p,S3D_P_S_CLICK,(uint8_t *)&moid, 4);
 	return(0);
 }
@@ -84,7 +84,7 @@
 int event_quit(struct t_process *p)
 {
 	prot_com_out(p, S3D_P_S_QUIT, NULL,0);
-	dprintf(HIGH,"sending pid %d QUIT signal",p->id); 
+	s3dprintf(HIGH,"sending pid %d QUIT signal",p->id); 
 	process_del(p->id);
 	return(0);
 }

Modified: trunk/server/global.h
===================================================================
--- trunk/server/global.h	2006-06-04 18:55:53 UTC (rev 329)
+++ trunk/server/global.h	2006-06-04 20:27:36 UTC (rev 330)
@@ -267,7 +267,7 @@
 void errsf(char *func, char *msg);
 #ifdef DEBUG
 void errds(int relevance,char *func, const char *fmt, ...);
-void dprintf(int relevance, const char *msg, ...);
+void s3dprintf(int relevance, const char *msg, ...);
 #endif
 /*  graphics.c */
 int graphics_quit(void);

Modified: trunk/server/graphics.c
===================================================================
--- trunk/server/graphics.c	2006-06-04 18:55:53 UTC (rev 329)
+++ trunk/server/graphics.c	2006-06-04 20:27:36 UTC (rev 330)
@@ -149,7 +149,7 @@
 					k=cull_sphere_in_frustum(&x,ap->object[j]->r * sqrt(y.x*y.x + y.y*y.y + y.z*y.z));
 					if (k)
 					{
-/*						dprintf(HIGH,"object %d is in %s frustum",j,k?"":"not");*/
+/*						s3dprintf(HIGH,"object %d is in %s frustum",j,k?"":"not");*/
 						if (select_mode==1)
 							glPushName(j);
 						obj_render(ap,j);
@@ -193,19 +193,19 @@
 						y.z-=x.z;
 
 						k=cull_sphere_in_frustum(&x,o->r * sqrt(y.x*y.x + y.y*y.y + y.z*y.z));
-						dprintf(VLOW,"mcp-object %d is in %s frustum",i,k?"":"not");
+						s3dprintf(VLOW,"mcp-object %d is in %s frustum",i,k?"":"not");
 						if (k)
 							{
 							if (select_mode==1)
 							{
-								dprintf(VLOW,"object %d in culling frustrum!",i);
+								s3dprintf(VLOW,"object %d in culling frustrum!",i);
 								glLoadName(i);
 							}
 							render_virtual_object(o);
 						} else {
 							if (select_mode==1)
 							{
-								dprintf(VLOW,"object %d not in culling frustrum!",i);
+								s3dprintf(VLOW,"object %d not in culling frustrum!",i);
 							}
 						}
 					}
@@ -222,7 +222,7 @@
 					{
 						if (select_mode==1)
 						{
-							dprintf(VLOW,"mcp object no. %d",i);
+							s3dprintf(VLOW,"mcp object no. %d",i);
 							glLoadName(-1);
 							glPushName(i);
 						}
@@ -288,7 +288,7 @@
 	if (hits>0)
 	{
 		big=INFINITY;
-		dprintf(LOW,"had %d hits",hits);
+		s3dprintf(LOW,"had %d hits",hits);
 		ptr=select_buf;
 		mcp_o=o=names=-1;
 		/* check all the hits, only select the nearest ... */
@@ -313,18 +313,18 @@
 			} else 
 				for (j=0;j<names;j++)
 					ptr++;
-		    dprintf(VLOW,"[HIT %d] names %d [z1:%f|z2:%f] mcp_o=%d, o=%d ",i,names, z1, z2, mcp_o, o);
+		    s3dprintf(VLOW,"[HIT %d] names %d [z1:%f|z2:%f] mcp_o=%d, o=%d ",i,names, z1, z2, mcp_o, o);
 		}
-		dprintf(VLOW,"mcp_o= %d, o= %d",mcp_o,o);
+		s3dprintf(VLOW,"mcp_o= %d, o= %d",mcp_o,o);
 		ptr=select_buf;
 		if (mcp_o==-1) /* it's an mcp object */
 		{
-			dprintf(LOW,"clicked on mcp-object no. %d",o);
+			s3dprintf(LOW,"clicked on mcp-object no. %d",o);
 			event_obj_click(p,o);
 		} else 
 		if ((names>1) && ((mcp_o>=0)&&(mcp_o<p->n_obj)))
 		{ /* it's an usual object */
-			dprintf(LOW,"clicked on mcp-object %d, object %d",mcp_o,o);
+			s3dprintf(LOW,"clicked on mcp-object %d, object %d",mcp_o,o);
 			if (p->object[mcp_o]!=NULL)  /*  that shouldn't happen anyways ... */
 			{
 				obj_debug(get_proc_by_pid(p->object[mcp_o]->n_mat),o); 

Modified: trunk/server/graphics_glut.c
===================================================================
--- trunk/server/graphics_glut.c	2006-06-04 18:55:53 UTC (rev 329)
+++ trunk/server/graphics_glut.c	2006-06-04 20:27:36 UTC (rev 330)
@@ -35,14 +35,14 @@
 	/* XXX: Faking argc and argv is probably not a good idea. */
 	int argc=1;
 	char *argv[]={"s3d", NULL};
-	dprintf(MED,"Using GLUT for GL/windowing ...");
+	s3dprintf(MED,"Using GLUT for GL/windowing ...");
  	glutInit(&argc, argv); 
 	glutInitDisplayMode(GLUT_DOUBLE | GLUT_DEPTH | GLUT_RGBA);
 	glutInitWindowSize (X_RES, Y_RES);
 	glutCreateWindow("grmbl");
     glutIdleFunc(one_time);
 	if (0!=(atexit(quit)))
-		dprintf(MED,"Error in setting Exit function ...");
+		s3dprintf(MED,"Error in setting Exit function ...");
 	glutDisplayFunc(graphics_main);
 	glutReshapeFunc(graphics_reshape);
 	return(0);

Modified: trunk/server/graphics_sdl.c
===================================================================
--- trunk/server/graphics_sdl.c	2006-06-04 18:55:53 UTC (rev 329)
+++ trunk/server/graphics_sdl.c	2006-06-04 20:27:36 UTC (rev 330)
@@ -32,7 +32,7 @@
     SDL_Surface *GLwin = NULL;
     SDL_VideoInfo *VideoInfo;
     int rgb_size[3]; 				 /*  for SDL_GL attributes */
-	dprintf(MED,"Using SDL driver ...");
+	s3dprintf(MED,"Using SDL driver ...");
 	
     SDLFlags = SDL_OPENGL | SDL_GL_DOUBLEBUFFER | SDL_HWPALETTE | SDL_RESIZABLE;
     if (SDL_Init(SDL_INIT_VIDEO) < 0)  		
@@ -41,12 +41,12 @@
 			errs("SDL_GetVIdeoInfo()",SDL_GetError());
     if(VideoInfo -> hw_available) 
 	{
-		dprintf(LOW,"detected HW_SURFACE");
+		s3dprintf(LOW,"detected HW_SURFACE");
 		SDLFlags |= SDL_HWSURFACE;
 	}
 	else
 	{
-		dprintf(LOW,"detected SW_SURFACE");
+		s3dprintf(LOW,"detected SW_SURFACE");
 		SDLFlags |= SDL_SWSURFACE;
 	}
     if(VideoInfo -> blit_hw)  	
@@ -77,11 +77,11 @@
 	}
 
 	 /*  print some information */
-	dprintf(VLOW,"Screen BPP: %d", SDL_GetVideoSurface()->format->BitsPerPixel);
-	dprintf(VLOW,"Vendor     : %s", glGetString( GL_VENDOR ) );
-	dprintf(VLOW,"Renderer   : %s", glGetString( GL_RENDERER ) );
-	dprintf(VLOW,"Version    : %s", glGetString( GL_VERSION ) );
-	dprintf(VLOW,"Extensions : %s", glGetString( GL_EXTENSIONS ) );
+	s3dprintf(VLOW,"Screen BPP: %d", SDL_GetVideoSurface()->format->BitsPerPixel);
+	s3dprintf(VLOW,"Vendor     : %s", glGetString( GL_VENDOR ) );
+	s3dprintf(VLOW,"Renderer   : %s", glGetString( GL_RENDERER ) );
+	s3dprintf(VLOW,"Version    : %s", glGetString( GL_VERSION ) );
+	s3dprintf(VLOW,"Extensions : %s", glGetString( GL_EXTENSIONS ) );
 	
 	graphics_reshape(X_RES,Y_RES);
 	return(0);

Modified: trunk/server/main.c
===================================================================
--- trunk/server/main.c	2006-06-04 18:55:53 UTC (rev 329)
+++ trunk/server/main.c	2006-06-04 20:27:36 UTC (rev 330)
@@ -51,7 +51,7 @@
 /*  handles the SIGINT command. maybe put signals in a special file? */
 void sigint_handler(int sig)
 {
-	dprintf(HIGH,"oh my gosh there is a sigint/term signal! running away ...");
+	s3dprintf(HIGH,"oh my gosh there is a sigint/term signal! running away ...");
 	quit();
 }
 void sigchld_handler(int sig)
@@ -59,7 +59,7 @@
 	if (kidpid!=0)
 	{
 		kidpid=0;
-	    dprintf(HIGH,"how cruel, my kid died!!");
+	    s3dprintf(HIGH,"how cruel, my kid died!!");
 		quit();
 	}
 }
@@ -81,17 +81,17 @@
 	{
 		nanosleep(&t,NULL); 	/* giving the father lots of time to set his signal handler
 					 			 * and all his sockets up */
-		dprintf(VHIGH,"hello, i'm the kid and will start the rc file now!");
+		s3dprintf(VHIGH,"hello, i'm the kid and will start the rc file now!");
 		for (i=0;i<(sizeof(s3drc)/sizeof(char **));i++)
 		{
 			if ((*s3drc[i])!=NULL)
 			{
-				dprintf(LOW,"[RC] launching %s",*s3drc[i]);
+				s3dprintf(LOW,"[RC] launching %s",*s3drc[i]);
 				ret=system(*s3drc[i]);
-				dprintf(LOW,"[RC] system() said %d",ret);
+				s3dprintf(LOW,"[RC] system() said %d",ret);
 				if (ret<128) 
 				{
-					dprintf(LOW,"[RC] system() did well, I guess. let's die clean now.");
+					s3dprintf(LOW,"[RC] system() did well, I guess. let's die clean now.");
 					exit(0);
 				}
 			} 
@@ -140,7 +140,7 @@
 	if (!norc)
 		rc_init();
 #else
-	dprintf(VHIGH,"rc-files won't work without signals :(");
+	s3dprintf(VHIGH,"rc-files won't work without signals :(");
 #endif
 	if (!frame_mode)  /*  turn default frame_mode on */
 	{
@@ -182,13 +182,13 @@
 		process_quit();
 		if (kidpid!=0)
 		{ /* our kid is most probably still alive. kill it!! */
-			dprintf(HIGH,"kill all the kids!!");
+			s3dprintf(HIGH,"kill all the kids!!");
 			kill(kidpid,SIGTERM);
 			kidpid=0;
 		}
 	}
 	running=0;
-	dprintf(VHIGH,"byebye, s3d quitting ...");
+	s3dprintf(VHIGH,"byebye, s3d quitting ...");
 	exit(0);
 }
 /*  processing arguments from the commandline */
@@ -225,25 +225,25 @@
 #endif					
 					break;
 				case 'r':
-					dprintf(VHIGH,"using rc file: %s",optarg);
+					s3dprintf(VHIGH,"using rc file: %s",optarg);
 					rc=optarg;
 					break;
 				case 'n':
-					dprintf(VHIGH,"Using no rc file!");
+					s3dprintf(VHIGH,"Using no rc file!");
 					norc=1;
 					break;
 
 				case '?':
 				case 'h':
-					dprintf(VHIGH,"usage: %s [options]",argv[0]);
-					dprintf(VHIGH,"s3d, the 3d server:");
+					s3dprintf(VHIGH,"usage: %s [options]",argv[0]);
+					s3dprintf(VHIGH,"s3d, the 3d server:");
 #ifdef G_GLUT
-					dprintf(VHIGH," --use-glut, -g:\tuse GLUT as framework-system");
+					s3dprintf(VHIGH," --use-glut, -g:\tuse GLUT as framework-system");
 #endif
 #ifdef G_SDL
-					dprintf(VHIGH," --use-sdl, -s:\tuse SDL as framework-system");
+					s3dprintf(VHIGH," --use-sdl, -s:\tuse SDL as framework-system");
 #endif
-					dprintf(VHIGH," --help, -?, -h: this helpful text");
+					s3dprintf(VHIGH," --help, -?, -h: this helpful text");
 					errsf("process_args()","exiting for users sake");
 					return(-1);
 		}

Modified: trunk/server/matrix.c
===================================================================
--- trunk/server/matrix.c	2006-06-04 18:55:53 UTC (rev 329)
+++ trunk/server/matrix.c	2006-06-04 20:27:36 UTC (rev 330)
@@ -42,10 +42,10 @@
 #define M(x, y)		MAT[I(x, y)]
 void mat_debug(t_mtrx S)
 {
-	dprintf(MED,"MAT_0: %.2f %.2f %.2f %.2f",S[I(0,0)],S[I(1,0)],S[I(2,0)],S[I(3,0)]);
-	dprintf(MED,"MAT_1: %.2f %.2f %.2f %.2f",S[I(0,1)],S[I(1,1)],S[I(2,1)],S[I(3,1)]);
-	dprintf(MED,"MAT_2: %.2f %.2f %.2f %.2f",S[I(0,2)],S[I(1,2)],S[I(2,2)],S[I(3,2)]);
-	dprintf(MED,"MAT_3: %.2f %.2f %.2f %.2f",S[I(0,3)],S[I(1,3)],S[I(2,3)],S[I(3,3)]);
+	s3dprintf(MED,"MAT_0: %.2f %.2f %.2f %.2f",S[I(0,0)],S[I(1,0)],S[I(2,0)],S[I(3,0)]);
+	s3dprintf(MED,"MAT_1: %.2f %.2f %.2f %.2f",S[I(0,1)],S[I(1,1)],S[I(2,1)],S[I(3,1)]);
+	s3dprintf(MED,"MAT_2: %.2f %.2f %.2f %.2f",S[I(0,2)],S[I(1,2)],S[I(2,2)],S[I(3,2)]);
+	s3dprintf(MED,"MAT_3: %.2f %.2f %.2f %.2f",S[I(0,3)],S[I(1,3)],S[I(2,3)],S[I(3,3)]);
 }
 void myMultMatrix(t_mtrx mat2)
 {
@@ -107,10 +107,10 @@
 	memcpy(Mm,MAT,sizeof(t_mtrx));			/* backup matrix */
 	memcpy(Pm,Identity,sizeof(t_mtrx));		/* target */
 
-/*	dprintf(MED,"start:");
+/*	s3dprintf(MED,"start:");
 	mat_debug(MAT);*/
 
-/*	dprintf(LOW,"inverting matrix, we shall begin now ...");*/
+/*	s3dprintf(LOW,"inverting matrix, we shall begin now ...");*/
 
 	/* step 1 */
 	for (l=0;l<4;l++)
@@ -118,7 +118,7 @@
 check:	if (M(l,l)*M(l,l)>0.00000001F) /* it won't work with real zero */
 		{
 			
-/*			dprintf(MED,"normalizing line %d",l);*/
+/*			s3dprintf(MED,"normalizing line %d",l);*/
 			/* normalize */
 			f=1/M(l,l);
 			M(l,l)=1.0;
@@ -127,12 +127,12 @@
 			for (i=0;i<4;i++)
 				P(i,l)*=f; /* ... and the right */
 /*			mat_debug(Mm);
-			dprintf(MED,"-");
+			s3dprintf(MED,"-");
 			mat_debug(Pm);*/
 			/* mult/fac */
 			for (lh=l+1;lh<4;lh++)
 			{
-			/*	dprintf(MED,"adding line %d for %d",lh,l);*/
+			/*	s3dprintf(MED,"adding line %d for %d",lh,l);*/
 				if (M(l,lh)!=0) /* "first" element of the line */
 				{
 					f=-M(l,lh);
@@ -141,15 +141,15 @@
 						M(i,lh)+=f*M(i,l);
 					for (i=0;i<4;i++)	/* ... and the right one! */
 						P(i,lh)+=f*P(i,l);
-				} /*else dprintf(MED,"element already zero!");*/
+				} /*else s3dprintf(MED,"element already zero!");*/
 			}
 		} else {
 			M(l,l)=0.0F;
-/*			dprintf(MED,"already zero now check and try to swap lines ...");*/
+/*			s3dprintf(MED,"already zero now check and try to swap lines ...");*/
 			for (lh=l+1;lh<4;lh++)
 				if (M(l,lh)!=0.0)
 				{
-/*					dprintf(MED,"swapping lines %d and %d",l,lh);*/
+/*					s3dprintf(MED,"swapping lines %d and %d",l,lh);*/
 					for (i=0;i<4;i++)
 					{
 						f=M(i,l);
@@ -162,7 +162,7 @@
 					}
 					goto check;
 				}
-			dprintf(MED,"nothing to swap, can't reverse this matrix! returning ... ");
+			s3dprintf(MED,"nothing to swap, can't reverse this matrix! returning ... ");
 			mat_debug(Mm);
 			return(-1); /* the dead end!! */
 		}
@@ -177,13 +177,13 @@
 	 * */
 
 	/* step 2 */
-/*	dprintf(MED,"S.T.E.P. 2!!");*/
+/*	s3dprintf(MED,"S.T.E.P. 2!!");*/
 	for (l=3;l>0;l--)
 	{
 		/* mult/fac */
 		for (lh=l-1;lh>=0;lh--)
 		{
-/*			dprintf(MED,"adding line %d for %d",lh,l);*/
+/*			s3dprintf(MED,"adding line %d for %d",lh,l);*/
 			if (M(l,lh)!=0) /* "first" element of the line */
 			{
 				f=-M(l,lh);
@@ -199,7 +199,7 @@
 		}
 	}
 	/* now, Mm,is Identity and Pm is result!*/
-/*	dprintf(MED,"result:");
+/*	s3dprintf(MED,"result:");
 	mat_debug(Pm);*/
 	memcpy(MAT,Pm,sizeof(t_mtrx)); /* copy result */
 	return(0);

Modified: trunk/server/mcp.c
===================================================================
--- trunk/server/mcp.c	2006-06-04 18:55:53 UTC (rev 329)
+++ trunk/server/mcp.c	2006-06-04 20:27:36 UTC (rev 330)
@@ -90,7 +90,7 @@
 	unsigned long oid=htonl(mcp_oid);
 	if (mcp_oid==focus_oid)
 	{
-		dprintf(MED,"lost the focus of mcp-oid %d",mcp_oid);
+		s3dprintf(MED,"lost the focus of mcp-oid %d",mcp_oid);
 		mcp_focus(-1);
 	}
 	prot_com_out(get_proc_by_pid(MCP),S3D_P_MCP_DEL_OBJECT,(uint8_t *)&oid,4);
@@ -103,7 +103,7 @@
 	struct t_obj *o;
 	focus_oid=-1;
 	p=get_proc_by_pid(MCP);
-	dprintf(MED,"request to focus %d",oid);
+	s3dprintf(MED,"request to focus %d",oid);
 	if (obj_valid(p,oid,o))
 		if (o->oflags&OF_VIRTUAL)
 		{

Modified: trunk/server/object.c
===================================================================
--- trunk/server/object.c	2006-06-04 18:55:53 UTC (rev 329)
+++ trunk/server/object.c	2006-06-04 20:27:36 UTC (rev 330)
@@ -43,25 +43,25 @@
 int obj_debug			(struct t_process *p, uint32_t oid)
 {
 	struct t_obj *o;
-	dprintf(HIGH,"about pid %d/obj %d:",p->id,oid);
+	s3dprintf(HIGH,"about pid %d/obj %d:",p->id,oid);
 	if (obj_valid(p,oid,o))
 	{
-		dprintf(HIGH,"vertices: %d, polygons: %d, materials: %d, textures: %d, flags: %010x",o->n_vertex,o->n_poly, o->n_mat, o->n_tex,o->oflags);
-		dprintf(HIGH,"linkid %d, displaylist %d",o->linkid,o->dplist);
-		dprintf(HIGH,"translation: %f %f %f",o->translate.x,o->translate.y,o->translate.z);
-		dprintf(HIGH,"rotation: %f %f %f",o->rotate.x,o->rotate.y,o->rotate.z);
-		dprintf(HIGH,"scale: %f",o->scale);
+		s3dprintf(HIGH,"vertices: %d, polygons: %d, materials: %d, textures: %d, flags: %010x",o->n_vertex,o->n_poly, o->n_mat, o->n_tex,o->oflags);
+		s3dprintf(HIGH,"linkid %d, displaylist %d",o->linkid,o->dplist);
+		s3dprintf(HIGH,"translation: %f %f %f",o->translate.x,o->translate.y,o->translate.z);
+		s3dprintf(HIGH,"rotation: %f %f %f",o->rotate.x,o->rotate.y,o->rotate.z);
+		s3dprintf(HIGH,"scale: %f",o->scale);
 		if (o->oflags&OF_SYSTEM)
 		{
-			dprintf(HIGH,"it's a system object!!");
+			s3dprintf(HIGH,"it's a system object!!");
 		}
 		else if (o->oflags&OF_CLONE)
 		{
-			dprintf(HIGH,"it's a clone linking to %d",o->n_vertex);
+			s3dprintf(HIGH,"it's a clone linking to %d",o->n_vertex);
 			obj_debug(p,o->n_vertex);
 		}
 	} else {
-		dprintf(HIGH,"can't get oid %d pid %d",oid,p->id);
+		s3dprintf(HIGH,"can't get oid %d pid %d",oid,p->id);
 	}
 	return(0);
 }
@@ -89,7 +89,7 @@
 		{
 			if (obj->dplist)
 			{
-				dprintf(VLOW,"freeing display list %d to get new data",obj->dplist);
+				s3dprintf(VLOW,"freeing display list %d to get new data",obj->dplist);
 				glDeleteLists(obj->dplist,1);
 				obj->dplist=0;
 			}
@@ -106,7 +106,7 @@
 						(a->y * a->y ) +
 						(a->z * a->z ));
 				if (r> obj->r) obj->r=r;
-/*				dprintf(VLOW,"added following vertex[%d]: %f, %f, %f",i,
+/*				s3dprintf(VLOW,"added following vertex[%d]: %f, %f, %f",i,
 								obj->p_vertex[m+i].x,
 								obj->p_vertex[m+i].y,
 								obj->p_vertex[m+i].z);*/
@@ -166,7 +166,7 @@
 		{
 			if (obj->dplist)
 			{
-				dprintf(VLOW,"freeing display list %d to get new data",obj->dplist);
+				s3dprintf(VLOW,"freeing display list %d to get new data",obj->dplist);
 				glDeleteLists(obj->dplist,1);
 				obj->dplist=0;
 			}
@@ -217,7 +217,7 @@
 		{
 			if (obj->dplist)
 			{
-				dprintf(VLOW,"freeing display list %d to get new data",obj->dplist);
+				s3dprintf(VLOW,"freeing display list %d to get new data",obj->dplist);
 				glDeleteLists(obj->dplist,1);
 				obj->dplist=0;
 			}
@@ -264,7 +264,7 @@
 		{
 			if (obj->dplist)
 			{
-				dprintf(VLOW,"freeing display list %d to get new data",obj->dplist);
+				s3dprintf(VLOW,"freeing display list %d to get new data",obj->dplist);
 				glDeleteLists(obj->dplist,1);
 				obj->dplist=0;
 			}
@@ -307,7 +307,7 @@
 		{
 /*			if (obj->dplist)
 			{
-				dprintf(VLOW,"freeing display list %d to get new data",obj->dplist);
+				s3dprintf(VLOW,"freeing display list %d to get new data",obj->dplist);
 				glDeleteLists(obj->dplist,1);
 				obj->dplist=0;
 			}*/
@@ -321,7 +321,7 @@
 				{
 					d=log((double)obj->p_tex[m+i].tw)/log(2.0);
 					hm=pow(2,floor(d));
-					dprintf(MED,"hm %d, tw %d",hm,obj->p_tex[m+i].tw);
+					s3dprintf(MED,"hm %d, tw %d",hm,obj->p_tex[m+i].tw);
 					if (hm!=obj->p_tex[m+i].tw) 	{
 						obj->p_tex[m+i].w=hm*2;
 						obj->p_tex[m+i].xs=(float)((double)obj->p_tex[m+i].tw)/((double)obj->p_tex[m+i].w);
@@ -331,7 +331,7 @@
 					}
 					d=log((double)obj->p_tex[m+i].th)/log(2.0);
 					hm=pow(2,floor(d));
-					dprintf(MED,"hm %d, th %d",hm,obj->p_tex[m+i].th);
+					s3dprintf(MED,"hm %d, th %d",hm,obj->p_tex[m+i].th);
 					
 					if (hm!=obj->p_tex[m+i].th) 	{
 						obj->p_tex[m+i].h=hm*2;
@@ -384,11 +384,11 @@
 
 		if (obj->dplist)
 		{
-			dprintf(VLOW,"freeing display list %d to get new data",obj->dplist);
+			s3dprintf(VLOW,"freeing display list %d to get new data",obj->dplist);
 			glDeleteLists(obj->dplist,1);
 			obj->dplist=0;
 		}
-		dprintf(VLOW,"pepping poly's %d to %d",(m-n),m);
+		s3dprintf(VLOW,"pepping poly's %d to %d",(m-n),m);
 		for (i=(m-n);i<m;i++)
 		{
 			for (j=0;j<3;j++)
@@ -434,11 +434,11 @@
 
 		if (obj->dplist)
 		{
-			dprintf(VLOW,"freeing display list %d to get new data",obj->dplist);
+			s3dprintf(VLOW,"freeing display list %d to get new data",obj->dplist);
 			glDeleteLists(obj->dplist,1);
 			obj->dplist=0;
 		}
-		dprintf(VLOW,"pepping line's %d to %d",(m-n),m);
+		s3dprintf(VLOW,"pepping line's %d to %d",(m-n),m);
 		for (i=(m-n);i<m;i++)
 		{
 			for (j=0;j<2;j++)
@@ -486,11 +486,11 @@
 
 		if (obj->dplist)
 		{
-			dprintf(VLOW,"freeing display list %d to get new data",obj->dplist);
+			s3dprintf(VLOW,"freeing display list %d to get new data",obj->dplist);
 			glDeleteLists(obj->dplist,1);
 			obj->dplist=0;
 		}
-		dprintf(VLOW,"pepping poly's %d to %d",(m-n),m);
+		s3dprintf(VLOW,"pepping poly's %d to %d",(m-n),m);
 		for (i=(m-n);i<m;i++)
 		{
 			for (j=0;j<3;j++)
@@ -525,11 +525,11 @@
 		}
 		if (obj->dplist)
 		{
-			dprintf(VLOW,"freeing display list %d to get new data",obj->dplist);
+			s3dprintf(VLOW,"freeing display list %d to get new data",obj->dplist);
 			glDeleteLists(obj->dplist,1);
 			obj->dplist=0;
 		}
-		dprintf(VLOW,"pepping mats %d to %d",(m-n),m);
+		s3dprintf(VLOW,"pepping mats %d to %d",(m-n),m);
 		for (i=(m-n);i<m;i++)
 		{
 			obj->p_mat[i].amb_r=*(px++);
@@ -571,11 +571,11 @@
 		}
 		if (obj->dplist)
 		{
-			dprintf(VLOW,"freeing display list %d to get new data",obj->dplist);
+			s3dprintf(VLOW,"freeing display list %d to get new data",obj->dplist);
 			glDeleteLists(obj->dplist,1);
 			obj->dplist=0;
 		}
-		dprintf(VLOW,"pepping lines %d to %d",(m-n),m);
+		s3dprintf(VLOW,"pepping lines %d to %d",(m-n),m);
 		for (i=(m-n);i<m;i++)
 		{
 			obj->p_line[i].v[0]=*(px++);
@@ -615,11 +615,11 @@
 		}
 		if (obj->dplist)
 		{
-			dprintf(VLOW,"freeing display list %d to get new data",obj->dplist);
+			s3dprintf(VLOW,"freeing display list %d to get new data",obj->dplist);
 			glDeleteLists(obj->dplist,1);
 			obj->dplist=0;
 		}
-		dprintf(VLOW,"pepping vertices %d to %d",(m-n),m-1);
+		s3dprintf(VLOW,"pepping vertices %d to %d",(m-n),m-1);
 		for (i=(m-n);i<m;i++)
 		{
 			obj->p_vertex[i].x=*(px++);
@@ -682,11 +682,11 @@
 		}
 		if (obj->dplist)
 		{
-			dprintf(VLOW,"freeing display list %d to get new data",obj->dplist);
+			s3dprintf(VLOW,"freeing display list %d to get new data",obj->dplist);
 			glDeleteLists(obj->dplist,1);
 			obj->dplist=0;
 		}
-		dprintf(MED,"pepping mats %d to %d",(m-n),m);
+		s3dprintf(MED,"pepping mats %d to %d",(m-n),m);
 		for (i=(m-n);i<m;i++)
 			obj->p_mat[i].tex=*(px++);
 	} else 
@@ -716,7 +716,7 @@
 
 		if (obj->dplist)
 		{
-			dprintf(VLOW,"freeing display list %d to get new data",obj->dplist);
+			s3dprintf(VLOW,"freeing display list %d to get new data",obj->dplist);
 			glDeleteLists(obj->dplist,1);
 			obj->dplist=0;
 		}
@@ -763,7 +763,7 @@
 
 		if (obj->dplist)
 		{
-			dprintf(VLOW,"freeing display list %d to get new data",obj->dplist);
+			s3dprintf(VLOW,"freeing display list %d to get new data",obj->dplist);
 			glDeleteLists(obj->dplist,1);
 			obj->dplist=0;
 		}
@@ -809,7 +809,7 @@
 
 		if (obj->dplist)
 		{
-			dprintf(VLOW,"freeing display list %d to get new data",obj->dplist);
+			s3dprintf(VLOW,"freeing display list %d to get new data",obj->dplist);
 			glDeleteLists(obj->dplist,1);
 			obj->dplist=0;
 		}
@@ -846,11 +846,11 @@
 		}
 		if (obj->dplist)
 		{
-			dprintf(VLOW,"freeing display list %d to get new data",obj->dplist);
+			s3dprintf(VLOW,"freeing display list %d to get new data",obj->dplist);
 			glDeleteLists(obj->dplist,1);
 			obj->dplist=0;
 		}
-		dprintf(MED,"pepping %d mats, starting at %d",n,start);
+		s3dprintf(MED,"pepping %d mats, starting at %d",n,start);
 		for (i=start;i<(start+n);i++)
 		{
 			obj->p_mat[i].amb_r=*(px++);
@@ -876,7 +876,7 @@
 	GLuint t;
 	if ((t=tex->gl_texnum)!=-1)
 	{
-/* dprintf(MED,"updating texture %d at [%d %d] with a [%d %d] pixbuf",t,x,y,w,h); */
+/* s3dprintf(MED,"updating texture %d at [%d %d] with a [%d %d] pixbuf",t,x,y,w,h); */
 /* 		glTexSubImage2D(t,0,x,y,w,h,GL_RGBA,GL_UNSIGNED_BYTE,pixbuf); */
 
 		glDeleteTextures(1,&t);
@@ -904,7 +904,7 @@
 			{
 				if (obj->dplist)
 				{
-					dprintf(VLOW,"freeing display list %d to get new data",obj->dplist);
+					s3dprintf(VLOW,"freeing display list %d to get new data",obj->dplist);
 					glDeleteLists(obj->dplist,1);
 					obj->dplist=0;
 				}
@@ -950,7 +950,7 @@
 			case OF_TURN_SWAP:	obj->oflags^=f;		break;
 			default:return(-1);
 		}
-/* 		dprintf(VLOW,"toggled %d->oflags=%010x with %010x [%d]",oid,obj->oflags,flags,type); */
+/* 		s3dprintf(VLOW,"toggled %d->oflags=%010x with %010x [%d]",oid,obj->oflags,flags,type); */
 	} 
 	return(0);
 }
@@ -968,7 +968,7 @@
 			return(-1);
 		}
 
-		dprintf(VLOW,"deleting %d vertices of pid %d/ oid %d",n,p->id,oid);
+		s3dprintf(VLOW,"deleting %d vertices of pid %d/ oid %d",n,p->id,oid);
 		m=obj->n_vertex;	 /*  saving the first number of vertices */
 		if (n>=m) 
 		{
@@ -983,7 +983,7 @@
 			{
 				if (obj->dplist)
 				{
-					dprintf(VLOW,"freeing display list %d to get new data",obj->dplist);
+					s3dprintf(VLOW,"freeing display list %d to get new data",obj->dplist);
 					glDeleteLists(obj->dplist,1);
 					obj->dplist=0;
 				}
@@ -1012,7 +1012,7 @@
 			return(-1);
 		}
 
-		dprintf(VLOW,"deleting %d materials of pid %d/ oid %d",n,p->id,oid);
+		s3dprintf(VLOW,"deleting %d materials of pid %d/ oid %d",n,p->id,oid);
 		m=obj->n_mat;	 /*  saving the first number of materials */
 		if (n>=m) 
 		{
@@ -1026,7 +1026,7 @@
 		{
 			if (obj->dplist)
 			{
-				dprintf(VLOW,"freeing display list %d to get new data",obj->dplist);
+				s3dprintf(VLOW,"freeing display list %d to get new data",obj->dplist);
 				glDeleteLists(obj->dplist,1);
 				obj->dplist=0;
 			}
@@ -1051,7 +1051,7 @@
 			return(-1);
 		}
 
-		dprintf(VLOW,"deleting %d polys of pid %d/ oid %d",n,p->id,oid);
+		s3dprintf(VLOW,"deleting %d polys of pid %d/ oid %d",n,p->id,oid);
 		m=obj->n_poly;	 /*  saving the first number of poly  */
 		if (n>=m) 
 		{
@@ -1065,7 +1065,7 @@
 		{
 			if (obj->dplist)
 			{
-				dprintf(VLOW,"freeing display list %d to get new data",obj->dplist);
+				s3dprintf(VLOW,"freeing display list %d to get new data",obj->dplist);
 				glDeleteLists(obj->dplist,1);
 				obj->dplist=0;
 			}
@@ -1090,7 +1090,7 @@
 			return(-1);
 		}
 
-		dprintf(VLOW,"deleting %d lines of pid %d/ oid %d",n,p->id,oid);
+		s3dprintf(VLOW,"deleting %d lines of pid %d/ oid %d",n,p->id,oid);
 		m=obj->n_line;	 /*  saving the first number of line  */
 		if (n>=m) 
 		{
@@ -1104,7 +1104,7 @@
 		{
 			if (obj->dplist)
 			{
-				dprintf(VLOW,"freeing display list %d to get new data",obj->dplist);
+				s3dprintf(VLOW,"freeing display list %d to get new data",obj->dplist);
 				glDeleteLists(obj->dplist,1);
 				obj->dplist=0;
 			}
@@ -1131,7 +1131,7 @@
 			return(-1);
 		}
 
-		dprintf(VLOW,"deleting %d textures of pid %d/ oid %d",n,p->id,oid);
+		s3dprintf(VLOW,"deleting %d textures of pid %d/ oid %d",n,p->id,oid);
 		m=obj->n_tex;	 /*  saving the first number of textures  */
 		if (n>=m) 
 		{
@@ -1166,7 +1166,7 @@
 			{
 				if (obj->dplist)
 				{
-					dprintf(VLOW,"freeing display list %d to get new data",obj->dplist);
+					s3dprintf(VLOW,"freeing display list %d to get new data",obj->dplist);
 						glDeleteLists(obj->dplist,1);
 					obj->dplist=0;
 				}
@@ -1202,7 +1202,7 @@
 /*				mySetMatrix(mcp_p->object[oid]->m);
 				myInvert();
 				myTransform3f(v);
-				dprintf(LOW,"%3.3f %3.3f %3.3f",v[0],v[1],v[2]);*/
+				s3dprintf(LOW,"%3.3f %3.3f %3.3f",v[0],v[1],v[2]);*/
 				obj_translate(mcp_p,oid,v);
 			} 
 		} else {
@@ -1211,7 +1211,7 @@
 			obj->translate.z=*(transv+2);
 			obj_pos_update(p,oid,oid);
 		}
-		dprintf(VLOW,"[translate|pid %d] %d: %3.3f %3.3f %3.3f",p->id,oid,obj->translate.x,obj->translate.y,obj->translate.z);
+		s3dprintf(VLOW,"[translate|pid %d] %d: %3.3f %3.3f %3.3f",p->id,oid,obj->translate.x,obj->translate.y,obj->translate.z);
 	}
 	return(0);
 }
@@ -1251,7 +1251,7 @@
 			obj->rotate.z=f;
 			obj_pos_update(p,oid,oid);
 		}
-		dprintf(VLOW,"[rotate|pid %d] %d: %3.3f %3.3f %3.3f",p->id,oid,obj->rotate.x,obj->rotate.y,obj->rotate.z);
+		s3dprintf(VLOW,"[rotate|pid %d] %d: %3.3f %3.3f %3.3f",p->id,oid,obj->rotate.x,obj->rotate.y,obj->rotate.z);
 	}
 	return(0);
 }
@@ -1264,7 +1264,7 @@
 		if ((p->id==MCP) || (!(obj->oflags&OF_SYSTEM)))
 		if (!isinf(scav) && !isnan(scav) && !((scav<1.0e-10) && (scav>-1.0e-10))) /* ignore very low values */
 		{
-			dprintf(VLOW,"[scale|pid %d] obj %d to %f",p->id,oid,scav);
+			s3dprintf(VLOW,"[scale|pid %d] obj %d to %f",p->id,oid,scav);
 			obj->scale=scav;
 	/*		obj->scale.x=*scav;
 			obj->scale.y=*(scav+1);
@@ -1287,12 +1287,12 @@
 			into_position(p,on,depth+1);
 		} else {
 			obj->oflags&=~OF_LINK;
-			dprintf(LOW,"link object is broken, removing link");
+			s3dprintf(LOW,"link object is broken, removing link");
 		}
 	}
 	 /* if (depth>=MAXLOOP) */
 	if (depth>=p->n_obj)
-		dprintf(MED,"too much looping ...");
+		s3dprintf(MED,"too much looping ...");
 	glTranslatef(obj->translate.x,obj->translate.y,obj->translate.z);
 	glRotatef(obj->rotate.y,0.0,1.0,0.0);
 	glRotatef(obj->rotate.x,1.0,0.0,0.0);
@@ -1376,7 +1376,7 @@
 	{	 /*  this is now the biggest object. */
 		mcp_o->r=r;
 		p->biggest_obj=oid;
-/*		dprintf(MED,"there is a new biggest object in [%d:\"\"]",p->id,p->name);*/
+/*		s3dprintf(MED,"there is a new biggest object in [%d:\"\"]",p->id,p->name);*/
 		mcp_rep_object(p->mcp_oid);	  /*  and tell the mcp */
 	} else {
 		if (p->biggest_obj==oid)
@@ -1397,7 +1397,7 @@
 				}
 			if (found)
 			{
-				dprintf(VLOW,"there is a new biggest object in [%d:\"\"]",p->id,p->name);
+				s3dprintf(VLOW,"there is a new biggest object in [%d:\"\"]",p->id,p->name);
 				mcp_o->r=r;  /*  save the new size */
 				mcp_rep_object(p->mcp_oid);	  /*  and tell the mcp */
 			}
@@ -1484,7 +1484,7 @@
 	struct t_obj 		*ao,*o;
 	struct t_process	*ap;
 	o=p->object[oid];
-	dprintf(VLOW,"[obj_pos_upd|pid %d] %d",p->id, oid,first_oid);
+	s3dprintf(VLOW,"[obj_pos_upd|pid %d] %d",p->id, oid,first_oid);
 	o->m_uptodate=0;
 	obj_recalc_tmat(p,oid);
 	if (p->id!=MCP) 
@@ -1526,7 +1526,7 @@
 					event_ptr_changed();
 					break;
 				default:
-					dprintf(LOW,"[obj_pos_upd|pid %d] %d unknown system event",p->id,oid);
+					s3dprintf(LOW,"[obj_pos_upd|pid %d] %d unknown system event",p->id,oid);
 					
 			}
 
@@ -1640,11 +1640,11 @@
 				glGenTextures(1,&t);
 				glBindTexture( GL_TEXTURE_2D, t);
 				tex->gl_texnum=t;
-				dprintf(HIGH,"generated texture %d [%dx%d, in memory %dx%d]",t,tex->tw,tex->th,tex->w,tex->h);
+				s3dprintf(HIGH,"generated texture %d [%dx%d, in memory %dx%d]",t,tex->tw,tex->th,tex->w,tex->h);
 /*				for (j=0;j<tex->th;j++)
 				for (i=0;i<tex->tw;i++)
 				{
-					dprintf(MED,"pixel[%d,%d], %d %d %d %d",i,j,
+					s3dprintf(MED,"pixel[%d,%d], %d %d %d %d",i,j,
 									tex->buf[(j*tex->w+i)*4+0],
 									tex->buf[(j*tex->w+i)*4+1],
 									tex->buf[(j*tex->w+i)*4+2],
@@ -1693,13 +1693,13 @@
 	else {
 		obj->dplist=glGenLists(1);
 		if (obj->dplist)	glNewList(obj->dplist,GL_COMPILE_AND_EXECUTE);
-		 else 				dprintf(LOW,"couldn't get a new list :/");
+		 else 				s3dprintf(LOW,"couldn't get a new list :/");
 		omat=-1;
 		for (pn=0; pn<obj->n_poly; pn++)  /*  cycle throu our polygons ... */
 		{
 			if (calc_normal(obj,pn))
 			{
-				dprintf(HIGH,"something is wrong with polygon %d!",pn);
+				s3dprintf(HIGH,"something is wrong with polygon %d!",pn);
 				if (obj->dplist) glEndList();	glPopMatrix(); /* clean up GL-stuff */
 				return(-1);
 			}
@@ -1712,7 +1712,7 @@
 					if (m->tex!=-1)		tex=get_texture(obj,m);
 					if (tex==NULL)		/* still NULL? then it couldn't get the texture. */
 					{
-/*						dprintf(VLOW,"no texture, using standard material...");*/
+/*						s3dprintf(VLOW,"no texture, using standard material...");*/
 						glBindTexture( GL_TEXTURE_2D,0);
 						matgl[0]=m->amb_r/2;		
 						matgl[1]=m->amb_g/2;		
@@ -1734,7 +1734,7 @@
 						glMaterialfv(GL_FRONT,GL_SPECULAR,matgl);
 					}
 				} else {
-					dprintf(MED,"something is wrong with polygon %d! material: [%d,%d]",pn, mat,obj->n_mat);
+					s3dprintf(MED,"something is wrong with polygon %d! material: [%d,%d]",pn, mat,obj->n_mat);
 					if (obj->dplist) glEndList();	glEnd();	glPopMatrix();
 					return(-1);
 				}
@@ -1747,7 +1747,7 @@
 					glNormal3f(-on->x,-on->y,-on->z);
 					if (tex!=NULL)
 					{
-/*						dprintf(MED,"using texture coordinate (%f,%f) for polygon %d point %d",
+/*						s3dprintf(MED,"using texture coordinate (%f,%f) for polygon %d point %d",
 										obj->p_poly[pn].tc[i].x *tex->xs,
 										obj->p_poly[pn].tc[i].y *tex->ys,
 										pn,i);*/
@@ -1765,7 +1765,7 @@
 		{
 			if (check_line_normal(obj,pn))
 			{
-				dprintf(HIGH,"something is wrong with line %d!",pn);
+				s3dprintf(HIGH,"something is wrong with line %d!",pn);
 				if (obj->dplist) glEndList();	glPopMatrix(); /* clean up GL-stuff */
 				return(-1);
 			}
@@ -1796,7 +1796,7 @@
 		 /* 			glMaterialfv(GL_FRONT_AND_BACK,GL_SPECULAR,matgl); */
 					glMaterialfv(GL_FRONT,GL_SPECULAR,matgl);
 				} else {
-					dprintf(MED,"something is wrong with line %d! material: [%d,%d]",pn, mat,obj->n_mat);
+					s3dprintf(MED,"something is wrong with line %d! material: [%d,%d]",pn, mat,obj->n_mat);
 					if (obj->dplist) glEndList();
 					glEnd();
 					glPopMatrix();
@@ -1827,7 +1827,7 @@
 	struct t_obj *o,*o2;
 	if (obj_valid(p,oid,o))
 	{
-		dprintf(VLOW,"link_delete(): [%d] unlinking %d from %d",p->id, oid, o->linkid);
+		s3dprintf(VLOW,"link_delete(): [%d] unlinking %d from %d",p->id, oid, o->linkid);
 		if (o->linkid!=-1) 
 		{
 			if (o->lprev!=-1)
@@ -1860,7 +1860,7 @@
 	struct t_obj *o,*ot,*o2;
 	if (obj_valid(p,oid,o) && obj_valid(p,target,ot))
 	{
-		dprintf(VLOW,"link_insert(): [%d] linking %d to %d",p->id, oid, target);
+		s3dprintf(VLOW,"link_insert(): [%d] linking %d to %d",p->id, oid, target);
 		o->oflags|=OF_LINK;
 		o->linkid=target;
 		o->lnext=ot->lsub; /* we have a new "first" element */
@@ -1904,7 +1904,7 @@
 			errds(VHIGH,"obj_link()","can't link system-objects in non-mcp-apps!");
 			return(-1);
 		}
- 		dprintf(VLOW,"[link|pid %d] %d -> %d",p->id, oid_from,oid_to); 
+ 		s3dprintf(VLOW,"[link|pid %d] %d -> %d",p->id, oid_from,oid_to); 
 		if (oid_to!=o->linkid) /* only if something changed ... */
 		{
 			if (o->linkid!=-1)
@@ -1929,7 +1929,7 @@
 			return(-1);
 		}
 		link_delete(p,oid);
-		dprintf(VLOW,"removing link of object %d from pid %d",oid,p->id);
+		s3dprintf(VLOW,"removing link of object %d from pid %d",oid,p->id);
 
 		obj_pos_update(p,oid,oid);
 		return(0);
@@ -1964,7 +1964,7 @@
 			{
 				reuse=1;
 				break;
-/* 				dprintf(HIGH,"reusing position %d",pos); */
+/* 				s3dprintf(HIGH,"reusing position %d",pos); */
 			}
 		}
 		if (!reuse)
@@ -1976,10 +1976,10 @@
 			p->n_obj++;					 /*  increment counter */
 		}
 		p->object[pos]=obj;						
-		dprintf(VLOW,"pid %d added new object %d at %010p [pos %d]",p->id,pos,obj,pos);
+		s3dprintf(VLOW,"pid %d added new object %d at %010p [pos %d]",p->id,pos,obj,pos);
 		return (pos);
 	} else {
-		dprintf(HIGH,"obj_new(): no such process %d",p->id);	
+		s3dprintf(HIGH,"obj_new(): no such process %d",p->id);	
 		return(-1);
 	}
 }
@@ -1995,7 +1995,7 @@
 	{
 		if ((o->oflags&OF_SYSTEM) || (no->oflags&OF_SYSTEM))
 		{
-			dprintf(MED,"can't clone from or to system objects");
+			s3dprintf(MED,"can't clone from or to system objects");
 		}
 		 /*  get obj pointer and check for availability of the other object. */
 		if (((already_clone=(o->oflags&OF_CLONE)) || (!(o->n_vertex|o->n_mat|o->n_poly|o->n_tex))) && (!(o->oflags&OF_VIRTUAL)))
@@ -2020,7 +2020,7 @@
 							}
 					if (!is_clnsrc)
 					{
-						dprintf(MED,"obj_clone_change(): %d in process %d is no longer a clone-source",oid,p->id);
+						s3dprintf(MED,"obj_clone_change(): %d in process %d is no longer a clone-source",oid,p->id);
 						p->object[oid]->oflags&=~OF_CLONE_SRC;
 					}
 				}
@@ -2031,7 +2031,7 @@
 				no->oflags|=OF_CLONE_SRC;
 				o->n_vertex=toid;  /*  n_vertex is not used for this as it's just cloned, so we can use it ... */
 				obj_size_update(p,oid);
-				dprintf(LOW,"changed clone-target of obj %d to %d of process %d",oid,toid,p->id);
+				s3dprintf(LOW,"changed clone-target of obj %d to %d of process %d",oid,toid,p->id);
 				if (p->id!=MCP) obj_check_biggest_object(p,oid);
 			} else {
 				errds(MED,"obj_clone_change()","couldn't clone %d from %d (on pid %d): cloning from itself doesn't make sense!",oid,toid,p->id,oid);
@@ -2061,7 +2061,7 @@
 	{
 		if (o->oflags&OF_SYSTEM)
 		{
-			dprintf(HIGH,"can't delete system object!");
+			s3dprintf(HIGH,"can't delete system object!");
 			return(0);
 		}
 
@@ -2070,7 +2070,7 @@
 		{
 			if (o->oflags&OF_VIRTUAL)  /*  only delete if virtual */
 			{
-				dprintf(HIGH,"the mcp wants %d to be closed",o->n_mat);
+				s3dprintf(HIGH,"the mcp wants %d to be closed",o->n_mat);
 				event_quit(get_proc_by_pid(o->n_mat));
 				return(0);
 			}
@@ -2098,7 +2098,7 @@
 						}
 					}
 				mcp_p->object[mcp_oid]->r=mr;
-				dprintf(MED,"new biggest object is :%d (size: %f)",p->biggest_obj,mr);
+				s3dprintf(MED,"new biggest object is :%d (size: %f)",p->biggest_obj,mr);
 			}
 			/*  check if someone depended on this object as clone.... */
 			if (o->oflags&OF_CLONE_SRC)
@@ -2123,7 +2123,7 @@
 	uint32_t i;
 	GLuint t;
 	struct t_obj *o=p->object[oid];
-	dprintf(HIGH,"deleting object %d of process %d",oid,p->id);
+	s3dprintf(HIGH,"deleting object %d of process %d",oid,p->id);
 
 	/* clearing links */
 	if (o->linkid!=-1)		link_delete(p,oid);
@@ -2133,7 +2133,7 @@
 		link_delete(p,o->lsub);
 		if (i==o->lsub) 
 		{
-			dprintf(HIGH,"something is wrong!!");
+			s3dprintf(HIGH,"something is wrong!!");
 			o=NULL; /* segfault */
 			o->lsub=-1;
 		}
@@ -2161,7 +2161,7 @@
 	{
 		if (!(o->oflags&(OF_CLONE|OF_SYSTEM))) 
 		{
-			dprintf(VLOW,"freeing display list %d",o->dplist);
+			s3dprintf(VLOW,"freeing display list %d",o->dplist);
 			glDeleteLists(o->dplist,1);
 		}
 	}

Modified: trunk/server/process.c
===================================================================
--- trunk/server/process.c	2006-06-04 18:55:53 UTC (rev 329)
+++ trunk/server/process.c	2006-06-04 20:27:36 UTC (rev 330)
@@ -48,7 +48,7 @@
 	{
 		if (procs_p[MCP].con_type==CON_NULL)
 		{
-			dprintf(MED,"free mcp place, pid %d becoming mcp!",p->id);
+			s3dprintf(MED,"free mcp place, pid %d becoming mcp!",p->id);
 			con_type=p->con_type; /* move connection data */
 #ifdef TCP			
 			procs_p[MCP].sockid=p->sockid; /* don't save contype yet,
@@ -64,7 +64,7 @@
 			process_list_rm(p->id); /* remove old process, but don't kill connection */
 			return(&procs_p[MCP]);
 		} else {
-			dprintf(LOW,"the place for the mcp is already taken ...");
+			s3dprintf(LOW,"the place for the mcp is already taken ...");
 			return(NULL);
 		}
 	} else {
@@ -80,14 +80,14 @@
 	/* 		mcp_p->object[mcp_oid]->p_mat=(struct t_material *)new_p; */
 						/*  dirty, but it's just a pointer after all ... */
 			p->mcp_oid=mcp_oid;
-			dprintf(LOW,"process %d now has mcp_oid %d",p->id,mcp_oid);
+			s3dprintf(LOW,"process %d now has mcp_oid %d",p->id,mcp_oid);
 			mcp_rep_object(mcp_oid);
 			if (mcp_p->con_type==CON_NULL)
 			{  /*  there is no mcp connected! setting focus to the new program: */
 				mcp_focus(mcp_oid);
 			}
 		} else {
-			dprintf(LOW,"couldn't add object to mcp ...");
+			s3dprintf(LOW,"couldn't add object to mcp ...");
 		}
 	}
 	return(p);
@@ -123,8 +123,8 @@
 		p->object[ptr]->oflags=OF_POINTER;
 		link_insert(p,ptr,cam);
 	}
-	dprintf(MED,"process_sys_init(): added object cam0 %d",cam);
-	dprintf(MED,"process_sys_init(): added object ptr0 %d",ptr);
+	s3dprintf(MED,"process_sys_init(): added object cam0 %d",cam);
+	s3dprintf(MED,"process_sys_init(): added object ptr0 %d",ptr);
 	obj_pos_update(get_proc_by_pid(MCP),cam,cam);
 	obj_pos_update(get_proc_by_pid(MCP),ptr,ptr);
 /*	obj_recalc_tmat(p,0);*/
@@ -228,7 +228,7 @@
 		 /*  the mcp keeps in our memory ... */
 		 /*  so we just delete the objects added */
 		 /*  by the last mcp */
-		dprintf(MED,"clean up mcp's junk ...");
+		s3dprintf(MED,"clean up mcp's junk ...");
 		for (i=0;i<p->n_obj;i++)
 		{
 			if (p->object[i]!=NULL)
@@ -252,10 +252,10 @@
 int process_quit()
 {
 	int i;
-	dprintf(HIGH,"telling %d processes to go away",procs_n);
+	s3dprintf(HIGH,"telling %d processes to go away",procs_n);
 	for (i=(procs_n-1);i>=0;i--)
 	{ 
-		dprintf(HIGH,"[QUIT] for %d",i);
+		s3dprintf(HIGH,"[QUIT] for %d",i);
 		event_quit(&procs_p[i]);
 /*		process_del(procs_p[i].id);*/
 	}

Modified: trunk/server/proto.c
===================================================================
--- trunk/server/proto.c	2006-06-04 18:55:53 UTC (rev 329)
+++ trunk/server/proto.c	2006-06-04 20:27:36 UTC (rev 330)
@@ -59,19 +59,19 @@
 								 /*  the mcp */
 		if ((mcp_oid==-1) && (command!=S3D_P_C_INIT))
 		{
-			dprintf(MED,"prot_com_in(): commands without beeing initialized ?! no way, kicking ...");
+			s3dprintf(MED,"prot_com_in(): commands without beeing initialized ?! no way, kicking ...");
 			event_quit(p);
 		}
 	} 
 	length=ntohs(*((uint16_t *)((uint8_t *)pbuf+1)));
 	cptr=buf=pbuf+3;
-/* 	if (mcp_oid==-1) dprintf(HIGH,"couldn't find mcp-oid for pid %d!",p->id); */
+/* 	if (mcp_oid==-1) s3dprintf(HIGH,"couldn't find mcp-oid for pid %d!",p->id); */
 		switch (command) {
 			case S3D_P_C_INIT:
 				memset(name,0,NAME_MAX);
 				if (length>NAME_MAX) i=NAME_MAX; else i=length;
 				strncpy(name,(char *)buf,i);
-				dprintf(LOW,"[%d]\"%s\" logged in", p->id,name);
+				s3dprintf(LOW,"[%d]\"%s\" logged in", p->id,name);
 				if (NULL==(np=process_protinit(p,name)))
 					event_quit(p);  /*  couldn't get process */
 				else
@@ -79,7 +79,7 @@
 				break;
 			case S3D_P_C_NEW_OBJ:
 				oid=htonl(obj_new(p));
-/* 				dprintf(LOW,"pid %d registering new object %d",p->id,ntohl(oid)); */
+/* 				s3dprintf(LOW,"pid %d registering new object %d",p->id,ntohl(oid)); */
 				prot_com_out(p,S3D_P_S_NEWOBJ,(uint8_t *)&oid, 4);
 				break;
 			case S3D_P_C_DEL_OBJ:
@@ -111,7 +111,7 @@
 				}
 				break;
 			case S3D_P_C_QUIT:
-				dprintf(LOW,"QUIT issued");
+				s3dprintf(LOW,"QUIT issued");
 				event_quit(p);
 				break;
 			case S3D_P_C_PUSH_VERTEX:
@@ -119,7 +119,7 @@
 				{
 					oid=ntohl(*((uint32_t *)cptr));		cptr+=4;
 					num=(length-4)/(4*3);
-/* 					dprintf(LOW,"received %d new vertices for object oid...%d", num, oid); */
+/* 					s3dprintf(LOW,"received %d new vertices for object oid...%d", num, oid); */
 					obj_push_vertex(p,oid, (float  *)cptr, num);
 				}
 				break;
@@ -128,7 +128,7 @@
 				{
 					oid=ntohl(*((uint32_t *)cptr));		cptr+=4;
 					num=(length-4)/(4*12);
-/* 					dprintf(LOW,"received %d new materials for object oid...%d", num, oid); */
+/* 					s3dprintf(LOW,"received %d new materials for object oid...%d", num, oid); */
 					obj_push_mat(p,oid, (float *)cptr, num);
 				}
 				break;
@@ -137,7 +137,7 @@
 				{
 					oid=ntohl(*((uint32_t *)cptr));		cptr+=4;
 					num=(length-4)/(4*4);
-/* 					dprintf(LOW,"received %d new polygons for object oid...%d", num, oid); */
+/* 					s3dprintf(LOW,"received %d new polygons for object oid...%d", num, oid); */
 					for (i=0;i<(num*4);i++)
 						*((uint32_t *)cptr+i)=
 								ntohl(*((uint32_t *)cptr+i));
@@ -150,7 +150,7 @@
 				{
 					oid=ntohl(*((uint32_t *)cptr));		cptr+=4;
 					num=(length-4)/(4*3);
- 					dprintf(VLOW,"received %d new lines for object oid...%d", num, oid); 
+ 					s3dprintf(VLOW,"received %d new lines for object oid...%d", num, oid); 
 					for (i=0;i<(num*3);i++)
 						*((uint32_t *)cptr+i)=
 								ntohl(*((uint32_t *)cptr+i));
@@ -163,7 +163,7 @@
 				{
 					oid=ntohl(*((uint32_t *)cptr));		cptr+=4;
 					num=(length-4)/(2*2);
-					dprintf(LOW,"received %d new textures for object oid...%d", num, oid);
+					s3dprintf(LOW,"received %d new textures for object oid...%d", num, oid);
 					for (i=0;i<(num*2);i++)
 						*((uint16_t *)cptr+i)=
 								ntohs(*((uint16_t *)cptr+i));
@@ -176,7 +176,7 @@
 				{
 					oid=ntohl(*((uint32_t *)cptr));		cptr+=4;
 					num=(length-4)/(9*4);
-					dprintf(VLOW,"PEP_POLY_NORMAL[%d]: oid %d, %f polys",length,oid, (length-4)/(9.0*4.0));
+					s3dprintf(VLOW,"PEP_POLY_NORMAL[%d]: oid %d, %f polys",length,oid, (length-4)/(9.0*4.0));
 					obj_pep_poly_normal(p,oid, (float *)cptr, num);
 				}
 				break;
@@ -185,7 +185,7 @@
 				{
 					oid=ntohl(*((uint32_t *)cptr));		cptr+=4;
 					num=(length-4)/(6*4);
-					dprintf(VLOW,"PEP_LINE_NORMAL[%d]: oid %d, %.1f lines",length,oid, (length-4)/(6.0*4.0));
+					s3dprintf(VLOW,"PEP_LINE_NORMAL[%d]: oid %d, %.1f lines",length,oid, (length-4)/(6.0*4.0));
 					obj_pep_line_normal(p,oid, (float *)cptr, num);
 				}
 				break;
@@ -194,7 +194,7 @@
 				{
 					oid=ntohl(*((uint32_t *)cptr));		cptr+=4;
 					num=(length-4)/(6*4);
-					dprintf(VLOW,"PEP_POLY_TEXC[%d]: oid %d, %f polys",length,oid, (length-4)/(6.0*4.0));
+					s3dprintf(VLOW,"PEP_POLY_TEXC[%d]: oid %d, %f polys",length,oid, (length-4)/(6.0*4.0));
 					obj_pep_poly_texc(p,oid, (float *)cptr, num);
 				}
 				break;
@@ -203,7 +203,7 @@
 				{
 					oid=ntohl(*((uint32_t *)cptr));		cptr+=4;
 					num=(length-4)/(4*12);
-					dprintf(VLOW,"PEP_MAT[%d]: %d materials for object oid...%d", length, num, oid);
+					s3dprintf(VLOW,"PEP_MAT[%d]: %d materials for object oid...%d", length, num, oid);
 					obj_pep_mat(p,oid, (float *)cptr, num);
 				}
 				break;
@@ -212,7 +212,7 @@
 				{
 					oid=ntohl(*((uint32_t *)cptr));		cptr+=4;
 					num=(length-4)/(4*3);
- 					dprintf(VLOW,"pepping %d new vertices for object oid...%d", num, oid); 
+ 					s3dprintf(VLOW,"pepping %d new vertices for object oid...%d", num, oid); 
 					obj_pep_vertex(p,oid, (float  *)cptr, num);
 				}
 				break;
@@ -222,7 +222,7 @@
 				{
 					oid=ntohl(*((uint32_t *)cptr));		cptr+=4;
 					num=(length-4)/(4);
-					dprintf(VLOW,"PEP_MAT_TEX[%d]: %d materials for object oid...%d", length, num, oid);
+					s3dprintf(VLOW,"PEP_MAT_TEX[%d]: %d materials for object oid...%d", length, num, oid);
 					obj_pep_mat_tex(p,oid, (uint32_t *)cptr, num);
 				}
 				break;
@@ -231,7 +231,7 @@
 				{
 					oid=ntohl(*((uint32_t *)cptr));		cptr+=4;
 					num=(length-4)/(4*3);
- 					dprintf(VLOW,"pepping %d new lines for object oid...%d", num, oid); 
+ 					s3dprintf(VLOW,"pepping %d new lines for object oid...%d", num, oid); 
 					for (i=0;i<(num*3);i++)
 						*((uint32_t *)cptr+i)=
 								ntohl(*((uint32_t *)cptr+i));
@@ -244,7 +244,7 @@
 					oid=ntohl(*((uint32_t *)cptr));		cptr+=4;
 					toid=ntohl(*((uint32_t *)cptr));		cptr+=4;
 					num=(length-8)/(6*4);
-					dprintf(VLOW,"LOAD_POLY_NORMAL[%d]: oid %d, %.2f lines",length,oid, (length-8)/(6.0*4.0));
+					s3dprintf(VLOW,"LOAD_POLY_NORMAL[%d]: oid %d, %.2f lines",length,oid, (length-8)/(6.0*4.0));
 					obj_load_line_normal(p,oid, (float *)cptr, toid, num);
 				}
 				break;
@@ -254,7 +254,7 @@
 					oid=ntohl(*((uint32_t *)cptr));		cptr+=4;
 					toid=ntohl(*((uint32_t *)cptr));		cptr+=4;
 					num=(length-8)/(9*4);
-					dprintf(MED,"LOAD_POLY_NORMAL[%d]: oid %d, %f polys",length,oid, (length-8)/(9.0*4.0));
+					s3dprintf(MED,"LOAD_POLY_NORMAL[%d]: oid %d, %f polys",length,oid, (length-8)/(9.0*4.0));
 					obj_load_poly_normal(p,oid, (float *)cptr, toid, num);
 				}
 				break;
@@ -264,7 +264,7 @@
 					oid=ntohl(*((uint32_t *)cptr));		cptr+=4;
 					toid=ntohl(*((uint32_t *)cptr));		cptr+=4;
 					num=(length-8)/(6*4);
-					dprintf(MED,"LOAD_POLY_TEXC[%d]: oid %d, %f polys",length,oid, (length-8)/(6.0*4.0));
+					s3dprintf(MED,"LOAD_POLY_TEXC[%d]: oid %d, %f polys",length,oid, (length-8)/(6.0*4.0));
 					obj_load_poly_texc(p,oid, (float *)cptr, toid, num);
 				}
 				break;
@@ -274,7 +274,7 @@
 					oid=ntohl(*((uint32_t *)cptr));		cptr+=4;
 					toid=ntohl(*((uint32_t *)cptr));		cptr+=4;
 					num=(length-8)/(4*12);
-					dprintf(LOW,"LOAD_MAT[%d]: %d materials for object oid...%d", length, num, oid);
+					s3dprintf(LOW,"LOAD_MAT[%d]: %d materials for object oid...%d", length, num, oid);
 					obj_load_mat(p,oid, (float *)cptr, toid, num);
 				}
 				break;
@@ -288,7 +288,7 @@
 					w=ntohs(*((uint16_t *)cptr));			cptr+=2;
 					h=ntohs(*((uint16_t *)cptr));			cptr+=2;
 					num=length-16;
-	 /* 				dprintf(MED,"LOAD_TEX[%d]: oid %d, texture %d, [%d x %d] data at [%d x %d] (%d = %d)",length, oid,toid,w,h,x,y,num,w*h*4,num); */
+	 /* 				s3dprintf(MED,"LOAD_TEX[%d]: oid %d, texture %d, [%d x %d] data at [%d x %d] (%d = %d)",length, oid,toid,w,h,x,y,num,w*h*4,num); */
 					if ((w*h*4)==num)  /*  check correct size */
 						obj_load_tex(p,oid, toid, x, y, w, h, cptr);
 				}
@@ -298,7 +298,7 @@
 				{
 					oid=ntohl(*((uint32_t *)cptr));		cptr+=4;
 					num=ntohl(*((uint32_t *)cptr));		cptr+=4;
-/* 					dprintf(LOW,"deleting %d vertices for object oid...%d", num, oid); */
+/* 					s3dprintf(LOW,"deleting %d vertices for object oid...%d", num, oid); */
 					obj_del_vertex(p,oid,num);
 				}
 				break;
@@ -307,7 +307,7 @@
 				{
 					oid=ntohl(*((uint32_t *)cptr));		cptr+=4;
 					num=ntohl(*((uint32_t *)cptr));		cptr+=4;
-/* 					dprintf(LOW,"deleting %d vertices for object oid...%d", num, oid); */
+/* 					s3dprintf(LOW,"deleting %d vertices for object oid...%d", num, oid); */
 					obj_del_poly(p,oid,num);
 				}	
 				break;
@@ -316,7 +316,7 @@
 				{
 					oid=ntohl(*((uint32_t *)cptr));		cptr+=4;
 					num=ntohl(*((uint32_t *)cptr));		cptr+=4;
- 					dprintf(VLOW,"deleting %d lines for object oid...%d", num, oid); 
+ 					s3dprintf(VLOW,"deleting %d lines for object oid...%d", num, oid); 
 					obj_del_line(p,oid,num);
 				}	
 				break;
@@ -326,7 +326,7 @@
 				{
 					oid=ntohl(*((uint32_t *)cptr));		cptr+=4;
 					num=ntohl(*((uint32_t *)cptr));		cptr+=4;
-/* 					dprintf(LOW,"deleting %d materials for object oid...%d", num, oid); */
+/* 					s3dprintf(LOW,"deleting %d materials for object oid...%d", num, oid); */
 					obj_del_mat(p,oid,num);
 				}
 				break;
@@ -335,7 +335,7 @@
 				{
 					oid=ntohl(*((uint32_t *)cptr));		cptr+=4;
 					num=ntohl(*((uint32_t *)cptr));		cptr+=4;
-/* 					dprintf(LOW,"deleting %d textures for object oid...%d", num, oid); */
+/* 					s3dprintf(LOW,"deleting %d textures for object oid...%d", num, oid); */
 					obj_del_tex(p,oid,num);
 				}
 				break;
@@ -377,7 +377,7 @@
 				}
 				break;
 			default:
-				dprintf(LOW,"don't know this command (%d)",command);
+				s3dprintf(LOW,"don't know this command (%d)",command);
 		}
 	return(0);
 }
@@ -394,7 +394,7 @@
 			memcpy(obuf+3,buf,length);
 		if (n_writen(p,obuf,length+3)<0)
 		{
-			dprintf(LOW,"prot_com_out():n_writen(): connection seems to be dead (pid %d)", p->id);
+			s3dprintf(LOW,"prot_com_out():n_writen(): connection seems to be dead (pid %d)", p->id);
 			process_del(p->id);
 		}
 		return(0);

Modified: trunk/server/shm.c
===================================================================
--- trunk/server/shm.c	2006-06-04 18:55:53 UTC (rev 329)
+++ trunk/server/shm.c	2006-06-04 20:27:36 UTC (rev 330)
@@ -68,7 +68,7 @@
 		errnf("shm_init():ftok()",errno);
 		return(1);
 	}
-	dprintf(LOW,"shm_init(): init key is 0x%08x",key);
+	s3dprintf(LOW,"shm_init(): init key is 0x%08x",key);
 	mkey=next_key(key);
 	/* connect to (and possibly create) the segment: */
 	if ((shmid = shmget(key, SHM_SIZE, 0644 | IPC_CREAT)) == -1) {
@@ -104,7 +104,7 @@
 	mkey=next_key(mkey);
 	mycb->key_ctos=mkey;
 	mkey=next_key(mkey);
-	dprintf(MED,"shm_open_comblock():stoc: %08x, ctos: %08x",mycb->key_stoc,mycb->key_ctos);
+	s3dprintf(MED,"shm_open_comblock():stoc: %08x, ctos: %08x",mycb->key_stoc,mycb->key_ctos);
 	/* connect & create the client to server segment: */
 	if ((mycb->shmid_ctos = shmget(mycb->key_ctos, RB_STD_SIZE, 0644 | IPC_CREAT)) == -1) {
 		errn("shm_open_comblock:shmget()",errno);
@@ -132,17 +132,17 @@
 	data[0]=mycb->key_ctos;
 	data[1]=mycb->key_stoc;
 	mycb->idle=0;
-	dprintf(LOW,"shm_open_comblock():data: %08x, %08x",data[0],data[1]);
+	s3dprintf(LOW,"shm_open_comblock():data: %08x, %08x",data[0],data[1]);
 	return(0);	
 }
 
 int shm_quit()
 {
 	/* detach from the segment: */
-	dprintf(LOW,"shm_quit()...");
+	s3dprintf(LOW,"shm_quit()...");
 	unlink(ftoken);
 	data[0]=data[1]=0;
-	dprintf(MED,"shm_quit():removing init block");
+	s3dprintf(MED,"shm_quit():removing init block");
 	if (shmdt(data) == -1) 
 		errn("shm_quit():shmdt()",errno);
 	if (shmctl(shmid, IPC_RMID, NULL) == -1) 
@@ -151,8 +151,8 @@
 }
 int shm_remove(struct t_process *p)
 {
-	dprintf(MED,"shm_remove(): removing pid %d",p->id);
-	dprintf(MED,"shm_remove():freeing keys: %08x, %08x",p->shmsock.key_ctos,p->shmsock.key_stoc);
+	s3dprintf(MED,"shm_remove(): removing pid %d",p->id);
+	s3dprintf(MED,"shm_remove():freeing keys: %08x, %08x",p->shmsock.key_ctos,p->shmsock.key_stoc);
 	if (shmdt(p->shmsock.data_ctos) == -1) 
 		errn("shm_rmove():shmdt()",errno);
 	if (shmctl(p->shmsock.shmid_ctos, IPC_RMID, NULL) == -1) 
@@ -188,7 +188,7 @@
 						shmctl(procs_p[i].shmsock.shmid_ctos,IPC_STAT,&d);
 						if (d.shm_nattch==1) /* we're all alone ... remove it!! */
 						{
-							dprintf(MED,"client [%s] detached, removing ... ",procs_p[i].name);
+							s3dprintf(MED,"client [%s] detached, removing ... ",procs_p[i].name);
 							process_del(procs_p[i].id);
 						} else {
 							procs_p[i].shmsock.idle=0;
@@ -203,8 +203,8 @@
 		new_p=process_add();
 		new_p->con_type=CON_SHM;
 		memcpy(&new_p->shmsock,&waiting_comblock,sizeof(struct t_shmcb));
-		dprintf(HIGH,"shm_main():registered new connection (keys %d, %d) as pid %d",new_p->shmsock.key_ctos,new_p->shmsock.key_stoc, new_p->id);
-			dprintf(LOW,"shm_main():new client attached! allocating shm block for further clients ...");
+		s3dprintf(HIGH,"shm_main():registered new connection (keys %d, %d) as pid %d",new_p->shmsock.key_ctos,new_p->shmsock.key_stoc, new_p->id);
+			s3dprintf(LOW,"shm_main():new client attached! allocating shm block for further clients ...");
 			shm_new_comblock(data);
 		}
 	return(0);
@@ -219,7 +219,7 @@
 	if (3==shm_readn(dai,ibuf,3))
 	{
 		length=ntohs(*((uint16_t *)((uint8_t *)ibuf+1)));
-		dprintf(VLOW,"command %d, length %d",ibuf[0], length);
+		s3dprintf(VLOW,"command %d, length %d",ibuf[0], length);
 		if (length>0)
 		{
 			shm_readn(dai,ibuf+3,length);	  
@@ -242,7 +242,7 @@
 		buf += no_written;
 		if (wait++>SHM_MAXLOOP) 
 		{
-			dprintf(HIGH,"shm_writen():waited too long ...");
+			s3dprintf(HIGH,"shm_writen():waited too long ...");
 			return(-1);
 		}
 	}
@@ -263,7 +263,7 @@
 		buf += no_read;
 		if (wait++>SHM_MAXLOOP) 
 		{
-			dprintf(HIGH,"shm_readn():waited too long ...");
+			s3dprintf(HIGH,"shm_readn():waited too long ...");
 			return(-1);
 		}
 	}

Modified: trunk/server/tcp.c
===================================================================
--- trunk/server/tcp.c	2006-06-04 18:55:53 UTC (rev 329)
+++ trunk/server/tcp.c	2006-06-04 20:27:36 UTC (rev 330)
@@ -53,7 +53,7 @@
 {
 	int yes=1;
 	struct sockaddr_in my_addr;   
-	dprintf(LOW,"server: creating socket");
+	s3dprintf(LOW,"server: creating socket");
 #ifdef WIN32  /*  sohn wars */
 	WSADATA datainfo;
 	if (WSAStartup(257, &datainfo) != 0)
@@ -62,7 +62,7 @@
    if ((tcp_sockid = socket(AF_INET,SOCK_STREAM,0)) < 0)
      errnf("socket()", errno);
 
-   dprintf(LOW,"server: binding my local socket");
+   s3dprintf(LOW,"server: binding my local socket");
    /*  allow addresses to be reused */
    /*  this seems to have something to do with servers using one port */
    if ( setsockopt(tcp_sockid, SOL_SOCKET, SO_REUSEADDR, &yes, sizeof(int)) == -1 )
@@ -118,7 +118,7 @@
 	}
 	else 
 	if (FD_ISSET(tcp_sockid,&fs_port)) {  /* redundant, I guess */
-		dprintf(HIGH,"select(): new connection!!");
+		s3dprintf(HIGH,"select(): new connection!!");
         if ((newsd = accept(tcp_sockid ,(struct sockaddr *) &client_addr,&clilen)) < 0)
 			 errn("accept()",errno);
 		else 
@@ -132,7 +132,7 @@
 			new_p=process_add();
 			new_p->con_type=CON_TCP;
 			new_p->sockid=newsd;
-			dprintf(HIGH,"registered new connection %d as pid %d",new_p->sockid, new_p->id);
+			s3dprintf(HIGH,"registered new connection %d as pid %d",new_p->sockid, new_p->id);
 		}
 	}
 	return(0);
@@ -207,7 +207,7 @@
 	if (3==tcp_readn(p->sockid, ibuf,3))
 	{
 		length=ntohs(*((uint16_t *)((uint8_t *)ibuf+1)));
-		dprintf(VLOW,"command %d, length %d",ibuf[0], length);
+		s3dprintf(VLOW,"command %d, length %d",ibuf[0], length);
 		if (length>0)
 		{
 			tcp_readn(p->sockid,ibuf+3,length);	  /*  uint16_t is limited to 65536, so  */
@@ -215,7 +215,7 @@
 		}
 		prot_com_in(p,ibuf);
 	} else {
-		dprintf(LOW,"tcp_prot_com_in():n_readn():fd seems to be dead (pid %d, sock %d)", p->id, p->sockid);
+		s3dprintf(LOW,"tcp_prot_com_in():n_readn():fd seems to be dead (pid %d, sock %d)", p->id, p->sockid);
 		process_del(p->id);
 	}
 	return(0);

Modified: trunk/server/user.c
===================================================================
--- trunk/server/user.c	2006-06-04 18:55:53 UTC (rev 329)
+++ trunk/server/user.c	2006-06-04 20:27:36 UTC (rev 330)
@@ -84,7 +84,7 @@
 					navi_back();
 					break;
 				default:
-					dprintf(VLOW,"button is ... %d", button);
+					s3dprintf(VLOW,"button is ... %d", button);
 			}
 			ox=x;
 			oy=y;
@@ -93,7 +93,7 @@
 		case 1:  /*  mouse up */
 			ox=oy=0xFFFFFF;
 			event_mbutton_clicked(button,state);
-	/*		dprintf(LOW,"state is: %d,button is %d",state,button);*/
+	/*		s3dprintf(LOW,"state is: %d,button is %d",state,button);*/
 			break;
 		case 2:	 /*  mouse still down */
 			switch (button)
@@ -113,7 +113,7 @@
 					navi_back();
 					break;
 				default:
-					dprintf(VLOW,"button is ... %d", button);
+					s3dprintf(VLOW,"button is ... %d", button);
 			}
 			ox=x;
 			oy=y;

Modified: trunk/server/user_glut.c
===================================================================
--- trunk/server/user_glut.c	2006-06-04 18:55:53 UTC (rev 329)
+++ trunk/server/user_glut.c	2006-06-04 20:27:36 UTC (rev 330)
@@ -34,7 +34,7 @@
 /*  init user input things for glut */
 int user_init_glut()
 {
-	dprintf(MED,"using GLUT for user input");
+	s3dprintf(MED,"using GLUT for user input");
 	glutKeyboardFunc (keyboard);
 	glutSpecialFunc (special);
 	glutMouseFunc (user_mouse);
@@ -76,7 +76,7 @@
 		case GLUT_KEY_INSERT: 	mkey=S3DK_INSERT;break;
 		default: 				mkey=skey; break;
 	}
-	dprintf(MED,"special(): %d -> %d",skey,mkey);
+	s3dprintf(MED,"special(): %d -> %d",skey,mkey);
 	user_key(mkey,0,0,0);
 	user_key(mkey,0,0,1);
 }

Modified: trunk/server/user_sdl.c
===================================================================
--- trunk/server/user_sdl.c	2006-06-04 18:55:53 UTC (rev 329)
+++ trunk/server/user_sdl.c	2006-06-04 20:27:36 UTC (rev 330)
@@ -40,7 +40,7 @@
 	switch (event.type)
 	{
 		case SDL_MOUSEMOTION: 
-/* 			dprintf(VLOW,"Current mouse position is: (%d, %d),button %d", event.motion.x, event.motion.y,event.button.button); */
+/* 			s3dprintf(VLOW,"Current mouse position is: (%d, %d),button %d", event.motion.x, event.motion.y,event.button.button); */
 			 switch (event.button.button)
 			 {
 			 	case SDL_BUTTON_LEFT:
@@ -59,7 +59,7 @@
 					break;
 					 /*  no button ... */
 				default:
-					dprintf(LOW,"don't know button %d", event.button.button);
+					s3dprintf(LOW,"don't know button %d", event.button.button);
 
 			 }
 			break;
@@ -77,7 +77,7 @@
 				case SDL_BUTTON_WHEELDOWN:
 			 		user_mouse(4,0,event.motion.x,event.motion.y);break;
 				default:
-					dprintf(LOW,"don't know button %d", event.button.button);
+					s3dprintf(LOW,"don't know button %d", event.button.button);
 			 }
 			 break;
 		case SDL_MOUSEBUTTONUP:
@@ -94,7 +94,7 @@
 				case SDL_BUTTON_WHEELDOWN:
 			 		user_mouse(4,1,event.motion.x,event.motion.y);break;
 				default:
-					dprintf(LOW,"don't know button %d", event.button.button);
+					s3dprintf(LOW,"don't know button %d", event.button.button);
 			 }
 			 break;
 
@@ -105,25 +105,25 @@
 			user_key(event.key.keysym.sym,event.key.keysym.unicode,event.key.keysym.mod,1);
 			break;
 		case SDL_QUIT:
-			dprintf(HIGH,"SDL_QUIT");
+			s3dprintf(HIGH,"SDL_QUIT");
 			quit();
 			break;
 		 /*  these events are not processed right now ... */
-		case SDL_ACTIVEEVENT:		dprintf(VLOW,"SDL_ACTIVEEVENT");break;
-		case SDL_SYSWMEVENT:		dprintf(VLOW,"SDL_SYSWMEVENT");break;
+		case SDL_ACTIVEEVENT:		s3dprintf(VLOW,"SDL_ACTIVEEVENT");break;
+		case SDL_SYSWMEVENT:		s3dprintf(VLOW,"SDL_SYSWMEVENT");break;
 		case SDL_VIDEORESIZE:		if ((GLwin = SDL_SetVideoMode(event.resize.w,event.resize.h,16,SDLFlags))==NULL) 
 										errsf("SDL_SetVideoMode()",SDL_GetError());
 									graphics_reshape(event.resize.w,event.resize.h);
 									break;
-		case SDL_VIDEOEXPOSE:		dprintf(LOW,"SDL_VIDEOEXPOSE");break;
-		case SDL_USEREVENT:			dprintf(VLOW,"SDL_USEREVENT");break;
-		case SDL_JOYAXISMOTION:		dprintf(VLOW,"SDL_JOYAXISMOTION");break;
-		case SDL_JOYBALLMOTION:		dprintf(VLOW,"SDL_JOYBALLMOTION");break;
-		case SDL_JOYHATMOTION:		dprintf(VLOW,"SDL_JOYHATMOTION");break;
-		case SDL_JOYBUTTONDOWN:		dprintf(VLOW,"SDL_JOYBUTTONDOWN");break;
-		case SDL_JOYBUTTONUP:		dprintf(VLOW,"SDL_JOYBUTTONUP");break;
+		case SDL_VIDEOEXPOSE:		s3dprintf(LOW,"SDL_VIDEOEXPOSE");break;
+		case SDL_USEREVENT:			s3dprintf(VLOW,"SDL_USEREVENT");break;
+		case SDL_JOYAXISMOTION:		s3dprintf(VLOW,"SDL_JOYAXISMOTION");break;
+		case SDL_JOYBALLMOTION:		s3dprintf(VLOW,"SDL_JOYBALLMOTION");break;
+		case SDL_JOYHATMOTION:		s3dprintf(VLOW,"SDL_JOYHATMOTION");break;
+		case SDL_JOYBUTTONDOWN:		s3dprintf(VLOW,"SDL_JOYBUTTONDOWN");break;
+		case SDL_JOYBUTTONUP:		s3dprintf(VLOW,"SDL_JOYBUTTONUP");break;
 		default:
-			dprintf(MED,"SDL_PollEvent(): unhandled event");
+			s3dprintf(MED,"SDL_PollEvent(): unhandled event");
 		 	break;
 	  }
   }



From dotslash at berlios.de  Sun Jun  4 23:14:39 2006
From: dotslash at berlios.de (dotslash at BerliOS)
Date: Sun, 4 Jun 2006 23:14:39 +0200
Subject: [S3d-svn] r331 - in trunk: . libs3d/libg3d/plugins/image
Message-ID: <200606042114.k54LEdWg024409@sheep.berlios.de>

Author: dotslash
Date: 2006-06-04 23:14:38 +0200 (Sun, 04 Jun 2006)
New Revision: 331

Removed:
   trunk/libs3d/libg3d/plugins/image/img_gdkpixbuf.c
Modified:
   trunk/
Log:
 r704 at balthasar:  dotslash | 2006-06-04 23:14:26 +0200
 - kick out gdk



Property changes on: trunk
___________________________________________________________________
Name: svk:merge
   - bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:701
   + bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:704

Deleted: trunk/libs3d/libg3d/plugins/image/img_gdkpixbuf.c
===================================================================
--- trunk/libs3d/libg3d/plugins/image/img_gdkpixbuf.c	2006-06-04 20:27:36 UTC (rev 330)
+++ trunk/libs3d/libg3d/plugins/image/img_gdkpixbuf.c	2006-06-04 21:14:38 UTC (rev 331)
@@ -1,124 +0,0 @@
-/* $Id: img_gdkpixbuf.c,v 1.1.2.3 2006/01/23 16:44:28 dahms Exp $ */
-
-/*
-    libg3d - 3D object loading library
-
-    Copyright (C) 2005, 2006  Markus Dahms <mad at automagically.de>
-
-    This library is free software; you can redistribute it and/or
-    modify it under the terms of the GNU Lesser General Public
-    License as published by the Free Software Foundation; either
-    version 2.1 of the License, or (at your option) any later version.
-
-    This library is distributed in the hope that it will be useful,
-    but WITHOUT ANY WARRANTY; without even the implied warranty of
-    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
-    Lesser General Public License for more details.
-
-    You should have received a copy of the GNU Lesser General Public
-    License along with this library; if not, write to the Free Software
-    Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
-*/
-
-#include <stdio.h>
-#include <string.h>
-#include <errno.h>
-
-#include <gdk-pixbuf/gdk-pixbuf.h>
-
-#include <g3d/types.h>
-
-gboolean plugin_load_image(G3DContext *context, const gchar *filename,
-	G3DImage *image, gpointer user_data)
-{
-	GdkPixbuf *pixbuf;
-	guint32 x, y, nchannels;
-	guchar *p;
-
-	pixbuf = gdk_pixbuf_new_from_file(filename, NULL);
-	if(pixbuf == NULL)
-	{
-		g_warning("failed to load '%s'", filename);
-		return FALSE;
-	}
-
-	if(gdk_pixbuf_get_colorspace(pixbuf) != GDK_COLORSPACE_RGB)
-	{
-		g_warning("GdkPixbuf: %s: colorspace is not RGB", filename);
-		gdk_pixbuf_unref(pixbuf);
-		return FALSE;
-	}
-
-	nchannels = gdk_pixbuf_get_n_channels(pixbuf);
-	if(nchannels < 3)
-	{
-		g_warning("GdkPixbuf: %s: has only %d channels", filename,
-			gdk_pixbuf_get_n_channels(pixbuf));
-		gdk_pixbuf_unref(pixbuf);
-		return FALSE;
-	}
-
-	image->width = gdk_pixbuf_get_width(pixbuf);
-	image->height = gdk_pixbuf_get_height(pixbuf);
-	image->depth = 32;
-	image->name = g_path_get_basename(filename);
-	image->pixeldata = g_new0(guint8, image->width * image->height * 4);
-
-	for(y = 0; y < image->height; y ++)
-		for(x = 0; x < image->width; x ++)
-		{
-			p = gdk_pixbuf_get_pixels(pixbuf) + y *
-				gdk_pixbuf_get_rowstride(pixbuf) + x * nchannels;
-
-			image->pixeldata[(y * image->width + x) * 4 + 0] = p[0];
-			image->pixeldata[(y * image->width + x) * 4 + 1] = p[1];
-			image->pixeldata[(y * image->width + x) * 4 + 2] = p[2];
-			if(gdk_pixbuf_get_n_channels(pixbuf) >= 4)
-				image->pixeldata[(y * image->width + x) * 4 + 3] = p[3];
-		}
-
-	/* set alpha to 1.0 */
-	if(gdk_pixbuf_get_n_channels(pixbuf) < 4)
-		for(y = 0; y < image->height; y ++)
-			for(x = 0; x < image->width; x ++)
-				image->pixeldata[(y * image->width + x) * 4 + 3] = 0xFF;
-
-	gdk_pixbuf_unref(pixbuf);
-
-#if DEBUG > 0
-	g_print("GdkPixbuf: image '%s' loaded (%dx%d)\n",
-		image->name, image->width, image->height);
-#endif
-
-	return TRUE;
-}
-
-gchar *plugin_description(G3DContext *context)
-{
-	return g_strdup("plugin to read images using the GdkPixbuf library");
-}
-
-gchar **plugin_extensions(G3DContext *context)
-{
-	gchar *extensions = g_strdup("");
-	gchar **retval;
-	gchar *tmp;
-	GSList *fitem;
-	GdkPixbufFormat *format;
-
-	fitem = gdk_pixbuf_get_formats();
-	while(fitem)
-	{
-		format = (GdkPixbufFormat *)fitem->data;
-		tmp = g_strdup_printf("%s%s%s", extensions,
-			strlen(extensions) ? ":" : "",
-			g_strjoinv(":", gdk_pixbuf_format_get_extensions(format)));
-		g_free(extensions);
-		extensions = tmp;
-		fitem = fitem->next;
-	}
-
-	retval = g_strsplit(extensions, ":", 0);
-	g_free(extensions);
-	return retval;
-}



From dotslash at berlios.de  Mon Jun  5 00:35:43 2006
From: dotslash at berlios.de (dotslash at BerliOS)
Date: Mon, 5 Jun 2006 00:35:43 +0200
Subject: [S3d-svn] r332 - in trunk: . libs3d libs3d/libg3d/src server
Message-ID: <200606042235.k54MZhWu003604@sheep.berlios.de>

Author: dotslash
Date: 2006-06-05 00:35:40 +0200 (Mon, 05 Jun 2006)
New Revision: 332

Removed:
   trunk/ROADMAP
Modified:
   trunk/
   trunk/libs3d/3dsread.c
   trunk/libs3d/freetype.c
   trunk/libs3d/libg3d/src/plugins.c
   trunk/server/graphics.c
Log:
 r706 at balthasar:  dotslash | 2006-06-05 00:35:30 +0200
 - enable backface culling (only front face is displayed)
 - repair 3dsreader and freetype for this (please check your programs)
 - delete ROADMAP, it's not needed anymore



Property changes on: trunk
___________________________________________________________________
Name: svk:merge
   - bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:704
   + bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:706

Deleted: trunk/ROADMAP
===================================================================
--- trunk/ROADMAP	2006-06-04 21:14:38 UTC (rev 331)
+++ trunk/ROADMAP	2006-06-04 22:35:40 UTC (rev 332)
@@ -1,7 +0,0 @@
-Release 0.1: (deadline: 19.03.06)
-
-* egoshooter-like movement (switchable on mcp)
-* some documentation (rc-file, api ...)
-* get everything stable :) (at least as much as possible ...)
-* implement object path
-

Modified: trunk/libs3d/3dsread.c
===================================================================
--- trunk/libs3d/3dsread.c	2006-06-04 21:14:38 UTC (rev 331)
+++ trunk/libs3d/3dsread.c	2006-06-04 22:35:40 UTC (rev 332)
@@ -356,8 +356,8 @@
 		    for (j=0; j<polynum; j++)
 			{
 				poly_buf[j*4+0]=vertex_offset+gints(ptr+0); 
-				poly_buf[j*4+1]=vertex_offset+gints(ptr+2);
-				poly_buf[j*4+2]=vertex_offset+gints(ptr+4);
+				poly_buf[j*4+1]=vertex_offset+gints(ptr+4);
+				poly_buf[j*4+2]=vertex_offset+gints(ptr+2);
 				poly_buf[j*4+3]=col_obj;  /*  we should have a default material .... */
 				ptr+=sizeof(unsigned short)*4;
 		    }

Modified: trunk/libs3d/freetype.c
===================================================================
--- trunk/libs3d/freetype.c	2006-06-04 21:14:38 UTC (rev 331)
+++ trunk/libs3d/freetype.c	2006-06-04 22:35:40 UTC (rev 332)
@@ -258,8 +258,8 @@
 				for (i=0;i<np;i++)
 				{
 					tess_buf[a].pbuf[k*4]=  triangles[i][0]+ncsta[c]-1;
-					tess_buf[a].pbuf[k*4+1]=triangles[i][1]+ncsta[c]-1;
-					tess_buf[a].pbuf[k*4+2]=triangles[i][2]+ncsta[c]-1;
+					tess_buf[a].pbuf[k*4+1]=triangles[i][2]+ncsta[c]-1;
+					tess_buf[a].pbuf[k*4+2]=triangles[i][1]+ncsta[c]-1;
 					tess_buf[a].pbuf[k*4+3]=0;
 					k++;
 				}

Modified: trunk/libs3d/libg3d/src/plugins.c
===================================================================
--- trunk/libs3d/libg3d/src/plugins.c	2006-06-04 21:14:38 UTC (rev 331)
+++ trunk/libs3d/libg3d/src/plugins.c	2006-06-04 22:35:40 UTC (rev 332)
@@ -158,6 +158,7 @@
 	context->exts_import = g_hash_table_new(g_str_hash, g_str_equal);
 	context->exts_image = g_hash_table_new(g_str_hash, g_str_equal);
 
+	printf("Loading plugins from " PLUGIN_DIR "\n");
 	plugins_loaddirectory(context, PLUGIN_DIR "/image");
 	plugins_loaddirectory(context, PLUGIN_DIR "/import");
 	return TRUE;

Modified: trunk/server/graphics.c
===================================================================
--- trunk/server/graphics.c	2006-06-04 21:14:38 UTC (rev 331)
+++ trunk/server/graphics.c	2006-06-04 22:35:40 UTC (rev 332)
@@ -96,6 +96,10 @@
 /* 	glMaterialfv(GL_FRONT_AND_BACK,GL_SHININESS,shin); */
 	glMaterialfv(GL_FRONT,GL_SHININESS,shin);
 	graphics_reshape(X_RES,Y_RES);
+
+	/* face culling */
+	glCullFace(GL_FRONT);
+	glEnable(GL_CULL_FACE);
 	return(0);
 }
 /*  this is to be called when the window is resized or created ... */
@@ -344,7 +348,8 @@
 {
 	struct t_process *p=get_proc_by_pid(MCP);
 	t_mtrx m;
-	GLfloat pos[]={100.0,20.0,100.0,1.0};
+/*	GLfloat pos[]={100.0,20.0,100.0,1.0};*/
+	GLfloat pos[]={0,20,0,1.0};
 	GLfloat light0_spec[]={0.7,0.7,0.7,0.0};
 	GLfloat light0_shininess[] ={50.0};
 	GLfloat light0_diff[]={0.5,0.5,0.5,1.0};
@@ -371,6 +376,7 @@
 	myInvert();
 	myGetMatrix(m);
 	glMultMatrixf(m);
+	glLightfv(GL_LIGHT0,GL_POSITION,pos);
 	
 	/*glRotatef(-cam.rotate.z, 0.0,0.0,1.0);
 	glRotatef(-cam.rotate.x, 1.0,0.0,0.0);
@@ -378,7 +384,6 @@
 	glTranslatef(-cam.translate.x,-cam.translate.y,-cam.translate.z);*/
 
  	glPushMatrix();  /*  save the cam */ 
-		glLightfv(GL_LIGHT0,GL_POSITION,pos);
 		render_by_mcp();
 /*
 #ifdef DEBUG



From dotslash at berlios.de  Mon Jun  5 00:42:56 2006
From: dotslash at berlios.de (dotslash at BerliOS)
Date: Mon, 5 Jun 2006 00:42:56 +0200
Subject: [S3d-svn] r333 - in trunk: . apps/s3d_x11gate apps/s3dvt
Message-ID: <200606042242.k54MguI1005210@sheep.berlios.de>

Author: dotslash
Date: 2006-06-05 00:42:54 +0200 (Mon, 05 Jun 2006)
New Revision: 333

Modified:
   trunk/
   trunk/apps/s3d_x11gate/s3d_x11gate.c
   trunk/apps/s3dvt/main.c
Log:
 r708 at balthasar:  dotslash | 2006-06-05 00:42:38 +0200
 - satisfy new polygon order



Property changes on: trunk
___________________________________________________________________
Name: svk:merge
   - bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:706
   + bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:708

Modified: trunk/apps/s3d_x11gate/s3d_x11gate.c
===================================================================
--- trunk/apps/s3d_x11gate/s3d_x11gate.c	2006-06-04 22:35:40 UTC (rev 332)
+++ trunk/apps/s3d_x11gate/s3d_x11gate.c	2006-06-04 22:42:54 UTC (rev 333)
@@ -196,14 +196,14 @@
 						0.8,	0.0,	0.0	,1.0,
 						1.0,	1.0,	1.0	,1.0,
 						0.8,	0.0,	0.0	,1.0);
-		s3d_push_polygon(oid,0,1,2,0);
+		s3d_push_polygon(oid,0,2,1,0);
 		s3d_pep_polygon_tex_coord(oid, 0.0,1.0, 
-									   1.0,1.0,
+									   1.0,0.0,
+									   1.0,1.0);
+		s3d_push_polygon(oid,0,3,2,0);
+		s3d_pep_polygon_tex_coord(oid, 0.0,1.0, 
+									   0.0,0.0,
 									   1.0,0.0);
-		s3d_push_polygon(oid,0,2,3,0);
-		s3d_pep_polygon_tex_coord(oid, 0.0,1.0, 
-									   1.0,0.0,
-									   0.0,0.0);
 		s3d_push_texture(oid,width,height);
 					 /*  push data on texture 0 position (0,0) */
 		s3d_pep_material_texture(oid,0);	 /*  assign texture 0 to material 0 */

Modified: trunk/apps/s3dvt/main.c
===================================================================
--- trunk/apps/s3dvt/main.c	2006-06-04 22:35:40 UTC (rev 332)
+++ trunk/apps/s3dvt/main.c	2006-06-04 22:42:54 UTC (rev 333)
@@ -526,8 +526,8 @@
 	s3d_push_material_a(b,0.5,0.5,0.5,0.7,
 						  1,1,1,0.7,
 						  0,0,0,0.7);
-	s3d_push_polygon(b,1,0,2,0);
-	s3d_push_polygon(b,2,0,3,0);
+	s3d_push_polygon(b,1,2,0,0);
+	s3d_push_polygon(b,2,3,0,0);
 	s3d_flags_on(b,S3D_OF_VISIBLE);
 	return(b);
 }



From dotslash at berlios.de  Mon Jun  5 00:49:50 2006
From: dotslash at berlios.de (dotslash at BerliOS)
Date: Mon, 5 Jun 2006 00:49:50 +0200
Subject: [S3d-svn] r334 - in trunk: . server
Message-ID: <200606042249.k54MnoDb009206@sheep.berlios.de>

Author: dotslash
Date: 2006-06-05 00:49:49 +0200 (Mon, 05 Jun 2006)
New Revision: 334

Modified:
   trunk/
   trunk/server/graphics.c
Log:
 r710 at balthasar:  dotslash | 2006-06-05 00:49:42 +0200
 - move the light a bit



Property changes on: trunk
___________________________________________________________________
Name: svk:merge
   - bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:708
   + bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:710

Modified: trunk/server/graphics.c
===================================================================
--- trunk/server/graphics.c	2006-06-04 22:42:54 UTC (rev 333)
+++ trunk/server/graphics.c	2006-06-04 22:49:49 UTC (rev 334)
@@ -80,7 +80,8 @@
 	
 	/* polygon smoothing */
 	glDisable(GL_POLYGON_SMOOTH);
-/*    glHint(GL_POLYGON_SMOOTH_HINT, GL_NICEST); */
+/*    glEnable(GL_POLYGON_SMOOTH); 
+    glHint(GL_POLYGON_SMOOTH_HINT, GL_NICEST); */
 
 	/* normalizing */
 	glDisable(GL_AUTO_NORMAL);
@@ -349,7 +350,7 @@
 	struct t_process *p=get_proc_by_pid(MCP);
 	t_mtrx m;
 /*	GLfloat pos[]={100.0,20.0,100.0,1.0};*/
-	GLfloat pos[]={0,20,0,1.0};
+	GLfloat pos[]={0,20,1.0,1.0};
 	GLfloat light0_spec[]={0.7,0.7,0.7,0.0};
 	GLfloat light0_shininess[] ={50.0};
 	GLfloat light0_diff[]={0.5,0.5,0.5,1.0};



From dotslash at berlios.de  Mon Jun  5 15:52:34 2006
From: dotslash at berlios.de (dotslash at BerliOS)
Date: Mon, 5 Jun 2006 15:52:34 +0200
Subject: [S3d-svn] r335 - in trunk: . apps/s3dvt
Message-ID: <200606051352.k55DqYbo005893@sheep.berlios.de>

Author: dotslash
Date: 2006-06-05 15:52:02 +0200 (Mon, 05 Jun 2006)
New Revision: 335

Added:
   trunk/apps/s3dvt/TODO
Modified:
   trunk/
Log:
 r721 at balthasar:  dotslash | 2006-06-05 15:51:57 +0200
 - TODO



Property changes on: trunk
___________________________________________________________________
Name: svk:merge
   - bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:710
   + bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:721

Added: trunk/apps/s3dvt/TODO
===================================================================
--- trunk/apps/s3dvt/TODO	2006-06-04 22:49:49 UTC (rev 334)
+++ trunk/apps/s3dvt/TODO	2006-06-05 13:52:02 UTC (rev 335)
@@ -0,0 +1,4 @@
+- vim should work
+- ppl have to move around the terminal to view it properly
+- too big
+- multiple consoles?



From dotslash at berlios.de  Mon Jun  5 15:57:59 2006
From: dotslash at berlios.de (dotslash at BerliOS)
Date: Mon, 5 Jun 2006 15:57:59 +0200
Subject: [S3d-svn] r336 - in trunk: . apps/s3dfm
Message-ID: <200606051357.k55DvxCX018732@sheep.berlios.de>

Author: dotslash
Date: 2006-06-05 15:57:39 +0200 (Mon, 05 Jun 2006)
New Revision: 336

Modified:
   trunk/
   trunk/apps/s3dfm/box.c
Log:
 r723 at balthasar:  dotslash | 2006-06-05 15:57:36 +0200
 - repair s3dfm for backface culling



Property changes on: trunk
___________________________________________________________________
Name: svk:merge
   - bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:721
   + bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:723

Modified: trunk/apps/s3dfm/box.c
===================================================================
--- trunk/apps/s3dfm/box.c	2006-06-05 13:52:02 UTC (rev 335)
+++ trunk/apps/s3dfm/box.c	2006-06-05 13:57:39 UTC (rev 336)
@@ -211,8 +211,8 @@
 						0.5,0.5,0.6,
 						0.5,0.5,0.6);
 
-	s3d_push_polygon(dir->block,4,5,6,1);
-	s3d_push_polygon(dir->block,4,6,7,1);
+	s3d_push_polygon(dir->block,4,6,5,1);
+	s3d_push_polygon(dir->block,4,7,6,1);
 
 	s3d_push_polygon(dir->block,0,4,5,0);
 	s3d_push_polygon(dir->block,0,5,1,0);



From dotslash at berlios.de  Mon Jun  5 17:19:16 2006
From: dotslash at berlios.de (dotslash at BerliOS)
Date: Mon, 5 Jun 2006 17:19:16 +0200
Subject: [S3d-svn] r337 - in trunk: . apps/s3dfm libs3dw server
Message-ID: <200606051519.k55FJGje009264@sheep.berlios.de>

Author: dotslash
Date: 2006-06-05 17:19:15 +0200 (Mon, 05 Jun 2006)
New Revision: 337

Added:
   trunk/apps/s3dfm/TODO
Modified:
   trunk/
   trunk/libs3dw/TODO
   trunk/server/graphics.c
Log:
 r725 at balthasar:  dotslash | 2006-06-05 17:19:07 +0200
 - more TODO
 - move light position again



Property changes on: trunk
___________________________________________________________________
Name: svk:merge
   - bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:723
   + bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:725

Added: trunk/apps/s3dfm/TODO
===================================================================
--- trunk/apps/s3dfm/TODO	2006-06-05 13:57:39 UTC (rev 336)
+++ trunk/apps/s3dfm/TODO	2006-06-05 15:19:15 UTC (rev 337)
@@ -0,0 +1,4 @@
+- copy
+- delete
+- create directories
+- load 3dsfiles on click

Modified: trunk/libs3dw/TODO
===================================================================
--- trunk/libs3dw/TODO	2006-06-05 13:57:39 UTC (rev 336)
+++ trunk/libs3dw/TODO	2006-06-05 15:19:15 UTC (rev 337)
@@ -1 +1,3 @@
 - focus colors, focus cycling
+- let widgets move
+- rotate widgets to camera

Modified: trunk/server/graphics.c
===================================================================
--- trunk/server/graphics.c	2006-06-05 13:57:39 UTC (rev 336)
+++ trunk/server/graphics.c	2006-06-05 15:19:15 UTC (rev 337)
@@ -350,7 +350,7 @@
 	struct t_process *p=get_proc_by_pid(MCP);
 	t_mtrx m;
 /*	GLfloat pos[]={100.0,20.0,100.0,1.0};*/
-	GLfloat pos[]={0,20,1.0,1.0};
+	GLfloat pos[]={0,50,50,1.0};
 	GLfloat light0_spec[]={0.7,0.7,0.7,0.0};
 	GLfloat light0_shininess[] ={50.0};
 	GLfloat light0_diff[]={0.5,0.5,0.5,1.0};



From dotslash at berlios.de  Mon Jun  5 18:04:31 2006
From: dotslash at berlios.de (dotslash at BerliOS)
Date: Mon, 5 Jun 2006 18:04:31 +0200
Subject: [S3d-svn] r338 - in trunk: . libs3dw
Message-ID: <200606051604.k55G4VjM018092@sheep.berlios.de>

Author: dotslash
Date: 2006-06-05 18:04:31 +0200 (Mon, 05 Jun 2006)
New Revision: 338

Modified:
   trunk/
   trunk/libs3dw/s3dw.h
   trunk/libs3dw/widget.c
Log:
 r727 at balthasar:  dotslash | 2006-06-05 18:04:24 +0200
 - changes to move widgets



Property changes on: trunk
___________________________________________________________________
Name: svk:merge
   - bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:725
   + bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:727

Modified: trunk/libs3dw/s3dw.h
===================================================================
--- trunk/libs3dw/s3dw.h	2006-06-05 15:19:15 UTC (rev 337)
+++ trunk/libs3dw/s3dw.h	2006-06-05 16:04:31 UTC (rev 338)
@@ -126,11 +126,13 @@
 void 				 s3dw_input_change_text(s3dw_input *input, char *text);
 s3dw_surface 		*s3dw_surface_new(char *title, float width, float height);
 
-void s3dw_delete(s3dw_widget *widget);
-void s3dw_show(s3dw_widget *widget);
-void s3dw_focus(s3dw_widget *focus);
+s3dw_widget 		*s3dw_getroot();
+void				 s3dw_moveit(s3dw_widget *widget);
+void 				 s3dw_delete(s3dw_widget *widget);
+void 				 s3dw_show(s3dw_widget *widget);
+void 				 s3dw_focus(s3dw_widget *focus);
 
-void s3dw_handle_click(struct s3d_evt *evt);
-void s3dw_handle_key(struct s3d_evt *evt);
+void 				 s3dw_handle_click(struct s3d_evt *evt);
+void 				 s3dw_handle_key(struct s3d_evt *evt);
 
-void s3dw_ani_mate();
+void 				 s3dw_ani_mate();

Modified: trunk/libs3dw/widget.c
===================================================================
--- trunk/libs3dw/widget.c	2006-06-05 15:19:15 UTC (rev 337)
+++ trunk/libs3dw/widget.c	2006-06-05 16:04:31 UTC (rev 338)
@@ -133,3 +133,8 @@
 	widget->flags|=S3DW_ONSCREEN;
 	s3dwcb_show[widget->type](widget);
 }
+/* apply the moves ... */
+void				 s3dw_moveit(s3dw_widget *widget)
+{
+	s3dw_ani_add(widget);
+}



From dotslash at berlios.de  Mon Jun  5 18:07:33 2006
From: dotslash at berlios.de (dotslash at BerliOS)
Date: Mon, 5 Jun 2006 18:07:33 +0200
Subject: [S3d-svn] r339 - in trunk: . Documentation Documentation/libg3d Documentation/libg3d/api Documentation/libg3d/api/tmpl Documentation/s3dapi libs3d/libg3d
Message-ID: <200606051607.k55G7Xwh018607@sheep.berlios.de>

Author: dotslash
Date: 2006-06-05 18:07:32 +0200 (Mon, 05 Jun 2006)
New Revision: 339

Added:
   trunk/Documentation/libg3d/
   trunk/Documentation/libg3d/Makefile.am
   trunk/Documentation/libg3d/api/
   trunk/Documentation/libg3d/api/Makefile.am
   trunk/Documentation/libg3d/api/libg3d-docs.sgml
   trunk/Documentation/libg3d/api/libg3d-overrides.txt
   trunk/Documentation/libg3d/api/libg3d-sections.txt
   trunk/Documentation/libg3d/api/libg3d.types
   trunk/Documentation/libg3d/api/tmpl/
   trunk/Documentation/libg3d/api/tmpl/context.sgml
   trunk/Documentation/libg3d/api/tmpl/face.sgml
   trunk/Documentation/libg3d/api/tmpl/iff.sgml
   trunk/Documentation/libg3d/api/tmpl/libg3d-unused.sgml
   trunk/Documentation/libg3d/api/tmpl/material.sgml
   trunk/Documentation/libg3d/api/tmpl/matrix.sgml
   trunk/Documentation/libg3d/api/tmpl/model.sgml
   trunk/Documentation/libg3d/api/tmpl/object.sgml
   trunk/Documentation/libg3d/api/tmpl/plugins.sgml
   trunk/Documentation/libg3d/api/tmpl/primitive.sgml
   trunk/Documentation/libg3d/api/tmpl/read.sgml
   trunk/Documentation/libg3d/api/tmpl/texture.sgml
   trunk/Documentation/libg3d/api/tmpl/types.sgml
   trunk/Documentation/libg3d/api/tmpl/vector.sgml
   trunk/Documentation/s3dapi/Makefile.am
Removed:
   trunk/libs3d/libg3d/doc/
Modified:
   trunk/
Log:
 r729 at balthasar:  dotslash | 2006-06-05 18:07:29 +0200
 - documentation moving



Property changes on: trunk
___________________________________________________________________
Name: svk:merge
   - bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:727
   + bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:729

Added: trunk/Documentation/libg3d/Makefile.am
===================================================================
--- trunk/Documentation/libg3d/Makefile.am	2006-06-05 16:04:31 UTC (rev 338)
+++ trunk/Documentation/libg3d/Makefile.am	2006-06-05 16:07:32 UTC (rev 339)
@@ -0,0 +1 @@
+SUBDIRS = api

Added: trunk/Documentation/libg3d/api/Makefile.am
===================================================================
--- trunk/Documentation/libg3d/api/Makefile.am	2006-06-05 16:04:31 UTC (rev 338)
+++ trunk/Documentation/libg3d/api/Makefile.am	2006-06-05 16:07:32 UTC (rev 339)
@@ -0,0 +1,37 @@
+AUTOMAKE_OPTIONS = 1.6
+
+DOC_MODULE = libg3d
+
+DOC_MAIN_SGML_FILE = $(DOC_MODULE)-docs.sgml
+
+DOC_SOURCE_DIR = ../../include/g3d
+
+SCANGOBJ_OPTIONS =
+
+SCAN_OPTIONS = 
+
+MKDB_OPTIONS = --sgml-mode --output-format=xml
+
+MKTMPL_OPTIONS =
+
+FIXXREF_OPTIONS =
+
+CFILE_GLOB =
+HFILE_GLOB =
+
+IGNORE_HFILES =
+
+HTML_IMAGES =
+
+content_files =
+
+expand_content_files =
+
+AM_CFLAGS = @GLIB_CFLAGS@
+INCLUDES = -I$(top_srcdir)/include
+GTKDOC_LIBS = @GLIB_LIBS@
+
+include $(top_srcdir)/gtk-doc.make
+
+EXTRA_DIST +=
+

Added: trunk/Documentation/libg3d/api/libg3d-docs.sgml
===================================================================
--- trunk/Documentation/libg3d/api/libg3d-docs.sgml	2006-06-05 16:04:31 UTC (rev 338)
+++ trunk/Documentation/libg3d/api/libg3d-docs.sgml	2006-06-05 16:07:32 UTC (rev 339)
@@ -0,0 +1,32 @@
+<?xml version="1.0"?>
+<!DOCTYPE book PUBLIC "-//OASIS//DTD DocBook XML V4.1.2//EN" 
+               "http://www.oasis-open.org/docbook/xml/4.1.2/docbookx.dtd">
+<book id="index" xmlns:xi="http://www.w3.org/2003/XInclude">
+  <bookinfo>
+    <title>Libg3d Reference Manual</title>
+  </bookinfo>
+
+  	<chapter>
+    	<title>libg3d types and initialization</title>
+	    <xi:include href="xml/types.xml"/>	
+    	<xi:include href="xml/context.xml"/>
+	</chapter>
+
+	<chapter>
+		<title>object interface</title>
+	    <xi:include href="xml/model.xml"/>
+    	<xi:include href="xml/object.xml"/>
+	    <xi:include href="xml/face.xml"/>
+    	<xi:include href="xml/material.xml"/>
+	    <xi:include href="xml/texture.xml"/>
+	</chapter>
+	<chapter>
+		<title>plugin interface</title>
+    	<xi:include href="xml/plugins.xml"/>
+	    <xi:include href="xml/iff.xml"/>
+    	<xi:include href="xml/read.xml"/>
+	    <xi:include href="xml/matrix.xml"/>
+    	<xi:include href="xml/vector.xml"/>
+	    <xi:include href="xml/primitive.xml"/>
+	</chapter>
+</book>

Added: trunk/Documentation/libg3d/api/libg3d-overrides.txt
===================================================================

Added: trunk/Documentation/libg3d/api/libg3d-sections.txt
===================================================================
--- trunk/Documentation/libg3d/api/libg3d-sections.txt	2006-06-05 16:04:31 UTC (rev 338)
+++ trunk/Documentation/libg3d/api/libg3d-sections.txt	2006-06-05 16:07:32 UTC (rev 339)
@@ -0,0 +1,127 @@
+<SECTION>
+<FILE>types</FILE>
+G3D_FLAG_IMG_GREYSCALE
+G3DImage
+G3D_FLAG_MAT_TWOSIDE
+G3DMaterial
+G3D_FLAG_FAC_NORMALS
+G3D_FLAG_FAC_TEXMAP
+G3DFace
+G3DObject
+G3DSetBgColorFunc
+G3DUpdateInterfaceFunc
+G3DUpdateProgressBarFunc
+G3DContext
+G3DModel
+</SECTION>
+
+<SECTION>
+<FILE>context</FILE>
+g3d_context_new
+g3d_context_free
+g3d_context_set_bgcolor
+g3d_context_update_interface
+g3d_context_update_progress_bar
+g3d_context_set_set_bgcolor_func
+</SECTION>
+
+<SECTION>
+<FILE>model</FILE>
+g3d_model_new
+g3d_model_load
+g3d_model_check
+g3d_model_center
+g3d_model_clear
+g3d_model_free
+</SECTION>
+
+<SECTION>
+<FILE>object</FILE>
+g3d_object_free
+g3d_object_radius
+g3d_object_scale
+g3d_object_transform
+g3d_object_duplicate
+g3d_object_optimize
+g3d_object_smooth
+g3d_object_merge
+</SECTION>
+
+<SECTION>
+<FILE>face</FILE>
+g3d_face_get_normal
+g3d_face_free
+</SECTION>
+
+<SECTION>
+<FILE>material</FILE>
+g3d_material_new
+g3d_material_free
+</SECTION>
+
+<SECTION>
+<FILE>texture</FILE>
+g3d_texture_load_cached
+g3d_texture_prepare
+</SECTION>
+
+<SECTION>
+<FILE>plugins</FILE>
+G3D_PLUGIN_UNKNOWN
+G3D_PLUGIN_IMPORT
+G3D_PLUGIN_IMAGE
+PluginInitFunc
+PluginCleanupFunc
+PluginLoadModelFunc
+PluginLoadImageFunc
+PluginGetDescFunc
+PluginGetExtFunc
+G3DPlugin
+g3d_plugins_init
+g3d_plugins_cleanup
+g3d_plugins_load_model
+g3d_plugins_load_image
+g3d_plugins_get_image_extensions
+</SECTION>
+
+<SECTION>
+<FILE>iff</FILE>
+G3D_IFF_MKID
+g3d_iff_open
+g3d_iff_readchunk
+</SECTION>
+
+<SECTION>
+<FILE>read</FILE>
+g3d_read_int8
+g3d_read_int16_be
+g3d_read_int16_le
+g3d_read_int32_be
+g3d_read_int32_le
+g3d_read_float_be
+g3d_read_float_le
+</SECTION>
+
+<SECTION>
+<FILE>primitive</FILE>
+g3d_primitive_cylinder
+g3d_primitive_tube
+</SECTION>
+
+<SECTION>
+<FILE>matrix</FILE>
+g3d_matrix_identity
+g3d_matrix_multiply
+g3d_matrix_translate
+g3d_matrix_rotate
+g3d_matrix_rotate_xyz
+</SECTION>
+
+<SECTION>
+<FILE>vector</FILE>
+g3d_vector_normal
+g3d_vector_unify
+g3d_vector_transform
+</SECTION>
+
+

Added: trunk/Documentation/libg3d/api/libg3d.types
===================================================================
--- trunk/Documentation/libg3d/api/libg3d.types	2006-06-05 16:04:31 UTC (rev 338)
+++ trunk/Documentation/libg3d/api/libg3d.types	2006-06-05 16:07:32 UTC (rev 339)
@@ -0,0 +1,2 @@
+#include <g3d/g3d.h>
+#include <glib-object.h>

Added: trunk/Documentation/libg3d/api/tmpl/context.sgml
===================================================================
--- trunk/Documentation/libg3d/api/tmpl/context.sgml	2006-06-05 16:04:31 UTC (rev 338)
+++ trunk/Documentation/libg3d/api/tmpl/context.sgml	2006-06-05 16:07:32 UTC (rev 339)
@@ -0,0 +1,78 @@
+<!-- ##### SECTION Title ##### -->
+context
+
+<!-- ##### SECTION Short_Description ##### -->
+Libg3d initialization and configuration
+
+<!-- ##### SECTION Long_Description ##### -->
+<para>
+
+</para>
+
+<!-- ##### SECTION See_Also ##### -->
+<para>
+
+</para>
+
+<!-- ##### SECTION Stability_Level ##### -->
+
+
+<!-- ##### FUNCTION g3d_context_new ##### -->
+<para>
+
+</para>
+
+ at Returns: 
+
+
+<!-- ##### FUNCTION g3d_context_free ##### -->
+<para>
+
+</para>
+
+ at context: 
+
+
+<!-- ##### FUNCTION g3d_context_set_bgcolor ##### -->
+<para>
+
+</para>
+
+ at context: 
+ at r: 
+ at g: 
+ at b: 
+ at a: 
+ at Returns: 
+
+
+<!-- ##### FUNCTION g3d_context_update_interface ##### -->
+<para>
+
+</para>
+
+ at context: 
+ at Returns: 
+
+
+<!-- ##### FUNCTION g3d_context_update_progress_bar ##### -->
+<para>
+
+</para>
+
+ at context: 
+ at percentage: 
+ at visibility: 
+ at Returns: 
+
+
+<!-- ##### FUNCTION g3d_context_set_set_bgcolor_func ##### -->
+<para>
+
+</para>
+
+ at context: 
+ at func: 
+ at user_data: 
+
+

Added: trunk/Documentation/libg3d/api/tmpl/face.sgml
===================================================================
--- trunk/Documentation/libg3d/api/tmpl/face.sgml	2006-06-05 16:04:31 UTC (rev 338)
+++ trunk/Documentation/libg3d/api/tmpl/face.sgml	2006-06-05 16:07:32 UTC (rev 339)
@@ -0,0 +1,40 @@
+<!-- ##### SECTION Title ##### -->
+face
+
+<!-- ##### SECTION Short_Description ##### -->
+Face manipulation
+
+<!-- ##### SECTION Long_Description ##### -->
+<para>
+
+</para>
+
+<!-- ##### SECTION See_Also ##### -->
+<para>
+
+</para>
+
+<!-- ##### SECTION Stability_Level ##### -->
+
+
+<!-- ##### FUNCTION g3d_face_get_normal ##### -->
+<para>
+
+</para>
+
+ at face: 
+ at object: 
+ at nx: 
+ at ny: 
+ at nz: 
+ at Returns: 
+
+
+<!-- ##### FUNCTION g3d_face_free ##### -->
+<para>
+
+</para>
+
+ at face: 
+
+

Added: trunk/Documentation/libg3d/api/tmpl/iff.sgml
===================================================================
--- trunk/Documentation/libg3d/api/tmpl/iff.sgml	2006-06-05 16:04:31 UTC (rev 338)
+++ trunk/Documentation/libg3d/api/tmpl/iff.sgml	2006-06-05 16:07:32 UTC (rev 339)
@@ -0,0 +1,52 @@
+<!-- ##### SECTION Title ##### -->
+iff
+
+<!-- ##### SECTION Short_Description ##### -->
+IFF file helper functions
+
+<!-- ##### SECTION Long_Description ##### -->
+<para>
+
+</para>
+
+<!-- ##### SECTION See_Also ##### -->
+<para>
+
+</para>
+
+<!-- ##### SECTION Stability_Level ##### -->
+
+
+<!-- ##### MACRO G3D_IFF_MKID ##### -->
+<para>
+
+</para>
+
+ at a: 
+ at b: 
+ at c: 
+ at d: 
+
+
+<!-- ##### FUNCTION g3d_iff_open ##### -->
+<para>
+
+</para>
+
+ at filename: 
+ at id: 
+ at len: 
+ at Returns: 
+
+
+<!-- ##### FUNCTION g3d_iff_readchunk ##### -->
+<para>
+
+</para>
+
+ at f: 
+ at id: 
+ at len: 
+ at Returns: 
+
+

Added: trunk/Documentation/libg3d/api/tmpl/libg3d-unused.sgml
===================================================================

Added: trunk/Documentation/libg3d/api/tmpl/material.sgml
===================================================================
--- trunk/Documentation/libg3d/api/tmpl/material.sgml	2006-06-05 16:04:31 UTC (rev 338)
+++ trunk/Documentation/libg3d/api/tmpl/material.sgml	2006-06-05 16:07:32 UTC (rev 339)
@@ -0,0 +1,35 @@
+<!-- ##### SECTION Title ##### -->
+material
+
+<!-- ##### SECTION Short_Description ##### -->
+Material generation and manipulation
+
+<!-- ##### SECTION Long_Description ##### -->
+<para>
+
+</para>
+
+<!-- ##### SECTION See_Also ##### -->
+<para>
+
+</para>
+
+<!-- ##### SECTION Stability_Level ##### -->
+
+
+<!-- ##### FUNCTION g3d_material_new ##### -->
+<para>
+
+</para>
+
+ at Returns: 
+
+
+<!-- ##### FUNCTION g3d_material_free ##### -->
+<para>
+
+</para>
+
+ at material: 
+
+

Added: trunk/Documentation/libg3d/api/tmpl/matrix.sgml
===================================================================
--- trunk/Documentation/libg3d/api/tmpl/matrix.sgml	2006-06-05 16:04:31 UTC (rev 338)
+++ trunk/Documentation/libg3d/api/tmpl/matrix.sgml	2006-06-05 16:07:32 UTC (rev 339)
@@ -0,0 +1,76 @@
+<!-- ##### SECTION Title ##### -->
+matrix
+
+<!-- ##### SECTION Short_Description ##### -->
+Matrix manipulation and calculation
+
+<!-- ##### SECTION Long_Description ##### -->
+<para>
+
+</para>
+
+<!-- ##### SECTION See_Also ##### -->
+<para>
+
+</para>
+
+<!-- ##### SECTION Stability_Level ##### -->
+
+
+<!-- ##### FUNCTION g3d_matrix_identity ##### -->
+<para>
+
+</para>
+
+ at matrix: 
+ at Returns: 
+
+
+<!-- ##### FUNCTION g3d_matrix_multiply ##### -->
+<para>
+
+</para>
+
+ at m1: 
+ at m2: 
+ at rm: 
+ at Returns: 
+
+
+<!-- ##### FUNCTION g3d_matrix_translate ##### -->
+<para>
+
+</para>
+
+ at x: 
+ at y: 
+ at z: 
+ at rm: 
+ at Returns: 
+
+
+<!-- ##### FUNCTION g3d_matrix_rotate ##### -->
+<para>
+
+</para>
+
+ at angle: 
+ at ax: 
+ at ay: 
+ at az: 
+ at rm: 
+ at Returns: 
+
+
+<!-- ##### FUNCTION g3d_matrix_rotate_xyz ##### -->
+<para>
+
+</para>
+
+ at rx: 
+ at ry: 
+ at rz: 
+ at rm: 
+ at Returns: 
+
+

Added: trunk/Documentation/libg3d/api/tmpl/model.sgml
===================================================================
--- trunk/Documentation/libg3d/api/tmpl/model.sgml	2006-06-05 16:04:31 UTC (rev 338)
+++ trunk/Documentation/libg3d/api/tmpl/model.sgml	2006-06-05 16:07:32 UTC (rev 339)
@@ -0,0 +1,71 @@
+<!-- ##### SECTION Title ##### -->
+model
+
+<!-- ##### SECTION Short_Description ##### -->
+Model manipulation functions
+
+<!-- ##### SECTION Long_Description ##### -->
+<para>
+
+</para>
+
+<!-- ##### SECTION See_Also ##### -->
+<para>
+
+</para>
+
+<!-- ##### SECTION Stability_Level ##### -->
+
+
+<!-- ##### FUNCTION g3d_model_new ##### -->
+<para>
+
+</para>
+
+ at Returns: 
+
+
+<!-- ##### FUNCTION g3d_model_load ##### -->
+<para>
+
+</para>
+
+ at context: 
+ at filename: 
+ at Returns: 
+
+
+<!-- ##### FUNCTION g3d_model_check ##### -->
+<para>
+
+</para>
+
+ at model: 
+ at Returns: 
+
+
+<!-- ##### FUNCTION g3d_model_center ##### -->
+<para>
+
+</para>
+
+ at model: 
+ at Returns: 
+
+
+<!-- ##### FUNCTION g3d_model_clear ##### -->
+<para>
+
+</para>
+
+ at model: 
+
+
+<!-- ##### FUNCTION g3d_model_free ##### -->
+<para>
+
+</para>
+
+ at model: 
+
+

Added: trunk/Documentation/libg3d/api/tmpl/object.sgml
===================================================================
--- trunk/Documentation/libg3d/api/tmpl/object.sgml	2006-06-05 16:04:31 UTC (rev 338)
+++ trunk/Documentation/libg3d/api/tmpl/object.sgml	2006-06-05 16:07:32 UTC (rev 339)
@@ -0,0 +1,93 @@
+<!-- ##### SECTION Title ##### -->
+object
+
+<!-- ##### SECTION Short_Description ##### -->
+Object manipulation
+
+<!-- ##### SECTION Long_Description ##### -->
+<para>
+
+</para>
+
+<!-- ##### SECTION See_Also ##### -->
+<para>
+
+</para>
+
+<!-- ##### SECTION Stability_Level ##### -->
+
+
+<!-- ##### FUNCTION g3d_object_free ##### -->
+<para>
+
+</para>
+
+ at object: 
+
+
+<!-- ##### FUNCTION g3d_object_radius ##### -->
+<para>
+
+</para>
+
+ at object: 
+ at Returns: 
+
+
+<!-- ##### FUNCTION g3d_object_scale ##### -->
+<para>
+
+</para>
+
+ at object: 
+ at scale: 
+ at Returns: 
+
+
+<!-- ##### FUNCTION g3d_object_transform ##### -->
+<para>
+
+</para>
+
+ at object: 
+ at matrix: 
+ at Returns: 
+
+
+<!-- ##### FUNCTION g3d_object_duplicate ##### -->
+<para>
+
+</para>
+
+ at object: 
+ at Returns: 
+
+
+<!-- ##### FUNCTION g3d_object_optimize ##### -->
+<para>
+
+</para>
+
+ at object: 
+ at Returns: 
+
+
+<!-- ##### FUNCTION g3d_object_smooth ##### -->
+<para>
+
+</para>
+
+ at object: 
+ at Returns: 
+
+
+<!-- ##### FUNCTION g3d_object_merge ##### -->
+<para>
+
+</para>
+
+ at o1: 
+ at o2: 
+ at Returns: 
+
+

Added: trunk/Documentation/libg3d/api/tmpl/plugins.sgml
===================================================================
--- trunk/Documentation/libg3d/api/tmpl/plugins.sgml	2006-06-05 16:04:31 UTC (rev 338)
+++ trunk/Documentation/libg3d/api/tmpl/plugins.sgml	2006-06-05 16:07:32 UTC (rev 339)
@@ -0,0 +1,165 @@
+<!-- ##### SECTION Title ##### -->
+plugins
+
+<!-- ##### SECTION Short_Description ##### -->
+Plugin interface
+
+<!-- ##### SECTION Long_Description ##### -->
+<para>
+
+</para>
+
+<!-- ##### SECTION See_Also ##### -->
+<para>
+
+</para>
+
+<!-- ##### SECTION Stability_Level ##### -->
+
+
+<!-- ##### MACRO G3D_PLUGIN_UNKNOWN ##### -->
+<para>
+
+</para>
+
+
+
+<!-- ##### MACRO G3D_PLUGIN_IMPORT ##### -->
+<para>
+
+</para>
+
+
+
+<!-- ##### MACRO G3D_PLUGIN_IMAGE ##### -->
+<para>
+
+</para>
+
+
+
+<!-- ##### USER_FUNCTION PluginInitFunc ##### -->
+<para>
+
+</para>
+
+ at context: 
+ at Returns: 
+
+
+<!-- ##### USER_FUNCTION PluginCleanupFunc ##### -->
+<para>
+
+</para>
+
+ at user_data: 
+
+
+<!-- ##### USER_FUNCTION PluginLoadModelFunc ##### -->
+<para>
+
+</para>
+
+ at context: 
+ at filename: 
+ at model: 
+ at user_data: 
+ at Returns: 
+
+
+<!-- ##### USER_FUNCTION PluginLoadImageFunc ##### -->
+<para>
+
+</para>
+
+ at context: 
+ at filename: 
+ at image: 
+ at user_data: 
+ at Returns: 
+
+
+<!-- ##### USER_FUNCTION PluginGetDescFunc ##### -->
+<para>
+
+</para>
+
+ at context: 
+ at Returns: 
+
+
+<!-- ##### USER_FUNCTION PluginGetExtFunc ##### -->
+<para>
+
+</para>
+
+ at context: 
+ at Returns: 
+
+
+<!-- ##### STRUCT G3DPlugin ##### -->
+<para>
+
+</para>
+
+ at name: 
+ at path: 
+ at type: 
+ at extensions: 
+ at init_func: 
+ at cleanup_func: 
+ at loadmodel_func: 
+ at loadimage_func: 
+ at desc_func: 
+ at ext_func: 
+ at user_data: 
+ at module: 
+
+<!-- ##### FUNCTION g3d_plugins_init ##### -->
+<para>
+
+</para>
+
+ at context: 
+ at Returns: 
+
+
+<!-- ##### FUNCTION g3d_plugins_cleanup ##### -->
+<para>
+
+</para>
+
+ at context: 
+
+
+<!-- ##### FUNCTION g3d_plugins_load_model ##### -->
+<para>
+
+</para>
+
+ at context: 
+ at filename: 
+ at model: 
+ at Returns: 
+
+
+<!-- ##### FUNCTION g3d_plugins_load_image ##### -->
+<para>
+
+</para>
+
+ at context: 
+ at filename: 
+ at image: 
+ at Returns: 
+
+
+<!-- ##### FUNCTION g3d_plugins_get_image_extensions ##### -->
+<para>
+
+</para>
+
+ at context: 
+ at Returns: 
+
+

Added: trunk/Documentation/libg3d/api/tmpl/primitive.sgml
===================================================================
--- trunk/Documentation/libg3d/api/tmpl/primitive.sgml	2006-06-05 16:04:31 UTC (rev 338)
+++ trunk/Documentation/libg3d/api/tmpl/primitive.sgml	2006-06-05 16:07:32 UTC (rev 339)
@@ -0,0 +1,48 @@
+<!-- ##### SECTION Title ##### -->
+primitive
+
+<!-- ##### SECTION Short_Description ##### -->
+3D primitive generation functions
+
+<!-- ##### SECTION Long_Description ##### -->
+<para>
+
+</para>
+
+<!-- ##### SECTION See_Also ##### -->
+<para>
+
+</para>
+
+<!-- ##### SECTION Stability_Level ##### -->
+
+
+<!-- ##### FUNCTION g3d_primitive_cylinder ##### -->
+<para>
+
+</para>
+
+ at radius: 
+ at height: 
+ at sides: 
+ at top: 
+ at bottom: 
+ at material: 
+ at Returns: 
+
+
+<!-- ##### FUNCTION g3d_primitive_tube ##### -->
+<para>
+
+</para>
+
+ at r_in: 
+ at r_out: 
+ at height: 
+ at sides: 
+ at top: 
+ at bottom: 
+ at material: 
+ at Returns: 
+
+

Added: trunk/Documentation/libg3d/api/tmpl/read.sgml
===================================================================
--- trunk/Documentation/libg3d/api/tmpl/read.sgml	2006-06-05 16:04:31 UTC (rev 338)
+++ trunk/Documentation/libg3d/api/tmpl/read.sgml	2006-06-05 16:07:32 UTC (rev 339)
@@ -0,0 +1,82 @@
+<!-- ##### SECTION Title ##### -->
+read
+
+<!-- ##### SECTION Short_Description ##### -->
+Binary file reading helper functions
+
+<!-- ##### SECTION Long_Description ##### -->
+<para>
+
+</para>
+
+<!-- ##### SECTION See_Also ##### -->
+<para>
+
+</para>
+
+<!-- ##### SECTION Stability_Level ##### -->
+
+
+<!-- ##### FUNCTION g3d_read_int8 ##### -->
+<para>
+
+</para>
+
+ at f: 
+ at Returns: 
+
+
+<!-- ##### FUNCTION g3d_read_int16_be ##### -->
+<para>
+
+</para>
+
+ at f: 
+ at Returns: 
+
+
+<!-- ##### FUNCTION g3d_read_int16_le ##### -->
+<para>
+
+</para>
+
+ at f: 
+ at Returns: 
+
+
+<!-- ##### FUNCTION g3d_read_int32_be ##### -->
+<para>
+
+</para>
+
+ at f: 
+ at Returns: 
+
+
+<!-- ##### FUNCTION g3d_read_int32_le ##### -->
+<para>
+
+</para>
+
+ at f: 
+ at Returns: 
+
+
+<!-- ##### FUNCTION g3d_read_float_be ##### -->
+<para>
+
+</para>
+
+ at f: 
+ at Returns: 
+
+
+<!-- ##### FUNCTION g3d_read_float_le ##### -->
+<para>
+
+</para>
+
+ at f: 
+ at Returns: 
+
+

Added: trunk/Documentation/libg3d/api/tmpl/texture.sgml
===================================================================
--- trunk/Documentation/libg3d/api/tmpl/texture.sgml	2006-06-05 16:04:31 UTC (rev 338)
+++ trunk/Documentation/libg3d/api/tmpl/texture.sgml	2006-06-05 16:07:32 UTC (rev 339)
@@ -0,0 +1,39 @@
+<!-- ##### SECTION Title ##### -->
+texture
+
+<!-- ##### SECTION Short_Description ##### -->
+Texture loading and manipulation
+
+<!-- ##### SECTION Long_Description ##### -->
+<para>
+
+</para>
+
+<!-- ##### SECTION See_Also ##### -->
+<para>
+
+</para>
+
+<!-- ##### SECTION Stability_Level ##### -->
+
+
+<!-- ##### FUNCTION g3d_texture_load_cached ##### -->
+<para>
+
+</para>
+
+ at context: 
+ at model: 
+ at filename: 
+ at Returns: 
+
+
+<!-- ##### FUNCTION g3d_texture_prepare ##### -->
+<para>
+
+</para>
+
+ at texture: 
+ at Returns: 
+
+

Added: trunk/Documentation/libg3d/api/tmpl/types.sgml
===================================================================
--- trunk/Documentation/libg3d/api/tmpl/types.sgml	2006-06-05 16:04:31 UTC (rev 338)
+++ trunk/Documentation/libg3d/api/tmpl/types.sgml	2006-06-05 16:07:32 UTC (rev 339)
@@ -0,0 +1,173 @@
+<!-- ##### SECTION Title ##### -->
+types
+
+<!-- ##### SECTION Short_Description ##### -->
+All types used in libg3d
+
+<!-- ##### SECTION Long_Description ##### -->
+<para>
+
+</para>
+
+<!-- ##### SECTION See_Also ##### -->
+<para>
+
+</para>
+
+<!-- ##### SECTION Stability_Level ##### -->
+
+
+<!-- ##### MACRO G3D_FLAG_IMG_GREYSCALE ##### -->
+<para>
+
+</para>
+
+
+
+<!-- ##### STRUCT G3DImage ##### -->
+<para>
+
+</para>
+
+ at name: 
+ at width: 
+ at height: 
+ at depth: 
+ at flags: 
+ at pixeldata: 
+ at tex_id: 
+ at tex_scale_u: 
+ at tex_scale_v: 
+
+<!-- ##### MACRO G3D_FLAG_MAT_TWOSIDE ##### -->
+<para>
+
+</para>
+
+
+
+<!-- ##### STRUCT G3DMaterial ##### -->
+<para>
+
+</para>
+
+ at name: 
+ at r: 
+ at g: 
+ at b: 
+ at a: 
+ at shininess: 
+ at specular: 
+ at flags: 
+ at tex_image: 
+
+<!-- ##### MACRO G3D_FLAG_FAC_NORMALS ##### -->
+<para>
+
+</para>
+
+
+
+<!-- ##### MACRO G3D_FLAG_FAC_TEXMAP ##### -->
+<para>
+
+</para>
+
+
+
+<!-- ##### STRUCT G3DFace ##### -->
+<para>
+
+</para>
+
+ at vertex_count: 
+ at vertex_indices: 
+ at material: 
+ at flags: 
+ at normals: 
+ at tex_image: 
+ at tex_vertex_count: 
+ at tex_vertex_data: 
+
+<!-- ##### STRUCT G3DObject ##### -->
+<para>
+
+</para>
+
+ at name: 
+ at materials: 
+ at faces: 
+ at objects: 
+ at hide: 
+ at vertex_count: 
+ at vertex_data: 
+ at tex_vertex_count: 
+ at tex_vertex_data: 
+ at tex_image: 
+ at _normals: 
+ at _materials: 
+ at _num_faces: 
+ at _indices: 
+ at _flags: 
+ at _tex_images: 
+ at _tex_coords: 
+
+<!-- ##### USER_FUNCTION G3DSetBgColorFunc ##### -->
+<para>
+
+</para>
+
+ at r: 
+ at g: 
+ at b: 
+ at a: 
+ at user_data: 
+ at Returns: 
+
+
+<!-- ##### USER_FUNCTION G3DUpdateInterfaceFunc ##### -->
+<para>
+
+</para>
+
+ at user_data: 
+ at Returns: 
+
+
+<!-- ##### USER_FUNCTION G3DUpdateProgressBarFunc ##### -->
+<para>
+
+</para>
+
+ at percentage: 
+ at show: 
+ at user_data: 
+ at Returns: 
+
+
+<!-- ##### STRUCT G3DContext ##### -->
+<para>
+
+</para>
+
+ at plugins: 
+ at exts_import: 
+ at exts_image: 
+ at set_bgcolor_func: 
+ at set_bgcolor_data: 
+ at update_interface_func: 
+ at update_interface_data: 
+ at update_progress_bar_func: 
+ at update_progress_bar_data: 
+
+<!-- ##### STRUCT G3DModel ##### -->
+<para>
+
+</para>
+
+ at filename: 
+ at context: 
+ at materials: 
+ at objects: 
+ at tex_images: 
+

Added: trunk/Documentation/libg3d/api/tmpl/vector.sgml
===================================================================
--- trunk/Documentation/libg3d/api/tmpl/vector.sgml	2006-06-05 16:04:31 UTC (rev 338)
+++ trunk/Documentation/libg3d/api/tmpl/vector.sgml	2006-06-05 16:07:32 UTC (rev 339)
@@ -0,0 +1,59 @@
+<!-- ##### SECTION Title ##### -->
+vector
+
+<!-- ##### SECTION Short_Description ##### -->
+Vector manipulation and calculation
+
+<!-- ##### SECTION Long_Description ##### -->
+<para>
+
+</para>
+
+<!-- ##### SECTION See_Also ##### -->
+<para>
+
+</para>
+
+<!-- ##### SECTION Stability_Level ##### -->
+
+
+<!-- ##### FUNCTION g3d_vector_normal ##### -->
+<para>
+
+</para>
+
+ at ax: 
+ at ay: 
+ at az: 
+ at bx: 
+ at by: 
+ at bz: 
+ at nx: 
+ at ny: 
+ at nz: 
+ at Returns: 
+
+
+<!-- ##### FUNCTION g3d_vector_unify ##### -->
+<para>
+
+</para>
+
+ at nx: 
+ at ny: 
+ at nz: 
+ at Returns: 
+
+
+<!-- ##### FUNCTION g3d_vector_transform ##### -->
+<para>
+
+</para>
+
+ at x: 
+ at y: 
+ at z: 
+ at matrix: 
+ at Returns: 
+
+

Added: trunk/Documentation/s3dapi/Makefile.am
===================================================================
--- trunk/Documentation/s3dapi/Makefile.am	2006-06-05 16:04:31 UTC (rev 338)
+++ trunk/Documentation/s3dapi/Makefile.am	2006-06-05 16:07:32 UTC (rev 339)
@@ -0,0 +1,2 @@
+EXTRA_DIST	= s3dapi.docbook bookinfo.docbook
+



From dotslash at berlios.de  Mon Jun  5 18:14:25 2006
From: dotslash at berlios.de (dotslash at BerliOS)
Date: Mon, 5 Jun 2006 18:14:25 +0200
Subject: [S3d-svn] r340 - in trunk: . Documentation Documentation/libs3d
Message-ID: <200606051614.k55GEPXc019235@sheep.berlios.de>

Author: dotslash
Date: 2006-06-05 18:14:23 +0200 (Mon, 05 Jun 2006)
New Revision: 340

Added:
   trunk/Documentation/libs3d/
   trunk/Documentation/libs3d/Makefile.am
   trunk/Documentation/libs3d/README
   trunk/Documentation/libs3d/TODO
   trunk/Documentation/libs3d/bookinfo.docbook
   trunk/Documentation/libs3d/s3dapi.docbook
Removed:
   trunk/Documentation/s3dapi/
Modified:
   trunk/
Log:
 r731 at balthasar:  dotslash | 2006-06-05 18:14:19 +0200
 - more movement
 - s3d_{pep|load}_line_normals



Property changes on: trunk
___________________________________________________________________
Name: svk:merge
   - bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:729
   + bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:731

Added: trunk/Documentation/libs3d/Makefile.am
===================================================================
--- trunk/Documentation/libs3d/Makefile.am	2006-06-05 16:07:32 UTC (rev 339)
+++ trunk/Documentation/libs3d/Makefile.am	2006-06-05 16:14:23 UTC (rev 340)
@@ -0,0 +1,2 @@
+EXTRA_DIST	= s3dapi.docbook bookinfo.docbook
+

Added: trunk/Documentation/libs3d/README
===================================================================
--- trunk/Documentation/libs3d/README	2006-06-05 16:07:32 UTC (rev 339)
+++ trunk/Documentation/libs3d/README	2006-06-05 16:14:23 UTC (rev 340)
@@ -0,0 +1,8 @@
+You can read this online on
+
+http://s3d.berlios.de/doc
+
+or compile it yourself, for example with
+
+docbook2html s3dapi.docbook
+

Added: trunk/Documentation/libs3d/TODO
===================================================================
--- trunk/Documentation/libs3d/TODO	2006-06-05 16:07:32 UTC (rev 339)
+++ trunk/Documentation/libs3d/TODO	2006-06-05 16:14:23 UTC (rev 340)
@@ -0,0 +1 @@
+- texture start position

Added: trunk/Documentation/libs3d/bookinfo.docbook
===================================================================
--- trunk/Documentation/libs3d/bookinfo.docbook	2006-06-05 16:07:32 UTC (rev 339)
+++ trunk/Documentation/libs3d/bookinfo.docbook	2006-06-05 16:14:23 UTC (rev 340)
@@ -0,0 +1,26 @@
+<bookinfo>
+<title>The s3d manual</title>
+<authorgroup>
+<author>
+<firstname>Simon</firstname>
+<surname>Wunderlich</surname>
+</author>
+</authorgroup>
+
+<date>03/19/2006</date>
+<releaseinfo>0.1</releaseinfo>
+
+<abstract>
+<para>
+This Manual is the programmers guide to the s3d API.
+</para>
+</abstract>
+
+<keywordset>
+<keyword>s3d</keyword>
+<keyword>API</keyword>
+<keyword>handbook</keyword>
+<keyword>guide</keyword>
+</keywordset>
+
+</bookinfo>

Added: trunk/Documentation/libs3d/s3dapi.docbook
===================================================================
--- trunk/Documentation/libs3d/s3dapi.docbook	2006-06-05 16:07:32 UTC (rev 339)
+++ trunk/Documentation/libs3d/s3dapi.docbook	2006-06-05 16:14:23 UTC (rev 340)
@@ -0,0 +1,1741 @@
+<?xml version="1.0" encoding="UTF-8" ?>
+<!DOCTYPE book PUBLIC "-//OASIS//DTD DocBook XML V4.2//EN" [
+  <!ENTITY introduction SYSTEM "bookinfo.docbook">
+]>
+<book id="s3dapi" lang="en">
+ 
+<bookinfo>
+<title>The <application>s3d</application> API manual</title>
+</bookinfo>
+<chapter id="introduction">
+<title>Introduction</title>
+ <para>I'm trying to cover as much as possible, please drop me a line if 
+ there is something missing or not clear enough. please beware: anything may change anytime,
+ as i'm sometimes in the mood of changing deep internal things.
+ </para>
+ <para>
+ Thanks to David Rugge, Mark Glassi and Eric Bischoff for their great <ulink url="http://opensource.bureau-cornavin.com/crash-course/">Docbook Crash Course</ulink>, this Doc wouldn't be here without that :)
+ </para>
+ <para>
+ And of course THANKS to the whole s3d team - Yd, Marek, 2x Andreas, Mog - and all the people who support <application>s3d</application>!!
+ </para>
+</chapter>
+<chapter id="using">
+<title>Using the <application>s3d</application> library</title>
+<sect1 id="setup">
+<title>Setting <application>s3d</application> up</title>
+ <para>
+ Install the lib using the usual usual mechanism:
+ <programlisting>
+ ./configure
+ make
+ make install
+ </programlisting>
+ You might need to have superuser rights in order to do make install. You should now have the server,
+ the library and some applications installed somewhere.
+ </para>
+</sect1>
+<sect1 id="gettingstarted">
+<title>Getting started</title>
+<para>
+ After having <application>s3d</application> installed, you can write your own <application>s3d</application> programs (yeah, that is what this guide is about ;)
+ <programlisting>
+ <![CDATA[#include <s3d.h>]]>
+ </programlisting>
+ should be enough to access the 3d functions. If you want to use keyboard interaction, do
+ <programlisting>
+ <![CDATA[#include <s3d_keysym.h>]]>
+ </programlisting>
+ for the keycode table.
+ Now you can compile your program with 
+ <screen>
+ <prompt>bash$</prompt> <command> gcc <replaceable>program</replaceable>.c -ls3d -o <replaceable>program</replaceable> </command>
+ That wasn't that hard, wasn't it?
+ </screen>
+</para>
+</sect1>
+</chapter>
+
+
+<chapter id="functions">
+<title>function reference</title>
+
+<sect1 id="s3d_init">
+<title>s3d_init</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_init</function></funcdef>
+<paramdef>
+int *<parameter>argc</parameter>.
+char ***<parameter>argv</parameter>
+char *<parameter>name</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+This will initialize the <application>s3d</application>-library and the connection to the Server. It will return 0 on
+success in Server initializion. name specifies the your programs name.
+</para>
+<programlisting>
+int main(char argc, char **argv)
+{
+	if (!<emphasis>s3d_init(<![CDATA[&argc,&argv]]>,"Hello world")</emphasis>) 
+	{
+		...
+		<link linkend="s3d_quit">s3d_quit()</link>;
+	}
+	return(0);
+}
+			   
+</programlisting>
+</sect1>
+
+
+<sect1 id="s3d_quit">
+<title>s3d_quit</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_quit</function></funcdef>
+<paramdef>void </paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+closes the connection and cleares the event-stack. it can also be used to leave
+the <link linkend="s3d_mainloop">s3d_mainloop</link>.
+</para>
+</sect1>
+
+<sect1 id="s3d_usage">
+<title>s3d_usage</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>void <function>s3d_usage</function></funcdef>
+<paramdef>void </paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Prints the possible parameter for the client library (which can be passed in 
+<link linkend="s3d_init">s3d_init()</link>)
+</para>
+</sect1>
+
+<sect1 id="s3d_mainloop">
+<title>s3d_mainloop</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_mainloop</function></funcdef>
+<paramdef>void (*<parameter>f</parameter>)()</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+takes a function as argument. it will loop this function until a quit-event is
+received. you can pass NULL if you have no function to be looped, but its
+better to sleep some time if you have nothing to do anyway to save cpu-time.
+</para>
+<programlisting>
+void mainloop()
+{
+    usleep(1000); // sleep 1 ms in every cycle
+}
+...
+
+<emphasis>s3d_mainloop</emphasis>(mainloop());
+
+</programlisting>
+</sect1>
+
+
+<sect1 id="s3d_push_vertex">
+<title>s3d_push_vertex</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_push_vertex</function></funcdef>
+<paramdef>int <parameter>object</parameter>, float <parameter>x</parameter>, float <parameter>y</parameter>, float <parameter>z</parameter></paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+pushes a vertex onto the vertex stack. make sure that you count how many
+vertices you've pushed because you'll need that for referencing when you push
+your polygons.
+</para>
+</sect1>
+
+
+<sect1>
+<title>s3d_push_vertices</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_push_vertices</function></funcdef>
+<paramdef>int <parameter>object</parameter>, float *<parameter>vbuf</parameter>, unsigned short <parameter>n</parameter></paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+push some vertices from an array. that's much better for performing than
+using <link linkend="s3d_push_vertex">s3d_push_vertex()</link> if you have a lot of vertices (and that's probably the
+usual case).
+</para>
+<programlisting>
+float vertices[] = { 0.0, 0.0, 0.0,
+                     1.0, 2.0, 3,0,
+                     3.0, 2.0, 1.0};
+<emphasis>s3d_push_vertices</emphasis>(object, vertices, 3); /* pushing 3 vertices */
+</programlisting>
+</sect1>
+
+
+<sect1 id="s3d_push_material">
+<title>s3d_push_material</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_push_material</function></funcdef>
+<paramdef>int <parameter>object</parameter>, 
+float <parameter>amb_r</parameter>,
+float <parameter>amb_g</parameter>,
+float <parameter>amb_b</parameter>,
+float <parameter>spec_r</parameter>,
+float <parameter>spec_g</parameter>,
+float <parameter>spec_b</parameter>,
+float <parameter>diff_r</parameter>,
+float <parameter>diff_g</parameter>,
+float <parameter>diff_b</parameter>,
+
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+pushes a material for an object. you will have to count them yourself too, as
+polygons will ask for the material index number. the material properties are
+given in rgb (red/green/blue) color codes, in float. 0.0 is the minimum,
+1.0 is the maximum a color value can be.
+the specular color is the color which is directly reflected from the light
+source. the diffuse color is the color which can be seen in the bright side
+of the object, and the ambience color is the color of the shadow side of the
+object.
+</para>
+</sect1>
+
+<sect1 id="s3d_push_material_a">
+<title>s3d_push_material_a</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_push_material_a</function></funcdef>
+<paramdef>int <parameter>object</parameter>, 
+float <parameter>amb_r</parameter>,
+float <parameter>amb_g</parameter>,
+float <parameter>amb_b</parameter>,
+float <parameter>amb_a</parameter>,
+float <parameter>spec_r</parameter>,
+float <parameter>spec_g</parameter>,
+float <parameter>spec_b</parameter>,
+float <parameter>spec_a</parameter>,
+float <parameter>diff_r</parameter>,
+float <parameter>diff_g</parameter>,
+float <parameter>diff_b</parameter>,
+float <parameter>diff_a</parameter>
+
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Same as <link linkend="s3d_push_material">s3d_push_material</link>, but color has <link linkend="alpha">alpha value</link> added.
+Use <link linkend="s3d_push_materials_a">s3d_push_materials_a()</link> if you have a lot of materials to push.
+</para>
+</sect1>
+
+
+<sect1 id="s3d_push_materials_a">
+<title>s3d_push_materials_a</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_push_materials_a</function></funcdef>
+<paramdef>
+int <parameter>object</parameter>, 
+float *<parameter>mbuf</parameter>, 
+unsigned short <parameter>n</parameter>
+
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Pushes a buffer of Materials. Those Materials are in the format float[n*12], with
+<itemizedlist>
+<listitem><para>mbuf[n*12 + 0-3] - ambience</para></listitem>
+<listitem><para>mbuf[n*12 + 4-7] - specular</para></listitem>
+<listitem><para>mbuf[n *12 + 8-11] - diffusion values </para></listitem>
+</itemizedlist>
+of each entry. n is the number of materials pushed. The values are in the order r,g,b,a.
+If you only want to push one material, use the more easy <link linkend="s3d_push_material_a">s3d_push_material_a()</link>
+function.
+</para>
+<programlisting>
+/* each line has r,g,b,a value */
+float bla[24]=
+	{1,0,0,1,
+	 1,0,0,1,
+	 1,0,0,1,
+	 0,1,1,1,
+	 0,1,1,1,
+	 0,1,1,1};
+
+s3d_push_materials_a(object,mbuf,2); /* push a red and a cyan material */
+</programlisting>
+</sect1>
+
+
+
+<sect1>
+<title>s3d_push_polygon</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_push_polygon</function></funcdef>
+<paramdef>int <parameter>object</parameter>, 
+int <parameter>v1</parameter>,
+int <parameter>v2</parameter>,
+int <parameter>v3</parameter>,
+int <parameter>material</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+push one polygon on the polygonstack of the object. it takes 3 vertex-index-
+numbers and one material material-index-nr. as argument.
+</para>
+<programlisting>
+int oid=<link linkend="s3d_new_object">s3d_new_object</link>();   /* create a new object */
+<link linkend="s3d_push_vertex">s3d_push_vertex</link>(oid,0.0,0.0,0.0);
+<link linkend="s3d_push_vertex">s3d_push_vertex</link>(oid,0.0,1.0,0.0);
+<link linkend="s3d_push_vertex">s3d_push_vertex</link>(oid,1.0,0.0,0.0);
+<link linkend="s3d_push_material">s3d_push_material</link>(oid,0.3,0.0,0.0, 1.0,1.0,1.0, 1.0,0.0,0.0);
+<emphasis>s3d_push_polygon</emphasis>(oid,0,1,2,0);
+/* this will create a red polygon */
+</programlisting>
+</sect1>
+
+
+<sect1>
+<title>s3d_push_polygons</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_push_polygons</function></funcdef>
+<paramdef>int <parameter>object</parameter>, 
+unsigned long <parameter>*pbuf</parameter>,
+unsigned short <parameter>n</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+as for vertices, you can push arrays of polygons to have greater performance.
+the pbuf should contain n polygons which consist of 4 unsigned long values
+of 3 vertices indeces and 1 material index.
+</para>
+<programlisting>
+unsigned long pbuf[] = { 0,1,2,0};
+int oid=<link linkend="s3d_new_object">s3d_new_object</link>();   /* create a new object */
+<link linkend="s3d_push_vertex">s3d_push_vertex</link>(oid,0.0,0.0,0.0);
+<link linkend="s3d_push_vertex">s3d_push_vertex</link>(oid,0.0,1.0,0.0);
+<link linkend="s3d_push_vertex">s3d_push_vertex</link>(oid,1.0,0.0,0.0);
+<link linkend="s3d_push_material">s3d_push_material</link>(oid,0.3,0.0,0.0, 1.0,1.0,1.0, 1.0,0.0,0.0);
+<emphasis>s3d_push_polygons</emphasis>(oid,pbuf,1);
+/* push one polygon with the pbuf data */
+</programlisting>
+</sect1>
+
+
+<sect1 id="s3d_push_line">
+<title>s3d_push_line</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_push_line</function></funcdef>
+<paramdef>int <parameter>object</parameter>, 
+int <parameter>v1</parameter>,
+int <parameter>v2</parameter>,
+int <parameter>material</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Push one line on the linestack of the object. It takes 2 vertex-index-
+numbers and one material material-index-nr. as argument. If you have
+a lot of lines to push, use <link linkend="s3d_push_lines">s3d_push_lines()</link>
+</para>
+</sect1>
+
+<sect1 id="s3d_push_lines">
+<title>s3d_push_lines</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_push_line</function></funcdef>
+<paramdef>int <parameter>object</parameter>, 
+unsigned  long *<parameter>*lbuf</parameter>,
+unsigned short <parameter>n</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Pushing n lines on the linestack of the object, each lbuf has a size of n*3,
+each entry has the index number of the first vertex, second vertex and material number just
+as in <link linkend="s3d_push_line">s3d_push_line()</link>.
+</para>
+</sect1>
+
+<sect1 id="s3d_push_texture">
+<title>s3d_push_texture</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_push_texture</function></funcdef>
+<paramdef>int <parameter>object</parameter>, 
+int <parameter>w</parameter>,
+int <parameter>h</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Adds a new texture with height w and height h on the texturestack.
+</para>
+</sect1>
+
+
+<sect1>
+<title>s3d_pop_vertex</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_pop_vertex</function></funcdef>
+<paramdef>int <parameter>object</parameter>, 
+unsigned short <parameter>n</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Deletes the latest n vertices from the vertex stack of the object.
+</para>
+</sect1>
+
+
+<sect1>
+<title>s3d_pop_polygon</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_pop_polygon</function></funcdef>
+<paramdef>int <parameter>object</parameter>, 
+unsigned short <parameter>n</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Deletes the latest n polygon from the polygon stack of the object.
+</para>
+</sect1>
+
+
+
+<sect1>
+<title>s3d_pop_material</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_pop_material</function></funcdef>
+<paramdef>int <parameter>object</parameter>, 
+unsigned short <parameter>n</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Deletes the latest n material from the material stack of the object.
+</para>
+</sect1>
+
+
+<sect1>
+<title>s3d_pop_texture</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_pop_texture</function></funcdef>
+<paramdef>int <parameter>object</parameter>, 
+unsigned short <parameter>n</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Deletes the latest n textures from the texture stack of the object.
+</para>
+</sect1>
+
+
+<sect1>
+<title>s3d_pop_line</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_pop_line</function></funcdef>
+<paramdef>int <parameter>object</parameter>, 
+unsigned short <parameter>n</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Deletes the latest n lines from the line stack of the object.
+</para>
+</sect1>
+
+<sect1 id="s3d_pep_polygon_normals">
+<title>s3d_pep_polygon_normals</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_pep_polygon_normals</function></funcdef>
+<paramdef>
+int <parameter>object</parameter>, 
+float *<parameter>nbuf</parameter>,
+unsigned short <parameter>n</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Adds normal information to polygons, giving each vertex of a polygon a normal information. With this, you can
+achieve smoothed edge effects. 
+</para>
+<para>
+nbuf should contain n * 9 float values, for each vertex a normal vector (x,y,z), and you have 
+3 Vertices for each Polygon so that makes 9 float values per Polygon in Total.	
+Don't worry if you don't use this, it's kind of hard to calculate and the server will always use some
+proper normal values (same for every vertex, calculated by the plane which is defined by the 3 points of the polygon.
+</para>
+</sect1>
+
+<sect1 id="s3d_pep_polygon_tex_coord">
+<title>s3d_pep_polygon_tex_coord</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_pep_polygon_tex_coord</function></funcdef>
+<paramdef>
+int <parameter>object</parameter>, 
+float <parameter>x1</parameter>, 
+float <parameter>y1</parameter>, 
+float <parameter>x2</parameter>, 
+float <parameter>y2</parameter>, 
+float <parameter>x3</parameter>, 
+float <parameter>y3</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Pimp the last polygon pushed with some textures coordinates, x and y values for each vertex point respectively.
+Those values may be between 0 and 1 and are vertex points on the <link linkend="s3d_pep_material_texture">
+texture defined in the material</link> of the polygon. If you have more polygons which should get a texture, use
+<link linkend="s3d_pep_polygon_tex_coords">s3d_pep_polygon_tex_coords()</link>
+</para>
+</sect1>
+
+<sect1 id="s3d_pep_polygon_tex_coords">
+<title>s3d_pep_polygon_tex_coords</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_pep_polygon_tex_coords</function></funcdef>
+<paramdef>
+int <parameter>object</parameter>, 
+float *<parameter>tbuf</parameter>, 
+int <parameter>n</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Pimp the latest n polygons with texture coordinates. tbuf has 6*n float values for its entries, which are supplied in the order
+as in <link linkend="s3d_pep_polygon_tex_coord">s3d_pep_polygon_tex_coord()</link>
+</para>
+</sect1>
+
+<sect1 id="s3d_pep_material_texture">
+<title>s3d_pep_material_texture</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_pep_material_texture</function></funcdef>
+<paramdef>
+int <parameter>object</parameter>, 
+unsigned long <parameter>tex</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Assign the latest material a texture referenced by the index tex. Of course, you will
+have pushed this texture with <link linkend="s3d_push_texture">s3d_push_texture</link>
+</para>
+</sect1>
+
+
+<sect1 id="s3d_pep_vertex">
+<title>s3d_pep_vertex</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_pep_vertex</function></funcdef>
+<paramdef>
+int <parameter>object</parameter>, 
+float <parameter>x</parameter>,
+float <parameter>y</parameter>,
+float <parameter>z</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Alter the latest pushed vertex, overwriting with the supplied values.
+</para>
+</sect1>
+
+<sect1 id="s3d_pep_vertices">
+<title>s3d_pep_vertices</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_pep_vertices</function></funcdef>
+<paramdef>
+int <parameter>object</parameter>, 
+float *<parameter>vbuf</parameter>,
+unsigned short <parameter>n</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Alter the latest n pushed vertex. vbuf holds the values which
+are used to overwrite the old data, n entries with each 3 floats
+specifying x,y,z of the vertices.
+</para>
+</sect1>
+
+<sect1 id="s3d_pep_line">
+<title>s3d_pep_line</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_pep_line</function></funcdef>
+<paramdef>
+int <parameter>object</parameter>, 
+unsigned long <parameter>v1</parameter>,
+unsigned long <parameter>v2</parameter>,
+unsigned long <parameter>material</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Alter the latest pushed line, overwriting with the supplied values.
+</para>
+</sect1>
+
+<sect1 id="s3d_pep_lines">
+<title>s3d_pep_lines</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_pep_lines</function></funcdef>
+<paramdef>
+int <parameter>object</parameter>, 
+unsigned long *<parameter>lbuf</parameter>,
+unsigned short <parameter>n</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Alter the latest n pushed lines. lbuf holds the values which
+are used to overwrite the old data, n entries with each 3 unsigned longs
+specifying first, second vertex and material of each line.
+</para>
+</sect1>
+
+<sect1 id="s3d_pep_line_normals">
+<title>s3d_pep_line_normals</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_pep_line_normals</function></funcdef>
+<paramdef>
+int <parameter>object</parameter>, 
+float *<parameter>nbuf</parameter>,
+unsigned short <parameter>n</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Adds normal information to lines, giving each vertex of a line a normal information. This makes 
+lines somewhat nicer, you'll need that especially when you're going to build wireframe models.
+</para>
+<para>
+nbuf should contain n * 6 float values, for each vertex a normal vector (x,y,z), and you have 
+2 Vertices for each line so that makes 6 float values per line in Total.	
+</para>
+</sect1>
+
+<sect1 id="s3d_load_line_normals">
+<title>s3d_load_line_normals</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_load_line_normals</function></funcdef>
+<paramdef>
+int <parameter>object</parameter>, 
+float *<parameter>nbuf</parameter>,
+int <parameter>start</parameter>,
+unsigned short <parameter>n</parameter>,
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Just as <link linkend="s3d_pep_line_normals">s3d_pep_line_normals()</link>, with the difference you won't alter 
+the latest n lines but n lines starting with index start.
+</para>
+</sect1>
+
+
+<sect1 id="s3d_pep_material">
+<title>s3d_pep_material</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_pep_material</function></funcdef>
+<paramdef>
+int <parameter>object</parameter>, 
+float <parameter>amb_r</parameter>,
+float <parameter>amb_g</parameter>,
+float <parameter>amb_b</parameter>,
+float <parameter>spec_r</parameter>,
+float <parameter>spec_g</parameter>,
+float <parameter>spec_b</parameter>,
+float <parameter>diff_r</parameter>,
+float <parameter>diff_g</parameter>,
+float <parameter>diff_b</parameter>,
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Overwriting the latest pushed Material, overwriting the current value with the specified one.
+See <link linkend="s3d_pep_materials_a">s3d_pep_materials_a</link> if you want to pep more materials.
+</para>
+</sect1>
+
+
+
+<sect1 id="s3d_pep_material_a">
+<title>s3d_pep_material_a</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_pep_material_a</function></funcdef>
+<paramdef>
+int <parameter>object</parameter>, 
+float <parameter>amb_r</parameter>,
+float <parameter>amb_g</parameter>,
+float <parameter>amb_b</parameter>,
+float <parameter>amb_a</parameter>,
+float <parameter>spec_r</parameter>,
+float <parameter>spec_g</parameter>,
+float <parameter>spec_b</parameter>,
+float <parameter>spec_a</parameter>,
+float <parameter>diff_r</parameter>,
+float <parameter>diff_g</parameter>,
+float <parameter>diff_b</parameter>,
+float <parameter>diff_a</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Overwriting the latest pushed Material, overwriting the current value with the specified one, with 
+<link linkend="alpha">alpha value</link> in contrast to <link linkend="s3d_pep_material">s3d_pep_material</link>
+See <link linkend="s3d_pep_materials_a">s3d_push_materials_a</link> if you want to pep more materials.
+</para>
+</sect1>
+
+<sect1 id="s3d_pep_materials_a">
+<title>s3d_pep_materials_a</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_pep_materials_a</function></funcdef>
+<paramdef>
+int <parameter>object</parameter>, 
+float *<parameter>mbuf</parameter>, 
+unsigned short <parameter>n</parameter>
+
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Alters the last n pushed Materials. See <link linkend="s3d_push_materials_a">s3d_push_materials_a()</link> for
+more information how mbuf should look like. Use <link linkend="s3d_pep_material_a">s3d_pep_material_a()</link>
+if you only want to alter the latest material.
+</para>
+</sect1>
+
+<sect1 id="s3d_load_materials_a">
+<title>s3d_load_materials_a</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_load_materials_a</function></funcdef>
+<paramdef>
+int <parameter>object</parameter>, 
+float *<parameter>mbuf</parameter>, 
+unsigned longs <parameter>start</parameter>,
+unsigned short <parameter>n</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Loads n materials starting from index position start into the Material stack.
+See <link linkend="s3d_push_materials_a">s3d_push_materials_a</link> for more informatino about the values in mbuf.
+</para>
+</sect1>
+
+
+
+<sect1 id="s3d_load_polygon_normals">
+<title>s3d_load_polygon_normals</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_load_polygon_normals</function></funcdef>
+<paramdef>
+int <parameter>object</parameter>, 
+float *<parameter>nbuf</parameter>,
+int <parameter>start</parameter>,
+unsigned short <parameter>n</parameter>,
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Just as <link linkend="s3d_pep_polygon_normals">s3d_pep_polygon_normals()</link>, with the difference you won't alter 
+the latest n polygons but n polygons starting with index start.
+</para>
+</sect1>
+
+
+<sect1 id="s3d_load_tex_coords">
+<title>s3d_load_tex_coords</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_load_tex_coords</function></funcdef>
+<paramdef>
+int <parameter>object</parameter>, 
+float *<parameter>tbuf</parameter>, 
+int <parameter>start</parameter>,
+int <parameter>n</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Just as <link linkend="s3d_pep_polygon_tex_coords">s3d_pep_polygon_tex_coords()</link>, with the difference you won't alter 
+the latest n polygons but n polygons starting with index start.
+</para>
+</sect1>
+
+<sect1 id="s3d_load_texture">
+<title>s3d_load_texture</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_load_texture</function></funcdef>
+<paramdef>
+int <parameter>object</parameter>, 
+unsigned long <parameter>tex</parameter>,
+unsigned short <parameter>xpos</parameter>,
+unsigned short <parameter>ypos</parameter>,
+unsigned short <parameter>w</parameter>,
+unsigned short <parameter>h</parameter>,
+unsgined char *<parameter>data</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+This will load an 32bit rgba image supplied in data at position xpos,ypos of the texture tex. The image has
+the width w and height h. This can be used to update only parts of the texture. It's no problem to supply big textures,
+as the image will be sent to server in fragments. Of course, you will have created the texture with 
+<link linkend="s3d_push_texture">s3d_push_texture</link>, have an material assigned to the texture with <link linkend="s3d_pep_material_texture">
+s3d_pep_material_texture()</link> and have your polygons set sane polygon texture coords 
+using <link linkend="s3d_pep_polygon_tex_coord">s3d_pep_polygon_tex_coord()</link>.
+</para>
+</sect1>
+
+
+<sect1 id="s3d_new_object">
+<title>s3d_new_object</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_new_object</function></funcdef>
+<paramdef>
+void
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Creates a new object, returning the object id.
+<warning><para>Of course, you won't forget to <link linkend="s3d_flags_on">toggle</link> it <link linkend="S3D_OF_VISIBLE">visible</link>, won't you?</para></warning>
+</para>
+</sect1>
+
+
+<sect1>
+<title>s3d_del_object</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_del_object</function></funcdef>
+<paramdef>
+int <parameter>oid</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Deletes the object referenced by oid.
+</para>
+</sect1>
+
+
+<sect1 id="s3d_clone_object">
+<title>s3d_clone_object</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_clone_object</function></funcdef>
+<paramdef>
+int <parameter>oid</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Clones an already exisiting object. They get just look the same as the
+parent-object and will change when the parent-object changes.
+Cloning especially makes sense if you want to use the same object a lot of
+times. Move and transform is independent from the parent.
+The function returns the childs object id.
+</para>
+</sect1>
+
+
+<sect1>
+<title>s3d_clone_object_target</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_clone_object_target</function></funcdef>
+<paramdef>
+int <parameter>oid</parameter>,
+int <parameter>toid</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Changes the clone target of oid to another object (toid). This assumes you've got
+oid from <link linkend="s3d_clone_object">s3d_clone_object</link> before.
+</para>
+</sect1>
+
+
+<sect1>
+<title>s3d_link</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_link</function></funcdef>
+<paramdef>
+int <parameter>oid_from</parameter>,
+int <parameter>oid_to</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+A linked object will move along with it's link parent. For example if you have
+a book on a table, you can link the book to the table so the book will 
+"keep on the table" if you move the table around in space.
+It will also rotate with the table etc.
+</para>
+</sect1>
+
+
+<sect1>
+<title>s3d_unlink</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_unlink</function></funcdef>
+<paramdef>
+int <parameter>oid</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Remove the link of object oid to its target.
+</para>
+</sect1>
+
+
+<sect1>
+<title>s3d_import_3ds</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_import_3ds</function></funcdef>
+<paramdef>
+char *<parameter>buf</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Imports a 3ds-file from memory (assuming that you have already loaded the 3ds-file and it's located at *buf).
+</para>
+<warning><para>Of course, you won't forget to <link linkend="s3d_flags_on">toggle</link> it <link linkend="S3D_OF_VISIBLE">visible</link>, won't you?</para></warning>
+</sect1>
+
+
+<sect1>
+<title>s3d_import_3ds_file</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_import_3ds_file</function></funcdef>
+<paramdef>
+char *<parameter>fname</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Opens the 3ds file referenced by 3ds. The function will also look in your object directories (maybe /usr/share/s3d, depending
+on your installation), so you can also use relative paths.
+</para>
+<warning><para>Of course, you won't forget to <link linkend="s3d_flags_on">toggle</link> it <link linkend="S3D_OF_VISIBLE">visible</link>, won't you?</para></warning>
+</sect1>
+
+
+<sect1 id="s3d_select_font">
+<title>s3d_select_font</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_select_font</function></funcdef>
+<paramdef>
+char *<parameter>mask</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+This selects a font for the <link linkend="s3d_draw_string">s3d_draw_string()</link> function.
+</para>
+<warning><para>Of course, you won't forget to <link linkend="s3d_flags_on">toggle</link> it <link linkend="S3D_OF_VISIBLE">visible</link>, won't you?</para></warning>
+<programlisting>
+    s3d_select_font("vera"); /* will use the vera font face */
+</programlisting>
+</sect1>
+
+
+<sect1 id="s3d_draw_string">
+<title>s3d_draw_string</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_draw_string</function></funcdef>
+<paramdef>
+char *<parameter>str</parameter>,
+float *<parameter>len</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Renders the string str with in Truetype format with the height 1, returns
+the length of the rendered string in *len (or set len=NULL to disable this).
+
+</para>
+<programlisting>
+	char str="hello world!";
+	float len;
+	<link linkend="s3d_select_font">s3d_select_font</link>("vera");
+	<emphasis>s3d_draw_string</emphasis>(str,len);
+
+	/* not interested in the length? do that:
+	 * <emphasis>s3d_draw_string</emphasis>(str,NULL); */
+</programlisting>
+</sect1>
+
+<sect1>
+<title>s3d_open_file</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_open_file</function></funcdef>
+<paramdef>
+char *<parameter>fname</parameter>,
+char **<parameter>pointer</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+This opens the file fname, setting *pointer to it's memory position. the
+function will return the size of buffer. you can free() the pointer when
+you're finished.
+</para>
+</sect1>
+
+
+
+<sect1 id="s3d_flags_on">
+<title>s3d_flags_on</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_flags_on</function></funcdef>
+<paramdef>
+int <parameter>object</parameter>,
+unsigned long <parameter>flags</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+turn some flags on for object.
+</para>
+<warning><para>if you don't toggle OF_VISIBLE on, you won't see your object. usually you want this. 
+(at least after you *push()d all your content)</para></warning>
+</sect1>
+
+<sect1 id="s3d_flags_off">
+<title>s3d_flags_off</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_flags_off</function></funcdef>
+<paramdef>
+int <parameter>object</parameter>,
+unsigned long <parameter>flags</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+turn some flags off for object.
+</para>
+</sect1>
+
+
+<sect1>
+<title>s3d_translate</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_translate</function></funcdef>
+<paramdef>
+int <parameter>object</parameter>,
+float <parameter>x</parameter>,
+float <parameter>y</parameter>,
+float <parameter>z</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Move the object to some position in space. when you create an object, it's 
+always located at 0.0 , 0.0, 0.0.
+</para>
+<important><para>Translation is absolute, not relative!</para></important>
+<programlisting>
+<emphasis>s3d_translate</emphasis>(object,2,0,0);
+<emphasis>s3d_translate</emphasis>(object,4,0,0);
+/* object will end up at 4,0,0 and not 6,0,0!! */
+</programlisting>
+</sect1>
+
+
+<sect1>
+<title>s3d_rotate</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_rotate</function></funcdef>
+<paramdef>
+int <parameter>object</parameter>,
+float <parameter>x</parameter>,
+float <parameter>y</parameter>,
+float <parameter>z</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+rotate an object around the x, y and z-axis respectively. x,y,z may have values
+between [0,360] degrees. 
+</para>
+<para>
+You will usually only rotate around one axis, leaving the unused fields on 0, I guess. 
+If you want to rotate around more than one axis, please note: The order of the rotation
+applies is y-axis, x-axis, and then z-axis. You can think of it as the earth position coordinates:
+x is the longitude, y is the latitude, and z is the rotation at this point of the earth around your
+bodies axis. (I wonder if that makes it any clearer ;)
+</para>
+<important><para>Rotate is absolute, not relative!</para></important>
+<programlisting>
+<emphasis>s3d_rotate</emphasis>(object,90,0,0);
+<emphasis>s3d_rotate</emphasis>(object,180,0,0);
+/* object will be rotated 180 degrees around the x-axis, not 270 degress! */
+</programlisting>
+</sect1>
+
+
+<sect1>
+<title>s3d_scale</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_scale</function></funcdef>
+<paramdef>
+int <parameter>object</parameter>,
+float <parameter>s</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Scales the object. about factor s. s=1 will be the original size, -1 will mirror it.
+</para>
+<important><para>s=0 is forbidden and will be ignored! s3d_scale is also absolute, not relative!</para></important>
+</sect1>
+
+<sect1>
+<title>s3d_push_event</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_push_event</function></funcdef>
+<paramdef>
+struct s3d_evt <parameter>*newevt</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Pushes an <link linkend="s3d_evt">event</link> onto the event-stack. Usually you don't need to do this manually.
+</para>
+</sect1>
+
+<sect1>
+<title>s3d_pop_event</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>struct s3d_evt *<function>s3d_pop_event</function></funcdef>
+<paramdef>void
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Pops the latest event from the stack. Don't forget to free() both the event
+and its buffer! Returns a pointer to <link linkend="s3d_evt">struct s3d_evt</link>.
+</para>
+</sect1>
+
+<sect1 id="s3d_find_event">
+<title>s3d_find_event</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>struct s3d_evt *<function>s3d_find_event</function></funcdef>
+<paramdef>
+unsigned char <parameter>event</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Finds the latest occurence of an event, giving the event type as argument.
+Returns a pointer to <link linkend="s3d_evt">struct s3d_evt</link>.
+</para>
+</sect1>
+
+<sect1>
+<title>s3d_delete_event</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_delete_event</function></funcdef>
+<paramdef>
+struct s3d_evt *<parameter>devt</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+deletes an event, the argument is the pointer to the <link linkend="s3d_evt">event</link> which is to be 
+deleted (maybe obtained from <link linkend="s3d_find_event">s3d_find_event</link>).
+</para>
+</sect1>
+
+<sect1 id="s3d_set_callback">
+<title>s3d_set_callback</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_set_callback</function></funcdef>
+<paramdef>
+unsigned char <parameter>event</parameter>
+s3d_cb <parameter>func</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+sets a <link linkend="s3d_cb">callback</link> for a certain event. this is very useful for event-oriented 
+applications. event callbacks will not interrupt each other or the mainloop.
+</para>
+<important><para>Defining callbacks will only work after calling <link linkend="s3d_init">s3d_init()</link></para></important>
+<programlisting>
+void obj_click(<link linkend="s3d_evt">struct s3d_evt</link> event)
+{
+	printf("object id %d got clicked", *((unsigned long *)event->buf));
+}
+...
+	<link linkend="s3d_set_callback">s3d_set_callback</link>(<link linkend="S3D_EVENT_NEW_OBJECT">S3D_EVENT_NEW_OBJECT</link>, obj_click);
+
+/* this will tell you when a object got clicked */
+</programlisting>
+</sect1>
+
+
+<sect1>
+<title>s3d_clear_callback</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>void <function>s3d_clear_callback</function></funcdef>
+<paramdef>
+unsigned char <parameter>event</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Clears the callback which is associated with the event.
+</para>
+</sect1>
+
+
+<sect1>
+<title>s3d_get_callback</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>s3d_cb <function>s3d_get_callback</function></funcdef>
+<paramdef>
+unsigned char <parameter>event</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Returns the <link linkend="s3d_cb">Callback-function</link> of the event.
+</para>
+<programlisting>
+	<link linkend="s3d_evt">struct s3d_evt</link> e;
+	...
+	<emphasis>s3d_get_callback</emphasis>(<link linkend="S3D_EVENT_KEY">S3D_EVENT_KEY</link>)(e);
+	/* will call the key-handling function with argument e.  */
+
+</programlisting>
+</sect1>
+
+
+<sect1>
+<title>s3d_process_stack</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>void <function>s3d_process_callback</function></funcdef>
+<paramdef>void
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+This function goes through all function of the event-stack and will call 
+functions. this is useful when you define a new function but still have a lot 
+of events of this type on the stack. 
+</para>
+<note><para>This is probably obsolete</para></note>
+</sect1>
+
+<sect1>
+<title>s3d_vector_length</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>float <function>s3d_vector_length</function></funcdef>
+<paramdef>
+float <parameter>vector</parameter>[]
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Calculates and returns the length of the given vector (which should be of the type float[3]).
+More info <ulink url="http://en.wikipedia.org/wiki/Vector_%28spatial%29#Length_of_a_vector">on wikipedia</ulink>.
+</para>
+</sect1>
+
+<sect1>
+<title>s3d_vector_substract</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>void <function>s3d_vector_substract</function></funcdef>
+<paramdef>
+float <parameter>vector1</parameter>[],
+float <parameter>vector2</parameter>[],
+float <parameter>result_vector</parameter>[]
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Substracts vector1 from vector2, writing result into result_vector.
+All vectors should have the format  float[3].
+More info <ulink url="http://en.wikipedia.org/wiki/Vector_%28spatial%29#Vector_addition_and_subtraction">on wikipedia</ulink>.
+</para>
+</sect1>
+
+<sect1>
+<title>s3d_vector_dot_product</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>float <function>s3d_vector_dot_product</function></funcdef>
+<paramdef>
+float <parameter>vector1</parameter>[],
+float <parameter>vector2</parameter>[]
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Calculates and returns the dot product of vector1 and vector2.
+All vectors should have the format  float[3].
+More info <ulink url="http://en.wikipedia.org/wiki/Vector_%28spatial%29#Dot_product">on wikipedia</ulink>.
+</para>
+</sect1>
+
+<sect1>
+<title>s3d_vector_angle</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>float <function>s3d_vector_angle</function></funcdef>
+<paramdef>
+float <parameter>vector1</parameter>[],
+float <parameter>vector2</parameter>[]
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Calculates and returns the angle between vector1 and vector2. Please note that the resulting angle is between 0 and PI, therefore not covering the whole period! To convert in degrees just do result*180/M_PI.
+All vectors should have the format  float[3].
+More info <ulink url="http://en.wikipedia.org/wiki/Vector_%28spatial%29#Dot_product">on wikipedia</ulink>.
+</para>
+</sect1>
+
+
+<sect1>
+<title>s3d_mcp_focus</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_mcp_focus</function></funcdef>
+<paramdef>
+int <parameter>object</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+This is an mcp-only function. It gives focus (for receiving key-strokes etc.)
+to an app referenced by it's mcp-object-id. 
+</para>
+</sect1>
+
+
+</chapter>
+
+
+<chapter id="data_types">
+<title>Data types</title>
+
+<sect1 id="s3d_obj_info">
+<title>struct s3d_but_info</title>
+<programlisting>
+struct s3d_obj_info 
+{
+	unsigned long object;
+	unsigned long flags;
+	float trans_x,trans_y,trans_z;
+	float rot_x,rot_y,rot_z;
+	float scale;
+	float r;
+	char name[256]; 
+};
+</programlisting>
+<para>
+Can be used on the buffer of an <link linkend="s3d_evt">event</link> of type <link linkend="S3D_EVENT_OBJ_INFO">S3D_EVENT_OBJ_INFO</link>.
+name will usually contain nothing for usual objects, but mcp objects will contain the applications names here. r is the radius of the convex sphere
+an object, which will also be interesting for the mcp.
+</para>
+<para>
+Special objects like camera, pointer will have the "sys_" prefix in the name and will be named "pointer0", "pointer1" ... or "cam0", "cam1" ...
+For cam object, scale will contain the aspect ratio.
+</para>
+</sect1>
+
+
+
+<sect1 id="s3d_but_info">
+<title>struct s3d_but_info</title>
+<programlisting>
+struct s3d_but_info     
+{                       
+    unsigned char button, state;
+};                      
+</programlisting>
+<para>
+Can be used on the buffer of an <link linkend="s3d_evt">event</link> of type <link linkend="S3D_EVENT_MBUTTON">S3D_EVENT_MBUTTON</link>.
+</para>
+</sect1>
+
+
+<sect1 id="mcp_object">
+<title>struct mcp_object</title>
+<programlisting>
+struct mcp_object 
+{
+	unsigned long object;
+	float trans_x,trans_y,trans_z;
+	float r;
+	char name[256]; 
+};
+
+</programlisting>
+<para>
+obsolete, deprecated, don't use, to be removed soon (use <link linkend="s3d_but_info">struct s3d_but_info</link>). ;)
+</para>
+</sect1>
+
+<sect1 id="s3d_evt">
+<title>struct s3d_evt</title>
+<programlisting>
+struct s3d_evt {
+	unsigned char event;
+	int length;
+	char *buf;
+	struct s3d_evt *next;
+};
+</programlisting>
+<para>
+
+This is the event information holder. 
+<variablelist>
+<varlistentry>
+<term>event</term>
+<listitem><para>gives the <link linkend="s3d_events">event type</link></para></listitem>
+</varlistentry>
+<varlistentry>
+<term>length</term>
+<listitem><para>gives the length of the buffer *buf</para></listitem>
+</varlistentry>
+<varlistentry>
+<term>*buf</term>
+<listitem><para>is the pointer to the multiple purpose buffer, which will have more specific information about the object</para></listitem>
+</varlistentry>
+<varlistentry>
+<term>*next</term>
+<listitem><para>can be safely ignored ;)</para></listitem>
+</varlistentry>
+</variablelist>
+
+Depending on the event, buf can contain the keycode pressed on keyboard event, the <link linkend="s3d_but_info">mouse button state</link> on a mouse event, <link linkend="s3d_obj_info">object information</link> etc.
+</para>
+</sect1>
+
+<sect1 id="s3d_cb">
+<title>typedef s3d_cb</title>
+<programlisting>
+typedef void (*<emphasis>s3d_cb</emphasis>)(<link linkend="s3d_evt">struct s3d_evt</link> *);
+</programlisting>
+<para>
+This defines the callback format. Each callback should return void and take an argument of <link linkend="s3d_evt">struct s3d_evt *</link>.
+Callbacks can be defined with <link linkend="s3d_set_callback">s3d_set_callback()</link>.
+</para>
+<programlisting>
+/* a callback handler could look like this: */
+void my_key_handler(struct s3d_evt *event_data)
+{
+	...
+}
+</programlisting>
+</sect1>
+</chapter>
+
+
+
+
+<chapter id="definitions">
+<title>Definitions</title>
+
+
+
+
+<sect1 id="s3d_events">
+<title>S3D events</title>
+<para>
+This defines the callback format. Each callback should return void and take an argument of <link linkend="s3d_evt">struct s3d_evt *</link>.
+Callbacks can be defined with <link linkend="s3d_set_callback">s3d_set_callback()</link>.
+<variablelist>
+
+<varlistentry>
+<term><anchor id="S3D_EVENT_OBJ_CLICK"/>S3D_EVENT_OBJ_CLICK</term>
+<listitem><para>
+An object got clicked (when you set the flag <link linkend="S3D_OF_SELECTABLE">S3D_OF_SELECTABLE</link>), buf will contain the object id
+of the object which got clicked (unsigned long, 4 byte)
+</para></listitem>
+</varlistentry>
+
+<varlistentry>
+<term><anchor id="S3D_EVENT_KEY"/>S3D_EVENT_KEY</term>
+<listitem><para>
+A key was pressed, buf will contain a keycode. use  <![CDATA[#include <s3d_keysym.h>]]> to have the keycodes available. buf is a 2 byte unsigned short keycode.
+</para></listitem>
+</varlistentry>
+
+
+<varlistentry>
+<term><anchor id="S3D_EVENT_MBUTTON"/>S3D_EVENT_MBUTTON</term>
+<listitem><para>
+A mouse button was clicked. Use <link linkend="s3d_but_info">struct s3d_but_info</link> on buf to get more info.
+</para></listitem>
+</varlistentry>
+
+<varlistentry>
+<term><anchor id="S3D_EVENT_NEW_OBJECT"/>S3D_EVENT_NEW_OBJECT</term>
+<listitem><para>
+deprecated, will use <link linkend="S3D_EVENT_OBJ_INFO">S3D_EVENT_OBJ_INFO</link>
+</para></listitem>
+</varlistentry>
+
+
+<varlistentry>
+<term><anchor id="S3D_EVENT_OBJ_INFO"/>S3D_EVENT_OBJ_INFO</term>
+<listitem><para>
+Something happened to an object. This can happen if the camera was moved, the mouse (pointer) was moved or an application appeared/changed in the mcp
+
+</para></listitem>
+</varlistentry>
+
+<varlistentry>
+<term><anchor id="S3D_MCP_OBJECT"/>S3D_MCP_OBJECT</term>
+<listitem><para>
+As the name suggests, those will only happen to the MCP. 
+This tells it about new/changed application object. <link linkend="mcp_object">struct mcp_object</link>
+can be used on buf. To be removed in the future.
+</para></listitem>
+</varlistentry>
+
+<varlistentry>
+<term><anchor id="S3D_MCP_DEL_OBJECT"/>S3D_MCP_DEL_OBJECT</term>
+<listitem><para>
+As the name suggests, those will only happen to the MCP. 
+This tells it about deleted application object. <link linkend="mcp_object">struct mcp_object</link>
+can be used on buf. To be removed in the future.
+</para></listitem>
+</varlistentry>
+
+
+<varlistentry>
+<term><anchor id="S3D_EVENT_QUIT"/>S3D_EVENT_QUIT</term>
+<listitem><para>
+Server sent the quit signal, or the connection was terminated. Usually, this is only processed internally.
+</para></listitem>
+</varlistentry>
+
+
+
+</variablelist>
+</para>
+<programlisting>
+/* a callback handler could look like this: */
+void my_key_handler(struct s3d_evt *event_data)
+{
+	...
+}
+</programlisting>
+</sect1>
+
+
+<sect1 id="s3d_object_flags">
+<title>S3D Object Flags</title>
+<para>
+Objects can have several flags to change their behaviour in the server and can be set with 
+<link linkend="s3d_flags_on">s3d_flags_on()</link> and
+<link linkend="s3d_flags_off">s3d_flags_off()</link>
+<variablelist>
+<varlistentry>
+<term><anchor id="S3D_OF_VISIBLE"/>S3D_OF_VISIBLE</term>
+<listitem><para>default:off</para><para>
+Obviously, if this flag is toggled the user can see it, if not it will be hidden. ;)
+</para><para>
+When an object is created it's turned off, so you will be able push your geometry data and
+turn it on after you're done. That avaoids flickering and stuff.
+</para></listitem>
+</varlistentry>
+
+<varlistentry>
+<term><anchor id="S3D_OF_SELECTABLE"/>S3D_OF_SELECTABLE</term>
+<listitem><para>default:off</para><para>
+When this is toggled on, you will receive <link linkend="S3D_EVENT_OBJ_CLICK">click events</link>.
+Don't use it if you don't need it, it will eat performance.
+</para></listitem>
+</varlistentry>
+
+<varlistentry>
+<term><anchor id="S3D_OF_POINTABLE"/>S3D_OF_POINTABLE</term>
+<listitem><para>default:off</para><para>
+Placeholder for pointer (onmouseover-event enabler) events. Not implemented yet.
+</para></listitem>
+</varlistentry>
+
+</variablelist>
+</para>
+</sect1>
+
+</chapter>
+
+<chapter id="Notes">
+<title>Additional Notes</title>
+<sect1 id="alpha">
+<title>About alpha transparency</title>
+<para>
+Alpha transparency works, but polygons don't get ordered in view direction on the server yet. So please don't
+use this feature yet. If you have an easy idea how to do that with opengl please drop me a line.
+</para>
+</sect1>
+</chapter>
+
+
+
+
+<chapter id="About">
+<title>About</title>
+<para>
+Copyright ? 2006 Simon Wunderlich <email>dotslash at packetmixer.de</email>
+</para>
+<para>
+All Rights reserved. That is, because I currently don't know how to license this. You may distribute or copy it as long this 
+Documentation is unmodified and complete (I'd love to receive patches and corrections though). Don't hesitate to ask
+if you want to use this doc in any way or have some license recommendation.
+</para>
+</chapter>
+
+</book>
+



From dotslash at berlios.de  Mon Jun  5 22:09:58 2006
From: dotslash at berlios.de (dotslash at BerliOS)
Date: Mon, 5 Jun 2006 22:09:58 +0200
Subject: [S3d-svn] r341 - in trunk: . Documentation Documentation/libs3d Documentation/libs3dw Documentation/server
Message-ID: <200606052009.k55K9wrM011037@sheep.berlios.de>

Author: dotslash
Date: 2006-06-05 22:09:53 +0200 (Mon, 05 Jun 2006)
New Revision: 341

Added:
   trunk/Documentation/README
   trunk/Documentation/TODO
   trunk/Documentation/bookinfo.docbook
   trunk/Documentation/libs3d/libs3d.docbook
   trunk/Documentation/libs3dw/
   trunk/Documentation/libs3dw/libs3dw.docbook
   trunk/Documentation/server/
   trunk/Documentation/server/server.docbook
Removed:
   trunk/Documentation/OPEN_PROBLEMS.txt
   trunk/Documentation/for_icon_designer.txt
   trunk/Documentation/libs3d/Makefile.am
   trunk/Documentation/libs3d/README
   trunk/Documentation/libs3d/TODO
   trunk/Documentation/libs3d/bookinfo.docbook
   trunk/Documentation/libs3d/s3dapi.docbook
   trunk/Documentation/movement.txt
   trunk/Documentation/s3drc.txt
Modified:
   trunk/
Log:
 r733 at balthasar:  dotslash | 2006-06-05 22:09:45 +0200
 - new documentation
 - move small doc files in the large docbook



Property changes on: trunk
___________________________________________________________________
Name: svk:merge
   - bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:731
   + bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:733

Deleted: trunk/Documentation/OPEN_PROBLEMS.txt
===================================================================
--- trunk/Documentation/OPEN_PROBLEMS.txt	2006-06-05 16:14:23 UTC (rev 340)
+++ trunk/Documentation/OPEN_PROBLEMS.txt	2006-06-05 20:09:53 UTC (rev 341)
@@ -1,27 +0,0 @@
-Of course we have a lot of problems which are yet unsolved,
-and maybe you're experienced in this topic and can help out.
-We need any comment and idea, so please help us! 
-
-You can find Contact Information in the README file.
-
-
-ANTI-ALIASING WITH OPENGL?
---------------------------
-
-Right now, rendering is not really pretty (as you can probably see),
-so we would like to have some anti-aliasing. Is there a (performant)
-way to do so?
-
-ALPHA SORTING
--------------
-
-Alpha polygons are blended in the order as they are drawn by opengl-calls,
-not in their z-order. Is there any easy way to do so?
-
-DOCUMENTATION
--------------
-
-I'd like to convert the old s3dlib.txt in some new format so we can export this 
-into man, html, latex (pdf,ps) etc ...
-Can you recommend any System? Doxygen? Docbook? I've fiddled with doxygen,
-but it slightly confused me ...

Added: trunk/Documentation/README
===================================================================
--- trunk/Documentation/README	2006-06-05 16:14:23 UTC (rev 340)
+++ trunk/Documentation/README	2006-06-05 20:09:53 UTC (rev 341)
@@ -0,0 +1,8 @@
+You can read this online on
+
+http://s3d.berlios.de/doc
+
+or compile it yourself, for example with
+
+docbook2html s3d.docbook
+

Added: trunk/Documentation/TODO
===================================================================
--- trunk/Documentation/TODO	2006-06-05 16:14:23 UTC (rev 340)
+++ trunk/Documentation/TODO	2006-06-05 20:09:53 UTC (rev 341)
@@ -0,0 +1,2 @@
+* libs3d
+  - texture start position

Added: trunk/Documentation/bookinfo.docbook
===================================================================
--- trunk/Documentation/bookinfo.docbook	2006-06-05 16:14:23 UTC (rev 340)
+++ trunk/Documentation/bookinfo.docbook	2006-06-05 20:09:53 UTC (rev 341)
@@ -0,0 +1,27 @@
+<?xml version="1.0" encoding="UTF-8" ?>
+<bookinfo>
+<title>S3D - a 3D Desktop Enviroment</title>
+<authorgroup>
+<author>
+<firstname>Simon</firstname>
+<surname>Wunderlich</surname>
+</author>
+</authorgroup>
+
+<date>06/05/2006</date>
+<releaseinfo>0.2</releaseinfo>
+
+<abstract>
+<para>
+This is the Documentation for the S3D and it's Developer Libraries.
+</para>
+</abstract>
+
+<keywordset>
+<keyword>s3d</keyword>
+<keyword>API</keyword>
+<keyword>handbook</keyword>
+<keyword>guide</keyword>
+</keywordset>
+
+</bookinfo>

Deleted: trunk/Documentation/for_icon_designer.txt
===================================================================
--- trunk/Documentation/for_icon_designer.txt	2006-06-05 16:14:23 UTC (rev 340)
+++ trunk/Documentation/for_icon_designer.txt	2006-06-05 20:09:53 UTC (rev 341)
@@ -1,15 +0,0 @@
-I hope this gives some useful Information for Icon designer:
-
-- We currently only support 3ds file format.
-- All Icons coordinates should be within [-1,-1,-1], [1,1,1]
-  so we always have the same size. Its no problem
-  to scale them bigger or smaller in s3d.
-- middle of the icon is located at [0,0,0]
-- please see objs/cube.3ds for a size reference. this cube is exactly
-  filling the [-1,-1,-1], [1,1,1] space
-- Textures are (not yet) supported.
-- Alpha blending works somehow, but not very well (see OPEN_PROBLEMS)
-- Please keep Polygon number low ... if possible, under 50,
-  but always under 100. Icons should not bloat the User workspace.
-
-

Deleted: trunk/Documentation/libs3d/Makefile.am
===================================================================
--- trunk/Documentation/libs3d/Makefile.am	2006-06-05 16:14:23 UTC (rev 340)
+++ trunk/Documentation/libs3d/Makefile.am	2006-06-05 20:09:53 UTC (rev 341)
@@ -1,2 +0,0 @@
-EXTRA_DIST	= s3dapi.docbook bookinfo.docbook
-

Deleted: trunk/Documentation/libs3d/README
===================================================================
--- trunk/Documentation/libs3d/README	2006-06-05 16:14:23 UTC (rev 340)
+++ trunk/Documentation/libs3d/README	2006-06-05 20:09:53 UTC (rev 341)
@@ -1,8 +0,0 @@
-You can read this online on
-
-http://s3d.berlios.de/doc
-
-or compile it yourself, for example with
-
-docbook2html s3dapi.docbook
-

Deleted: trunk/Documentation/libs3d/TODO
===================================================================
--- trunk/Documentation/libs3d/TODO	2006-06-05 16:14:23 UTC (rev 340)
+++ trunk/Documentation/libs3d/TODO	2006-06-05 20:09:53 UTC (rev 341)
@@ -1 +0,0 @@
-- texture start position

Deleted: trunk/Documentation/libs3d/bookinfo.docbook
===================================================================
--- trunk/Documentation/libs3d/bookinfo.docbook	2006-06-05 16:14:23 UTC (rev 340)
+++ trunk/Documentation/libs3d/bookinfo.docbook	2006-06-05 20:09:53 UTC (rev 341)
@@ -1,26 +0,0 @@
-<bookinfo>
-<title>The s3d manual</title>
-<authorgroup>
-<author>
-<firstname>Simon</firstname>
-<surname>Wunderlich</surname>
-</author>
-</authorgroup>
-
-<date>03/19/2006</date>
-<releaseinfo>0.1</releaseinfo>
-
-<abstract>
-<para>
-This Manual is the programmers guide to the s3d API.
-</para>
-</abstract>
-
-<keywordset>
-<keyword>s3d</keyword>
-<keyword>API</keyword>
-<keyword>handbook</keyword>
-<keyword>guide</keyword>
-</keywordset>
-
-</bookinfo>

Added: trunk/Documentation/libs3d/libs3d.docbook
===================================================================
--- trunk/Documentation/libs3d/libs3d.docbook	2006-06-05 16:14:23 UTC (rev 340)
+++ trunk/Documentation/libs3d/libs3d.docbook	2006-06-05 20:09:53 UTC (rev 341)
@@ -0,0 +1,1709 @@
+<?xml version="1.0" encoding="UTF-8" ?>
+<chapter id="libs3d">
+<title>libs3d - The S3D API</title>
+<sect1 id="using">
+<title>Using the <application>s3d</application> library</title>
+<sect2 id="setup">
+<title>Setting <application>s3d</application> up</title>
+ <para>
+ Install the lib using the usual usual mechanism:
+ <programlisting>
+ ./configure
+ make
+ make install
+ </programlisting>
+ You might need to have superuser rights in order to do make install. You should now have the server,
+ the library and some applications installed somewhere.
+ </para>
+</sect2>
+<sect2 id="gettingstarted">
+<title>Getting started</title>
+<para>
+ After having <application>s3d</application> installed, you can write your own <application>s3d</application> programs (yeah, that is what this guide is about ;)
+ <programlisting>
+ <![CDATA[#include <s3d.h>]]>
+ </programlisting>
+ should be enough to access the 3d functions. If you want to use keyboard interaction, do
+ <programlisting>
+ <![CDATA[#include <s3d_keysym.h>]]>
+ </programlisting>
+ for the keycode table.
+ Now you can compile your program with 
+ <screen>
+ <prompt>bash$</prompt> <command> gcc <replaceable>program</replaceable>.c -ls3d -o <replaceable>program</replaceable> </command>
+ That wasn't that hard, wasn't it?
+ </screen>
+</para>
+</sect2>
+</sect1>
+
+
+<sect1 id="functions">
+<title>function reference</title>
+
+<sect2 id="s3d_init">
+<title>s3d_init</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_init</function></funcdef>
+<paramdef>
+int *<parameter>argc</parameter>.
+char ***<parameter>argv</parameter>
+char *<parameter>name</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+This will initialize the <application>s3d</application>-library and the connection to the Server. It will return 0 on
+success in Server initializion. name specifies the your programs name.
+</para>
+<programlisting>
+int main(char argc, char **argv)
+{
+	if (!<emphasis>s3d_init(<![CDATA[&argc,&argv]]>,"Hello world")</emphasis>) 
+	{
+		...
+		<link linkend="s3d_quit">s3d_quit()</link>;
+	}
+	return(0);
+}
+			   
+</programlisting>
+</sect2>
+
+
+<sect2 id="s3d_quit">
+<title>s3d_quit</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_quit</function></funcdef>
+<paramdef>void </paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+closes the connection and cleares the event-stack. it can also be used to leave
+the <link linkend="s3d_mainloop">s3d_mainloop</link>.
+</para>
+</sect2>
+
+<sect2 id="s3d_usage">
+<title>s3d_usage</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>void <function>s3d_usage</function></funcdef>
+<paramdef>void </paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Prints the possible parameter for the client library (which can be passed in 
+<link linkend="s3d_init">s3d_init()</link>)
+</para>
+</sect2>
+
+<sect2 id="s3d_mainloop">
+<title>s3d_mainloop</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_mainloop</function></funcdef>
+<paramdef>void (*<parameter>f</parameter>)()</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+takes a function as argument. it will loop this function until a quit-event is
+received. you can pass NULL if you have no function to be looped, but its
+better to sleep some time if you have nothing to do anyway to save cpu-time.
+</para>
+<programlisting>
+void mainloop()
+{
+    usleep(1000); // sleep 1 ms in every cycle
+}
+...
+
+<emphasis>s3d_mainloop</emphasis>(mainloop());
+
+</programlisting>
+</sect2>
+
+
+<sect2 id="s3d_push_vertex">
+<title>s3d_push_vertex</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_push_vertex</function></funcdef>
+<paramdef>int <parameter>object</parameter>, float <parameter>x</parameter>, float <parameter>y</parameter>, float <parameter>z</parameter></paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+pushes a vertex onto the vertex stack. make sure that you count how many
+vertices you've pushed because you'll need that for referencing when you push
+your polygons.
+</para>
+</sect2>
+
+
+<sect2>
+<title>s3d_push_vertices</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_push_vertices</function></funcdef>
+<paramdef>int <parameter>object</parameter>, float *<parameter>vbuf</parameter>, unsigned short <parameter>n</parameter></paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+push some vertices from an array. that's much better for performing than
+using <link linkend="s3d_push_vertex">s3d_push_vertex()</link> if you have a lot of vertices (and that's probably the
+usual case).
+</para>
+<programlisting>
+float vertices[] = { 0.0, 0.0, 0.0,
+                     1.0, 2.0, 3,0,
+                     3.0, 2.0, 1.0};
+<emphasis>s3d_push_vertices</emphasis>(object, vertices, 3); /* pushing 3 vertices */
+</programlisting>
+</sect2>
+
+
+<sect2 id="s3d_push_material">
+<title>s3d_push_material</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_push_material</function></funcdef>
+<paramdef>int <parameter>object</parameter>, 
+float <parameter>amb_r</parameter>,
+float <parameter>amb_g</parameter>,
+float <parameter>amb_b</parameter>,
+float <parameter>spec_r</parameter>,
+float <parameter>spec_g</parameter>,
+float <parameter>spec_b</parameter>,
+float <parameter>diff_r</parameter>,
+float <parameter>diff_g</parameter>,
+float <parameter>diff_b</parameter>,
+
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+pushes a material for an object. you will have to count them yourself too, as
+polygons will ask for the material index number. the material properties are
+given in rgb (red/green/blue) color codes, in float. 0.0 is the minimum,
+1.0 is the maximum a color value can be.
+the specular color is the color which is directly reflected from the light
+source. the diffuse color is the color which can be seen in the bright side
+of the object, and the ambience color is the color of the shadow side of the
+object.
+</para>
+</sect2>
+
+<sect2 id="s3d_push_material_a">
+<title>s3d_push_material_a</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_push_material_a</function></funcdef>
+<paramdef>int <parameter>object</parameter>, 
+float <parameter>amb_r</parameter>,
+float <parameter>amb_g</parameter>,
+float <parameter>amb_b</parameter>,
+float <parameter>amb_a</parameter>,
+float <parameter>spec_r</parameter>,
+float <parameter>spec_g</parameter>,
+float <parameter>spec_b</parameter>,
+float <parameter>spec_a</parameter>,
+float <parameter>diff_r</parameter>,
+float <parameter>diff_g</parameter>,
+float <parameter>diff_b</parameter>,
+float <parameter>diff_a</parameter>
+
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Same as <link linkend="s3d_push_material">s3d_push_material</link>, but color has <link linkend="alpha">alpha value</link> added.
+Use <link linkend="s3d_push_materials_a">s3d_push_materials_a()</link> if you have a lot of materials to push.
+</para>
+</sect2>
+
+
+<sect2 id="s3d_push_materials_a">
+<title>s3d_push_materials_a</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_push_materials_a</function></funcdef>
+<paramdef>
+int <parameter>object</parameter>, 
+float *<parameter>mbuf</parameter>, 
+unsigned short <parameter>n</parameter>
+
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Pushes a buffer of Materials. Those Materials are in the format float[n*12], with
+<itemizedlist>
+<listitem><para>mbuf[n*12 + 0-3] - ambience</para></listitem>
+<listitem><para>mbuf[n*12 + 4-7] - specular</para></listitem>
+<listitem><para>mbuf[n *12 + 8-11] - diffusion values </para></listitem>
+</itemizedlist>
+of each entry. n is the number of materials pushed. The values are in the order r,g,b,a.
+If you only want to push one material, use the more easy <link linkend="s3d_push_material_a">s3d_push_material_a()</link>
+function.
+</para>
+<programlisting>
+/* each line has r,g,b,a value */
+float bla[24]=
+	{1,0,0,1,
+	 1,0,0,1,
+	 1,0,0,1,
+	 0,1,1,1,
+	 0,1,1,1,
+	 0,1,1,1};
+
+s3d_push_materials_a(object,mbuf,2); /* push a red and a cyan material */
+</programlisting>
+</sect2>
+
+
+
+<sect2>
+<title>s3d_push_polygon</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_push_polygon</function></funcdef>
+<paramdef>int <parameter>object</parameter>, 
+int <parameter>v1</parameter>,
+int <parameter>v2</parameter>,
+int <parameter>v3</parameter>,
+int <parameter>material</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+push one polygon on the polygonstack of the object. it takes 3 vertex-index-
+numbers and one material material-index-nr. as argument.
+</para>
+<programlisting>
+int oid=<link linkend="s3d_new_object">s3d_new_object</link>();   /* create a new object */
+<link linkend="s3d_push_vertex">s3d_push_vertex</link>(oid,0.0,0.0,0.0);
+<link linkend="s3d_push_vertex">s3d_push_vertex</link>(oid,0.0,1.0,0.0);
+<link linkend="s3d_push_vertex">s3d_push_vertex</link>(oid,1.0,0.0,0.0);
+<link linkend="s3d_push_material">s3d_push_material</link>(oid,0.3,0.0,0.0, 1.0,1.0,1.0, 1.0,0.0,0.0);
+<emphasis>s3d_push_polygon</emphasis>(oid,0,1,2,0);
+/* this will create a red polygon */
+</programlisting>
+</sect2>
+
+
+<sect2>
+<title>s3d_push_polygons</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_push_polygons</function></funcdef>
+<paramdef>int <parameter>object</parameter>, 
+unsigned long <parameter>*pbuf</parameter>,
+unsigned short <parameter>n</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+as for vertices, you can push arrays of polygons to have greater performance.
+the pbuf should contain n polygons which consist of 4 unsigned long values
+of 3 vertices indeces and 1 material index.
+</para>
+<programlisting>
+unsigned long pbuf[] = { 0,1,2,0};
+int oid=<link linkend="s3d_new_object">s3d_new_object</link>();   /* create a new object */
+<link linkend="s3d_push_vertex">s3d_push_vertex</link>(oid,0.0,0.0,0.0);
+<link linkend="s3d_push_vertex">s3d_push_vertex</link>(oid,0.0,1.0,0.0);
+<link linkend="s3d_push_vertex">s3d_push_vertex</link>(oid,1.0,0.0,0.0);
+<link linkend="s3d_push_material">s3d_push_material</link>(oid,0.3,0.0,0.0, 1.0,1.0,1.0, 1.0,0.0,0.0);
+<emphasis>s3d_push_polygons</emphasis>(oid,pbuf,1);
+/* push one polygon with the pbuf data */
+</programlisting>
+</sect2>
+
+
+<sect2 id="s3d_push_line">
+<title>s3d_push_line</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_push_line</function></funcdef>
+<paramdef>int <parameter>object</parameter>, 
+int <parameter>v1</parameter>,
+int <parameter>v2</parameter>,
+int <parameter>material</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Push one line on the linestack of the object. It takes 2 vertex-index-
+numbers and one material material-index-nr. as argument. If you have
+a lot of lines to push, use <link linkend="s3d_push_lines">s3d_push_lines()</link>
+</para>
+</sect2>
+
+<sect2 id="s3d_push_lines">
+<title>s3d_push_lines</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_push_line</function></funcdef>
+<paramdef>int <parameter>object</parameter>, 
+unsigned  long *<parameter>*lbuf</parameter>,
+unsigned short <parameter>n</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Pushing n lines on the linestack of the object, each lbuf has a size of n*3,
+each entry has the index number of the first vertex, second vertex and material number just
+as in <link linkend="s3d_push_line">s3d_push_line()</link>.
+</para>
+</sect2>
+
+<sect2 id="s3d_push_texture">
+<title>s3d_push_texture</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_push_texture</function></funcdef>
+<paramdef>int <parameter>object</parameter>, 
+int <parameter>w</parameter>,
+int <parameter>h</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Adds a new texture with height w and height h on the texturestack.
+</para>
+</sect2>
+
+
+<sect2>
+<title>s3d_pop_vertex</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_pop_vertex</function></funcdef>
+<paramdef>int <parameter>object</parameter>, 
+unsigned short <parameter>n</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Deletes the latest n vertices from the vertex stack of the object.
+</para>
+</sect2>
+
+
+<sect2>
+<title>s3d_pop_polygon</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_pop_polygon</function></funcdef>
+<paramdef>int <parameter>object</parameter>, 
+unsigned short <parameter>n</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Deletes the latest n polygon from the polygon stack of the object.
+</para>
+</sect2>
+
+
+
+<sect2>
+<title>s3d_pop_material</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_pop_material</function></funcdef>
+<paramdef>int <parameter>object</parameter>, 
+unsigned short <parameter>n</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Deletes the latest n material from the material stack of the object.
+</para>
+</sect2>
+
+
+<sect2>
+<title>s3d_pop_texture</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_pop_texture</function></funcdef>
+<paramdef>int <parameter>object</parameter>, 
+unsigned short <parameter>n</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Deletes the latest n textures from the texture stack of the object.
+</para>
+</sect2>
+
+
+<sect2>
+<title>s3d_pop_line</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_pop_line</function></funcdef>
+<paramdef>int <parameter>object</parameter>, 
+unsigned short <parameter>n</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Deletes the latest n lines from the line stack of the object.
+</para>
+</sect2>
+
+<sect2 id="s3d_pep_polygon_normals">
+<title>s3d_pep_polygon_normals</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_pep_polygon_normals</function></funcdef>
+<paramdef>
+int <parameter>object</parameter>, 
+float *<parameter>nbuf</parameter>,
+unsigned short <parameter>n</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Adds normal information to polygons, giving each vertex of a polygon a normal information. With this, you can
+achieve smoothed edge effects. 
+</para>
+<para>
+nbuf should contain n * 9 float values, for each vertex a normal vector (x,y,z), and you have 
+3 Vertices for each Polygon so that makes 9 float values per Polygon in Total.	
+Don't worry if you don't use this, it's kind of hard to calculate and the server will always use some
+proper normal values (same for every vertex, calculated by the plane which is defined by the 3 points of the polygon.
+</para>
+</sect2>
+
+<sect2 id="s3d_pep_polygon_tex_coord">
+<title>s3d_pep_polygon_tex_coord</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_pep_polygon_tex_coord</function></funcdef>
+<paramdef>
+int <parameter>object</parameter>, 
+float <parameter>x1</parameter>, 
+float <parameter>y1</parameter>, 
+float <parameter>x2</parameter>, 
+float <parameter>y2</parameter>, 
+float <parameter>x3</parameter>, 
+float <parameter>y3</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Pimp the last polygon pushed with some textures coordinates, x and y values for each vertex point respectively.
+Those values may be between 0 and 1 and are vertex points on the <link linkend="s3d_pep_material_texture">
+texture defined in the material</link> of the polygon. If you have more polygons which should get a texture, use
+<link linkend="s3d_pep_polygon_tex_coords">s3d_pep_polygon_tex_coords()</link>
+</para>
+</sect2>
+
+<sect2 id="s3d_pep_polygon_tex_coords">
+<title>s3d_pep_polygon_tex_coords</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_pep_polygon_tex_coords</function></funcdef>
+<paramdef>
+int <parameter>object</parameter>, 
+float *<parameter>tbuf</parameter>, 
+int <parameter>n</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Pimp the latest n polygons with texture coordinates. tbuf has 6*n float values for its entries, which are supplied in the order
+as in <link linkend="s3d_pep_polygon_tex_coord">s3d_pep_polygon_tex_coord()</link>
+</para>
+</sect2>
+
+<sect2 id="s3d_pep_material_texture">
+<title>s3d_pep_material_texture</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_pep_material_texture</function></funcdef>
+<paramdef>
+int <parameter>object</parameter>, 
+unsigned long <parameter>tex</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Assign the latest material a texture referenced by the index tex. Of course, you will
+have pushed this texture with <link linkend="s3d_push_texture">s3d_push_texture</link>
+</para>
+</sect2>
+
+
+<sect2 id="s3d_pep_vertex">
+<title>s3d_pep_vertex</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_pep_vertex</function></funcdef>
+<paramdef>
+int <parameter>object</parameter>, 
+float <parameter>x</parameter>,
+float <parameter>y</parameter>,
+float <parameter>z</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Alter the latest pushed vertex, overwriting with the supplied values.
+</para>
+</sect2>
+
+<sect2 id="s3d_pep_vertices">
+<title>s3d_pep_vertices</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_pep_vertices</function></funcdef>
+<paramdef>
+int <parameter>object</parameter>, 
+float *<parameter>vbuf</parameter>,
+unsigned short <parameter>n</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Alter the latest n pushed vertex. vbuf holds the values which
+are used to overwrite the old data, n entries with each 3 floats
+specifying x,y,z of the vertices.
+</para>
+</sect2>
+
+<sect2 id="s3d_pep_line">
+<title>s3d_pep_line</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_pep_line</function></funcdef>
+<paramdef>
+int <parameter>object</parameter>, 
+unsigned long <parameter>v1</parameter>,
+unsigned long <parameter>v2</parameter>,
+unsigned long <parameter>material</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Alter the latest pushed line, overwriting with the supplied values.
+</para>
+</sect2>
+
+<sect2 id="s3d_pep_lines">
+<title>s3d_pep_lines</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_pep_lines</function></funcdef>
+<paramdef>
+int <parameter>object</parameter>, 
+unsigned long *<parameter>lbuf</parameter>,
+unsigned short <parameter>n</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Alter the latest n pushed lines. lbuf holds the values which
+are used to overwrite the old data, n entries with each 3 unsigned longs
+specifying first, second vertex and material of each line.
+</para>
+</sect2>
+
+<sect2 id="s3d_pep_line_normals">
+<title>s3d_pep_line_normals</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_pep_line_normals</function></funcdef>
+<paramdef>
+int <parameter>object</parameter>, 
+float *<parameter>nbuf</parameter>,
+unsigned short <parameter>n</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Adds normal information to lines, giving each vertex of a line a normal information. This makes 
+lines somewhat nicer, you'll need that especially when you're going to build wireframe models.
+</para>
+<para>
+nbuf should contain n * 6 float values, for each vertex a normal vector (x,y,z), and you have 
+2 Vertices for each line so that makes 6 float values per line in Total.	
+</para>
+</sect2>
+
+<sect2 id="s3d_load_line_normals">
+<title>s3d_load_line_normals</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_load_line_normals</function></funcdef>
+<paramdef>
+int <parameter>object</parameter>, 
+float *<parameter>nbuf</parameter>,
+int <parameter>start</parameter>,
+unsigned short <parameter>n</parameter>,
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Just as <link linkend="s3d_pep_line_normals">s3d_pep_line_normals()</link>, with the difference you won't alter 
+the latest n lines but n lines starting with index start.
+</para>
+</sect2>
+
+
+<sect2 id="s3d_pep_material">
+<title>s3d_pep_material</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_pep_material</function></funcdef>
+<paramdef>
+int <parameter>object</parameter>, 
+float <parameter>amb_r</parameter>,
+float <parameter>amb_g</parameter>,
+float <parameter>amb_b</parameter>,
+float <parameter>spec_r</parameter>,
+float <parameter>spec_g</parameter>,
+float <parameter>spec_b</parameter>,
+float <parameter>diff_r</parameter>,
+float <parameter>diff_g</parameter>,
+float <parameter>diff_b</parameter>,
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Overwriting the latest pushed Material, overwriting the current value with the specified one.
+See <link linkend="s3d_pep_materials_a">s3d_pep_materials_a</link> if you want to pep more materials.
+</para>
+</sect2>
+
+
+
+<sect2 id="s3d_pep_material_a">
+<title>s3d_pep_material_a</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_pep_material_a</function></funcdef>
+<paramdef>
+int <parameter>object</parameter>, 
+float <parameter>amb_r</parameter>,
+float <parameter>amb_g</parameter>,
+float <parameter>amb_b</parameter>,
+float <parameter>amb_a</parameter>,
+float <parameter>spec_r</parameter>,
+float <parameter>spec_g</parameter>,
+float <parameter>spec_b</parameter>,
+float <parameter>spec_a</parameter>,
+float <parameter>diff_r</parameter>,
+float <parameter>diff_g</parameter>,
+float <parameter>diff_b</parameter>,
+float <parameter>diff_a</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Overwriting the latest pushed Material, overwriting the current value with the specified one, with 
+<link linkend="alpha">alpha value</link> in contrast to <link linkend="s3d_pep_material">s3d_pep_material</link>
+See <link linkend="s3d_pep_materials_a">s3d_push_materials_a</link> if you want to pep more materials.
+</para>
+</sect2>
+
+<sect2 id="s3d_pep_materials_a">
+<title>s3d_pep_materials_a</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_pep_materials_a</function></funcdef>
+<paramdef>
+int <parameter>object</parameter>, 
+float *<parameter>mbuf</parameter>, 
+unsigned short <parameter>n</parameter>
+
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Alters the last n pushed Materials. See <link linkend="s3d_push_materials_a">s3d_push_materials_a()</link> for
+more information how mbuf should look like. Use <link linkend="s3d_pep_material_a">s3d_pep_material_a()</link>
+if you only want to alter the latest material.
+</para>
+</sect2>
+
+<sect2 id="s3d_load_materials_a">
+<title>s3d_load_materials_a</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_load_materials_a</function></funcdef>
+<paramdef>
+int <parameter>object</parameter>, 
+float *<parameter>mbuf</parameter>, 
+unsigned longs <parameter>start</parameter>,
+unsigned short <parameter>n</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Loads n materials starting from index position start into the Material stack.
+See <link linkend="s3d_push_materials_a">s3d_push_materials_a</link> for more informatino about the values in mbuf.
+</para>
+</sect2>
+
+
+
+<sect2 id="s3d_load_polygon_normals">
+<title>s3d_load_polygon_normals</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_load_polygon_normals</function></funcdef>
+<paramdef>
+int <parameter>object</parameter>, 
+float *<parameter>nbuf</parameter>,
+int <parameter>start</parameter>,
+unsigned short <parameter>n</parameter>,
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Just as <link linkend="s3d_pep_polygon_normals">s3d_pep_polygon_normals()</link>, with the difference you won't alter 
+the latest n polygons but n polygons starting with index start.
+</para>
+</sect2>
+
+
+<sect2 id="s3d_load_tex_coords">
+<title>s3d_load_tex_coords</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_load_tex_coords</function></funcdef>
+<paramdef>
+int <parameter>object</parameter>, 
+float *<parameter>tbuf</parameter>, 
+int <parameter>start</parameter>,
+int <parameter>n</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Just as <link linkend="s3d_pep_polygon_tex_coords">s3d_pep_polygon_tex_coords()</link>, with the difference you won't alter 
+the latest n polygons but n polygons starting with index start.
+</para>
+</sect2>
+
+<sect2 id="s3d_load_texture">
+<title>s3d_load_texture</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_load_texture</function></funcdef>
+<paramdef>
+int <parameter>object</parameter>, 
+unsigned long <parameter>tex</parameter>,
+unsigned short <parameter>xpos</parameter>,
+unsigned short <parameter>ypos</parameter>,
+unsigned short <parameter>w</parameter>,
+unsigned short <parameter>h</parameter>,
+unsgined char *<parameter>data</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+This will load an 32bit rgba image supplied in data at position xpos,ypos of the texture tex. The image has
+the width w and height h. This can be used to update only parts of the texture. It's no problem to supply big textures,
+as the image will be sent to server in fragments. Of course, you will have created the texture with 
+<link linkend="s3d_push_texture">s3d_push_texture</link>, have an material assigned to the texture with <link linkend="s3d_pep_material_texture">
+s3d_pep_material_texture()</link> and have your polygons set sane polygon texture coords 
+using <link linkend="s3d_pep_polygon_tex_coord">s3d_pep_polygon_tex_coord()</link>.
+</para>
+</sect2>
+
+
+<sect2 id="s3d_new_object">
+<title>s3d_new_object</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_new_object</function></funcdef>
+<paramdef>
+void
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Creates a new object, returning the object id.
+<warning><para>Of course, you won't forget to <link linkend="s3d_flags_on">toggle</link> it <link linkend="S3D_OF_VISIBLE">visible</link>, won't you?</para></warning>
+</para>
+</sect2>
+
+
+<sect2>
+<title>s3d_del_object</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_del_object</function></funcdef>
+<paramdef>
+int <parameter>oid</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Deletes the object referenced by oid.
+</para>
+</sect2>
+
+
+<sect2 id="s3d_clone_object">
+<title>s3d_clone_object</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_clone_object</function></funcdef>
+<paramdef>
+int <parameter>oid</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Clones an already exisiting object. They get just look the same as the
+parent-object and will change when the parent-object changes.
+Cloning especially makes sense if you want to use the same object a lot of
+times. Move and transform is independent from the parent.
+The function returns the childs object id.
+</para>
+</sect2>
+
+
+<sect2>
+<title>s3d_clone_object_target</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_clone_object_target</function></funcdef>
+<paramdef>
+int <parameter>oid</parameter>,
+int <parameter>toid</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Changes the clone target of oid to another object (toid). This assumes you've got
+oid from <link linkend="s3d_clone_object">s3d_clone_object</link> before.
+</para>
+</sect2>
+
+
+<sect2>
+<title>s3d_link</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_link</function></funcdef>
+<paramdef>
+int <parameter>oid_from</parameter>,
+int <parameter>oid_to</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+A linked object will move along with it's link parent. For example if you have
+a book on a table, you can link the book to the table so the book will 
+"keep on the table" if you move the table around in space.
+It will also rotate with the table etc.
+</para>
+</sect2>
+
+
+<sect2>
+<title>s3d_unlink</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_unlink</function></funcdef>
+<paramdef>
+int <parameter>oid</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Remove the link of object oid to its target.
+</para>
+</sect2>
+
+
+<sect2>
+<title>s3d_import_3ds</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_import_3ds</function></funcdef>
+<paramdef>
+char *<parameter>buf</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Imports a 3ds-file from memory (assuming that you have already loaded the 3ds-file and it's located at *buf).
+</para>
+<warning><para>Of course, you won't forget to <link linkend="s3d_flags_on">toggle</link> it <link linkend="S3D_OF_VISIBLE">visible</link>, won't you?</para></warning>
+</sect2>
+
+
+<sect2>
+<title>s3d_import_3ds_file</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_import_3ds_file</function></funcdef>
+<paramdef>
+char *<parameter>fname</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Opens the 3ds file referenced by 3ds. The function will also look in your object directories (maybe /usr/share/s3d, depending
+on your installation), so you can also use relative paths.
+</para>
+<warning><para>Of course, you won't forget to <link linkend="s3d_flags_on">toggle</link> it <link linkend="S3D_OF_VISIBLE">visible</link>, won't you?</para></warning>
+</sect2>
+
+
+<sect2 id="s3d_select_font">
+<title>s3d_select_font</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_select_font</function></funcdef>
+<paramdef>
+char *<parameter>mask</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+This selects a font for the <link linkend="s3d_draw_string">s3d_draw_string()</link> function.
+</para>
+<warning><para>Of course, you won't forget to <link linkend="s3d_flags_on">toggle</link> it <link linkend="S3D_OF_VISIBLE">visible</link>, won't you?</para></warning>
+<programlisting>
+    s3d_select_font("vera"); /* will use the vera font face */
+</programlisting>
+</sect2>
+
+
+<sect2 id="s3d_draw_string">
+<title>s3d_draw_string</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_draw_string</function></funcdef>
+<paramdef>
+char *<parameter>str</parameter>,
+float *<parameter>len</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Renders the string str with in Truetype format with the height 1, returns
+the length of the rendered string in *len (or set len=NULL to disable this).
+
+</para>
+<programlisting>
+	char str="hello world!";
+	float len;
+	<link linkend="s3d_select_font">s3d_select_font</link>("vera");
+	<emphasis>s3d_draw_string</emphasis>(str,len);
+
+	/* not interested in the length? do that:
+	 * <emphasis>s3d_draw_string</emphasis>(str,NULL); */
+</programlisting>
+</sect2>
+
+<sect2>
+<title>s3d_open_file</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_open_file</function></funcdef>
+<paramdef>
+char *<parameter>fname</parameter>,
+char **<parameter>pointer</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+This opens the file fname, setting *pointer to it's memory position. the
+function will return the size of buffer. you can free() the pointer when
+you're finished.
+</para>
+</sect2>
+
+
+
+<sect2 id="s3d_flags_on">
+<title>s3d_flags_on</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_flags_on</function></funcdef>
+<paramdef>
+int <parameter>object</parameter>,
+unsigned long <parameter>flags</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+turn some flags on for object.
+</para>
+<warning><para>if you don't toggle OF_VISIBLE on, you won't see your object. usually you want this. 
+(at least after you *push()d all your content)</para></warning>
+</sect2>
+
+<sect2 id="s3d_flags_off">
+<title>s3d_flags_off</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_flags_off</function></funcdef>
+<paramdef>
+int <parameter>object</parameter>,
+unsigned long <parameter>flags</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+turn some flags off for object.
+</para>
+</sect2>
+
+
+<sect2>
+<title>s3d_translate</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_translate</function></funcdef>
+<paramdef>
+int <parameter>object</parameter>,
+float <parameter>x</parameter>,
+float <parameter>y</parameter>,
+float <parameter>z</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Move the object to some position in space. when you create an object, it's 
+always located at 0.0 , 0.0, 0.0.
+</para>
+<important><para>Translation is absolute, not relative!</para></important>
+<programlisting>
+<emphasis>s3d_translate</emphasis>(object,2,0,0);
+<emphasis>s3d_translate</emphasis>(object,4,0,0);
+/* object will end up at 4,0,0 and not 6,0,0!! */
+</programlisting>
+</sect2>
+
+
+<sect2>
+<title>s3d_rotate</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_rotate</function></funcdef>
+<paramdef>
+int <parameter>object</parameter>,
+float <parameter>x</parameter>,
+float <parameter>y</parameter>,
+float <parameter>z</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+rotate an object around the x, y and z-axis respectively. x,y,z may have values
+between [0,360] degrees. 
+</para>
+<para>
+You will usually only rotate around one axis, leaving the unused fields on 0, I guess. 
+If you want to rotate around more than one axis, please note: The order of the rotation
+applies is y-axis, x-axis, and then z-axis. You can think of it as the earth position coordinates:
+x is the longitude, y is the latitude, and z is the rotation at this point of the earth around your
+bodies axis. (I wonder if that makes it any clearer ;)
+</para>
+<important><para>Rotate is absolute, not relative!</para></important>
+<programlisting>
+<emphasis>s3d_rotate</emphasis>(object,90,0,0);
+<emphasis>s3d_rotate</emphasis>(object,180,0,0);
+/* object will be rotated 180 degrees around the x-axis, not 270 degress! */
+</programlisting>
+</sect2>
+
+
+<sect2>
+<title>s3d_scale</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_scale</function></funcdef>
+<paramdef>
+int <parameter>object</parameter>,
+float <parameter>s</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Scales the object. about factor s. s=1 will be the original size, -1 will mirror it.
+</para>
+<important><para>s=0 is forbidden and will be ignored! s3d_scale is also absolute, not relative!</para></important>
+</sect2>
+
+<sect2>
+<title>s3d_push_event</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_push_event</function></funcdef>
+<paramdef>
+		struct s3d_evt *<parameter>newevt</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Pushes an <link linkend="s3d_evt">event</link> onto the event-stack. Usually you don't need to do this manually.
+</para>
+</sect2>
+
+<sect2>
+<title>s3d_pop_event</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>struct s3d_evt *<function>s3d_pop_event</function></funcdef>
+<paramdef>void
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Pops the latest event from the stack. Don't forget to free() both the event
+and its buffer! Returns a pointer to <link linkend="s3d_evt">struct s3d_evt</link>.
+</para>
+</sect2>
+
+<sect2 id="s3d_find_event">
+<title>s3d_find_event</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>struct s3d_evt *<function>s3d_find_event</function></funcdef>
+<paramdef>
+unsigned char <parameter>event</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Finds the latest occurence of an event, giving the event type as argument.
+Returns a pointer to <link linkend="s3d_evt">struct s3d_evt</link>.
+</para>
+</sect2>
+
+<sect2>
+<title>s3d_delete_event</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_delete_event</function></funcdef>
+<paramdef>
+struct s3d_evt *<parameter>devt</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+deletes an event, the argument is the pointer to the <link linkend="s3d_evt">event</link> which is to be 
+deleted (maybe obtained from <link linkend="s3d_find_event">s3d_find_event</link>).
+</para>
+</sect2>
+
+<sect2 id="s3d_set_callback">
+<title>s3d_set_callback</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_set_callback</function></funcdef>
+<paramdef>
+unsigned char <parameter>event</parameter>
+s3d_cb <parameter>func</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+sets a <link linkend="s3d_cb">callback</link> for a certain event. this is very useful for event-oriented 
+applications. event callbacks will not interrupt each other or the mainloop.
+</para>
+<important><para>Defining callbacks will only work after calling <link linkend="s3d_init">s3d_init()</link></para></important>
+<programlisting>
+void obj_click(<link linkend="s3d_evt">struct s3d_evt</link> event)
+{
+	printf("object id %d got clicked", *((unsigned long *)event->buf));
+}
+...
+	<link linkend="s3d_set_callback">s3d_set_callback</link>(<link linkend="S3D_EVENT_NEW_OBJECT">S3D_EVENT_NEW_OBJECT</link>, obj_click);
+
+/* this will tell you when a object got clicked */
+</programlisting>
+</sect2>
+
+
+<sect2>
+<title>s3d_clear_callback</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>void <function>s3d_clear_callback</function></funcdef>
+<paramdef>
+unsigned char <parameter>event</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Clears the callback which is associated with the event.
+</para>
+</sect2>
+
+
+<sect2>
+<title>s3d_get_callback</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>s3d_cb <function>s3d_get_callback</function></funcdef>
+<paramdef>
+unsigned char <parameter>event</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Returns the <link linkend="s3d_cb">Callback-function</link> of the event.
+</para>
+<programlisting>
+	<link linkend="s3d_evt">struct s3d_evt</link> e;
+	...
+	<emphasis>s3d_get_callback</emphasis>(<link linkend="S3D_EVENT_KEY">S3D_EVENT_KEY</link>)(e);
+	/* will call the key-handling function with argument e.  */
+
+</programlisting>
+</sect2>
+
+
+<sect2>
+<title>s3d_process_stack</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>void <function>s3d_process_callback</function></funcdef>
+<paramdef>void
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+This function goes through all function of the event-stack and will call 
+functions. this is useful when you define a new function but still have a lot 
+of events of this type on the stack. 
+</para>
+<note><para>This is probably obsolete</para></note>
+</sect2>
+
+<sect2>
+<title>s3d_vector_length</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>float <function>s3d_vector_length</function></funcdef>
+<paramdef>
+float <parameter>vector</parameter>[]
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Calculates and returns the length of the given vector (which should be of the type float[3]).
+More info <ulink url="http://en.wikipedia.org/wiki/Vector_%28spatial%29#Length_of_a_vector">on wikipedia</ulink>.
+</para>
+</sect2>
+
+<sect2>
+<title>s3d_vector_substract</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>void <function>s3d_vector_substract</function></funcdef>
+<paramdef>
+float <parameter>vector1</parameter>[],
+float <parameter>vector2</parameter>[],
+float <parameter>result_vector</parameter>[]
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Substracts vector1 from vector2, writing result into result_vector.
+All vectors should have the format  float[3].
+More info <ulink url="http://en.wikipedia.org/wiki/Vector_%28spatial%29#Vector_addition_and_subtraction">on wikipedia</ulink>.
+</para>
+</sect2>
+
+<sect2>
+<title>s3d_vector_dot_product</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>float <function>s3d_vector_dot_product</function></funcdef>
+<paramdef>
+float <parameter>vector1</parameter>[],
+float <parameter>vector2</parameter>[]
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Calculates and returns the dot product of vector1 and vector2.
+All vectors should have the format  float[3].
+More info <ulink url="http://en.wikipedia.org/wiki/Vector_%28spatial%29#Dot_product">on wikipedia</ulink>.
+</para>
+</sect2>
+
+<sect2>
+<title>s3d_vector_angle</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>float <function>s3d_vector_angle</function></funcdef>
+<paramdef>
+float <parameter>vector1</parameter>[],
+float <parameter>vector2</parameter>[]
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+Calculates and returns the angle between vector1 and vector2. Please note that the resulting angle is between 0 and PI, therefore not covering the whole period! To convert in degrees just do result*180/M_PI.
+All vectors should have the format  float[3].
+More info <ulink url="http://en.wikipedia.org/wiki/Vector_%28spatial%29#Dot_product">on wikipedia</ulink>.
+</para>
+</sect2>
+
+
+<sect2>
+<title>s3d_mcp_focus</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>int <function>s3d_mcp_focus</function></funcdef>
+<paramdef>
+int <parameter>object</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+This is an mcp-only function. It gives focus (for receiving key-strokes etc.)
+to an app referenced by it's mcp-object-id. 
+</para>
+</sect2>
+
+
+</sect1>
+
+
+<sect1 id="data_types">
+<title>Data types</title>
+
+<sect2 id="s3d_obj_info">
+<title>struct s3d_but_info</title>
+<programlisting>
+struct s3d_obj_info 
+{
+	unsigned long object;
+	unsigned long flags;
+	float trans_x,trans_y,trans_z;
+	float rot_x,rot_y,rot_z;
+	float scale;
+	float r;
+	char name[256]; 
+};
+</programlisting>
+<para>
+Can be used on the buffer of an <link linkend="s3d_evt">event</link> of type <link linkend="S3D_EVENT_OBJ_INFO">S3D_EVENT_OBJ_INFO</link>.
+name will usually contain nothing for usual objects, but mcp objects will contain the applications names here. r is the radius of the convex sphere
+an object, which will also be interesting for the mcp.
+</para>
+<para>
+Special objects like camera, pointer will have the "sys_" prefix in the name and will be named "pointer0", "pointer1" ... or "cam0", "cam1" ...
+For cam object, scale will contain the aspect ratio.
+</para>
+</sect2>
+
+
+
+<sect2 id="s3d_but_info">
+<title>struct s3d_but_info</title>
+<programlisting>
+struct s3d_but_info     
+{                       
+    unsigned char button, state;
+};                      
+</programlisting>
+<para>
+Can be used on the buffer of an <link linkend="s3d_evt">event</link> of type <link linkend="S3D_EVENT_MBUTTON">S3D_EVENT_MBUTTON</link>.
+</para>
+</sect2>
+
+
+<sect2 id="mcp_object">
+<title>struct mcp_object</title>
+<programlisting>
+struct mcp_object 
+{
+	unsigned long object;
+	float trans_x,trans_y,trans_z;
+	float r;
+	char name[256]; 
+};
+
+</programlisting>
+<para>
+obsolete, deprecated, don't use, to be removed soon (use <link linkend="s3d_but_info">struct s3d_but_info</link>). ;)
+</para>
+</sect2>
+
+<sect2 id="s3d_evt">
+<title>struct s3d_evt</title>
+<programlisting>
+struct s3d_evt {
+	unsigned char event;
+	int length;
+	char *buf;
+	struct s3d_evt *next;
+};
+</programlisting>
+<para>
+
+This is the event information holder. 
+<variablelist>
+<varlistentry>
+<term>event</term>
+<listitem><para>gives the <link linkend="s3d_events">event type</link></para></listitem>
+</varlistentry>
+<varlistentry>
+<term>length</term>
+<listitem><para>gives the length of the buffer *buf</para></listitem>
+</varlistentry>
+<varlistentry>
+<term>*buf</term>
+<listitem><para>is the pointer to the multiple purpose buffer, which will have more specific information about the object</para></listitem>
+</varlistentry>
+<varlistentry>
+<term>*next</term>
+<listitem><para>can be safely ignored ;)</para></listitem>
+</varlistentry>
+</variablelist>
+
+Depending on the event, buf can contain the keycode pressed on keyboard event, the <link linkend="s3d_but_info">mouse button state</link> on a mouse event, <link linkend="s3d_obj_info">object information</link> etc.
+</para>
+</sect2>
+
+<sect2 id="s3d_cb">
+<title>typedef s3d_cb</title>
+<programlisting>
+typedef void (*<emphasis>s3d_cb</emphasis>)(<link linkend="s3d_evt">struct s3d_evt</link> *);
+</programlisting>
+<para>
+This defines the callback format. Each callback should return void and take an argument of <link linkend="s3d_evt">struct s3d_evt *</link>.
+Callbacks can be defined with <link linkend="s3d_set_callback">s3d_set_callback()</link>.
+</para>
+<programlisting>
+/* a callback handler could look like this: */
+void my_key_handler(struct s3d_evt *event_data)
+{
+	...
+}
+</programlisting>
+</sect2>
+</sect1>
+
+
+
+
+<sect1 id="definitions">
+<title>Definitions</title>
+
+
+
+
+<sect2 id="s3d_events">
+<title>S3D events</title>
+<para>
+This defines the callback format. Each callback should return void and take an argument of <link linkend="s3d_evt">struct s3d_evt *</link>.
+Callbacks can be defined with <link linkend="s3d_set_callback">s3d_set_callback()</link>.
+<variablelist>
+
+<varlistentry>
+<term><anchor id="S3D_EVENT_OBJ_CLICK"/>S3D_EVENT_OBJ_CLICK</term>
+<listitem><para>
+An object got clicked (when you set the flag <link linkend="S3D_OF_SELECTABLE">S3D_OF_SELECTABLE</link>), buf will contain the object id
+of the object which got clicked (unsigned long, 4 byte)
+</para></listitem>
+</varlistentry>
+
+<varlistentry>
+<term><anchor id="S3D_EVENT_KEY"/>S3D_EVENT_KEY</term>
+<listitem><para>
+A key was pressed, buf will contain a keycode. use  <![CDATA[#include <s3d_keysym.h>]]> to have the keycodes available. buf is a 2 byte unsigned short keycode.
+</para></listitem>
+</varlistentry>
+
+
+<varlistentry>
+<term><anchor id="S3D_EVENT_MBUTTON"/>S3D_EVENT_MBUTTON</term>
+<listitem><para>
+A mouse button was clicked. Use <link linkend="s3d_but_info">struct s3d_but_info</link> on buf to get more info.
+</para></listitem>
+</varlistentry>
+
+<varlistentry>
+<term><anchor id="S3D_EVENT_NEW_OBJECT"/>S3D_EVENT_NEW_OBJECT</term>
+<listitem><para>
+deprecated, will use <link linkend="S3D_EVENT_OBJ_INFO">S3D_EVENT_OBJ_INFO</link>
+</para></listitem>
+</varlistentry>
+
+
+<varlistentry>
+<term><anchor id="S3D_EVENT_OBJ_INFO"/>S3D_EVENT_OBJ_INFO</term>
+<listitem><para>
+Something happened to an object. This can happen if the camera was moved, the mouse (pointer) was moved or an application appeared/changed in the mcp
+
+</para></listitem>
+</varlistentry>
+
+<varlistentry>
+<term><anchor id="S3D_MCP_OBJECT"/>S3D_MCP_OBJECT</term>
+<listitem><para>
+As the name suggests, those will only happen to the MCP. 
+This tells it about new/changed application object. <link linkend="mcp_object">struct mcp_object</link>
+can be used on buf. To be removed in the future.
+</para></listitem>
+</varlistentry>
+
+<varlistentry>
+<term><anchor id="S3D_MCP_DEL_OBJECT"/>S3D_MCP_DEL_OBJECT</term>
+<listitem><para>
+As the name suggests, those will only happen to the MCP. 
+This tells it about deleted application object. <link linkend="mcp_object">struct mcp_object</link>
+can be used on buf. To be removed in the future.
+</para></listitem>
+</varlistentry>
+
+
+<varlistentry>
+<term><anchor id="S3D_EVENT_QUIT"/>S3D_EVENT_QUIT</term>
+<listitem><para>
+Server sent the quit signal, or the connection was terminated. Usually, this is only processed internally.
+</para></listitem>
+</varlistentry>
+
+
+
+</variablelist>
+</para>
+<programlisting>
+/* a callback handler could look like this: */
+void my_key_handler(struct s3d_evt *event_data)
+{
+	...
+}
+</programlisting>
+</sect2>
+
+
+<sect2 id="s3d_object_flags">
+<title>S3D Object Flags</title>
+<para>
+Objects can have several flags to change their behaviour in the server and can be set with 
+<link linkend="s3d_flags_on">s3d_flags_on()</link> and
+<link linkend="s3d_flags_off">s3d_flags_off()</link>
+<variablelist>
+<varlistentry>
+<term><anchor id="S3D_OF_VISIBLE"/>S3D_OF_VISIBLE</term>
+<listitem><para>default:off</para><para>
+Obviously, if this flag is toggled the user can see it, if not it will be hidden. ;)
+</para><para>
+When an object is created it's turned off, so you will be able push your geometry data and
+turn it on after you're done. That avaoids flickering and stuff.
+</para></listitem>
+</varlistentry>
+
+<varlistentry>
+<term><anchor id="S3D_OF_SELECTABLE"/>S3D_OF_SELECTABLE</term>
+<listitem><para>default:off</para><para>
+When this is toggled on, you will receive <link linkend="S3D_EVENT_OBJ_CLICK">click events</link>.
+Don't use it if you don't need it, it will eat performance.
+</para></listitem>
+</varlistentry>
+
+<varlistentry>
+<term><anchor id="S3D_OF_POINTABLE"/>S3D_OF_POINTABLE</term>
+<listitem><para>default:off</para><para>
+Placeholder for pointer (onmouseover-event enabler) events. Not implemented yet.
+</para></listitem>
+</varlistentry>
+
+</variablelist>
+</para>
+</sect2>
+
+</sect1>
+
+<sect1 id="Notes">
+<title>Additional Notes</title>
+<sect2 id="alpha">
+<title>About alpha transparency</title>
+<para>
+Alpha transparency works, but polygons don't get ordered in view direction on the server yet. So please don't
+use this feature yet. If you have an easy idea how to do that with opengl please drop me a line.
+</para>
+</sect2>
+</sect1>
+
+
+
+
+</chapter>

Deleted: trunk/Documentation/libs3d/s3dapi.docbook
===================================================================
--- trunk/Documentation/libs3d/s3dapi.docbook	2006-06-05 16:14:23 UTC (rev 340)
+++ trunk/Documentation/libs3d/s3dapi.docbook	2006-06-05 20:09:53 UTC (rev 341)
@@ -1,1741 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" ?>
-<!DOCTYPE book PUBLIC "-//OASIS//DTD DocBook XML V4.2//EN" [
-  <!ENTITY introduction SYSTEM "bookinfo.docbook">
-]>
-<book id="s3dapi" lang="en">
- 
-<bookinfo>
-<title>The <application>s3d</application> API manual</title>
-</bookinfo>
-<chapter id="introduction">
-<title>Introduction</title>
- <para>I'm trying to cover as much as possible, please drop me a line if 
- there is something missing or not clear enough. please beware: anything may change anytime,
- as i'm sometimes in the mood of changing deep internal things.
- </para>
- <para>
- Thanks to David Rugge, Mark Glassi and Eric Bischoff for their great <ulink url="http://opensource.bureau-cornavin.com/crash-course/">Docbook Crash Course</ulink>, this Doc wouldn't be here without that :)
- </para>
- <para>
- And of course THANKS to the whole s3d team - Yd, Marek, 2x Andreas, Mog - and all the people who support <application>s3d</application>!!
- </para>
-</chapter>
-<chapter id="using">
-<title>Using the <application>s3d</application> library</title>
-<sect1 id="setup">
-<title>Setting <application>s3d</application> up</title>
- <para>
- Install the lib using the usual usual mechanism:
- <programlisting>
- ./configure
- make
- make install
- </programlisting>
- You might need to have superuser rights in order to do make install. You should now have the server,
- the library and some applications installed somewhere.
- </para>
-</sect1>
-<sect1 id="gettingstarted">
-<title>Getting started</title>
-<para>
- After having <application>s3d</application> installed, you can write your own <application>s3d</application> programs (yeah, that is what this guide is about ;)
- <programlisting>
- <![CDATA[#include <s3d.h>]]>
- </programlisting>
- should be enough to access the 3d functions. If you want to use keyboard interaction, do
- <programlisting>
- <![CDATA[#include <s3d_keysym.h>]]>
- </programlisting>
- for the keycode table.
- Now you can compile your program with 
- <screen>
- <prompt>bash$</prompt> <command> gcc <replaceable>program</replaceable>.c -ls3d -o <replaceable>program</replaceable> </command>
- That wasn't that hard, wasn't it?
- </screen>
-</para>
-</sect1>
-</chapter>
-
-
-<chapter id="functions">
-<title>function reference</title>
-
-<sect1 id="s3d_init">
-<title>s3d_init</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_init</function></funcdef>
-<paramdef>
-int *<parameter>argc</parameter>.
-char ***<parameter>argv</parameter>
-char *<parameter>name</parameter>
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-This will initialize the <application>s3d</application>-library and the connection to the Server. It will return 0 on
-success in Server initializion. name specifies the your programs name.
-</para>
-<programlisting>
-int main(char argc, char **argv)
-{
-	if (!<emphasis>s3d_init(<![CDATA[&argc,&argv]]>,"Hello world")</emphasis>) 
-	{
-		...
-		<link linkend="s3d_quit">s3d_quit()</link>;
-	}
-	return(0);
-}
-			   
-</programlisting>
-</sect1>
-
-
-<sect1 id="s3d_quit">
-<title>s3d_quit</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_quit</function></funcdef>
-<paramdef>void </paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-closes the connection and cleares the event-stack. it can also be used to leave
-the <link linkend="s3d_mainloop">s3d_mainloop</link>.
-</para>
-</sect1>
-
-<sect1 id="s3d_usage">
-<title>s3d_usage</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>void <function>s3d_usage</function></funcdef>
-<paramdef>void </paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-Prints the possible parameter for the client library (which can be passed in 
-<link linkend="s3d_init">s3d_init()</link>)
-</para>
-</sect1>
-
-<sect1 id="s3d_mainloop">
-<title>s3d_mainloop</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_mainloop</function></funcdef>
-<paramdef>void (*<parameter>f</parameter>)()</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-takes a function as argument. it will loop this function until a quit-event is
-received. you can pass NULL if you have no function to be looped, but its
-better to sleep some time if you have nothing to do anyway to save cpu-time.
-</para>
-<programlisting>
-void mainloop()
-{
-    usleep(1000); // sleep 1 ms in every cycle
-}
-...
-
-<emphasis>s3d_mainloop</emphasis>(mainloop());
-
-</programlisting>
-</sect1>
-
-
-<sect1 id="s3d_push_vertex">
-<title>s3d_push_vertex</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_push_vertex</function></funcdef>
-<paramdef>int <parameter>object</parameter>, float <parameter>x</parameter>, float <parameter>y</parameter>, float <parameter>z</parameter></paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-pushes a vertex onto the vertex stack. make sure that you count how many
-vertices you've pushed because you'll need that for referencing when you push
-your polygons.
-</para>
-</sect1>
-
-
-<sect1>
-<title>s3d_push_vertices</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_push_vertices</function></funcdef>
-<paramdef>int <parameter>object</parameter>, float *<parameter>vbuf</parameter>, unsigned short <parameter>n</parameter></paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-push some vertices from an array. that's much better for performing than
-using <link linkend="s3d_push_vertex">s3d_push_vertex()</link> if you have a lot of vertices (and that's probably the
-usual case).
-</para>
-<programlisting>
-float vertices[] = { 0.0, 0.0, 0.0,
-                     1.0, 2.0, 3,0,
-                     3.0, 2.0, 1.0};
-<emphasis>s3d_push_vertices</emphasis>(object, vertices, 3); /* pushing 3 vertices */
-</programlisting>
-</sect1>
-
-
-<sect1 id="s3d_push_material">
-<title>s3d_push_material</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_push_material</function></funcdef>
-<paramdef>int <parameter>object</parameter>, 
-float <parameter>amb_r</parameter>,
-float <parameter>amb_g</parameter>,
-float <parameter>amb_b</parameter>,
-float <parameter>spec_r</parameter>,
-float <parameter>spec_g</parameter>,
-float <parameter>spec_b</parameter>,
-float <parameter>diff_r</parameter>,
-float <parameter>diff_g</parameter>,
-float <parameter>diff_b</parameter>,
-
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-pushes a material for an object. you will have to count them yourself too, as
-polygons will ask for the material index number. the material properties are
-given in rgb (red/green/blue) color codes, in float. 0.0 is the minimum,
-1.0 is the maximum a color value can be.
-the specular color is the color which is directly reflected from the light
-source. the diffuse color is the color which can be seen in the bright side
-of the object, and the ambience color is the color of the shadow side of the
-object.
-</para>
-</sect1>
-
-<sect1 id="s3d_push_material_a">
-<title>s3d_push_material_a</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_push_material_a</function></funcdef>
-<paramdef>int <parameter>object</parameter>, 
-float <parameter>amb_r</parameter>,
-float <parameter>amb_g</parameter>,
-float <parameter>amb_b</parameter>,
-float <parameter>amb_a</parameter>,
-float <parameter>spec_r</parameter>,
-float <parameter>spec_g</parameter>,
-float <parameter>spec_b</parameter>,
-float <parameter>spec_a</parameter>,
-float <parameter>diff_r</parameter>,
-float <parameter>diff_g</parameter>,
-float <parameter>diff_b</parameter>,
-float <parameter>diff_a</parameter>
-
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-Same as <link linkend="s3d_push_material">s3d_push_material</link>, but color has <link linkend="alpha">alpha value</link> added.
-Use <link linkend="s3d_push_materials_a">s3d_push_materials_a()</link> if you have a lot of materials to push.
-</para>
-</sect1>
-
-
-<sect1 id="s3d_push_materials_a">
-<title>s3d_push_materials_a</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_push_materials_a</function></funcdef>
-<paramdef>
-int <parameter>object</parameter>, 
-float *<parameter>mbuf</parameter>, 
-unsigned short <parameter>n</parameter>
-
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-Pushes a buffer of Materials. Those Materials are in the format float[n*12], with
-<itemizedlist>
-<listitem><para>mbuf[n*12 + 0-3] - ambience</para></listitem>
-<listitem><para>mbuf[n*12 + 4-7] - specular</para></listitem>
-<listitem><para>mbuf[n *12 + 8-11] - diffusion values </para></listitem>
-</itemizedlist>
-of each entry. n is the number of materials pushed. The values are in the order r,g,b,a.
-If you only want to push one material, use the more easy <link linkend="s3d_push_material_a">s3d_push_material_a()</link>
-function.
-</para>
-<programlisting>
-/* each line has r,g,b,a value */
-float bla[24]=
-	{1,0,0,1,
-	 1,0,0,1,
-	 1,0,0,1,
-	 0,1,1,1,
-	 0,1,1,1,
-	 0,1,1,1};
-
-s3d_push_materials_a(object,mbuf,2); /* push a red and a cyan material */
-</programlisting>
-</sect1>
-
-
-
-<sect1>
-<title>s3d_push_polygon</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_push_polygon</function></funcdef>
-<paramdef>int <parameter>object</parameter>, 
-int <parameter>v1</parameter>,
-int <parameter>v2</parameter>,
-int <parameter>v3</parameter>,
-int <parameter>material</parameter>
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-push one polygon on the polygonstack of the object. it takes 3 vertex-index-
-numbers and one material material-index-nr. as argument.
-</para>
-<programlisting>
-int oid=<link linkend="s3d_new_object">s3d_new_object</link>();   /* create a new object */
-<link linkend="s3d_push_vertex">s3d_push_vertex</link>(oid,0.0,0.0,0.0);
-<link linkend="s3d_push_vertex">s3d_push_vertex</link>(oid,0.0,1.0,0.0);
-<link linkend="s3d_push_vertex">s3d_push_vertex</link>(oid,1.0,0.0,0.0);
-<link linkend="s3d_push_material">s3d_push_material</link>(oid,0.3,0.0,0.0, 1.0,1.0,1.0, 1.0,0.0,0.0);
-<emphasis>s3d_push_polygon</emphasis>(oid,0,1,2,0);
-/* this will create a red polygon */
-</programlisting>
-</sect1>
-
-
-<sect1>
-<title>s3d_push_polygons</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_push_polygons</function></funcdef>
-<paramdef>int <parameter>object</parameter>, 
-unsigned long <parameter>*pbuf</parameter>,
-unsigned short <parameter>n</parameter>
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-as for vertices, you can push arrays of polygons to have greater performance.
-the pbuf should contain n polygons which consist of 4 unsigned long values
-of 3 vertices indeces and 1 material index.
-</para>
-<programlisting>
-unsigned long pbuf[] = { 0,1,2,0};
-int oid=<link linkend="s3d_new_object">s3d_new_object</link>();   /* create a new object */
-<link linkend="s3d_push_vertex">s3d_push_vertex</link>(oid,0.0,0.0,0.0);
-<link linkend="s3d_push_vertex">s3d_push_vertex</link>(oid,0.0,1.0,0.0);
-<link linkend="s3d_push_vertex">s3d_push_vertex</link>(oid,1.0,0.0,0.0);
-<link linkend="s3d_push_material">s3d_push_material</link>(oid,0.3,0.0,0.0, 1.0,1.0,1.0, 1.0,0.0,0.0);
-<emphasis>s3d_push_polygons</emphasis>(oid,pbuf,1);
-/* push one polygon with the pbuf data */
-</programlisting>
-</sect1>
-
-
-<sect1 id="s3d_push_line">
-<title>s3d_push_line</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_push_line</function></funcdef>
-<paramdef>int <parameter>object</parameter>, 
-int <parameter>v1</parameter>,
-int <parameter>v2</parameter>,
-int <parameter>material</parameter>
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-Push one line on the linestack of the object. It takes 2 vertex-index-
-numbers and one material material-index-nr. as argument. If you have
-a lot of lines to push, use <link linkend="s3d_push_lines">s3d_push_lines()</link>
-</para>
-</sect1>
-
-<sect1 id="s3d_push_lines">
-<title>s3d_push_lines</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_push_line</function></funcdef>
-<paramdef>int <parameter>object</parameter>, 
-unsigned  long *<parameter>*lbuf</parameter>,
-unsigned short <parameter>n</parameter>
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-Pushing n lines on the linestack of the object, each lbuf has a size of n*3,
-each entry has the index number of the first vertex, second vertex and material number just
-as in <link linkend="s3d_push_line">s3d_push_line()</link>.
-</para>
-</sect1>
-
-<sect1 id="s3d_push_texture">
-<title>s3d_push_texture</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_push_texture</function></funcdef>
-<paramdef>int <parameter>object</parameter>, 
-int <parameter>w</parameter>,
-int <parameter>h</parameter>
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-Adds a new texture with height w and height h on the texturestack.
-</para>
-</sect1>
-
-
-<sect1>
-<title>s3d_pop_vertex</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_pop_vertex</function></funcdef>
-<paramdef>int <parameter>object</parameter>, 
-unsigned short <parameter>n</parameter>
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-Deletes the latest n vertices from the vertex stack of the object.
-</para>
-</sect1>
-
-
-<sect1>
-<title>s3d_pop_polygon</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_pop_polygon</function></funcdef>
-<paramdef>int <parameter>object</parameter>, 
-unsigned short <parameter>n</parameter>
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-Deletes the latest n polygon from the polygon stack of the object.
-</para>
-</sect1>
-
-
-
-<sect1>
-<title>s3d_pop_material</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_pop_material</function></funcdef>
-<paramdef>int <parameter>object</parameter>, 
-unsigned short <parameter>n</parameter>
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-Deletes the latest n material from the material stack of the object.
-</para>
-</sect1>
-
-
-<sect1>
-<title>s3d_pop_texture</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_pop_texture</function></funcdef>
-<paramdef>int <parameter>object</parameter>, 
-unsigned short <parameter>n</parameter>
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-Deletes the latest n textures from the texture stack of the object.
-</para>
-</sect1>
-
-
-<sect1>
-<title>s3d_pop_line</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_pop_line</function></funcdef>
-<paramdef>int <parameter>object</parameter>, 
-unsigned short <parameter>n</parameter>
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-Deletes the latest n lines from the line stack of the object.
-</para>
-</sect1>
-
-<sect1 id="s3d_pep_polygon_normals">
-<title>s3d_pep_polygon_normals</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_pep_polygon_normals</function></funcdef>
-<paramdef>
-int <parameter>object</parameter>, 
-float *<parameter>nbuf</parameter>,
-unsigned short <parameter>n</parameter>
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-Adds normal information to polygons, giving each vertex of a polygon a normal information. With this, you can
-achieve smoothed edge effects. 
-</para>
-<para>
-nbuf should contain n * 9 float values, for each vertex a normal vector (x,y,z), and you have 
-3 Vertices for each Polygon so that makes 9 float values per Polygon in Total.	
-Don't worry if you don't use this, it's kind of hard to calculate and the server will always use some
-proper normal values (same for every vertex, calculated by the plane which is defined by the 3 points of the polygon.
-</para>
-</sect1>
-
-<sect1 id="s3d_pep_polygon_tex_coord">
-<title>s3d_pep_polygon_tex_coord</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_pep_polygon_tex_coord</function></funcdef>
-<paramdef>
-int <parameter>object</parameter>, 
-float <parameter>x1</parameter>, 
-float <parameter>y1</parameter>, 
-float <parameter>x2</parameter>, 
-float <parameter>y2</parameter>, 
-float <parameter>x3</parameter>, 
-float <parameter>y3</parameter>
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-Pimp the last polygon pushed with some textures coordinates, x and y values for each vertex point respectively.
-Those values may be between 0 and 1 and are vertex points on the <link linkend="s3d_pep_material_texture">
-texture defined in the material</link> of the polygon. If you have more polygons which should get a texture, use
-<link linkend="s3d_pep_polygon_tex_coords">s3d_pep_polygon_tex_coords()</link>
-</para>
-</sect1>
-
-<sect1 id="s3d_pep_polygon_tex_coords">
-<title>s3d_pep_polygon_tex_coords</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_pep_polygon_tex_coords</function></funcdef>
-<paramdef>
-int <parameter>object</parameter>, 
-float *<parameter>tbuf</parameter>, 
-int <parameter>n</parameter>
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-Pimp the latest n polygons with texture coordinates. tbuf has 6*n float values for its entries, which are supplied in the order
-as in <link linkend="s3d_pep_polygon_tex_coord">s3d_pep_polygon_tex_coord()</link>
-</para>
-</sect1>
-
-<sect1 id="s3d_pep_material_texture">
-<title>s3d_pep_material_texture</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_pep_material_texture</function></funcdef>
-<paramdef>
-int <parameter>object</parameter>, 
-unsigned long <parameter>tex</parameter>
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-Assign the latest material a texture referenced by the index tex. Of course, you will
-have pushed this texture with <link linkend="s3d_push_texture">s3d_push_texture</link>
-</para>
-</sect1>
-
-
-<sect1 id="s3d_pep_vertex">
-<title>s3d_pep_vertex</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_pep_vertex</function></funcdef>
-<paramdef>
-int <parameter>object</parameter>, 
-float <parameter>x</parameter>,
-float <parameter>y</parameter>,
-float <parameter>z</parameter>
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-Alter the latest pushed vertex, overwriting with the supplied values.
-</para>
-</sect1>
-
-<sect1 id="s3d_pep_vertices">
-<title>s3d_pep_vertices</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_pep_vertices</function></funcdef>
-<paramdef>
-int <parameter>object</parameter>, 
-float *<parameter>vbuf</parameter>,
-unsigned short <parameter>n</parameter>
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-Alter the latest n pushed vertex. vbuf holds the values which
-are used to overwrite the old data, n entries with each 3 floats
-specifying x,y,z of the vertices.
-</para>
-</sect1>
-
-<sect1 id="s3d_pep_line">
-<title>s3d_pep_line</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_pep_line</function></funcdef>
-<paramdef>
-int <parameter>object</parameter>, 
-unsigned long <parameter>v1</parameter>,
-unsigned long <parameter>v2</parameter>,
-unsigned long <parameter>material</parameter>
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-Alter the latest pushed line, overwriting with the supplied values.
-</para>
-</sect1>
-
-<sect1 id="s3d_pep_lines">
-<title>s3d_pep_lines</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_pep_lines</function></funcdef>
-<paramdef>
-int <parameter>object</parameter>, 
-unsigned long *<parameter>lbuf</parameter>,
-unsigned short <parameter>n</parameter>
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-Alter the latest n pushed lines. lbuf holds the values which
-are used to overwrite the old data, n entries with each 3 unsigned longs
-specifying first, second vertex and material of each line.
-</para>
-</sect1>
-
-<sect1 id="s3d_pep_line_normals">
-<title>s3d_pep_line_normals</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_pep_line_normals</function></funcdef>
-<paramdef>
-int <parameter>object</parameter>, 
-float *<parameter>nbuf</parameter>,
-unsigned short <parameter>n</parameter>
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-Adds normal information to lines, giving each vertex of a line a normal information. This makes 
-lines somewhat nicer, you'll need that especially when you're going to build wireframe models.
-</para>
-<para>
-nbuf should contain n * 6 float values, for each vertex a normal vector (x,y,z), and you have 
-2 Vertices for each line so that makes 6 float values per line in Total.	
-</para>
-</sect1>
-
-<sect1 id="s3d_load_line_normals">
-<title>s3d_load_line_normals</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_load_line_normals</function></funcdef>
-<paramdef>
-int <parameter>object</parameter>, 
-float *<parameter>nbuf</parameter>,
-int <parameter>start</parameter>,
-unsigned short <parameter>n</parameter>,
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-Just as <link linkend="s3d_pep_line_normals">s3d_pep_line_normals()</link>, with the difference you won't alter 
-the latest n lines but n lines starting with index start.
-</para>
-</sect1>
-
-
-<sect1 id="s3d_pep_material">
-<title>s3d_pep_material</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_pep_material</function></funcdef>
-<paramdef>
-int <parameter>object</parameter>, 
-float <parameter>amb_r</parameter>,
-float <parameter>amb_g</parameter>,
-float <parameter>amb_b</parameter>,
-float <parameter>spec_r</parameter>,
-float <parameter>spec_g</parameter>,
-float <parameter>spec_b</parameter>,
-float <parameter>diff_r</parameter>,
-float <parameter>diff_g</parameter>,
-float <parameter>diff_b</parameter>,
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-Overwriting the latest pushed Material, overwriting the current value with the specified one.
-See <link linkend="s3d_pep_materials_a">s3d_pep_materials_a</link> if you want to pep more materials.
-</para>
-</sect1>
-
-
-
-<sect1 id="s3d_pep_material_a">
-<title>s3d_pep_material_a</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_pep_material_a</function></funcdef>
-<paramdef>
-int <parameter>object</parameter>, 
-float <parameter>amb_r</parameter>,
-float <parameter>amb_g</parameter>,
-float <parameter>amb_b</parameter>,
-float <parameter>amb_a</parameter>,
-float <parameter>spec_r</parameter>,
-float <parameter>spec_g</parameter>,
-float <parameter>spec_b</parameter>,
-float <parameter>spec_a</parameter>,
-float <parameter>diff_r</parameter>,
-float <parameter>diff_g</parameter>,
-float <parameter>diff_b</parameter>,
-float <parameter>diff_a</parameter>
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-Overwriting the latest pushed Material, overwriting the current value with the specified one, with 
-<link linkend="alpha">alpha value</link> in contrast to <link linkend="s3d_pep_material">s3d_pep_material</link>
-See <link linkend="s3d_pep_materials_a">s3d_push_materials_a</link> if you want to pep more materials.
-</para>
-</sect1>
-
-<sect1 id="s3d_pep_materials_a">
-<title>s3d_pep_materials_a</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_pep_materials_a</function></funcdef>
-<paramdef>
-int <parameter>object</parameter>, 
-float *<parameter>mbuf</parameter>, 
-unsigned short <parameter>n</parameter>
-
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-Alters the last n pushed Materials. See <link linkend="s3d_push_materials_a">s3d_push_materials_a()</link> for
-more information how mbuf should look like. Use <link linkend="s3d_pep_material_a">s3d_pep_material_a()</link>
-if you only want to alter the latest material.
-</para>
-</sect1>
-
-<sect1 id="s3d_load_materials_a">
-<title>s3d_load_materials_a</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_load_materials_a</function></funcdef>
-<paramdef>
-int <parameter>object</parameter>, 
-float *<parameter>mbuf</parameter>, 
-unsigned longs <parameter>start</parameter>,
-unsigned short <parameter>n</parameter>
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-Loads n materials starting from index position start into the Material stack.
-See <link linkend="s3d_push_materials_a">s3d_push_materials_a</link> for more informatino about the values in mbuf.
-</para>
-</sect1>
-
-
-
-<sect1 id="s3d_load_polygon_normals">
-<title>s3d_load_polygon_normals</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_load_polygon_normals</function></funcdef>
-<paramdef>
-int <parameter>object</parameter>, 
-float *<parameter>nbuf</parameter>,
-int <parameter>start</parameter>,
-unsigned short <parameter>n</parameter>,
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-Just as <link linkend="s3d_pep_polygon_normals">s3d_pep_polygon_normals()</link>, with the difference you won't alter 
-the latest n polygons but n polygons starting with index start.
-</para>
-</sect1>
-
-
-<sect1 id="s3d_load_tex_coords">
-<title>s3d_load_tex_coords</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_load_tex_coords</function></funcdef>
-<paramdef>
-int <parameter>object</parameter>, 
-float *<parameter>tbuf</parameter>, 
-int <parameter>start</parameter>,
-int <parameter>n</parameter>
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-Just as <link linkend="s3d_pep_polygon_tex_coords">s3d_pep_polygon_tex_coords()</link>, with the difference you won't alter 
-the latest n polygons but n polygons starting with index start.
-</para>
-</sect1>
-
-<sect1 id="s3d_load_texture">
-<title>s3d_load_texture</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_load_texture</function></funcdef>
-<paramdef>
-int <parameter>object</parameter>, 
-unsigned long <parameter>tex</parameter>,
-unsigned short <parameter>xpos</parameter>,
-unsigned short <parameter>ypos</parameter>,
-unsigned short <parameter>w</parameter>,
-unsigned short <parameter>h</parameter>,
-unsgined char *<parameter>data</parameter>
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-This will load an 32bit rgba image supplied in data at position xpos,ypos of the texture tex. The image has
-the width w and height h. This can be used to update only parts of the texture. It's no problem to supply big textures,
-as the image will be sent to server in fragments. Of course, you will have created the texture with 
-<link linkend="s3d_push_texture">s3d_push_texture</link>, have an material assigned to the texture with <link linkend="s3d_pep_material_texture">
-s3d_pep_material_texture()</link> and have your polygons set sane polygon texture coords 
-using <link linkend="s3d_pep_polygon_tex_coord">s3d_pep_polygon_tex_coord()</link>.
-</para>
-</sect1>
-
-
-<sect1 id="s3d_new_object">
-<title>s3d_new_object</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_new_object</function></funcdef>
-<paramdef>
-void
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-Creates a new object, returning the object id.
-<warning><para>Of course, you won't forget to <link linkend="s3d_flags_on">toggle</link> it <link linkend="S3D_OF_VISIBLE">visible</link>, won't you?</para></warning>
-</para>
-</sect1>
-
-
-<sect1>
-<title>s3d_del_object</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_del_object</function></funcdef>
-<paramdef>
-int <parameter>oid</parameter>
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-Deletes the object referenced by oid.
-</para>
-</sect1>
-
-
-<sect1 id="s3d_clone_object">
-<title>s3d_clone_object</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_clone_object</function></funcdef>
-<paramdef>
-int <parameter>oid</parameter>
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-Clones an already exisiting object. They get just look the same as the
-parent-object and will change when the parent-object changes.
-Cloning especially makes sense if you want to use the same object a lot of
-times. Move and transform is independent from the parent.
-The function returns the childs object id.
-</para>
-</sect1>
-
-
-<sect1>
-<title>s3d_clone_object_target</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_clone_object_target</function></funcdef>
-<paramdef>
-int <parameter>oid</parameter>,
-int <parameter>toid</parameter>
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-Changes the clone target of oid to another object (toid). This assumes you've got
-oid from <link linkend="s3d_clone_object">s3d_clone_object</link> before.
-</para>
-</sect1>
-
-
-<sect1>
-<title>s3d_link</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_link</function></funcdef>
-<paramdef>
-int <parameter>oid_from</parameter>,
-int <parameter>oid_to</parameter>
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-A linked object will move along with it's link parent. For example if you have
-a book on a table, you can link the book to the table so the book will 
-"keep on the table" if you move the table around in space.
-It will also rotate with the table etc.
-</para>
-</sect1>
-
-
-<sect1>
-<title>s3d_unlink</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_unlink</function></funcdef>
-<paramdef>
-int <parameter>oid</parameter>
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-Remove the link of object oid to its target.
-</para>
-</sect1>
-
-
-<sect1>
-<title>s3d_import_3ds</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_import_3ds</function></funcdef>
-<paramdef>
-char *<parameter>buf</parameter>
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-Imports a 3ds-file from memory (assuming that you have already loaded the 3ds-file and it's located at *buf).
-</para>
-<warning><para>Of course, you won't forget to <link linkend="s3d_flags_on">toggle</link> it <link linkend="S3D_OF_VISIBLE">visible</link>, won't you?</para></warning>
-</sect1>
-
-
-<sect1>
-<title>s3d_import_3ds_file</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_import_3ds_file</function></funcdef>
-<paramdef>
-char *<parameter>fname</parameter>
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-Opens the 3ds file referenced by 3ds. The function will also look in your object directories (maybe /usr/share/s3d, depending
-on your installation), so you can also use relative paths.
-</para>
-<warning><para>Of course, you won't forget to <link linkend="s3d_flags_on">toggle</link> it <link linkend="S3D_OF_VISIBLE">visible</link>, won't you?</para></warning>
-</sect1>
-
-
-<sect1 id="s3d_select_font">
-<title>s3d_select_font</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_select_font</function></funcdef>
-<paramdef>
-char *<parameter>mask</parameter>
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-This selects a font for the <link linkend="s3d_draw_string">s3d_draw_string()</link> function.
-</para>
-<warning><para>Of course, you won't forget to <link linkend="s3d_flags_on">toggle</link> it <link linkend="S3D_OF_VISIBLE">visible</link>, won't you?</para></warning>
-<programlisting>
-    s3d_select_font("vera"); /* will use the vera font face */
-</programlisting>
-</sect1>
-
-
-<sect1 id="s3d_draw_string">
-<title>s3d_draw_string</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_draw_string</function></funcdef>
-<paramdef>
-char *<parameter>str</parameter>,
-float *<parameter>len</parameter>
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-Renders the string str with in Truetype format with the height 1, returns
-the length of the rendered string in *len (or set len=NULL to disable this).
-
-</para>
-<programlisting>
-	char str="hello world!";
-	float len;
-	<link linkend="s3d_select_font">s3d_select_font</link>("vera");
-	<emphasis>s3d_draw_string</emphasis>(str,len);
-
-	/* not interested in the length? do that:
-	 * <emphasis>s3d_draw_string</emphasis>(str,NULL); */
-</programlisting>
-</sect1>
-
-<sect1>
-<title>s3d_open_file</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_open_file</function></funcdef>
-<paramdef>
-char *<parameter>fname</parameter>,
-char **<parameter>pointer</parameter>
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-This opens the file fname, setting *pointer to it's memory position. the
-function will return the size of buffer. you can free() the pointer when
-you're finished.
-</para>
-</sect1>
-
-
-
-<sect1 id="s3d_flags_on">
-<title>s3d_flags_on</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_flags_on</function></funcdef>
-<paramdef>
-int <parameter>object</parameter>,
-unsigned long <parameter>flags</parameter>
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-turn some flags on for object.
-</para>
-<warning><para>if you don't toggle OF_VISIBLE on, you won't see your object. usually you want this. 
-(at least after you *push()d all your content)</para></warning>
-</sect1>
-
-<sect1 id="s3d_flags_off">
-<title>s3d_flags_off</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_flags_off</function></funcdef>
-<paramdef>
-int <parameter>object</parameter>,
-unsigned long <parameter>flags</parameter>
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-turn some flags off for object.
-</para>
-</sect1>
-
-
-<sect1>
-<title>s3d_translate</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_translate</function></funcdef>
-<paramdef>
-int <parameter>object</parameter>,
-float <parameter>x</parameter>,
-float <parameter>y</parameter>,
-float <parameter>z</parameter>
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-Move the object to some position in space. when you create an object, it's 
-always located at 0.0 , 0.0, 0.0.
-</para>
-<important><para>Translation is absolute, not relative!</para></important>
-<programlisting>
-<emphasis>s3d_translate</emphasis>(object,2,0,0);
-<emphasis>s3d_translate</emphasis>(object,4,0,0);
-/* object will end up at 4,0,0 and not 6,0,0!! */
-</programlisting>
-</sect1>
-
-
-<sect1>
-<title>s3d_rotate</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_rotate</function></funcdef>
-<paramdef>
-int <parameter>object</parameter>,
-float <parameter>x</parameter>,
-float <parameter>y</parameter>,
-float <parameter>z</parameter>
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-rotate an object around the x, y and z-axis respectively. x,y,z may have values
-between [0,360] degrees. 
-</para>
-<para>
-You will usually only rotate around one axis, leaving the unused fields on 0, I guess. 
-If you want to rotate around more than one axis, please note: The order of the rotation
-applies is y-axis, x-axis, and then z-axis. You can think of it as the earth position coordinates:
-x is the longitude, y is the latitude, and z is the rotation at this point of the earth around your
-bodies axis. (I wonder if that makes it any clearer ;)
-</para>
-<important><para>Rotate is absolute, not relative!</para></important>
-<programlisting>
-<emphasis>s3d_rotate</emphasis>(object,90,0,0);
-<emphasis>s3d_rotate</emphasis>(object,180,0,0);
-/* object will be rotated 180 degrees around the x-axis, not 270 degress! */
-</programlisting>
-</sect1>
-
-
-<sect1>
-<title>s3d_scale</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_scale</function></funcdef>
-<paramdef>
-int <parameter>object</parameter>,
-float <parameter>s</parameter>
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-Scales the object. about factor s. s=1 will be the original size, -1 will mirror it.
-</para>
-<important><para>s=0 is forbidden and will be ignored! s3d_scale is also absolute, not relative!</para></important>
-</sect1>
-
-<sect1>
-<title>s3d_push_event</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_push_event</function></funcdef>
-<paramdef>
-struct s3d_evt <parameter>*newevt</parameter>
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-Pushes an <link linkend="s3d_evt">event</link> onto the event-stack. Usually you don't need to do this manually.
-</para>
-</sect1>
-
-<sect1>
-<title>s3d_pop_event</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>struct s3d_evt *<function>s3d_pop_event</function></funcdef>
-<paramdef>void
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-Pops the latest event from the stack. Don't forget to free() both the event
-and its buffer! Returns a pointer to <link linkend="s3d_evt">struct s3d_evt</link>.
-</para>
-</sect1>
-
-<sect1 id="s3d_find_event">
-<title>s3d_find_event</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>struct s3d_evt *<function>s3d_find_event</function></funcdef>
-<paramdef>
-unsigned char <parameter>event</parameter>
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-Finds the latest occurence of an event, giving the event type as argument.
-Returns a pointer to <link linkend="s3d_evt">struct s3d_evt</link>.
-</para>
-</sect1>
-
-<sect1>
-<title>s3d_delete_event</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_delete_event</function></funcdef>
-<paramdef>
-struct s3d_evt *<parameter>devt</parameter>
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-deletes an event, the argument is the pointer to the <link linkend="s3d_evt">event</link> which is to be 
-deleted (maybe obtained from <link linkend="s3d_find_event">s3d_find_event</link>).
-</para>
-</sect1>
-
-<sect1 id="s3d_set_callback">
-<title>s3d_set_callback</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_set_callback</function></funcdef>
-<paramdef>
-unsigned char <parameter>event</parameter>
-s3d_cb <parameter>func</parameter>
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-sets a <link linkend="s3d_cb">callback</link> for a certain event. this is very useful for event-oriented 
-applications. event callbacks will not interrupt each other or the mainloop.
-</para>
-<important><para>Defining callbacks will only work after calling <link linkend="s3d_init">s3d_init()</link></para></important>
-<programlisting>
-void obj_click(<link linkend="s3d_evt">struct s3d_evt</link> event)
-{
-	printf("object id %d got clicked", *((unsigned long *)event->buf));
-}
-...
-	<link linkend="s3d_set_callback">s3d_set_callback</link>(<link linkend="S3D_EVENT_NEW_OBJECT">S3D_EVENT_NEW_OBJECT</link>, obj_click);
-
-/* this will tell you when a object got clicked */
-</programlisting>
-</sect1>
-
-
-<sect1>
-<title>s3d_clear_callback</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>void <function>s3d_clear_callback</function></funcdef>
-<paramdef>
-unsigned char <parameter>event</parameter>
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-Clears the callback which is associated with the event.
-</para>
-</sect1>
-
-
-<sect1>
-<title>s3d_get_callback</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>s3d_cb <function>s3d_get_callback</function></funcdef>
-<paramdef>
-unsigned char <parameter>event</parameter>
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-Returns the <link linkend="s3d_cb">Callback-function</link> of the event.
-</para>
-<programlisting>
-	<link linkend="s3d_evt">struct s3d_evt</link> e;
-	...
-	<emphasis>s3d_get_callback</emphasis>(<link linkend="S3D_EVENT_KEY">S3D_EVENT_KEY</link>)(e);
-	/* will call the key-handling function with argument e.  */
-
-</programlisting>
-</sect1>
-
-
-<sect1>
-<title>s3d_process_stack</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>void <function>s3d_process_callback</function></funcdef>
-<paramdef>void
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-This function goes through all function of the event-stack and will call 
-functions. this is useful when you define a new function but still have a lot 
-of events of this type on the stack. 
-</para>
-<note><para>This is probably obsolete</para></note>
-</sect1>
-
-<sect1>
-<title>s3d_vector_length</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>float <function>s3d_vector_length</function></funcdef>
-<paramdef>
-float <parameter>vector</parameter>[]
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-Calculates and returns the length of the given vector (which should be of the type float[3]).
-More info <ulink url="http://en.wikipedia.org/wiki/Vector_%28spatial%29#Length_of_a_vector">on wikipedia</ulink>.
-</para>
-</sect1>
-
-<sect1>
-<title>s3d_vector_substract</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>void <function>s3d_vector_substract</function></funcdef>
-<paramdef>
-float <parameter>vector1</parameter>[],
-float <parameter>vector2</parameter>[],
-float <parameter>result_vector</parameter>[]
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-Substracts vector1 from vector2, writing result into result_vector.
-All vectors should have the format  float[3].
-More info <ulink url="http://en.wikipedia.org/wiki/Vector_%28spatial%29#Vector_addition_and_subtraction">on wikipedia</ulink>.
-</para>
-</sect1>
-
-<sect1>
-<title>s3d_vector_dot_product</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>float <function>s3d_vector_dot_product</function></funcdef>
-<paramdef>
-float <parameter>vector1</parameter>[],
-float <parameter>vector2</parameter>[]
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-Calculates and returns the dot product of vector1 and vector2.
-All vectors should have the format  float[3].
-More info <ulink url="http://en.wikipedia.org/wiki/Vector_%28spatial%29#Dot_product">on wikipedia</ulink>.
-</para>
-</sect1>
-
-<sect1>
-<title>s3d_vector_angle</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>float <function>s3d_vector_angle</function></funcdef>
-<paramdef>
-float <parameter>vector1</parameter>[],
-float <parameter>vector2</parameter>[]
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-Calculates and returns the angle between vector1 and vector2. Please note that the resulting angle is between 0 and PI, therefore not covering the whole period! To convert in degrees just do result*180/M_PI.
-All vectors should have the format  float[3].
-More info <ulink url="http://en.wikipedia.org/wiki/Vector_%28spatial%29#Dot_product">on wikipedia</ulink>.
-</para>
-</sect1>
-
-
-<sect1>
-<title>s3d_mcp_focus</title>
-<funcsynopsis>
-<funcsynopsisinfo><![CDATA[#include <s3d.h>]]></funcsynopsisinfo>
-<funcprototype>
-<funcdef>int <function>s3d_mcp_focus</function></funcdef>
-<paramdef>
-int <parameter>object</parameter>
-</paramdef>
-</funcprototype>
-</funcsynopsis>
-<para>
-This is an mcp-only function. It gives focus (for receiving key-strokes etc.)
-to an app referenced by it's mcp-object-id. 
-</para>
-</sect1>
-
-
-</chapter>
-
-
-<chapter id="data_types">
-<title>Data types</title>
-
-<sect1 id="s3d_obj_info">
-<title>struct s3d_but_info</title>
-<programlisting>
-struct s3d_obj_info 
-{
-	unsigned long object;
-	unsigned long flags;
-	float trans_x,trans_y,trans_z;
-	float rot_x,rot_y,rot_z;
-	float scale;
-	float r;
-	char name[256]; 
-};
-</programlisting>
-<para>
-Can be used on the buffer of an <link linkend="s3d_evt">event</link> of type <link linkend="S3D_EVENT_OBJ_INFO">S3D_EVENT_OBJ_INFO</link>.
-name will usually contain nothing for usual objects, but mcp objects will contain the applications names here. r is the radius of the convex sphere
-an object, which will also be interesting for the mcp.
-</para>
-<para>
-Special objects like camera, pointer will have the "sys_" prefix in the name and will be named "pointer0", "pointer1" ... or "cam0", "cam1" ...
-For cam object, scale will contain the aspect ratio.
-</para>
-</sect1>
-
-
-
-<sect1 id="s3d_but_info">
-<title>struct s3d_but_info</title>
-<programlisting>
-struct s3d_but_info     
-{                       
-    unsigned char button, state;
-};                      
-</programlisting>
-<para>
-Can be used on the buffer of an <link linkend="s3d_evt">event</link> of type <link linkend="S3D_EVENT_MBUTTON">S3D_EVENT_MBUTTON</link>.
-</para>
-</sect1>
-
-
-<sect1 id="mcp_object">
-<title>struct mcp_object</title>
-<programlisting>
-struct mcp_object 
-{
-	unsigned long object;
-	float trans_x,trans_y,trans_z;
-	float r;
-	char name[256]; 
-};
-
-</programlisting>
-<para>
-obsolete, deprecated, don't use, to be removed soon (use <link linkend="s3d_but_info">struct s3d_but_info</link>). ;)
-</para>
-</sect1>
-
-<sect1 id="s3d_evt">
-<title>struct s3d_evt</title>
-<programlisting>
-struct s3d_evt {
-	unsigned char event;
-	int length;
-	char *buf;
-	struct s3d_evt *next;
-};
-</programlisting>
-<para>
-
-This is the event information holder. 
-<variablelist>
-<varlistentry>
-<term>event</term>
-<listitem><para>gives the <link linkend="s3d_events">event type</link></para></listitem>
-</varlistentry>
-<varlistentry>
-<term>length</term>
-<listitem><para>gives the length of the buffer *buf</para></listitem>
-</varlistentry>
-<varlistentry>
-<term>*buf</term>
-<listitem><para>is the pointer to the multiple purpose buffer, which will have more specific information about the object</para></listitem>
-</varlistentry>
-<varlistentry>
-<term>*next</term>
-<listitem><para>can be safely ignored ;)</para></listitem>
-</varlistentry>
-</variablelist>
-
-Depending on the event, buf can contain the keycode pressed on keyboard event, the <link linkend="s3d_but_info">mouse button state</link> on a mouse event, <link linkend="s3d_obj_info">object information</link> etc.
-</para>
-</sect1>
-
-<sect1 id="s3d_cb">
-<title>typedef s3d_cb</title>
-<programlisting>
-typedef void (*<emphasis>s3d_cb</emphasis>)(<link linkend="s3d_evt">struct s3d_evt</link> *);
-</programlisting>
-<para>
-This defines the callback format. Each callback should return void and take an argument of <link linkend="s3d_evt">struct s3d_evt *</link>.
-Callbacks can be defined with <link linkend="s3d_set_callback">s3d_set_callback()</link>.
-</para>
-<programlisting>
-/* a callback handler could look like this: */
-void my_key_handler(struct s3d_evt *event_data)
-{
-	...
-}
-</programlisting>
-</sect1>
-</chapter>
-
-
-
-
-<chapter id="definitions">
-<title>Definitions</title>
-
-
-
-
-<sect1 id="s3d_events">
-<title>S3D events</title>
-<para>
-This defines the callback format. Each callback should return void and take an argument of <link linkend="s3d_evt">struct s3d_evt *</link>.
-Callbacks can be defined with <link linkend="s3d_set_callback">s3d_set_callback()</link>.
-<variablelist>
-
-<varlistentry>
-<term><anchor id="S3D_EVENT_OBJ_CLICK"/>S3D_EVENT_OBJ_CLICK</term>
-<listitem><para>
-An object got clicked (when you set the flag <link linkend="S3D_OF_SELECTABLE">S3D_OF_SELECTABLE</link>), buf will contain the object id
-of the object which got clicked (unsigned long, 4 byte)
-</para></listitem>
-</varlistentry>
-
-<varlistentry>
-<term><anchor id="S3D_EVENT_KEY"/>S3D_EVENT_KEY</term>
-<listitem><para>
-A key was pressed, buf will contain a keycode. use  <![CDATA[#include <s3d_keysym.h>]]> to have the keycodes available. buf is a 2 byte unsigned short keycode.
-</para></listitem>
-</varlistentry>
-
-
-<varlistentry>
-<term><anchor id="S3D_EVENT_MBUTTON"/>S3D_EVENT_MBUTTON</term>
-<listitem><para>
-A mouse button was clicked. Use <link linkend="s3d_but_info">struct s3d_but_info</link> on buf to get more info.
-</para></listitem>
-</varlistentry>
-
-<varlistentry>
-<term><anchor id="S3D_EVENT_NEW_OBJECT"/>S3D_EVENT_NEW_OBJECT</term>
-<listitem><para>
-deprecated, will use <link linkend="S3D_EVENT_OBJ_INFO">S3D_EVENT_OBJ_INFO</link>
-</para></listitem>
-</varlistentry>
-
-
-<varlistentry>
-<term><anchor id="S3D_EVENT_OBJ_INFO"/>S3D_EVENT_OBJ_INFO</term>
-<listitem><para>
-Something happened to an object. This can happen if the camera was moved, the mouse (pointer) was moved or an application appeared/changed in the mcp
-
-</para></listitem>
-</varlistentry>
-
-<varlistentry>
-<term><anchor id="S3D_MCP_OBJECT"/>S3D_MCP_OBJECT</term>
-<listitem><para>
-As the name suggests, those will only happen to the MCP. 
-This tells it about new/changed application object. <link linkend="mcp_object">struct mcp_object</link>
-can be used on buf. To be removed in the future.
-</para></listitem>
-</varlistentry>
-
-<varlistentry>
-<term><anchor id="S3D_MCP_DEL_OBJECT"/>S3D_MCP_DEL_OBJECT</term>
-<listitem><para>
-As the name suggests, those will only happen to the MCP. 
-This tells it about deleted application object. <link linkend="mcp_object">struct mcp_object</link>
-can be used on buf. To be removed in the future.
-</para></listitem>
-</varlistentry>
-
-
-<varlistentry>
-<term><anchor id="S3D_EVENT_QUIT"/>S3D_EVENT_QUIT</term>
-<listitem><para>
-Server sent the quit signal, or the connection was terminated. Usually, this is only processed internally.
-</para></listitem>
-</varlistentry>
-
-
-
-</variablelist>
-</para>
-<programlisting>
-/* a callback handler could look like this: */
-void my_key_handler(struct s3d_evt *event_data)
-{
-	...
-}
-</programlisting>
-</sect1>
-
-
-<sect1 id="s3d_object_flags">
-<title>S3D Object Flags</title>
-<para>
-Objects can have several flags to change their behaviour in the server and can be set with 
-<link linkend="s3d_flags_on">s3d_flags_on()</link> and
-<link linkend="s3d_flags_off">s3d_flags_off()</link>
-<variablelist>
-<varlistentry>
-<term><anchor id="S3D_OF_VISIBLE"/>S3D_OF_VISIBLE</term>
-<listitem><para>default:off</para><para>
-Obviously, if this flag is toggled the user can see it, if not it will be hidden. ;)
-</para><para>
-When an object is created it's turned off, so you will be able push your geometry data and
-turn it on after you're done. That avaoids flickering and stuff.
-</para></listitem>
-</varlistentry>
-
-<varlistentry>
-<term><anchor id="S3D_OF_SELECTABLE"/>S3D_OF_SELECTABLE</term>
-<listitem><para>default:off</para><para>
-When this is toggled on, you will receive <link linkend="S3D_EVENT_OBJ_CLICK">click events</link>.
-Don't use it if you don't need it, it will eat performance.
-</para></listitem>
-</varlistentry>
-
-<varlistentry>
-<term><anchor id="S3D_OF_POINTABLE"/>S3D_OF_POINTABLE</term>
-<listitem><para>default:off</para><para>
-Placeholder for pointer (onmouseover-event enabler) events. Not implemented yet.
-</para></listitem>
-</varlistentry>
-
-</variablelist>
-</para>
-</sect1>
-
-</chapter>
-
-<chapter id="Notes">
-<title>Additional Notes</title>
-<sect1 id="alpha">
-<title>About alpha transparency</title>
-<para>
-Alpha transparency works, but polygons don't get ordered in view direction on the server yet. So please don't
-use this feature yet. If you have an easy idea how to do that with opengl please drop me a line.
-</para>
-</sect1>
-</chapter>
-
-
-
-
-<chapter id="About">
-<title>About</title>
-<para>
-Copyright ? 2006 Simon Wunderlich <email>dotslash at packetmixer.de</email>
-</para>
-<para>
-All Rights reserved. That is, because I currently don't know how to license this. You may distribute or copy it as long this 
-Documentation is unmodified and complete (I'd love to receive patches and corrections though). Don't hesitate to ask
-if you want to use this doc in any way or have some license recommendation.
-</para>
-</chapter>
-
-</book>
-

Added: trunk/Documentation/libs3dw/libs3dw.docbook
===================================================================
--- trunk/Documentation/libs3dw/libs3dw.docbook	2006-06-05 16:14:23 UTC (rev 340)
+++ trunk/Documentation/libs3dw/libs3dw.docbook	2006-06-05 20:09:53 UTC (rev 341)
@@ -0,0 +1,525 @@
+<?xml version="1.0" encoding="UTF-8" ?>
+<chapter id="libs3dw">
+<title>libs3wd - The S3D Widget Library</title>
+<sect1 id="using_3dw">
+<title>Using the <application>s3d</application> widget library</title>
+<sect2 id="gettingstarted_s3dw">
+<title>Getting started</title>
+<para>
+	Assuming you have already read about the lowlevel <link linkend="libs3d">libs3d s3d api</link>, the s3d widget library is 
+	build on top of it and should be (hopefully) easy to use as any other widget library.
+	Just include
+	
+ 	<programlisting>
+	  <![CDATA[#include <s3dw.h>]]>
+	 </programlisting>
+
+	 and link with -ls3dw -ls3d, and everything should be fine. :)
+	 <screen>
+	 <prompt>bash$</prompt> <command> gcc <replaceable>program</replaceable>.c -ls3dw -ls3d -o <replaceable>program</replaceable> </command>
+ 	</screen>
+</para>
+</sect2>
+</sect1>
+
+
+<sect1 id="functions_s3dw">
+<title>function reference</title>
+
+
+
+<sect2 id="s3dw_surface_new">
+<title>s3dw_surface_new</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3dw.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>s3dw_surface *<function>s3dw_surface_new</function></funcdef>
+<paramdef>
+char         *<parameter>title</parameter>,
+float		  <parameter>width</parameter>,
+float		  <parameter>height</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+		Creates a new surface (a new window) with title "title" and dimension "width" x "height".
+</para>
+<para>
+		See <link linkend="s3dw_surface">s3dw_surface</link> for information about callbacks which may be defined.
+</para>
+</sect2>
+
+
+<sect2 id="s3dw_button_new">
+<title>s3dw_button_new</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3dw.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>s3dw_button *<function>s3dw_button_new</function></funcdef>
+<paramdef>
+s3dw_surface *<parameter>surface</parameter>,
+char         *<parameter>text</parameter>,
+float		  <parameter>posx</parameter>,
+float		  <parameter>posy</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+		Creates a new button on the <link linkend="s3dw_surface">surface</link>, 
+		with "text" written on it and the upper left 
+		corner at (posx,posy) on the <link linkend="s3dw_surface">surface</link>.
+</para>
+<para>
+		See <link linkend="s3dw_button">s3dw_button</link> for information about callbacks which may be defined.
+</para>
+</sect2>
+
+<sect2 id="s3dw_input_new">
+<title>s3dw_input_new</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3dw.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>s3dw_input *<function>s3dw_input_new</function></funcdef>
+<paramdef>
+s3dw_surface *<parameter>surface</parameter>,
+float		  <parameter>width</parameter>,
+float		  <parameter>posx</parameter>,
+float		  <parameter>posy</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+		Creates a new input-box on the <link linkend="s3dw_surface">surface</link> with a input width of "width",
+		the upper left  corner at (posx,posy) on the <link linkend="s3dw_surface">surface</link>.
+		The input-box is empty on creation and can be change with <link linkend="s3dw_input_change_text">s3dw_input_change_text</link>,
+		and received with <link linkend="s3dw_input_gettext">s3dw_input_gettext</link>
+</para>
+<para>
+		See <link linkend="s3dw_input">s3dw_input</link> for information about callbacks which may be defined.
+</para>
+</sect2>
+
+<sect2 id="s3dw_label_new">
+<title>s3dw_label_new</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3dw.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>s3dw_label *<function>s3dw_label_new</function></funcdef>
+<paramdef>
+s3dw_surface *<parameter>surface</parameter>,
+char         *<parameter>text</parameter>,
+float		  <parameter>posx</parameter>,
+float		  <parameter>posy</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+		Creates a new label on the <link linkend="s3dw_surface">surface</link>, 
+		with "text" written on it and the upper left 
+		corner at (posx,posy) on the <link linkend="s3dw_surface">surface</link>.
+</para>
+<para>
+		See <link linkend="s3dw_label">s3dw_label</link> for information about callbacks which may be defined.
+</para>
+</sect2>
+
+<sect2 id="s3dw_getroot">
+<title>s3dw_getroot</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3dw.h>]]></funcsynopsisinfo>
+<funcprototype>
+	<funcdef>s3dw_widget *<function>s3dw_getroot</function></funcdef>
+<paramdef>
+		void
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+		Returns the root-<link linkend="s3dw_widget">widget</link>, which holds all the surfaces. E.g. if you want
+		to move all widgets at once, adjust the root-widgets x,y,z and use <link linkend="s3dw_moveit">s3dw_moveit()</link>
+</para>
+<programlisting>
+		<link linkend="s3dw_widget">s3dw_widget</link> *root = <emphasis>s3dw_getroot</emphasis>();
+		/* move <link linkend="s3dw_widget">widget</link> center to (0,5,0). upon creation, it's centered at (0,0,0), 
+		 * so this might move it up */
+		root->x=0;
+		root->y=5;
+		root->z=0;
+		<link linkend="s3dw_moveit">s3dw_moveit</link>(root);
+</programlisting>
+</sect2>
+
+
+<sect2 id="s3dw_input_gettext">
+<title>s3dw_input_gettext</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3dw.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>char *<function>s3dw_input_gettext</function></funcdef>
+<paramdef>
+		s3dw_input *<parameter>input</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+		Returns the text which is currently entered in the referenced <link linkend="s3dw_input">input-box</link>.
+</para>
+</sect2>
+
+<sect2 id="s3dw_input_change_text">
+<title>s3dw_input_change_text</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3dw.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>void <function>s3dw_input_change_text</function></funcdef>
+<paramdef>
+		s3dw_input *<parameter>input</parameter>,
+		char *<parameter>text</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+		Change the text in the referenced <link linkend="s3dw_input">input-box</link> to the specified text.
+</para>
+</sect2>
+
+<sect2 id="s3dw_delete">
+<title>s3dw_delete</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3dw.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>void <function>s3dw_delete</function></funcdef>
+<paramdef>
+		s3dw_widget *<parameter>widget</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+	Deletes any widget. Should be casted with <link linkend="S3DWIDGET">S3DWIDGET()</link>.
+</para>
+</sect2>
+
+<sect2 id="s3dw_moveit">
+<title>s3dw_moveit</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3dw.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>void <function>s3dw_moveit</function></funcdef>
+<paramdef>
+		s3dw_widget *<parameter>widget</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+		Moves/translates the widget as you specified in it's private <link linkend="s3dw_widget">s3dw_widget structure</link>.
+		Should be casted with <link linkend="S3DWIDGET">S3DWIDGET()</link>.
+</para>
+</sect2>
+
+<sect2 id="s3dw_show">
+<title>s3dw_show</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3dw.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>void <function>s3dw_show</function></funcdef>
+<paramdef>
+		s3dw_widget *<parameter>widget</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+		Switches a <link linkend="s3dw_widget">widget</link> visible. Should be casted with <link linkend="S3DWIDGET">S3DWIDGET()</link>.
+</para>
+</sect2>
+
+<sect2 id="s3dw_focus">
+<title>s3dw_focus</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3dw.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>void <function>s3dw_focus</function></funcdef>
+<paramdef>
+		s3dw_widget *<parameter>widget</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+		Gives focus to the <link linkend="s3dw_widget">widget</link>, relative to its parent. That means you can focus a 
+		<link linkend="s3dw_surface">surface</link>, and each <link linkend="s3dw_surface">surface</link> can focus 
+		one of its element, e.g. an input field. 
+		Should be casted with <link linkend="S3DWIDGET">S3DWIDGET()</link>.
+</para>
+</sect2>
+
+<sect2 id="s3dw_handle_click">
+<title>s3dw_handle_click</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3dw.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>void <function>s3dw_handle_click</function></funcdef>
+<paramdef>
+		struct s3d_evt *<parameter>event</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+	If you want your widgets on mouseclicks (believe me, you want that), you have to call this
+	either in your clickhandler-function or specifiy it itself as the clickhandler.
+</para>
+<programlisting>
+/* way 1: */
+<link linkend="s3d_set_callback">s3d_set_callback</link>(<link linkend="S3D_EVENT_OBJ_CLICK">S3D_EVENT_OBJ_CLICK</link>,<emphasis>s3dw_handle_click</emphasis>);
+
+/* way 2: */
+...
+void click(<link linkend="s3d_evt">struct s3d_evt</link> *evt)
+{
+	<emphasis>s3dw_handle_click</emphasis>(evt);
+	.... 
+	/* your own clickhandler code */
+	...
+}
+....
+<link linkend="s3d_set_callback">s3d_set_callback</link>(<link linkend="S3D_EVENT_OBJ_CLICK">S3D_EVENT_OBJ_CLICK</link>,click);
+</programlisting>
+</sect2>
+
+
+<sect2 id="s3dw_handle_key">
+<title>s3dw_handle_key</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3dw.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>void <function>s3dw_handle_key</function></funcdef>
+<paramdef>
+		struct s3d_evt *<parameter>event</parameter>
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+	This is somehow useful to call in your keyhandler functions if you want to 
+	have input-boxes work. ;)
+</para>
+<programlisting>
+/* way 1: */
+<link linkend="s3d_set_callback">s3d_set_callback</link>(<link linkend="S3D_EVENT_KEY">S3D_EVENT_KEY</link>,<emphasis>s3dw_handle_key</emphasis>);
+
+/* way 2: */
+...
+void key(<link linkend="s3d_evt">struct s3d_evt</link> *evt)
+{
+	<emphasis>s3dw_handle_key</emphasis>(evt);
+	.... 
+	/* your own keyhandler code */
+	...
+}
+....
+<link linkend="s3d_set_callback">s3d_set_callback</link>(<link linkend="S3D_EVENT_KEY">S3D_EVENT_KEY</link>,key);
+</programlisting>
+</sect2>
+
+
+<sect2 id="s3dw_ani_mate">
+<title>s3dw_ani_mate</title>
+<funcsynopsis>
+<funcsynopsisinfo><![CDATA[#include <s3dw.h>]]></funcsynopsisinfo>
+<funcprototype>
+<funcdef>void <function>s3dw_ani_mate</function></funcdef>
+<paramdef>void
+</paramdef>
+</funcprototype>
+</funcsynopsis>
+<para>
+	Just call this in your mainloop if you want
+	some nice window sliding animations. it's somewhat bloating, but you don't want to miss it ;)
+</para>
+<programlisting>
+<![CDATA[#include <time.h>]]>   /* nanosleep() */
+static struct timespec t={0,33*1000*1000}; /* 33 mili seconds */
+void mainloop()
+{
+    /* keep this in your mainloop. this will do smooth animations for you ... */
+    s3dw_ani_mate();
+    nanosleep(<![CDATA[&t,NULL]]>);
+}
+
+....
+<link linkend="s3d_mainloop">s3d_mainloop</link>(mainloop);
+</programlisting>
+</sect2>
+
+</sect1>
+<sect1 id="data_types_s3dw">
+<title>Data types</title>
+
+
+
+<sect2 id="s3dw_widget">
+<title>s3dw_widget</title>
+<programlisting>
+struct _s3dw_widget {   
+		/* private .. */
+		int          type;
+		<emphasis>s3dw_widget</emphasis> *parent;        
+		<link linkend="s3dw_style">s3dw_style</link>  *style;
+		int                   nobj; /* number of children objects */
+		<emphasis>s3dw_widget</emphasis>         **pobj; /* pointer to list of children objects */
+		int          focus;         /* index of the widget focused in pobj */
+		int          flags;         /* flags like visibility */
+		float        ax,ay,az;      /* current position for animation */
+		float        as;            /* current scale factor */
+		float        arx,ary,arz;   /* current rotation */
+		float        width,height;  /* width and height of the widget, outer size */
+		unsigned long oid;          /* the main object which is used for transformations etc ...*/
+		/* public */
+		float        x,y,z;         /* position, relative to the surface usually */
+		float        s;             /* scale factor */
+		float        rx,ry,rz;      /* rotation around the axis */
+};
+typedef struct _s3dw_widget     s3dw_widget;
+
+/* type may be one of the following ... */		
+
+enum {
+    S3DW_TROOT,
+    S3DW_TSURFACE,
+    S3DW_TBUTTON,
+    S3DW_TLABEL,
+    S3DW_TINPUT,
+    S3DW_NTYPES
+};
+<anchor id="S3DWIDGET"/>
+#define     S3DWIDGET(x)    (s3dw_widget *)x
+						
+</programlisting>
+<para>
+		This is the most basic widget type, it contains all the "general" widget information. If you want to move a widget, you'd
+		change x,y,z,s and rx,ry,rz and call <link linkend="s3dw_moveit">s3dw_moveit</link> to turn your action reality. Every other
+		widget has this type as first entry, so a simple typecast to <emphasis>s3dw_widget</emphasis> will give you the widgets "general"
+		information. For typecast, you may use S3DWIDGET()
+</para>
+</sect2>
+
+<sect2 id="s3dw_button">
+<title>s3dw_button</title>
+<programlisting>
+typedef struct _s3dw_button     s3dw_button;
+struct _s3dw_button {
+    /* private */
+	<link linkend="s3dw_widget">s3dw_widget</link>      widget;
+	char            *text;
+	unsigned long    oid_text;
+	/* public */
+	<link linkend="s3dw_callback">s3dw_callback</link>    onclick;
+};
+</programlisting>
+<para>
+	The buttons is just a button as you would expect it in a 2D widget library. It only reacts on clicks.
+</para>
+</sect2>
+
+
+<sect2 id="s3dw_input">
+<title>s3dw_input</title>
+<programlisting>
+typedef struct _s3dw_input     s3dw_input;
+struct _s3dw_input {
+    /* private */
+	<link linkend="s3dw_widget">s3dw_widget</link>      widget;
+	char            *text;
+	unsigned long    oid_text;
+	/* public */
+	<link linkend="s3dw_callback">s3dw_callback</link>    onclick;
+	<link linkend="s3dw_callback">s3dw_callback</link>    onedit;
+};
+</programlisting>
+<para>
+		The inputs is an input-field where a user may type things. onclick reacts on click in the field,
+		onedit notifies you when someone writes in the field.
+</para>
+</sect2>
+
+
+<sect2 id="s3dw_label">
+<title>s3dw_label</title>
+<programlisting>
+typedef struct _s3dw_label     s3dw_label;
+struct _s3dw_label {
+    /* private */
+	<link linkend="s3dw_widget">s3dw_widget</link>      widget;
+	char            *text;
+	/* public */
+	<link linkend="s3dw_callback">s3dw_callback</link>    onclick;
+};
+</programlisting>
+<para>
+		The labels is an label-field where a user may type things. onclick reacts on click in the field,
+		onedit notifies you when someone writes in the field.
+</para>
+</sect2>
+
+<sect2 id="s3dw_surface">
+<title>s3dw_surface</title>
+<programlisting>
+typedef struct _s3dw_surface     s3dw_surface;
+struct _s3dw_surface {
+    /* private */
+	<link linkend="s3dw_widget">s3dw_widget</link>      widget;
+	unsigned long         oid_title;
+	unsigned long         oid_tbar;
+	char            *text;
+};
+</programlisting>
+<para>
+	A surface is the window of this widget library, holding all of our elements like <link linkend="s3dw_button">buttons</link>, 
+	<link linkend="s3dw_input">inputfields</link> etc ...
+</para>
+</sect2>
+
+
+<sect2 id="s3dw_style">
+<title>s3dw_style</title>
+<programlisting>
+typedef struct _s3dw_style     s3dw_style;
+/* style */
+struct _s3dw_style {
+    char *name;                 /* name of the style ... kind of redundant */
+    char *fontface;             /* font face for all used fonts */
+    float surface_mat[12];      /* material for the surface background */
+    float input_mat[12];        /* material for buttonboxes and other widgets */
+    float inputback_mat[12];    /* material for inputfield background */
+    float text_mat[12];         /* material for the text on buttons and inputs */
+    float title_mat[12];        /* material for the title bar */
+    float title_text_mat[12];   /* material for the text on the title bar */
+};
+
+</programlisting>
+<para>
+	With s3dw_style you can change the colors/materials of your widgets. materials are in the same as in 
+	<link linkend="s3d_push_materials_a">s3d_push_materials_a</link>, that means red,green,blue and alpha float values 
+	(between 0.0 and 1.0) for Ambience, Specular and Diffuse Color.
+</para>
+</sect2>
+
+<sect2 id="s3dw_callback">
+<title>s3dw_callback</title>
+<programlisting>
+typedef void (*s3dw_callback)(s3dw_widget *);
+
+</programlisting>
+<para>
+	The callback type. Receive the widget which is affected as argument.
+</para>
+<programlisting>
+/* example */
+void my_handler(<link linkend="s3dw_widget">s3dw_widget</link> *widget)
+{
+	/* do something with the widget */
+	...
+}
+</programlisting>
+</sect2>
+
+
+</sect1>
+</chapter>

Deleted: trunk/Documentation/movement.txt
===================================================================
--- trunk/Documentation/movement.txt	2006-06-05 16:14:23 UTC (rev 340)
+++ trunk/Documentation/movement.txt	2006-06-05 20:09:53 UTC (rev 341)
@@ -1,8 +0,0 @@
-this is not the final version for movement, but ...
-
-- hold middle mouse button (or left+right at once if you have middle-mousebutton-emulation) and move
-  your mouse to move around the world
-- hold right mouse button and move mouse to rotate the mouse (look around)
-- left mouse button is for clicking :)
-- presse f1 to get in ego-shooter mode :D you can use w,a,s,d for movement now. f1 again to deactivate.
-  this only works with dot_mcp, the others above work out-of-the box within the server.

Deleted: trunk/Documentation/s3drc.txt
===================================================================
--- trunk/Documentation/s3drc.txt	2006-06-05 16:14:23 UTC (rev 340)
+++ trunk/Documentation/s3drc.txt	2006-06-05 20:09:53 UTC (rev 341)
@@ -1,20 +0,0 @@
-You can automatically fire up the mcp or anything you want with s3d and 
-have it closed when s3d goes down or vice versa:
-
-just create a shellscript at position /etc/s3drc or ~/.s3drc, for example
-have it starting the mcp. Don't forget to toggle it executable (chmod 755 
-or so).
-
-When s3d starts, it will look for ~/.s3drc or /etc/s3drc (in this order),
-and will start it along with the server. E.g. when you log out off your mcp,
-the s3d server is shut down too.
-
-You can disable this behavior with s3d --no-rc
-
-For example my .s3drc looks like this:
-
-$ cat ~/.s3drc 
-#!/bin/sh
-cd ~/msrc/s3d/apps/dot_mcp/
-./dot_mcp
-

Added: trunk/Documentation/server/server.docbook
===================================================================
--- trunk/Documentation/server/server.docbook	2006-06-05 16:14:23 UTC (rev 340)
+++ trunk/Documentation/server/server.docbook	2006-06-05 20:09:53 UTC (rev 341)
@@ -0,0 +1,76 @@
+<?xml version="1.0" encoding="UTF-8" ?>
+<chapter id="introduction">
+<title>s3d - the server</title>
+<sect1 id="client_server">
+<title>Client-Server Architecture</title>
+ <para><application>s3d</application> is build as client-server architecture, similar to the xserver.
+ 	The s3d-server is the program executed on the users desktop and waits for incoming connections, the applications,
+	which give their content they want to have displayed to the server. The server will then display the content to the 
+	user, who can move to the 3D space, and interact (mouse moving/clicking, keyboard), and the client will receive these 
+	signals over the network from the server.
+ </para>
+ <para>
+	Just like on the X-Server, it may seem unusual to have the "server" on the own machine, while the "client" may be 
+	on any other machine with network connection. But this makes features possible like browsing files on your 
+	file server or even access point. ;)
+</para>
+<para>
+	Don't let the server-client thing confuse you too much for now, on a properly installed system the s3d will startup with
+	the mcp (which is the window manager in s3d-terms) which will give you a complete look and feel just as you would expect.
+</para>
+<para>
+	More (internal) information about the server will be presented here as soon as someone is interested. ;)
+</para>
+</sect1>
+<sect1 id="Moving">
+<title>Moving in s3d</title>
+<para>
+this is not the final version for movement, but ...
+
+<itemizedlist>
+<listitem><para>
+hold middle mouse button (or left+right at once if you have middle-mousebutton-emulation) and move your mouse to move around the world
+</para></listitem>
+<listitem><para>
+hold right mouse button and move mouse to rotate the mouse (look around)
+</para></listitem>
+<listitem><para>
+left mouse button is for clicking :)
+</para></listitem>
+<listitem><para>
+presse f1 to get in ego-shooter mode :D you can use w,a,s,d for movement now. f1 again to deactivate.
+this only works with dot_mcp, the others above work out-of-the box within the server.
+</para></listitem>
+</itemizedlist>
+</para>
+</sect1>
+<sect1 id="s3drc">
+<title>The s3drc file</title>
+<para>
+You can automatically fire up the mcp or anything you want with s3d and 
+have it closed when s3d goes down or vice versa:
+</para>
+<para>
+just create a shellscript at position /etc/s3drc or ~/.s3drc, for example
+have it starting the mcp. Don't forget to toggle it executable (chmod 755 
+or so).
+</para>
+<para>
+When s3d starts, it will look for ~/.s3drc or /etc/s3drc (in this order),
+and will start it along with the server. E.g. when you log out off your mcp,
+the s3d server is shut down too.
+</para>
+<para>
+You can disable this behavior with s3d --no-rc
+</para>
+<para>
+For example my .s3drc looks like this:
+</para>
+ <screen>
+<prompt>$</prompt> cat ~/.s3drc 
+ #!/bin/sh
+cd ~/msrc/s3d/apps/dot_mcp/
+./dot_mcp
+</screen>
+</sect1>
+</chapter>



From dotslash at berlios.de  Mon Jun  5 22:14:44 2006
From: dotslash at berlios.de (dotslash at BerliOS)
Date: Mon, 5 Jun 2006 22:14:44 +0200
Subject: [S3d-svn] r342 - in trunk: . libs3dw
Message-ID: <200606052014.k55KEiOu012546@sheep.berlios.de>

Author: dotslash
Date: 2006-06-05 22:14:44 +0200 (Mon, 05 Jun 2006)
New Revision: 342

Modified:
   trunk/
   trunk/libs3dw/s3dw.h
Log:
 r738 at balthasar:  dotslash | 2006-06-05 22:14:40 +0200
 - small things



Property changes on: trunk
___________________________________________________________________
Name: svk:merge
   - bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:733
   + bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:738

Modified: trunk/libs3dw/s3dw.h
===================================================================
--- trunk/libs3dw/s3dw.h	2006-06-05 20:09:53 UTC (rev 341)
+++ trunk/libs3dw/s3dw.h	2006-06-05 20:14:44 UTC (rev 342)
@@ -53,7 +53,7 @@
 
 
 struct _s3dw_widget {
-	/* it's all private .. */
+	/* private .. */
 	int   		 type;
 	s3dw_widget *parent; 
 	s3dw_style  *style;
@@ -61,14 +61,15 @@
 	s3dw_widget		 	**pobj; /* pointer to list of children objects */
 	int 		 focus;			/* index of the widget focused in pobj */
 	int   		 flags;			/* flags like visibility */
-	float 		 x,y,z;			/* position, relative to the surface usually */
 	float 		 ax,ay,az;		/* current position for animation */
-	float 		 s;				/* scale factor */
 	float 		 as;			/* current scale factor */
-	float 		 rx,ry,rz;		/* rotation around the axis */
 	float 		 arx,ary,arz;   /* current rotation */
 	float 		 width,height;	/* width and height of the widget, outer size */
 	unsigned long oid;			/* the main object which is used for transformations etc ...*/
+	/* public */
+	float 		 x,y,z;			/* position, relative to the surface usually */
+	float 		 s;				/* scale factor */
+	float 		 rx,ry,rz;		/* rotation around the axis */
 };
 
 
@@ -84,7 +85,6 @@
 	/* private */
 	s3dw_widget 	 widget;
 	char 			*text;
-	unsigned long    oid_text;
 	/* public */
 	s3dw_callback 	 onclick;
 	



From dotslash at berlios.de  Mon Jun  5 22:28:56 2006
From: dotslash at berlios.de (dotslash at BerliOS)
Date: Mon, 5 Jun 2006 22:28:56 +0200
Subject: [S3d-svn] r343 - in trunk: . Documentation
Message-ID: <200606052028.k55KSu7M014691@sheep.berlios.de>

Author: dotslash
Date: 2006-06-05 22:28:56 +0200 (Mon, 05 Jun 2006)
New Revision: 343

Modified:
   trunk/
   trunk/Documentation/bookinfo.docbook
Log:
 r740 at balthasar:  dotslash | 2006-06-05 22:28:52 +0200
 - Developer -> Development



Property changes on: trunk
___________________________________________________________________
Name: svk:merge
   - bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:738
   + bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:740

Modified: trunk/Documentation/bookinfo.docbook
===================================================================
--- trunk/Documentation/bookinfo.docbook	2006-06-05 20:14:44 UTC (rev 342)
+++ trunk/Documentation/bookinfo.docbook	2006-06-05 20:28:56 UTC (rev 343)
@@ -13,7 +13,7 @@
 
 <abstract>
 <para>
-This is the Documentation for the S3D and it's Developer Libraries.
+This is the Documentation for the S3D and it's Development Libraries.
 </para>
 </abstract>
 



From nichtsnutz at berlios.de  Tue Jun  6 04:32:58 2006
From: nichtsnutz at berlios.de (nichtsnutz at BerliOS)
Date: Tue, 6 Jun 2006 04:32:58 +0200
Subject: [S3d-svn] r344 - trunk/apps/olsrs3d
Message-ID: <200606060232.k562WwO1003798@sheep.berlios.de>

Author: nichtsnutz
Date: 2006-06-06 04:32:43 +0200 (Tue, 06 Jun 2006)
New Revision: 344

Added:
   trunk/apps/olsrs3d/mod_search.c
   trunk/apps/olsrs3d/mod_search.h
Modified:
   trunk/apps/olsrs3d/Makefile.am
   trunk/apps/olsrs3d/main.c
   trunk/apps/olsrs3d/terminal.c
Log:
- Use widget for search input
- put search in modul
- code cleaning main.c



Modified: trunk/apps/olsrs3d/Makefile.am
===================================================================
--- trunk/apps/olsrs3d/Makefile.am	2006-06-05 20:28:56 UTC (rev 343)
+++ trunk/apps/olsrs3d/Makefile.am	2006-06-06 02:32:43 UTC (rev 344)
@@ -3,16 +3,16 @@
 olsrs3dincludedir = $(pkgincludedir)/olsrs3d
 olsrs3dinclude_HEADERS =  \
 	olsrs3d.h \
-	terminal.h
+	mod_search.h
 
 olsrs3d_SOURCES =  \
 	process.c \
 	main.c \
 	net.c \
-	terminal.c
+	mod_search.c
 
-olsrs3d_CPPFLAGS=	-I$(top_srcdir)/libs3d
-olsrs3d_LDADD=		$(top_builddir)/libs3d/libs3d.la
+olsrs3d_CPPFLAGS=	-I$(top_srcdir)/libs3d -I$(top_srcdir)/libs3dw
+olsrs3d_LDADD=		$(top_builddir)/libs3d/libs3d.la $(top_builddir)/libs3dw/libs3dw.la
 
 EXTRA_DIST = \
 	output.sample TODO

Modified: trunk/apps/olsrs3d/main.c
===================================================================
--- trunk/apps/olsrs3d/main.c	2006-06-05 20:28:56 UTC (rev 343)
+++ trunk/apps/olsrs3d/main.c	2006-06-06 02:32:43 UTC (rev 344)
@@ -28,13 +28,14 @@
 #include <stdio.h>
 #include <s3d.h>
 #include <s3d_keysym.h>
+#include <s3dw.h>
 #include <time.h>	      /* nanosleep() */
 #include <string.h>	/* strncpy() */
 #include <math.h>		/* sqrt() */
 #include <getopt.h>	/* getopt() */
 #include <stdlib.h>	/* exit() */
 #include "olsrs3d.h"
-#include "terminal.h"
+#include "mod_search.h"
 
 #define SPEED		10.0
 
@@ -54,8 +55,8 @@
 int Output_border[4];
 int *Olsr_neighbour_label_obj = NULL;
 int Size;
-int Move_prepared = 0;
 
+
 int Net_read_count;
 int Output_block_counter = 0;
 int Output_block_completed = 0;
@@ -68,9 +69,10 @@
 
 float CamPosition[2][3];	/* CamPosition[trans|rot][x-z] */
 float CamPosition2[2][3];	/* CamPosition[trans|rot][x-z] */
-float ZeroPosition[3] = {0,0,0};	/* current position zero position */
-float ReturnPoint[2][3];	/* return point to move back from terminal */
 
+/* needed ? */
+/* float ZeroPosition[3] = {0,0,0};	 current position zero position */
+
 int ZeroPoint;   /* object zeropoint */
 float Zp_rotate = 0.0;
 int ColorSwitch = 0;   /* enable/disable colored olsr connections */
@@ -80,21 +82,10 @@
 struct olsr_node *Olsr_node_pEtx;
 
 int Btn_close_id = -1;
-int Btn_close_obj;
-int Btn_move_terminal_obj;
-int Btn_move_terminal_id = -1;
-int Btn_follow_mode_obj;
-int Btn_follow_mode_id = -1;
 
-int Rotate_follow_button = 0;
-
+int Btn_close_obj;
 float Title_len;
-int cam_go=0;
 
-int move_cam_to = -1;
-int Oid_focus = -1;
-
-
 /***
  *
  * print usage info
@@ -691,40 +682,25 @@
 		}
 	}
 	
+	/* rotate modus */
 	if(RotateSwitch) {
 		Zp_rotate = ( Zp_rotate + RotateSpeed ) > 360 ? 0.0 : ( Zp_rotate + RotateSpeed );	
 		s3d_rotate(ZeroPoint,0,Zp_rotate,0);
 	}
+
+	/* calc for node description */
 	CamPosition2[0][0]=  CamPosition[0][0]*cos(Zp_rotate*M_PI/180.0) - CamPosition[0][2] * sin (Zp_rotate*M_PI/180.0);
 	CamPosition2[0][1]=  CamPosition[0][1];
 	CamPosition2[0][2]=  CamPosition[0][0]*sin(Zp_rotate*M_PI/180.0) + CamPosition[0][2] * cos (Zp_rotate*M_PI/180.0);
 
-	/* move to terminal */
-	if( move_cam_to == obj[obj_term]->oid )
-	{
-		Oid_focus = obj[obj_term]->oid;
-		for( i=0; i<3; i++)
-		{
-			CamPosition[0][i]=(CamPosition[0][i]*4+obj[obj_term]->poi[i])/5;
-
-			target = obj[obj_term]->rot[i];
-			current = CamPosition[1][i];
-
-			if( obj[obj_term]->rot[i] - CamPosition[1][i] > 180 )
-				target = obj[obj_term]->rot[i] - 360;
-			if( obj[obj_term]->rot[i] - CamPosition[1][i] < -180 )
-				current = CamPosition[1][i] - 360;
-			CamPosition[1][i]=(CamPosition[1][i]*4+target)/5;
-		}
-		s3d_translate(0,CamPosition[0][0],CamPosition[0][1],CamPosition[0][2]);
-		s3d_rotate(0,CamPosition[1][0],CamPosition[1][1],CamPosition[1][2]);
-
-		if (dist(CamPosition[0],obj[obj_term]->poi)<0.2)
-		{
-			s3d_translate(0,obj[obj_term]->poi[0],obj[obj_term]->poi[1],obj[obj_term]->poi[2]);
-			s3d_rotate(0,obj[obj_term]->rot[0],(obj[obj_term]->rot[1]),obj[obj_term]->rot[2]);
-			move_cam_to = -1;
-		}
+	/* check search status */
+	if( get_search_status() == WIDGET )
+		move_to_search_widget( CamPosition[0], CamPosition[1] );
+	/* if( get_search_status  == FOLLOW ) */
+		/* follow the white rabbit ;) */
+	if( get_search_status() == ABORT )
+		move_to_return_point( CamPosition[0], CamPosition[1] );
+	/*
 	} else if ( move_cam_to != -2 && move_cam_to != -1 ) {
 	
 		Oid_focus = -1;
@@ -772,8 +748,9 @@
 		Rotate_follow_button = (Rotate_follow_button + 50)%360;
 		s3d_rotate(Btn_follow_mode_id,0,Rotate_follow_button,0);
 	}
-	
-	/* move back to returnPoint */
+	*/
+		
+	/* mod_search move back to returnPoint
 	if(move_cam_to == -2)
 	{
 		Oid_focus = -1;
@@ -800,25 +777,14 @@
 			move_cam_to = -1;
 		}
 	}
+*/
 
-	rotate_cursor();
 
 	if( Olsr_ip_label_obj != -1 )
 	{
 		print_etx();
 	}
 
-	
-	if (cam_go && move_cam_to == -1)
-	{ /* move a little bit closer ... */
-		CamPosition[0][0]=(CamPosition[0][0]*9+Olsr_node_pEtx->pos_vec[0])/10;
-		CamPosition[0][1]=(CamPosition[0][1]*9+Olsr_node_pEtx->pos_vec[1])/10;
-		CamPosition[0][2]=(CamPosition[0][2]*9+Olsr_node_pEtx->pos_vec[2])/10;
-		s3d_translate(0,CamPosition[0][0],CamPosition[0][1],CamPosition[0][2]);
-		if (dist(CamPosition[0],Olsr_node_pEtx->pos_vec)<5) /* close enough? stop! */
-				cam_go=0;
-	}
-
 	nanosleep( &sleep_time, NULL );
 
 	return;
@@ -842,18 +808,30 @@
 	int key;
 	key=*((unsigned short *)event->buf);
 
-	if(Oid_focus != obj[obj_term]->oid)
-	{
+	/* mod_search if(Oid_focus != obj[obj_term]->oid)
+	{*/
 		switch(key) {
-			case S3DK_ESCAPE: /* esc -> close olsr */
-				stop();
+			case S3DK_ESCAPE: /* esc abort action */
+			
+				set_search_status( get_search_status() == WIDGET ? ABORT : NOTHING );
 				break;
+				
+			case 's': /* move to search widget, give widget focus */
+
+				set_search_status(WIDGET);
+				set_return_point(CamPosition[0],CamPosition[1]);
+				break;
+			
 			case 'c': /* c -> color on/off */
+				
 				ColorSwitch =  ColorSwitch ? 0 : 1;
 				break;
+				
 			case 'r': /* r -> rotate start/stop*/
+				
 				RotateSwitch = RotateSwitch ? 0 : 1;
 				break;
+				
 			case S3DK_KP_PLUS:
 			case '+': /* + -> rotate speed increase*/
 				
@@ -883,24 +861,30 @@
 				break;
 				
 			case 16: /* strg + p -> reset nodes ( zeroPoint to 0,0,0 ) */
-				{
-					s3d_translate(ZeroPoint,0.0,0.0,0.0);
-					ZeroPosition[0] = ZeroPosition[1] = ZeroPosition[2] = 0.0;
-					break;
-				}
+				
+				s3d_rotate(ZeroPoint, 0, 0, 0);
+				Zp_rotate = 0.0;
+				break;
+				
 			case S3DK_PAGEUP: /* page up -> change factor in calc_olsr_node_mov */
+				
 				if(Factor < 0.9)
 					Factor += 0.1;
 				break;
+				
 			case S3DK_PAGEDOWN: /* page down -> change factor in calc_olsr_node_mov */
+				
 				if(Factor > 0.3)
 					Factor -= 0.1;
 				break;
+				
 		}
+	/* mod_search
 	} else {
 		if( (key >= 48 && key <= 57) || key == 46 || key == 13 || key == 8 || (key >= 256 && key <= 265) || key == 266 || key == 271 )
 			write_terminal(key);
 	}
+	*/
 }
 
 /***
@@ -912,9 +896,14 @@
 void object_click(struct s3d_evt *evt)
 {
 	int oid,i;
-	/* float distance,tmp_vector[3]; */
 	char ip_str[50];
 
+	if( get_search_status() == WIDGET )
+	{
+		s3dw_handle_click(evt);	
+		return;
+	}
+	
 	oid=(int)*((unsigned long *)evt->buf);
 
 	if( oid == Btn_close_id )
@@ -935,32 +924,6 @@
 		return;
 	}
 
-	if( oid == Btn_move_terminal_id )
-	{
-		if(Oid_focus != obj[obj_term]->oid)
-		{
-			for(i=0;i<3;i++)
-			{
-				ReturnPoint[0][i] = CamPosition[0][i];
-				ReturnPoint[1][i] = CamPosition[1][i];
-			}
-			move_cam_to = obj[obj_term]->oid;
-		} else {
-			Oid_focus = -1;
-			move_cam_to = -2;	
-		}
-		return;
-	}
-	
-	if( oid == Btn_follow_mode_id )
-	{
-		s3d_del_object(Btn_follow_mode_id	);
-		Btn_follow_mode_id = -1;
-		Oid_focus = -1;
-		move_cam_to = -1;
-		return;
-	}
-
 	Olsr_node_pEtx = *lst_search(oid);
 
 	if( Olsr_node_pEtx != NULL )
@@ -1146,19 +1109,6 @@
 	return;
 }
 
-void initialize_objects()
-{
-	create_terminal();
-	create_cursor();
-	
-	Btn_move_terminal_id = s3d_clone( Btn_move_terminal_obj );
-	s3d_link(Btn_move_terminal_id,0);
-	s3d_flags_on(Btn_move_terminal_id,S3D_OF_VISIBLE|S3D_OF_SELECTABLE);
-	s3d_scale( Btn_move_terminal_id, 0.5 );
-	s3d_translate( Btn_move_terminal_id,-Left*3.0-0.5, -Bottom*3.0-0.7, -3.0 );
-
-}
-
 int main( int argc, char *argv[] ) {
 
 	int optchar;
@@ -1218,18 +1168,12 @@
 			Olsr_node_obj = s3d_import_3ds_file( "objs/accesspoint.3ds" );
 			Olsr_node_inet_obj = s3d_import_3ds_file( "objs/accesspoint_inet.3ds" );
 			Olsr_node_hna_net = s3d_import_3ds_file( "objs/internet.3ds" );
-
-			/* terminal buttons */
-			Btn_close_obj = s3d_import_3ds_file("objs/btn_close.3ds");
-			Btn_move_terminal_obj = s3d_import_3ds_file("objs/dot.3ds");
-			Btn_follow_mode_obj = s3d_import_3ds_file("objs/dotdot.3ds");
+			Btn_close_obj = s3d_import_3ds_file( "objs/btn_close.3ds" );
+			create_search_widget( 0, 0, 300 );			
 			
 			ZeroPoint = s3d_new_object();
 			Output_border[0] = Output_border[1] = Output_border[2] = Output_border[3] = -1;
-
-			/* create system objects */
-			initialize_objects();
-
+			
 			s3d_mainloop(mainloop);
 			s3d_quit();
 			net_quit();

Added: trunk/apps/olsrs3d/mod_search.c
===================================================================
--- trunk/apps/olsrs3d/mod_search.c	2006-06-05 20:28:56 UTC (rev 343)
+++ trunk/apps/olsrs3d/mod_search.c	2006-06-06 02:32:43 UTC (rev 344)
@@ -0,0 +1,209 @@
+/*
+ * mod_search.c
+ * 
+ * Copyright (C) 2006 Andreas Langer <andreas_lbg at gmx.de>
+ *
+ * This file is part of the olsrs3d, an olsr topology visualizer for s3d.
+ * See http://s3d.berlios.de/ for more updates.
+ * 
+ * s3d is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2 of the License, or
+ * (at your option) any later version.
+ * 
+ * s3d is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ * 
+ * You should have received a copy of the GNU General Public License
+ * along with s3d; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
+ */
+
+#include <s3d.h>
+#include <s3dw.h>
+#include <math.h>
+#include <stdio.h>	/* TODO can remove then no more printf needed */
+#include "mod_search.h"
+
+s3dw_surface	*_search_surface;
+s3dw_input		*_search_input;
+s3dw_widget		*_search_widget;
+
+float	_return_point[2][3];				/* cam position before move to the widget */
+int		_search_status = NOTHING;			/* status of search */
+											
+void _search_node(s3dw_widget *dummy);
+void _abort_search(s3dw_widget *dummy);
+
+/* public */
+void create_search_widget(float x, float y, float z)
+{
+	s3dw_button *search_button, *abort_button;
+	
+	_search_surface	= s3dw_surface_new( "Node Search", 17, 10 );
+	_search_input	= s3dw_input_new( _search_surface, 15, 1, 4 );
+	
+	s3dw_label_new( _search_surface, "Enter the IP of the node.", 1, 2);
+	s3dw_focus( S3DWIDGET( _search_input ) );
+	
+	search_button = s3dw_button_new( _search_surface, "Search", 11.5, 7 );
+	abort_button  = s3dw_button_new( _search_surface, "Abort", 1, 7 );
+	search_button->onclick = _search_node;
+	abort_button->onclick = _abort_search;
+	
+	s3dw_focus	( S3DWIDGET( _search_input ) );	
+	s3dw_focus	( S3DWIDGET( _search_surface ) );
+	s3dw_show	( S3DWIDGET( _search_surface ) );
+	
+	_search_widget	= s3dw_getroot();
+	move_search_widget( x, y, z );
+
+	_search_widget->ary = 180;
+	s3d_rotate( _search_widget->oid, _search_widget->arx, _search_widget->ary, _search_widget->arz );
+}
+
+/* public */
+void move_search_widget(float x, float y, float z)
+{
+	_search_widget->x = x; _search_widget->y = y; _search_widget->z = z;
+	s3dw_moveit( _search_widget );
+}
+
+/* public */
+void move_to_search_widget(float cam_position_t[], float cam_position_r[])
+{
+	float target, current;
+	
+	set_search_status(WIDGET);
+	cam_position_t[0] = ( cam_position_t[0] * 4 + _search_widget->x ) / 5;
+	cam_position_t[1] = ( cam_position_t[1] * 4 + _search_widget->y ) / 5;
+	cam_position_t[2] = ( cam_position_t[2] * 4 + ( _search_widget->z - 10 ) ) / 5;
+
+	target = _search_widget->arx;
+	current = cam_position_r[0];
+
+	if( _search_widget->arx - cam_position_r[0] > 180 )
+		target -= 360;
+	if( _search_widget->arx - cam_position_r[0] < -180 )
+		current -= 360;
+	cam_position_r[0] = ( cam_position_r[0] * 4 + target ) / 5;
+
+	target = _search_widget->ary;
+	current = cam_position_r[1];
+
+	if( _search_widget->ary - cam_position_r[1] > 180 )
+		target -= 360;
+	if( _search_widget->ary - cam_position_r[1] < -180 )
+		current -= 360;
+	cam_position_r[1] = ( cam_position_r[1] * 4 + target ) / 5;
+
+	target = _search_widget->arz;
+	current = cam_position_r[2];
+
+	if( _search_widget->arz - cam_position_r[2] > 180 )
+		target -= 360;
+	if( _search_widget->arz - cam_position_r[2] < -180 )
+		current -= 360;
+	cam_position_r[2] = ( cam_position_r[2] * 4 + target ) / 5;
+	
+	s3d_translate(0,cam_position_t[0],cam_position_t[1],cam_position_t[2]);
+	s3d_rotate(0,cam_position_r[0],cam_position_r[1],cam_position_r[2]);
+	
+	if ( sqrt(  (( cam_position_t[0] - _search_widget->x)*( cam_position_t[0] - _search_widget->x)) + 
+				(( cam_position_t[1] - _search_widget->y)*( cam_position_t[1] - _search_widget->y)) + 
+				(( cam_position_t[2] - _search_widget->z)*( cam_position_t[2] - _search_widget->z)) ) < 0.2 )
+	{
+		s3d_translate( 0, _search_widget->x, _search_widget->y, ( _search_widget->z - 10 ) );
+		s3d_rotate( 0, _search_widget->arx, _search_widget->ary, _search_widget->arz );
+	}
+}
+
+/* public */
+void move_to_return_point(float cam_position_t[], float cam_position_r[])
+{
+	float target, current;
+
+	cam_position_t[0] = ( cam_position_t[0] * 4 + _return_point[0][0] ) / 5;
+	cam_position_t[1] = ( cam_position_t[1] * 4 + _return_point[0][1] ) / 5;
+	cam_position_t[2] = ( cam_position_t[2] * 4 + _return_point[0][2] ) / 5;
+
+	target = _return_point[1][0];
+	current = cam_position_r[0];
+
+	if( _return_point[1][0] - cam_position_r[0] > 180 )
+		target -= 360;
+	if( _return_point[1][0] - cam_position_r[0] < -180 )
+		current -= 360;
+	cam_position_r[0] = ( cam_position_r[0] * 4 + target ) / 5;
+
+	target = _return_point[1][1];
+	current = cam_position_r[1];
+
+	if( _return_point[1][1] - cam_position_r[1] > 180 )
+		target -= 360;
+	if( _return_point[1][1] - cam_position_r[1] < -180 )
+		current -= 360;
+	cam_position_r[1] = ( cam_position_r[1] * 4 + target ) / 5;
+
+	target = _return_point[1][2];
+	current = cam_position_r[2];
+
+	if( _return_point[1][2] - cam_position_r[2] > 180 )
+		target -= 360;
+	if( _return_point[1][2] - cam_position_r[2] < -180 )
+		current -= 360;
+	cam_position_r[2] = ( cam_position_r[2] * 4 + target ) / 5;
+	
+	s3d_translate(0,cam_position_t[0],cam_position_t[1],cam_position_t[2]);
+	s3d_rotate(0,cam_position_r[0],cam_position_r[1],cam_position_r[2]);
+	
+	if ( sqrt(  (( cam_position_t[0] - _return_point[0][0])*( cam_position_t[0] - _return_point[0][0])) + 
+				(( cam_position_t[1] - _return_point[0][1])*( cam_position_t[1] - _return_point[0][1])) + 
+				(( cam_position_t[2] - _return_point[0][2])*( cam_position_t[2] - _return_point[0][2])) ) < 0.2 )
+	{
+		s3d_translate( 0, _return_point[0][0], _return_point[0][1], _return_point[0][2] );
+		s3d_rotate( 0, _return_point[1][0], _return_point[1][1], _return_point[1][2] );
+		set_search_status(NOTHING);
+	}
+}
+
+/* public */
+void set_return_point(float cam_position_t[], float cam_position_r[])
+{
+	int i;
+	for( i = 0; i < 3; i++ )
+		_return_point[0][i] = cam_position_t[i];
+	for( i = 0; i < 3; i++ )
+		_return_point[1][i] = cam_position_r[i];
+}
+
+/* public */
+int get_search_status(void)
+{
+	return _search_status;
+}
+
+/* public */
+void set_search_status(int stat)
+{
+	/* TODO check if stat between 0-3 else debug printf */
+	_search_status = stat;
+}
+
+/* private */
+void _search_node(s3dw_widget *dummy)
+{
+	char *ip;
+	ip = s3dw_input_gettext( _search_input );
+	printf("%s\n",ip);
+}
+
+/* private */
+void _abort_search(s3dw_widget *dummy)
+{
+	set_search_status(ABORT);
+}
+
+	

Added: trunk/apps/olsrs3d/mod_search.h
===================================================================
--- trunk/apps/olsrs3d/mod_search.h	2006-06-05 20:28:56 UTC (rev 343)
+++ trunk/apps/olsrs3d/mod_search.h	2006-06-06 02:32:43 UTC (rev 344)
@@ -0,0 +1,36 @@
+/*
+ * mod_search.h
+ *
+ * Copyright (C) 2006 Andreas Langer <andreas_lbg at gmx.de>
+ *
+ * This file is part of the olsrs3d, an olsr topology visualizer for s3d.
+ * See http://s3d.berlios.de/ for more updates.
+ * 
+ * s3d Widgets is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU Lesser General Public License as published by
+ * the Free Software Foundation; either version 2.1 of the License, or
+ * (at your option) any later version.
+ * 
+ * s3d Widgets is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU Lesser General Public License for more details.
+ * 
+ * You should have received a copy of the GNU Lesser General Public License
+ * along with the s3d Widgets; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
+ */
+
+#define NOTHING 0		/* nothing ;) */
+#define ABORT 1			/* widget has no focus */
+#define WIDGET 2		/* focus on widget */
+#define FOLLOW 3		/* follow search result */
+
+void create_search_widget(float x, float y, float z);
+void move_search_widget(float x, float y, float z);
+void move_to_search_widget(float cam_position_t[], float cam_position_r[]);
+void move_to_return_point(float cam_position_t[], float cam_position_r[]);
+void set_return_point(float cam_position_t[], float cam_position_r[]);
+int get_search_status(void);
+void set_search_status(int stat);
+

Modified: trunk/apps/olsrs3d/terminal.c
===================================================================
--- trunk/apps/olsrs3d/terminal.c	2006-06-05 20:28:56 UTC (rev 343)
+++ trunk/apps/olsrs3d/terminal.c	2006-06-06 02:32:43 UTC (rev 344)
@@ -27,6 +27,7 @@
 {
 	int oid=s3d_new_object();
 	float vertices[24];
+	/*
 	unsigned long pbuf[] = { 1,2,0,0,
 											1,3,2,0,
 											5,3,1,0,
@@ -38,7 +39,19 @@
 											3,2,7,0,
 											3,7,4,0,
 											5,6,0,0,
-											5,0,1,0};
+											5,0,1,0};*/
+	unsigned long pbuf[] = { 1,0,2,0,
+											1,2,3,0,
+											5,1,3,0,
+											5,3,4,0,
+											6,4,5,0,
+											6,7,4,0,
+											0,7,6,0,
+											0,2,7,0,
+											3,7,2,0,
+											3,4,7,0,
+											5,0,6,0,
+											5,1,0,0};
 
 	vertices[0]  = (*rect).front.x; vertices[1] = (*rect).front.y; vertices[2] = (*rect).front.z;
 	vertices[3]  = (*rect).rear.x;vertices[4] = (*rect).front.y; vertices[5] = (*rect).front.z;
@@ -118,6 +131,7 @@
 	return;
 }
 
+/* mod_search
 void write_terminal(int key)
 {
 	static char s[20];
@@ -159,7 +173,7 @@
 		}
 	}
 }
-
+*/
 int find_olsr_node( char *ip )
 {
 	int result;



From nichtsnutz at berlios.de  Tue Jun  6 04:34:02 2006
From: nichtsnutz at berlios.de (nichtsnutz at BerliOS)
Date: Tue, 6 Jun 2006 04:34:02 +0200
Subject: [S3d-svn] r345 - trunk/apps/olsrs3d
Message-ID: <200606060234.k562Y2P8004960@sheep.berlios.de>

Author: nichtsnutz
Date: 2006-06-06 04:34:00 +0200 (Tue, 06 Jun 2006)
New Revision: 345

Removed:
   trunk/apps/olsrs3d/terminal.c
   trunk/apps/olsrs3d/terminal.h
Log:
remove old terminal :(



Deleted: trunk/apps/olsrs3d/terminal.c
===================================================================
--- trunk/apps/olsrs3d/terminal.c	2006-06-06 02:32:43 UTC (rev 344)
+++ trunk/apps/olsrs3d/terminal.c	2006-06-06 02:34:00 UTC (rev 345)
@@ -1,203 +0,0 @@
-#include <stdlib.h>
-#include <stdio.h>
-#include <string.h>
-#include <s3d.h>
-#include "terminal.h"
-#include "olsrs3d.h"
-
-#define BLOCK_SIZE 10
-
-/* index of s3d_object array for objects */
-int obj_term = 0;
-int obj_cursor = 0;
-
-/* object_id of middlepoint cursor */
-int obj_cursor_mp = 0;
-
-int obj_cnt=0;
-int obj_max = 0;
-
-struct s3d_object **obj = NULL;
-struct olsr_node *search_node;
-
-int create_rectangle(struct rectangle *rect,float mat[]);
-int find_olsr_node( char *ip );
-
-int create_rectangle(struct rectangle *rect,float mat[])
-{
-	int oid=s3d_new_object();
-	float vertices[24];
-	/*
-	unsigned long pbuf[] = { 1,2,0,0,
-											1,3,2,0,
-											5,3,1,0,
-											5,4,3,0,
-											6,5,4,0,
-											6,4,7,0,
-											0,6,7,0,
-											0,7,2,0,
-											3,2,7,0,
-											3,7,4,0,
-											5,6,0,0,
-											5,0,1,0};*/
-	unsigned long pbuf[] = { 1,0,2,0,
-											1,2,3,0,
-											5,1,3,0,
-											5,3,4,0,
-											6,4,5,0,
-											6,7,4,0,
-											0,7,6,0,
-											0,2,7,0,
-											3,7,2,0,
-											3,4,7,0,
-											5,0,6,0,
-											5,1,0,0};
-
-	vertices[0]  = (*rect).front.x; vertices[1] = (*rect).front.y; vertices[2] = (*rect).front.z;
-	vertices[3]  = (*rect).rear.x;vertices[4] = (*rect).front.y; vertices[5] = (*rect).front.z;
-	vertices[6]  = (*rect).front.x; vertices[7] = (*rect).rear.y; vertices[8] = (*rect).front.z;
-	vertices[9]  = (*rect).rear.x; vertices[10] = (*rect).rear.y; vertices[11] = (*rect).front.z;
-	vertices[12] = (*rect).rear.x; vertices[13] = (*rect).rear.y; vertices[14] = (*rect).rear.z;
-	vertices[15] = (*rect).rear.x; vertices[16] = (*rect).front.y; vertices[17] = (*rect).rear.z;
-	vertices[18] = (*rect).front.x; vertices[19] = (*rect).front.y; vertices[20] = (*rect).rear.z;
-	vertices[21] = (*rect).front.x; vertices[22] = (*rect).rear.y; vertices[23] = (*rect).rear.z;
-
-	s3d_push_vertices(oid,vertices,8);
-	s3d_push_material(oid,mat[0],mat[1],mat[2],mat[3],mat[4],mat[5],mat[6],mat[7],mat[8]);
-	s3d_push_polygons(oid,pbuf,12);
-	return(oid);
-}
-
-int create_object(char name[],float sp[], float ep[],float pos[],float poi[],float mat[])
-{
-	int oid;
-
-	struct rectangle rect;
-	rect.front.x = sp[0]; rect.front.y = sp[1]; rect.front.z = sp[2];
-	rect.rear.x = ep[0]; rect.rear.y = ep[1]; rect.rear.z = ep[2];
-	oid = create_rectangle(&rect,mat);
-
-	if( obj_cnt >= obj_max )
-	{
-		obj_max += BLOCK_SIZE;
-		obj = (struct s3d_object **) realloc(obj, obj_max*sizeof(struct s3d_object *));
-		if(obj == NULL)
-			out_of_mem();
-	}
-	if( (obj[obj_cnt] = (struct s3d_object *) malloc( sizeof(struct s3d_object ) )) == NULL)
-		out_of_mem();
-
-	obj[obj_cnt]->oid = oid;
-	obj[obj_cnt]->pos[0] = pos[0]; obj[obj_cnt]->pos[1] = pos[1]; obj[obj_cnt]->pos[2] = pos[2];
-	obj[obj_cnt]->rot[0] = 0; obj[obj_cnt]->rot[1] = 180; obj[obj_cnt]->rot[2] = 0;
-
-	s3d_translate(oid,pos[0],pos[1],pos[2]);
-
-	strncpy(obj[obj_cnt]->name,name,20);
-	obj[obj_cnt]->poi[0] = poi[0]; obj[obj_cnt]->poi[1] = poi[1]; obj[obj_cnt]->poi[2] = poi[2];
-	obj_cnt++;
-	return(	obj_cnt-1);
-}
-
-void create_cursor()
-{
-	float sp[] = {-0.15,-0.15,-0.05};
-	float ep[] = {0.15,0.15,0.05};
-	float pos[] = {9.15, 4.25, 299.95};
-	float poi[] = {9.0,-17.5,295.0};
-	float mat[] = {1.0,1.0,0.7,1.0,1.0,0.7,1.0,1.0,0.7};
-	obj_cursor = create_object("cursor",sp,ep,pos,poi,mat);
-	s3d_flags_on(obj[obj_cursor]->oid, S3D_OF_VISIBLE);
-	return;
-}
-
-void create_terminal()
-{
-	float sp[] = {0.0,0.0,0.0};
-	float ep[] = {10.0,5.0,2.0};
-	float pos[] = {0.0, 0.0, 300.0};
-	float poi[] = {5,2.5,295.0};
-	float mat[] = {0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6};
-	obj_term = create_object("terminal",sp,ep,pos,poi,mat);
-	s3d_flags_on(obj[obj_term]->oid, S3D_OF_VISIBLE|S3D_OF_SELECTABLE);
-	return;
-}
-
-void rotate_cursor()
-{
-	static int y = 0;
-	y = (y+20)%360;
-	s3d_rotate(obj[obj_cursor]->oid,0,y,0);
-	return;
-}
-
-/* mod_search
-void write_terminal(int key)
-{
-	static char s[20];
-	int ln = strlen(s);
-	float draw_length;
-	float tmp;
-	static int str_id = -1;
-
-	if( key == 266) key = 46;
-	if( key >= 256 && key <= 265) key = key - 208;
-	
-	if(key != 13 && key != 271)
-	{
-		if(key == 8)
-		{
-			if(ln > 0)
-				s[ln-1] = '\0';
-		} else {
-			if(ln < 20)
-				s[ln] = key;
-		}
-		if(str_id != -1)
-			s3d_del_object(str_id);
-		str_id = s3d_draw_string( s, &draw_length );
-		s3d_flags_on( str_id, S3D_OF_VISIBLE );
-		s3d_pep_material(str_id,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0);
-		s3d_scale( str_id, 0.4 );
-		s3d_translate( str_id,9,4,-0.45);
-		s3d_rotate(str_id,0,180,0);
-		s3d_link( str_id, obj[obj_term]->oid );
-		tmp = obj[obj_cursor]->pos[0] - (draw_length*0.43);
-		s3d_translate( obj[obj_cursor]->oid , tmp, obj[obj_cursor]->pos[1], obj[obj_cursor]->pos[2]);
-	} else {
-		if(!find_olsr_node(s))
-		{
-			printf("no node found\n");
-		} else {
-			move_cam_to = search_node->obj_id;
-		}
-	}
-}
-*/
-int find_olsr_node( char *ip )
-{
-	int result;
-	search_node = Olsr_root;
-	
-	while ( search_node != NULL )
-	{
-
-		result = strncmp( search_node->ip, ip, NAMEMAX );
-
-		/* we found the node */
-		if ( result == 0 ) 
-			break;
-
-		/* the searched node must be in the subtree */
-		if ( result < 0 )
-			search_node = search_node->right;
-		else
-			search_node = search_node->left;
-	}
-	
-	if( search_node != NULL )
-	{
-		return(1);
-	}
-	return(0);
-}

Deleted: trunk/apps/olsrs3d/terminal.h
===================================================================
--- trunk/apps/olsrs3d/terminal.h	2006-06-06 02:32:43 UTC (rev 344)
+++ trunk/apps/olsrs3d/terminal.h	2006-06-06 02:34:00 UTC (rev 345)
@@ -1,30 +0,0 @@
-struct coordinates {
-	float x;
-	float y;
-	float z;
-};
-
-struct rectangle {
-	struct coordinates front;
-	struct coordinates rear;
-};
-
-struct s3d_object {
-	int oid;
-	char name[20];
-	float pos[3];
-	float rot[3];
-	float poi[3];
-	int focus;
-};
-
-extern int obj_term;
-extern int obj_cursor;
-extern int obj_cursor_mp;
-extern struct s3d_object **obj;
-extern struct olsr_node *search_node;
-
-void create_cursor();
-void create_terminal();
-void rotate_cursor();
-void write_terminal(int key);



From dotslash at berlios.de  Tue Jun  6 13:46:36 2006
From: dotslash at berlios.de (dotslash at BerliOS)
Date: Tue, 6 Jun 2006 13:46:36 +0200
Subject: [S3d-svn] r346 - in trunk: Documentation/libs3dw libs3dw
Message-ID: <200606061146.k56Bkafe022115@sheep.berlios.de>

Author: dotslash
Date: 2006-06-06 13:46:07 +0200 (Tue, 06 Jun 2006)
New Revision: 346

Modified:
   trunk/Documentation/libs3dw/libs3dw.docbook
   trunk/libs3dw/s3dw.h
Log:
- proper S3DWIDGET typedef

Modified: trunk/Documentation/libs3dw/libs3dw.docbook
===================================================================
--- trunk/Documentation/libs3dw/libs3dw.docbook	2006-06-06 02:34:00 UTC (rev 345)
+++ trunk/Documentation/libs3dw/libs3dw.docbook	2006-06-06 11:46:07 UTC (rev 346)
@@ -389,7 +389,7 @@
     S3DW_NTYPES
 };
 <anchor id="S3DWIDGET"/>
-#define     S3DWIDGET(x)    (s3dw_widget *)x
+#define     S3DWIDGET(x)    ((s3dw_widget *)x)
 						
 </programlisting>
 <para>

Modified: trunk/libs3dw/s3dw.h
===================================================================
--- trunk/libs3dw/s3dw.h	2006-06-06 02:34:00 UTC (rev 345)
+++ trunk/libs3dw/s3dw.h	2006-06-06 11:46:07 UTC (rev 346)
@@ -33,7 +33,7 @@
 /* if the surface (or widget) is already properly arranged */
 #define 	S3DW_ARRANGED	512
 /* just a typecaster to beatify code. use it if you like */
-#define 	S3DWIDGET(x)	(s3dw_widget *)x
+#define 	S3DWIDGET(x)	((s3dw_widget *)x)
 
 enum {
 	S3DW_TROOT,



From nichtsnutz at berlios.de  Wed Jun  7 21:37:42 2006
From: nichtsnutz at berlios.de (nichtsnutz at BerliOS)
Date: Wed, 7 Jun 2006 21:37:42 +0200
Subject: [S3d-svn] r347 - trunk/apps/olsrs3d
Message-ID: <200606071937.k57Jbgne004987@sheep.berlios.de>

Author: nichtsnutz
Date: 2006-06-07 21:37:38 +0200 (Wed, 07 Jun 2006)
New Revision: 347

Modified:
   trunk/apps/olsrs3d/main.c
   trunk/apps/olsrs3d/mod_search.c
   trunk/apps/olsrs3d/mod_search.h
Log:
- widget implementation II

Modified: trunk/apps/olsrs3d/main.c
===================================================================
--- trunk/apps/olsrs3d/main.c	2006-06-06 11:46:07 UTC (rev 346)
+++ trunk/apps/olsrs3d/main.c	2006-06-07 19:37:38 UTC (rev 347)
@@ -808,8 +808,8 @@
 	int key;
 	key=*((unsigned short *)event->buf);
 
-	/* mod_search if(Oid_focus != obj[obj_term]->oid)
-	{*/
+	if( get_search_status() != WIDGET )
+	{
 		switch(key) {
 			case S3DK_ESCAPE: /* esc abort action */
 			
@@ -879,12 +879,10 @@
 				break;
 				
 		}
-	/* mod_search
 	} else {
 		if( (key >= 48 && key <= 57) || key == 46 || key == 13 || key == 8 || (key >= 256 && key <= 265) || key == 266 || key == 271 )
-			write_terminal(key);
+			search_widget_write( key );
 	}
-	*/
 }
 
 /***

Modified: trunk/apps/olsrs3d/mod_search.c
===================================================================
--- trunk/apps/olsrs3d/mod_search.c	2006-06-06 11:46:07 UTC (rev 346)
+++ trunk/apps/olsrs3d/mod_search.c	2006-06-07 19:37:38 UTC (rev 347)
@@ -25,6 +25,7 @@
 #include <s3dw.h>
 #include <math.h>
 #include <stdio.h>	/* TODO can remove then no more printf needed */
+#include <string.h>
 #include "mod_search.h"
 
 s3dw_surface	*_search_surface;
@@ -52,6 +53,8 @@
 	abort_button  = s3dw_button_new( _search_surface, "Abort", 1, 7 );
 	search_button->onclick = _search_node;
 	abort_button->onclick = _abort_search;
+
+	/* TODO calc position for ok button */
 	
 	s3dw_focus	( S3DWIDGET( _search_input ) );	
 	s3dw_focus	( S3DWIDGET( _search_surface ) );
@@ -170,6 +173,34 @@
 }
 
 /* public */
+void search_widget_write(int key)
+{
+	static char s[20];
+	int ln = strlen(s);
+	float draw_length;
+	float tmp;
+	static int str_id = -1;
+
+	if( key == 266) key = 46;
+	if( key >= 256 && key <= 265) key = key - 208;
+	
+	if(key != 13 && key != 271)
+	{
+		if(key == 8)
+		{
+			if(ln > 0)
+				s[ln-1] = '\0';
+		} else {
+			if(ln < 20)
+				s[ln] = key;
+		}
+		s3dw_input_change_text( _search_input, s );
+	} else {
+		
+	}
+}
+
+/* public */
 void set_return_point(float cam_position_t[], float cam_position_r[])
 {
 	int i;
@@ -194,10 +225,33 @@
 
 /* private */
 void _search_node(s3dw_widget *dummy)
-{
+{/*
 	char *ip;
 	ip = s3dw_input_gettext( _search_input );
-	printf("%s\n",ip);
+	
+	int result;
+	search_node = Olsr_root;
+	
+	while ( search_node != NULL )
+	{
+
+		result = strncmp( search_node->ip, ip, NAMEMAX );
+
+		if ( result == 0 ) 
+			break;
+
+
+		if ( result < 0 )
+			search_node = search_node->right;
+		else
+			search_node = search_node->left;
+	}
+	
+	if( search_node != NULL )
+	{
+		return(1);
+	}
+	return(0);*/
 }
 
 /* private */

Modified: trunk/apps/olsrs3d/mod_search.h
===================================================================
--- trunk/apps/olsrs3d/mod_search.h	2006-06-06 11:46:07 UTC (rev 346)
+++ trunk/apps/olsrs3d/mod_search.h	2006-06-07 19:37:38 UTC (rev 347)
@@ -33,4 +33,5 @@
 void set_return_point(float cam_position_t[], float cam_position_r[]);
 int get_search_status(void);
 void set_search_status(int stat);
+void search_widget_write(int key);
 



From nichtsnutz at berlios.de  Thu Jun  8 00:58:03 2006
From: nichtsnutz at berlios.de (nichtsnutz at BerliOS)
Date: Thu, 8 Jun 2006 00:58:03 +0200
Subject: [S3d-svn] r348 - trunk/apps/olsrs3d
Message-ID: <200606072258.k57Mw3ZG019462@sheep.berlios.de>

Author: nichtsnutz
Date: 2006-06-08 00:58:02 +0200 (Thu, 08 Jun 2006)
New Revision: 348

Modified:
   trunk/apps/olsrs3d/mod_search.c
   trunk/apps/olsrs3d/mod_search.h
Log:
add widget III

Modified: trunk/apps/olsrs3d/mod_search.c
===================================================================
--- trunk/apps/olsrs3d/mod_search.c	2006-06-07 19:37:38 UTC (rev 347)
+++ trunk/apps/olsrs3d/mod_search.c	2006-06-07 22:58:02 UTC (rev 348)
@@ -23,15 +23,19 @@
 
 #include <s3d.h>
 #include <s3dw.h>
+#include <s3d_keysym.h>
 #include <math.h>
 #include <stdio.h>	/* TODO can remove then no more printf needed */
 #include <string.h>
+#include "structs.h"
 #include "mod_search.h"
 
 s3dw_surface	*_search_surface;
 s3dw_input		*_search_input;
 s3dw_widget		*_search_widget;
 
+struct olsr_node *_node_root = NULL;
+
 float	_return_point[2][3];				/* cam position before move to the widget */
 int		_search_status = NOTHING;			/* status of search */
 											
@@ -177,26 +181,22 @@
 {
 	static char s[20];
 	int ln = strlen(s);
-	float draw_length;
-	float tmp;
-	static int str_id = -1;
-
-	if( key == 266) key = 46;
-	if( key >= 256 && key <= 265) key = key - 208;
 	
-	if(key != 13 && key != 271)
+	if( key == S3DK_COMMA ) key = S3DK_PERIOD;
+	
+	if( key != S3DK_RETURN )
 	{
-		if(key == 8)
+		if( key == S3DK_BACKSPACE )
 		{
-			if(ln > 0)
+			if( ln > 0 )
 				s[ln-1] = '\0';
 		} else {
-			if(ln < 20)
+			if( ln < 20 )
 				s[ln] = key;
 		}
 		s3dw_input_change_text( _search_input, s );
 	} else {
-		
+		_search_node( _search_widget );	
 	}
 }
 
@@ -223,13 +223,20 @@
 	_search_status = stat;
 }
 
+/* public */
+void set_node_root(struct olsr_node *root)
+{
+	_node_root = root;
+}
 /* private */
 void _search_node(s3dw_widget *dummy)
-{/*
+{
 	char *ip;
+	int result;
 	ip = s3dw_input_gettext( _search_input );
 	
-	int result;
+	printf("%s\n",ip);
+	/*	
 	search_node = Olsr_root;
 	
 	while ( search_node != NULL )

Modified: trunk/apps/olsrs3d/mod_search.h
===================================================================
--- trunk/apps/olsrs3d/mod_search.h	2006-06-07 19:37:38 UTC (rev 347)
+++ trunk/apps/olsrs3d/mod_search.h	2006-06-07 22:58:02 UTC (rev 348)
@@ -34,4 +34,5 @@
 int get_search_status(void);
 void set_search_status(int stat);
 void search_widget_write(int key);
+void set_node_root(struct olsr_node *root);
 



From nichtsnutz at berlios.de  Thu Jun  8 01:04:17 2006
From: nichtsnutz at berlios.de (nichtsnutz at BerliOS)
Date: Thu, 8 Jun 2006 01:04:17 +0200
Subject: [S3d-svn] r349 - trunk/apps/olsrs3d
Message-ID: <200606072304.k57N4HQr021048@sheep.berlios.de>

Author: nichtsnutz
Date: 2006-06-08 01:04:15 +0200 (Thu, 08 Jun 2006)
New Revision: 349

Added:
   trunk/apps/olsrs3d/search.c
   trunk/apps/olsrs3d/search.h
   trunk/apps/olsrs3d/structs.h
Removed:
   trunk/apps/olsrs3d/mod_search.c
   trunk/apps/olsrs3d/mod_search.h
Modified:
   trunk/apps/olsrs3d/Makefile.am
   trunk/apps/olsrs3d/main.c
   trunk/apps/olsrs3d/olsrs3d.h
Log:
- add widget IIII
- push the structs for olsr in structs.h
- rename files ( search )

Modified: trunk/apps/olsrs3d/Makefile.am
===================================================================
--- trunk/apps/olsrs3d/Makefile.am	2006-06-07 22:58:02 UTC (rev 348)
+++ trunk/apps/olsrs3d/Makefile.am	2006-06-07 23:04:15 UTC (rev 349)
@@ -2,14 +2,15 @@
 
 olsrs3dincludedir = $(pkgincludedir)/olsrs3d
 olsrs3dinclude_HEADERS =  \
+	structs.h \
 	olsrs3d.h \
-	mod_search.h
+	search.h
 
 olsrs3d_SOURCES =  \
 	process.c \
 	main.c \
 	net.c \
-	mod_search.c
+	search.c
 
 olsrs3d_CPPFLAGS=	-I$(top_srcdir)/libs3d -I$(top_srcdir)/libs3dw
 olsrs3d_LDADD=		$(top_builddir)/libs3d/libs3d.la $(top_builddir)/libs3dw/libs3dw.la

Modified: trunk/apps/olsrs3d/main.c
===================================================================
--- trunk/apps/olsrs3d/main.c	2006-06-07 22:58:02 UTC (rev 348)
+++ trunk/apps/olsrs3d/main.c	2006-06-07 23:04:15 UTC (rev 349)
@@ -35,7 +35,7 @@
 #include <getopt.h>	/* getopt() */
 #include <stdlib.h>	/* exit() */
 #include "olsrs3d.h"
-#include "mod_search.h"
+#include "search.h"
 
 #define SPEED		10.0
 
@@ -805,35 +805,36 @@
  ***/
 
 void keypress(struct s3d_evt *event) {
-	int key;
-	key=*((unsigned short *)event->buf);
 
+	struct s3d_key_event *key=(struct s3d_key_event *)event->buf;
+	printf("%d\n",key->unicode);	
 	if( get_search_status() != WIDGET )
 	{
-		switch(key) {
-			case S3DK_ESCAPE: /* esc abort action */
+		switch(key->unicode)
+		{
+			case S3DK_ESCAPE: /* abort action */
 			
 				set_search_status( get_search_status() == WIDGET ? ABORT : NOTHING );
 				break;
 				
-			case 's': /* move to search widget, give widget focus */
+			case S3DK_s: /* move to search widget, give widget focus */
 
-				set_search_status(WIDGET);
-				set_return_point(CamPosition[0],CamPosition[1]);
+				set_search_status(WIDGET);							/* set status for mainloop */
+				set_return_point(CamPosition[0],CamPosition[1]);	/* save the return position */
+				set_node_root( Olsr_root );
 				break;
 			
-			case 'c': /* c -> color on/off */
+			case S3DK_c: /* color on/off */
 				
 				ColorSwitch =  ColorSwitch ? 0 : 1;
 				break;
 				
-			case 'r': /* r -> rotate start/stop*/
+			case S3DK_r: /* rotate start/stop*/
 				
 				RotateSwitch = RotateSwitch ? 0 : 1;
 				break;
 				
-			case S3DK_KP_PLUS:
-			case '+': /* + -> rotate speed increase*/
+			case S3DK_PLUS: /* rotate speed increase */
 				
 				if(RotateSwitch && RotateSpeed < 5)
 				{
@@ -845,8 +846,7 @@
 				}
 				break;
 				
-			case S3DK_KP_MINUS:
-			case '-': /* - -> rotate speed decrease*/
+			case S3DK_MINUS: /* - -> rotate speed decrease */
 				
 				if(RotateSwitch)
 				{
@@ -866,13 +866,13 @@
 				Zp_rotate = 0.0;
 				break;
 				
-			case S3DK_PAGEUP: /* page up -> change factor in calc_olsr_node_mov */
+			case S3DK_PAGEUP: /* change factor in calc_olsr_node_mov */
 				
 				if(Factor < 0.9)
 					Factor += 0.1;
 				break;
 				
-			case S3DK_PAGEDOWN: /* page down -> change factor in calc_olsr_node_mov */
+			case S3DK_PAGEDOWN: /* change factor in calc_olsr_node_mov */
 				
 				if(Factor > 0.3)
 					Factor -= 0.1;
@@ -880,8 +880,8 @@
 				
 		}
 	} else {
-		if( (key >= 48 && key <= 57) || key == 46 || key == 13 || key == 8 || (key >= 256 && key <= 265) || key == 266 || key == 271 )
-			search_widget_write( key );
+		if( (key->unicode >= S3DK_PERIOD && key->unicode <= S3DK_9) || key->unicode == S3DK_COMMA || key->unicode == S3DK_RETURN || key->unicode == S3DK_BACKSPACE )
+			search_widget_write( key->unicode );
 	}
 }
 

Deleted: trunk/apps/olsrs3d/mod_search.c
===================================================================
--- trunk/apps/olsrs3d/mod_search.c	2006-06-07 22:58:02 UTC (rev 348)
+++ trunk/apps/olsrs3d/mod_search.c	2006-06-07 23:04:15 UTC (rev 349)
@@ -1,270 +0,0 @@
-/*
- * mod_search.c
- * 
- * Copyright (C) 2006 Andreas Langer <andreas_lbg at gmx.de>
- *
- * This file is part of the olsrs3d, an olsr topology visualizer for s3d.
- * See http://s3d.berlios.de/ for more updates.
- * 
- * s3d is free software; you can redistribute it and/or modify
- * it under the terms of the GNU General Public License as published by
- * the Free Software Foundation; either version 2 of the License, or
- * (at your option) any later version.
- * 
- * s3d is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with s3d; if not, write to the Free Software
- * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
- */
-
-#include <s3d.h>
-#include <s3dw.h>
-#include <s3d_keysym.h>
-#include <math.h>
-#include <stdio.h>	/* TODO can remove then no more printf needed */
-#include <string.h>
-#include "structs.h"
-#include "mod_search.h"
-
-s3dw_surface	*_search_surface;
-s3dw_input		*_search_input;
-s3dw_widget		*_search_widget;
-
-struct olsr_node *_node_root = NULL;
-
-float	_return_point[2][3];				/* cam position before move to the widget */
-int		_search_status = NOTHING;			/* status of search */
-											
-void _search_node(s3dw_widget *dummy);
-void _abort_search(s3dw_widget *dummy);
-
-/* public */
-void create_search_widget(float x, float y, float z)
-{
-	s3dw_button *search_button, *abort_button;
-	
-	_search_surface	= s3dw_surface_new( "Node Search", 17, 10 );
-	_search_input	= s3dw_input_new( _search_surface, 15, 1, 4 );
-	
-	s3dw_label_new( _search_surface, "Enter the IP of the node.", 1, 2);
-	s3dw_focus( S3DWIDGET( _search_input ) );
-	
-	search_button = s3dw_button_new( _search_surface, "Search", 11.5, 7 );
-	abort_button  = s3dw_button_new( _search_surface, "Abort", 1, 7 );
-	search_button->onclick = _search_node;
-	abort_button->onclick = _abort_search;
-
-	/* TODO calc position for ok button */
-	
-	s3dw_focus	( S3DWIDGET( _search_input ) );	
-	s3dw_focus	( S3DWIDGET( _search_surface ) );
-	s3dw_show	( S3DWIDGET( _search_surface ) );
-	
-	_search_widget	= s3dw_getroot();
-	move_search_widget( x, y, z );
-
-	_search_widget->ary = 180;
-	s3d_rotate( _search_widget->oid, _search_widget->arx, _search_widget->ary, _search_widget->arz );
-}
-
-/* public */
-void move_search_widget(float x, float y, float z)
-{
-	_search_widget->x = x; _search_widget->y = y; _search_widget->z = z;
-	s3dw_moveit( _search_widget );
-}
-
-/* public */
-void move_to_search_widget(float cam_position_t[], float cam_position_r[])
-{
-	float target, current;
-	
-	set_search_status(WIDGET);
-	cam_position_t[0] = ( cam_position_t[0] * 4 + _search_widget->x ) / 5;
-	cam_position_t[1] = ( cam_position_t[1] * 4 + _search_widget->y ) / 5;
-	cam_position_t[2] = ( cam_position_t[2] * 4 + ( _search_widget->z - 10 ) ) / 5;
-
-	target = _search_widget->arx;
-	current = cam_position_r[0];
-
-	if( _search_widget->arx - cam_position_r[0] > 180 )
-		target -= 360;
-	if( _search_widget->arx - cam_position_r[0] < -180 )
-		current -= 360;
-	cam_position_r[0] = ( cam_position_r[0] * 4 + target ) / 5;
-
-	target = _search_widget->ary;
-	current = cam_position_r[1];
-
-	if( _search_widget->ary - cam_position_r[1] > 180 )
-		target -= 360;
-	if( _search_widget->ary - cam_position_r[1] < -180 )
-		current -= 360;
-	cam_position_r[1] = ( cam_position_r[1] * 4 + target ) / 5;
-
-	target = _search_widget->arz;
-	current = cam_position_r[2];
-
-	if( _search_widget->arz - cam_position_r[2] > 180 )
-		target -= 360;
-	if( _search_widget->arz - cam_position_r[2] < -180 )
-		current -= 360;
-	cam_position_r[2] = ( cam_position_r[2] * 4 + target ) / 5;
-	
-	s3d_translate(0,cam_position_t[0],cam_position_t[1],cam_position_t[2]);
-	s3d_rotate(0,cam_position_r[0],cam_position_r[1],cam_position_r[2]);
-	
-	if ( sqrt(  (( cam_position_t[0] - _search_widget->x)*( cam_position_t[0] - _search_widget->x)) + 
-				(( cam_position_t[1] - _search_widget->y)*( cam_position_t[1] - _search_widget->y)) + 
-				(( cam_position_t[2] - _search_widget->z)*( cam_position_t[2] - _search_widget->z)) ) < 0.2 )
-	{
-		s3d_translate( 0, _search_widget->x, _search_widget->y, ( _search_widget->z - 10 ) );
-		s3d_rotate( 0, _search_widget->arx, _search_widget->ary, _search_widget->arz );
-	}
-}
-
-/* public */
-void move_to_return_point(float cam_position_t[], float cam_position_r[])
-{
-	float target, current;
-
-	cam_position_t[0] = ( cam_position_t[0] * 4 + _return_point[0][0] ) / 5;
-	cam_position_t[1] = ( cam_position_t[1] * 4 + _return_point[0][1] ) / 5;
-	cam_position_t[2] = ( cam_position_t[2] * 4 + _return_point[0][2] ) / 5;
-
-	target = _return_point[1][0];
-	current = cam_position_r[0];
-
-	if( _return_point[1][0] - cam_position_r[0] > 180 )
-		target -= 360;
-	if( _return_point[1][0] - cam_position_r[0] < -180 )
-		current -= 360;
-	cam_position_r[0] = ( cam_position_r[0] * 4 + target ) / 5;
-
-	target = _return_point[1][1];
-	current = cam_position_r[1];
-
-	if( _return_point[1][1] - cam_position_r[1] > 180 )
-		target -= 360;
-	if( _return_point[1][1] - cam_position_r[1] < -180 )
-		current -= 360;
-	cam_position_r[1] = ( cam_position_r[1] * 4 + target ) / 5;
-
-	target = _return_point[1][2];
-	current = cam_position_r[2];
-
-	if( _return_point[1][2] - cam_position_r[2] > 180 )
-		target -= 360;
-	if( _return_point[1][2] - cam_position_r[2] < -180 )
-		current -= 360;
-	cam_position_r[2] = ( cam_position_r[2] * 4 + target ) / 5;
-	
-	s3d_translate(0,cam_position_t[0],cam_position_t[1],cam_position_t[2]);
-	s3d_rotate(0,cam_position_r[0],cam_position_r[1],cam_position_r[2]);
-	
-	if ( sqrt(  (( cam_position_t[0] - _return_point[0][0])*( cam_position_t[0] - _return_point[0][0])) + 
-				(( cam_position_t[1] - _return_point[0][1])*( cam_position_t[1] - _return_point[0][1])) + 
-				(( cam_position_t[2] - _return_point[0][2])*( cam_position_t[2] - _return_point[0][2])) ) < 0.2 )
-	{
-		s3d_translate( 0, _return_point[0][0], _return_point[0][1], _return_point[0][2] );
-		s3d_rotate( 0, _return_point[1][0], _return_point[1][1], _return_point[1][2] );
-		set_search_status(NOTHING);
-	}
-}
-
-/* public */
-void search_widget_write(int key)
-{
-	static char s[20];
-	int ln = strlen(s);
-	
-	if( key == S3DK_COMMA ) key = S3DK_PERIOD;
-	
-	if( key != S3DK_RETURN )
-	{
-		if( key == S3DK_BACKSPACE )
-		{
-			if( ln > 0 )
-				s[ln-1] = '\0';
-		} else {
-			if( ln < 20 )
-				s[ln] = key;
-		}
-		s3dw_input_change_text( _search_input, s );
-	} else {
-		_search_node( _search_widget );	
-	}
-}
-
-/* public */
-void set_return_point(float cam_position_t[], float cam_position_r[])
-{
-	int i;
-	for( i = 0; i < 3; i++ )
-		_return_point[0][i] = cam_position_t[i];
-	for( i = 0; i < 3; i++ )
-		_return_point[1][i] = cam_position_r[i];
-}
-
-/* public */
-int get_search_status(void)
-{
-	return _search_status;
-}
-
-/* public */
-void set_search_status(int stat)
-{
-	/* TODO check if stat between 0-3 else debug printf */
-	_search_status = stat;
-}
-
-/* public */
-void set_node_root(struct olsr_node *root)
-{
-	_node_root = root;
-}
-/* private */
-void _search_node(s3dw_widget *dummy)
-{
-	char *ip;
-	int result;
-	ip = s3dw_input_gettext( _search_input );
-	
-	printf("%s\n",ip);
-	/*	
-	search_node = Olsr_root;
-	
-	while ( search_node != NULL )
-	{
-
-		result = strncmp( search_node->ip, ip, NAMEMAX );
-
-		if ( result == 0 ) 
-			break;
-
-
-		if ( result < 0 )
-			search_node = search_node->right;
-		else
-			search_node = search_node->left;
-	}
-	
-	if( search_node != NULL )
-	{
-		return(1);
-	}
-	return(0);*/
-}
-
-/* private */
-void _abort_search(s3dw_widget *dummy)
-{
-	set_search_status(ABORT);
-}
-
-	

Deleted: trunk/apps/olsrs3d/mod_search.h
===================================================================
--- trunk/apps/olsrs3d/mod_search.h	2006-06-07 22:58:02 UTC (rev 348)
+++ trunk/apps/olsrs3d/mod_search.h	2006-06-07 23:04:15 UTC (rev 349)
@@ -1,38 +0,0 @@
-/*
- * mod_search.h
- *
- * Copyright (C) 2006 Andreas Langer <andreas_lbg at gmx.de>
- *
- * This file is part of the olsrs3d, an olsr topology visualizer for s3d.
- * See http://s3d.berlios.de/ for more updates.
- * 
- * s3d Widgets is free software; you can redistribute it and/or modify
- * it under the terms of the GNU Lesser General Public License as published by
- * the Free Software Foundation; either version 2.1 of the License, or
- * (at your option) any later version.
- * 
- * s3d Widgets is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU Lesser General Public License for more details.
- * 
- * You should have received a copy of the GNU Lesser General Public License
- * along with the s3d Widgets; if not, write to the Free Software
- * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
- */
-
-#define NOTHING 0		/* nothing ;) */
-#define ABORT 1			/* widget has no focus */
-#define WIDGET 2		/* focus on widget */
-#define FOLLOW 3		/* follow search result */
-
-void create_search_widget(float x, float y, float z);
-void move_search_widget(float x, float y, float z);
-void move_to_search_widget(float cam_position_t[], float cam_position_r[]);
-void move_to_return_point(float cam_position_t[], float cam_position_r[]);
-void set_return_point(float cam_position_t[], float cam_position_r[]);
-int get_search_status(void);
-void set_search_status(int stat);
-void search_widget_write(int key);
-void set_node_root(struct olsr_node *root);
-

Modified: trunk/apps/olsrs3d/olsrs3d.h
===================================================================
--- trunk/apps/olsrs3d/olsrs3d.h	2006-06-07 22:58:02 UTC (rev 348)
+++ trunk/apps/olsrs3d/olsrs3d.h	2006-06-07 23:04:15 UTC (rev 349)
@@ -23,72 +23,14 @@
  * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
  */
 
+#include "structs.h"
 
 
-#define NAMEMAX		128
-#define MAXLINESIZE 1000 /* lines in a digraph just shouldn't get that longer ... */
-#define MAXDATASIZE 100 /* max number of bytes we can get at once  */
-
 #define max(x,y)((x)>(y)?(x):(y))
 #define min(x,y)((x)<(y)?(x):(y))
 
 
-/* linked list for the all connections */
-struct olsr_con {
 
-	struct olsr_con *next_olsr_con;   /* pointer to next connection */
-	struct olsr_con *prev_olsr_con;   /* pointer to previous connection */
-	struct olsr_node *left_olsr_node;   /* pointer to left end point of the connection */
-	struct olsr_node *right_olsr_node;   /* pointer to right end point of the connection */
-	float left_etx;   /* etx of left olsr node */
-	float right_etx;   /* etx of right olsr node */
-	float left_etx_sqrt;   /* sqrt of etx of left olsr node */
-	float right_etx_sqrt;   /* sqrt etx of right olsr node */
-	int obj_id;   /* id of connection object in s3d */
-	int color;
-	float rgb;
-
-};
-
-
-/* linked list for the neighbours of each olsr node */
-struct olsr_neigh_list {
-
-	struct olsr_neigh_list *next_olsr_neigh_list;   /* pointer to next neighbour */
-	struct olsr_con *olsr_con;   /* pointer to the connection */
-
-};
-
-
-/* we contruct a binary tree to handle the nodes */
-struct olsr_node {
-
-	struct olsr_node *left;
-	struct olsr_node *right;
-	char ip[NAMEMAX];   /* host ip */
-	int node_type;   /* normal = 0, internet gateway = 1, via hna announced network = 2 */
-	int node_type_modified;   /* node_type modified flag */
-	int last_seen;   /* last seen counter */
-	int visible;   /* is this node visible or vanished */
-	float pos_vec[3];   /* position vector in 3d "space" */
-	float mov_vec[3];   /* move vector */
-	int obj_id;   /* id of node object in s3d */
-	int desc_id;   /* id of node description object in s3d */
-	float desc_length;   /* length of node description object in s3d */
-	struct olsr_neigh_list *olsr_neigh_list;   /* pointer to first neighbour */
-
-};
-
-
-struct Obj_to_ip {
-	int id;
-	struct olsr_node *olsr_node;
-	struct Obj_to_ip *next;
-	struct Obj_to_ip *prev;
-};
-
-
-
 extern int Debug;
 
 extern struct olsr_con *Con_begin;   /* begin of connection list */

Copied: trunk/apps/olsrs3d/search.c (from rev 348, trunk/apps/olsrs3d/mod_search.c)
===================================================================
--- trunk/apps/olsrs3d/mod_search.c	2006-06-07 22:58:02 UTC (rev 348)
+++ trunk/apps/olsrs3d/search.c	2006-06-07 23:04:15 UTC (rev 349)
@@ -0,0 +1,270 @@
+/*
+ * search.c
+ * 
+ * Copyright (C) 2006 Andreas Langer <andreas_lbg at gmx.de>
+ *
+ * This file is part of the olsrs3d, an olsr topology visualizer for s3d.
+ * See http://s3d.berlios.de/ for more updates.
+ * 
+ * s3d is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2 of the License, or
+ * (at your option) any later version.
+ * 
+ * s3d is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ * 
+ * You should have received a copy of the GNU General Public License
+ * along with s3d; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
+ */
+
+#include <s3d.h>
+#include <s3dw.h>
+#include <s3d_keysym.h>
+#include <math.h>
+#include <stdio.h>	/* TODO can remove then no more printf needed */
+#include <string.h>
+#include "structs.h"
+#include "search.h"
+
+s3dw_surface	*_search_surface;
+s3dw_input		*_search_input;
+s3dw_widget		*_search_widget;
+
+struct olsr_node *_node_root = NULL;
+
+float	_return_point[2][3];				/* cam position before move to the widget */
+int		_search_status = NOTHING;			/* status of search */
+											
+void _search_node(s3dw_widget *dummy);
+void _abort_search(s3dw_widget *dummy);
+
+/* public */
+void create_search_widget(float x, float y, float z)
+{
+	s3dw_button *search_button, *abort_button;
+	
+	_search_surface	= s3dw_surface_new( "Node Search", 17, 10 );
+	_search_input	= s3dw_input_new( _search_surface, 15, 1, 4 );
+	
+	s3dw_label_new( _search_surface, "Enter the IP of the node.", 1, 2);
+	s3dw_focus( S3DWIDGET( _search_input ) );
+	
+	search_button = s3dw_button_new( _search_surface, "Search", 11.5, 7 );
+	abort_button  = s3dw_button_new( _search_surface, "Abort", 1, 7 );
+	search_button->onclick = _search_node;
+	abort_button->onclick = _abort_search;
+
+	/* TODO calc position for ok button */
+	
+	s3dw_focus	( S3DWIDGET( _search_input ) );	
+	s3dw_focus	( S3DWIDGET( _search_surface ) );
+	s3dw_show	( S3DWIDGET( _search_surface ) );
+	
+	_search_widget	= s3dw_getroot();
+	move_search_widget( x, y, z );
+
+	_search_widget->ary = 180;
+	s3d_rotate( _search_widget->oid, _search_widget->arx, _search_widget->ary, _search_widget->arz );
+}
+
+/* public */
+void move_search_widget(float x, float y, float z)
+{
+	_search_widget->x = x; _search_widget->y = y; _search_widget->z = z;
+	s3dw_moveit( _search_widget );
+}
+
+/* public */
+void move_to_search_widget(float cam_position_t[], float cam_position_r[])
+{
+	float target, current;
+	
+	set_search_status(WIDGET);
+	cam_position_t[0] = ( cam_position_t[0] * 4 + _search_widget->x ) / 5;
+	cam_position_t[1] = ( cam_position_t[1] * 4 + _search_widget->y ) / 5;
+	cam_position_t[2] = ( cam_position_t[2] * 4 + ( _search_widget->z - 10 ) ) / 5;
+
+	target = _search_widget->arx;
+	current = cam_position_r[0];
+
+	if( _search_widget->arx - cam_position_r[0] > 180 )
+		target -= 360;
+	if( _search_widget->arx - cam_position_r[0] < -180 )
+		current -= 360;
+	cam_position_r[0] = ( cam_position_r[0] * 4 + target ) / 5;
+
+	target = _search_widget->ary;
+	current = cam_position_r[1];
+
+	if( _search_widget->ary - cam_position_r[1] > 180 )
+		target -= 360;
+	if( _search_widget->ary - cam_position_r[1] < -180 )
+		current -= 360;
+	cam_position_r[1] = ( cam_position_r[1] * 4 + target ) / 5;
+
+	target = _search_widget->arz;
+	current = cam_position_r[2];
+
+	if( _search_widget->arz - cam_position_r[2] > 180 )
+		target -= 360;
+	if( _search_widget->arz - cam_position_r[2] < -180 )
+		current -= 360;
+	cam_position_r[2] = ( cam_position_r[2] * 4 + target ) / 5;
+	
+	s3d_translate(0,cam_position_t[0],cam_position_t[1],cam_position_t[2]);
+	s3d_rotate(0,cam_position_r[0],cam_position_r[1],cam_position_r[2]);
+	
+	if ( sqrt(  (( cam_position_t[0] - _search_widget->x)*( cam_position_t[0] - _search_widget->x)) + 
+				(( cam_position_t[1] - _search_widget->y)*( cam_position_t[1] - _search_widget->y)) + 
+				(( cam_position_t[2] - _search_widget->z)*( cam_position_t[2] - _search_widget->z)) ) < 0.2 )
+	{
+		s3d_translate( 0, _search_widget->x, _search_widget->y, ( _search_widget->z - 10 ) );
+		s3d_rotate( 0, _search_widget->arx, _search_widget->ary, _search_widget->arz );
+	}
+}
+
+/* public */
+void move_to_return_point(float cam_position_t[], float cam_position_r[])
+{
+	float target, current;
+
+	cam_position_t[0] = ( cam_position_t[0] * 4 + _return_point[0][0] ) / 5;
+	cam_position_t[1] = ( cam_position_t[1] * 4 + _return_point[0][1] ) / 5;
+	cam_position_t[2] = ( cam_position_t[2] * 4 + _return_point[0][2] ) / 5;
+
+	target = _return_point[1][0];
+	current = cam_position_r[0];
+
+	if( _return_point[1][0] - cam_position_r[0] > 180 )
+		target -= 360;
+	if( _return_point[1][0] - cam_position_r[0] < -180 )
+		current -= 360;
+	cam_position_r[0] = ( cam_position_r[0] * 4 + target ) / 5;
+
+	target = _return_point[1][1];
+	current = cam_position_r[1];
+
+	if( _return_point[1][1] - cam_position_r[1] > 180 )
+		target -= 360;
+	if( _return_point[1][1] - cam_position_r[1] < -180 )
+		current -= 360;
+	cam_position_r[1] = ( cam_position_r[1] * 4 + target ) / 5;
+
+	target = _return_point[1][2];
+	current = cam_position_r[2];
+
+	if( _return_point[1][2] - cam_position_r[2] > 180 )
+		target -= 360;
+	if( _return_point[1][2] - cam_position_r[2] < -180 )
+		current -= 360;
+	cam_position_r[2] = ( cam_position_r[2] * 4 + target ) / 5;
+	
+	s3d_translate(0,cam_position_t[0],cam_position_t[1],cam_position_t[2]);
+	s3d_rotate(0,cam_position_r[0],cam_position_r[1],cam_position_r[2]);
+	
+	if ( sqrt(  (( cam_position_t[0] - _return_point[0][0])*( cam_position_t[0] - _return_point[0][0])) + 
+				(( cam_position_t[1] - _return_point[0][1])*( cam_position_t[1] - _return_point[0][1])) + 
+				(( cam_position_t[2] - _return_point[0][2])*( cam_position_t[2] - _return_point[0][2])) ) < 0.2 )
+	{
+		s3d_translate( 0, _return_point[0][0], _return_point[0][1], _return_point[0][2] );
+		s3d_rotate( 0, _return_point[1][0], _return_point[1][1], _return_point[1][2] );
+		set_search_status(NOTHING);
+	}
+}
+
+/* public */
+void search_widget_write(int key)
+{
+	static char s[20];
+	int ln = strlen(s);
+	
+	if( key == S3DK_COMMA ) key = S3DK_PERIOD;
+	
+	if( key != S3DK_RETURN )
+	{
+		if( key == S3DK_BACKSPACE )
+		{
+			if( ln > 0 )
+				s[ln-1] = '\0';
+		} else {
+			if( ln < 20 )
+				s[ln] = key;
+		}
+		s3dw_input_change_text( _search_input, s );
+	} else {
+		_search_node( _search_widget );	
+	}
+}
+
+/* public */
+void set_return_point(float cam_position_t[], float cam_position_r[])
+{
+	int i;
+	for( i = 0; i < 3; i++ )
+		_return_point[0][i] = cam_position_t[i];
+	for( i = 0; i < 3; i++ )
+		_return_point[1][i] = cam_position_r[i];
+}
+
+/* public */
+int get_search_status(void)
+{
+	return _search_status;
+}
+
+/* public */
+void set_search_status(int stat)
+{
+	/* TODO check if stat between 0-3 else debug printf */
+	_search_status = stat;
+}
+
+/* public */
+void set_node_root(struct olsr_node *root)
+{
+	_node_root = root;
+}
+/* private */
+void _search_node(s3dw_widget *dummy)
+{
+	char *ip;
+	int result;
+	ip = s3dw_input_gettext( _search_input );
+	
+	printf("%s\n",ip);
+	/*	
+	search_node = Olsr_root;
+	
+	while ( search_node != NULL )
+	{
+
+		result = strncmp( search_node->ip, ip, NAMEMAX );
+
+		if ( result == 0 ) 
+			break;
+
+
+		if ( result < 0 )
+			search_node = search_node->right;
+		else
+			search_node = search_node->left;
+	}
+	
+	if( search_node != NULL )
+	{
+		return(1);
+	}
+	return(0);*/
+}
+
+/* private */
+void _abort_search(s3dw_widget *dummy)
+{
+	set_search_status(ABORT);
+}
+
+	

Copied: trunk/apps/olsrs3d/search.h (from rev 348, trunk/apps/olsrs3d/mod_search.h)
===================================================================
--- trunk/apps/olsrs3d/mod_search.h	2006-06-07 22:58:02 UTC (rev 348)
+++ trunk/apps/olsrs3d/search.h	2006-06-07 23:04:15 UTC (rev 349)
@@ -0,0 +1,38 @@
+/*
+ * search.h
+ *
+ * Copyright (C) 2006 Andreas Langer <andreas_lbg at gmx.de>
+ *
+ * This file is part of the olsrs3d, an olsr topology visualizer for s3d.
+ * See http://s3d.berlios.de/ for more updates.
+ * 
+ * s3d Widgets is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU Lesser General Public License as published by
+ * the Free Software Foundation; either version 2.1 of the License, or
+ * (at your option) any later version.
+ * 
+ * s3d Widgets is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU Lesser General Public License for more details.
+ * 
+ * You should have received a copy of the GNU Lesser General Public License
+ * along with the s3d Widgets; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
+ */
+
+#define NOTHING 0		/* nothing ;) */
+#define ABORT 1			/* widget has no focus */
+#define WIDGET 2		/* focus on widget */
+#define FOLLOW 3		/* follow search result */
+
+void create_search_widget(float x, float y, float z);
+void move_search_widget(float x, float y, float z);
+void move_to_search_widget(float cam_position_t[], float cam_position_r[]);
+void move_to_return_point(float cam_position_t[], float cam_position_r[]);
+void set_return_point(float cam_position_t[], float cam_position_r[]);
+int get_search_status(void);
+void set_search_status(int stat);
+void search_widget_write(int key);
+void set_node_root(struct olsr_node *root);
+

Added: trunk/apps/olsrs3d/structs.h
===================================================================
--- trunk/apps/olsrs3d/structs.h	2006-06-07 22:58:02 UTC (rev 348)
+++ trunk/apps/olsrs3d/structs.h	2006-06-07 23:04:15 UTC (rev 349)
@@ -0,0 +1,81 @@
+/*
+ * structs.h
+ *
+ * Copyright (C) 2004-2006 Simon Wunderlich <dotslash at packetmixer.de>
+ *                         Marek Lindner <lindner_marek at yahoo.de>
+ *                         Andreas Langer <andreas_lbg at gmx.de>
+ *
+ * This file is part of olsrs3d, an olsr topology visualizer for s3d.
+ * See http://s3d.berlios.de/ for more updates.
+ *
+ * olsrs3d is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2 of the License, or
+ * (at your option) any later version.
+ *
+ * olsrs3d is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with s3d; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
+ */
+
+#define NAMEMAX		128
+#define MAXLINESIZE 1000		/* lines in a digraph just shouldn't get that longer ... */
+#define MAXDATASIZE 100			/* max number of bytes we can get at once  */
+
+/* linked list for the all connections */
+struct olsr_con 
+{
+	struct olsr_con *next_olsr_con;			/* pointer to next connection */
+	struct olsr_con *prev_olsr_con;			/* pointer to previous connection */
+	struct olsr_node *left_olsr_node;		/* pointer to left end point of the connection */
+	struct olsr_node *right_olsr_node;		/* pointer to right end point of the connection */
+	float left_etx;							/* etx of left olsr node */
+	float right_etx;						/* etx of right olsr node */
+	float left_etx_sqrt;					/* sqrt of etx of left olsr node */
+	float right_etx_sqrt;					/* sqrt etx of right olsr node */
+	int obj_id;								/* id of connection object in s3d */
+	int color;
+	float rgb;
+};
+
+
+/* linked list for the neighbours of each olsr node */
+struct olsr_neigh_list
+{
+	struct olsr_neigh_list *next_olsr_neigh_list;		/* pointer to next neighbour */
+	struct olsr_con *olsr_con;							/* pointer to the connection */
+};
+
+
+/* we contruct a binary tree to handle the nodes */
+struct olsr_node 
+{
+	struct olsr_node *left;
+	struct olsr_node *right;
+	char ip[NAMEMAX];				/* host ip */
+	int node_type;					/* normal = 0, internet gateway = 1, via hna announced network = 2 */
+	int node_type_modified;			/* node_type modified flag */
+	int last_seen;					/* last seen counter */
+	int visible;					/* is this node visible or vanished */
+	float pos_vec[3];				/* position vector in 3d "space" */
+	float mov_vec[3];				/* move vector */
+	int obj_id;						/* id of node object in s3d */
+	int desc_id;					/* id of node description object in s3d */
+	float desc_length;				/* length of node description object in s3d */
+	struct olsr_neigh_list *olsr_neigh_list;	/* pointer to first neighbour */
+};
+
+
+struct Obj_to_ip
+{
+	int id;
+	struct olsr_node *olsr_node;
+	struct Obj_to_ip *next;
+	struct Obj_to_ip *prev;
+};
+



From nichtsnutz at berlios.de  Thu Jun  8 02:16:21 2006
From: nichtsnutz at berlios.de (nichtsnutz at BerliOS)
Date: Thu, 8 Jun 2006 02:16:21 +0200
Subject: [S3d-svn] r350 - trunk/apps/olsrs3d
Message-ID: <200606080016.k580GLc9004591@sheep.berlios.de>

Author: nichtsnutz
Date: 2006-06-08 02:16:11 +0200 (Thu, 08 Jun 2006)
New Revision: 350

Modified:
   trunk/apps/olsrs3d/main.c
   trunk/apps/olsrs3d/search.c
   trunk/apps/olsrs3d/search.h
Log:
- finish widget implementation


Modified: trunk/apps/olsrs3d/main.c
===================================================================
--- trunk/apps/olsrs3d/main.c	2006-06-07 23:04:15 UTC (rev 349)
+++ trunk/apps/olsrs3d/main.c	2006-06-08 00:16:11 UTC (rev 350)
@@ -639,10 +639,8 @@
 
 	int net_result;   /* result of function net_main */
 	char nc_str[20];
-	float strLen,node_length;
-	float target,current,diff[3],angle;
-	float tmpVec[3], diffVec[3], np[3];
-	int i;
+	float strLen;
+	
 	/* calculate new movement vector */
 	calc_olsr_node_mov();
 
@@ -696,90 +694,12 @@
 	/* check search status */
 	if( get_search_status() == WIDGET )
 		move_to_search_widget( CamPosition[0], CamPosition[1] );
-	/* if( get_search_status  == FOLLOW ) */
-		/* follow the white rabbit ;) */
+	if( get_search_status() == FOLLOW )
+		follow_node( CamPosition[0], CamPosition[1], Zp_rotate );
 	if( get_search_status() == ABORT )
 		move_to_return_point( CamPosition[0], CamPosition[1] );
-	/*
-	} else if ( move_cam_to != -2 && move_cam_to != -1 ) {
 	
-		Oid_focus = -1;
-				
-		diff[0] =  search_node->pos_vec[0]*cos(Zp_rotate*M_PI/180.0) - search_node->pos_vec[2] * -sin (Zp_rotate*M_PI/180.0);
-		diff[1] =  search_node->pos_vec[1];
-		diff[2] =  search_node->pos_vec[0]*-sin(Zp_rotate*M_PI/180.0) + search_node->pos_vec[2] * cos (Zp_rotate*M_PI/180.0);
 
-		node_length = s3d_vector_length(diff);
-		
-		np[0] = ( diff[0] + 7);
-		np[1] = diff[1];
-		np[2] = ( diff[2] + 7);
-		
-		CamPosition[0][0]=( CamPosition[0][0] * 4 + np[0] ) / 5;
-		CamPosition[0][1]=( CamPosition[0][1] * 4 + np[1] ) / 5;
-		CamPosition[0][2]=( CamPosition[0][2] * 4 + np[2] ) / 5;
-		
-		tmpVec[0] = 0.0;
-		tmpVec[1] = 0.0;
-		tmpVec[2] = -1.0;
-		
-		diffVec[0] = CamPosition[0][0] - diff[0];
-		diffVec[1] = 0.0;
-		diffVec[2] = CamPosition[0][2] - diff[2];
-		
-		angle = s3d_vector_angle( diffVec, tmpVec );
-		angle = (diff[0] > 0)?(180-(180 / M_PI * angle)):(180+(180 / M_PI * angle));
-		
-		CamPosition[1][1] = (CamPosition[1][1]*4 + angle)/5;
-		
-		s3d_translate(0,CamPosition[0][0],CamPosition[0][1],CamPosition[0][2]);
-		s3d_rotate(0,CamPosition[1][0],CamPosition[1][1],CamPosition[1][2]);
-
-		
-		if(Btn_follow_mode_id == -1)
-		{
-			Btn_follow_mode_id = s3d_clone( Btn_follow_mode_obj );
-			s3d_link(Btn_follow_mode_id,0);
-			s3d_flags_on(Btn_follow_mode_id,S3D_OF_VISIBLE|S3D_OF_SELECTABLE);
-			s3d_scale( Btn_follow_mode_id, 0.5 );
-			s3d_translate( Btn_follow_mode_id,-Left*3.0-1.0, -Bottom*3.0-0.7, -3.0 );
-		}
-		
-		Rotate_follow_button = (Rotate_follow_button + 50)%360;
-		s3d_rotate(Btn_follow_mode_id,0,Rotate_follow_button,0);
-	}
-	*/
-		
-	/* mod_search move back to returnPoint
-	if(move_cam_to == -2)
-	{
-		Oid_focus = -1;
-		for( i=0; i<3; i++)
-		{
-			CamPosition[0][i]=(CamPosition[0][i]*4+ReturnPoint[0][i])/5;
-
-			target = ReturnPoint[1][i];
-			current = CamPosition[1][i];
-
-			if( ReturnPoint[1][i] - CamPosition[1][i] > 180 )
-				target = ReturnPoint[1][i] - 360;
-			if( ReturnPoint[1][i] - CamPosition[1][i] < -180 )
-				current = CamPosition[1][i] - 360;
-			CamPosition[1][i]=(CamPosition[1][i]*4+target)/5;
-		}
-		s3d_translate(0,CamPosition[0][0],CamPosition[0][1],CamPosition[0][2]);
-		s3d_rotate(0,CamPosition[1][0],CamPosition[1][1],CamPosition[1][2]);
-
-		if (dist(CamPosition[0],ReturnPoint[0])<0.2)
-		{
-			s3d_translate(0,ReturnPoint[0][0],ReturnPoint[0][1],ReturnPoint[0][2]);
-			s3d_rotate(0,ReturnPoint[1][0],ReturnPoint[1][1],ReturnPoint[1][2]);
-			move_cam_to = -1;
-		}
-	}
-*/
-
-
 	if( Olsr_ip_label_obj != -1 )
 	{
 		print_etx();

Modified: trunk/apps/olsrs3d/search.c
===================================================================
--- trunk/apps/olsrs3d/search.c	2006-06-07 23:04:15 UTC (rev 349)
+++ trunk/apps/olsrs3d/search.c	2006-06-08 00:16:11 UTC (rev 350)
@@ -35,6 +35,7 @@
 s3dw_widget		*_search_widget;
 
 struct olsr_node *_node_root = NULL;
+struct olsr_node **search_node = NULL;
 
 float	_return_point[2][3];				/* cam position before move to the widget */
 int		_search_status = NOTHING;			/* status of search */
@@ -43,6 +44,44 @@
 void _abort_search(s3dw_widget *dummy);
 
 /* public */
+void follow_node(float cam_position_t[], float cam_position_r[],float rotate)
+{
+	float real_node_pos[3],
+		  cam_target[3],
+		  tmp_vec[3],
+		  diff_vec[3],
+		  angle;
+	
+	real_node_pos[0] =  (*search_node)->pos_vec[0] * cos( rotate * M_PI / 180.0 ) - (*search_node)->pos_vec[2] * -sin ( rotate * M_PI / 180.0 );
+	real_node_pos[1] =  (*search_node)->pos_vec[1];
+	real_node_pos[2] =  (*search_node)->pos_vec[0] * -sin( rotate * M_PI / 180.0) + (*search_node)->pos_vec[2] * cos ( rotate * M_PI / 180.0 );
+
+	cam_target[0] = ( real_node_pos[0] + 7);
+	cam_target[1] =   real_node_pos[1];
+	cam_target[2] = ( real_node_pos[2] + 7);
+	
+	cam_position_t[0]=( cam_position_t[0] * 4 + cam_target[0] ) / 5;
+	cam_position_t[1]=( cam_position_t[1] * 4 + cam_target[1] ) / 5;
+	cam_position_t[2]=( cam_position_t[2] * 4 + cam_target[2] ) / 5;
+	
+	tmp_vec[0] =  0.0;
+	tmp_vec[1] =  0.0;
+	tmp_vec[2] = -1.0;
+	
+	diff_vec[0] = cam_position_t[0] - real_node_pos[0];
+	diff_vec[1] = 0.0;
+	diff_vec[2] = cam_position_t[2] - real_node_pos[2];
+	/* FIXME bug ;) */	
+	angle = s3d_vector_angle( diff_vec, tmp_vec );
+	angle = ( real_node_pos[0] > 0) ? ( 180 - ( 180 / M_PI * angle ) ) : ( 180 + ( 180 / M_PI * angle ) );
+	
+	cam_position_r[1] = ( cam_position_r[1] * 4 + angle ) / 5;
+	
+	s3d_translate( 0, cam_position_t[0], cam_position_t[1], cam_position_t[2] );
+	s3d_rotate( 0, cam_position_r[0], cam_position_r[1], cam_position_r[2] );
+}
+
+/* public */
 void create_search_widget(float x, float y, float z)
 {
 	s3dw_button *search_button, *abort_button;
@@ -228,37 +267,33 @@
 {
 	_node_root = root;
 }
+
 /* private */
 void _search_node(s3dw_widget *dummy)
 {
 	char *ip;
 	int result;
+	
+	search_node = &_node_root;
+	
 	ip = s3dw_input_gettext( _search_input );
 	
-	printf("%s\n",ip);
-	/*	
-	search_node = Olsr_root;
-	
-	while ( search_node != NULL )
+	while ( (*search_node) != NULL )
 	{
 
-		result = strncmp( search_node->ip, ip, NAMEMAX );
+		result = strncmp( (*search_node)->ip, ip, NAMEMAX );
 
 		if ( result == 0 ) 
 			break;
-
-
+		
 		if ( result < 0 )
-			search_node = search_node->right;
+			(*search_node) = (*search_node)->right;
 		else
-			search_node = search_node->left;
+			(*search_node) = (*search_node)->left;
 	}
-	
-	if( search_node != NULL )
-	{
-		return(1);
-	}
-	return(0);*/
+
+	if( (*search_node) != NULL )
+		set_search_status( FOLLOW );
 }
 
 /* private */

Modified: trunk/apps/olsrs3d/search.h
===================================================================
--- trunk/apps/olsrs3d/search.h	2006-06-07 23:04:15 UTC (rev 349)
+++ trunk/apps/olsrs3d/search.h	2006-06-08 00:16:11 UTC (rev 350)
@@ -35,4 +35,5 @@
 void set_search_status(int stat);
 void search_widget_write(int key);
 void set_node_root(struct olsr_node *root);
+void follow_node(float cam_position_t[], float cam_position_r[],float rotate);
 



From nichtsnutz at berlios.de  Fri Jun  9 12:16:51 2006
From: nichtsnutz at berlios.de (nichtsnutz at BerliOS)
Date: Fri, 9 Jun 2006 12:16:51 +0200
Subject: [S3d-svn] r351 - trunk/apps/olsrs3d
Message-ID: <200606091016.k59AGpRr024326@sheep.berlios.de>

Author: nichtsnutz
Date: 2006-06-09 12:16:51 +0200 (Fri, 09 Jun 2006)
New Revision: 351

Modified:
   trunk/apps/olsrs3d/search.c
Log:
- fix node search


Modified: trunk/apps/olsrs3d/search.c
===================================================================
--- trunk/apps/olsrs3d/search.c	2006-06-08 00:16:11 UTC (rev 350)
+++ trunk/apps/olsrs3d/search.c	2006-06-09 10:16:51 UTC (rev 351)
@@ -71,10 +71,9 @@
 	diff_vec[0] = cam_position_t[0] - real_node_pos[0];
 	diff_vec[1] = 0.0;
 	diff_vec[2] = cam_position_t[2] - real_node_pos[2];
-	/* FIXME bug ;) */	
 	angle = s3d_vector_angle( diff_vec, tmp_vec );
-	angle = ( real_node_pos[0] > 0) ? ( 180 - ( 180 / M_PI * angle ) ) : ( 180 + ( 180 / M_PI * angle ) );
-	
+	/* angle = ( real_node_pos[0] > 0) ? ( 180 - ( 180 / M_PI * angle ) ) : ( 180 + ( 180 / M_PI * angle ) ); */
+	angle = 180 - ( 180 / M_PI * angle );
 	cam_position_r[1] = ( cam_position_r[1] * 4 + angle ) / 5;
 	
 	s3d_translate( 0, cam_position_t[0], cam_position_t[1], cam_position_t[2] );



From dotslash at berlios.de  Sat Jun 10 18:57:53 2006
From: dotslash at berlios.de (dotslash at BerliOS)
Date: Sat, 10 Jun 2006 18:57:53 +0200
Subject: [S3d-svn] r352 - in trunk: . example
Message-ID: <200606101657.k5AGvrl2021798@sheep.berlios.de>

Author: dotslash
Date: 2006-06-10 18:57:51 +0200 (Sat, 10 Jun 2006)
New Revision: 352

Modified:
   trunk/
   trunk/example/filebrowser.c
Log:
 r753 at balthasar:  dotslash | 2006-06-10 18:57:21 +0200
 filebrowser-example: 
  - better material
  - turn polygons



Property changes on: trunk
___________________________________________________________________
Name: svk:merge
   - bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:740
   + bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:753

Modified: trunk/example/filebrowser.c
===================================================================
--- trunk/example/filebrowser.c	2006-06-09 10:16:51 UTC (rev 351)
+++ trunk/example/filebrowser.c	2006-06-10 16:57:51 UTC (rev 352)
@@ -29,6 +29,7 @@
 #include <dirent.h>  /*  dirent */
 #include <stdlib.h>	 /*  malloc() */
 #include <string.h>  /*  strlen(), strncmp(), strrchr() */
+#include <unistd.h>	 /*  chdir() */
 #include <math.h>	 /*  sin(),cos() */
 #include <time.h>	/* nanosleep() */
 static struct timespec t={0,100*1000*1000}; /* 100 mili seconds */
@@ -150,12 +151,12 @@
 			f=1.0-0.05*(n%2);
 			switch (item[n].type)
 			{
-				case T_LOCALDIR:s3d_push_material(item[n].pie_oid,		0,f,0,			1,1,1,		f,f,f);		break;
-				case T_BACKDIR:	s3d_push_material(item[n].pie_oid,		0,f/2,0,		1,1,1,		f,f,f);		break;
-				case T_FOLDER:	s3d_push_material(item[n].pie_oid,		f,f,0,			1,1,0,		f,f,1);		break;
-				default:		s3d_push_material(item[n].pie_oid,		f,f,f,			1,1,1,		f,f,f);		break;
+				case T_LOCALDIR:s3d_push_material(item[n].pie_oid,		0,f,0,			0.5,0.5,0.5,		f,f,f);		break;
+				case T_BACKDIR:	s3d_push_material(item[n].pie_oid,		0,f/2,0,		0.5,0.5,0.5,		f,f,f);		break;
+				case T_FOLDER:	s3d_push_material(item[n].pie_oid,		f,f,0,			0.5,0.5,0.0,		f,f,1);		break;
+				default:		s3d_push_material(item[n].pie_oid,		f,f,f,			0.5,0.5,0.5,		f,f,f);		break;
 			}
-			s3d_push_polygon(item[n].pie_oid,	0,1,2,	0);
+			s3d_push_polygon(item[n].pie_oid,	0,2,1,	0);
 
 			s3d_push_vertex(item[n].pie_oid,pz,-2,0);
 			s3d_translate(item[n].icon_oid,px,py,pz);



From dotslash at berlios.de  Sat Jun 10 18:58:16 2006
From: dotslash at berlios.de (dotslash at BerliOS)
Date: Sat, 10 Jun 2006 18:58:16 +0200
Subject: [S3d-svn] r353 - in trunk: . apps/dot_mcp
Message-ID: <200606101658.k5AGwGb2021970@sheep.berlios.de>

Author: dotslash
Date: 2006-06-10 18:58:14 +0200 (Sat, 10 Jun 2006)
New Revision: 353

Modified:
   trunk/
   trunk/apps/dot_mcp/main.c
Log:
 r755 at balthasar:  dotslash | 2006-06-10 18:58:10 +0200
 - moving with keyup/keydown-events (smooth!)



Property changes on: trunk
___________________________________________________________________
Name: svk:merge
   - bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:753
   + bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:755

Modified: trunk/apps/dot_mcp/main.c
===================================================================
--- trunk/apps/dot_mcp/main.c	2006-06-10 16:57:51 UTC (rev 352)
+++ trunk/apps/dot_mcp/main.c	2006-06-10 16:58:14 UTC (rev 353)
@@ -30,12 +30,16 @@
 #include <string.h>  /*  strncpy() */
 #include <stdio.h>  /*  printf() */
 #include <math.h>	/* sin(), cos() */
+#include <time.h>	/* nanosleep() */
+static struct timespec t={0,33*1000*1000}; 
+
 #define bsize 	0.2
 struct tver
 {
 	float x,y,z;
 };
 struct tver campos, camrot;
+float xdif=0,ydif=0;
 
 struct app {
 	unsigned int oid,oid_c;
@@ -443,34 +447,46 @@
 		alpha=alpha+0.1;
 		if (alpha>360.0) alpha=0.0;
 	}
-	usleep(10000);
+	if (ego_mode)
+	{
+		if ((ydif!=0) || (xdif!=0))
+		{
+			campos.x+=ydif*sin((camrot.y*M_PI)/180);
+			campos.z+=ydif*cos((camrot.y*M_PI)/180);
+			campos.x+=xdif*cos((-camrot.y*M_PI)/180);
+			campos.z+=xdif*sin((-camrot.y*M_PI)/180);
+			campos.y+=ydif*sin((-camrot.x*M_PI)/180);
+			s3d_translate(	0,campos.x,campos.y,campos.z);
+		}
+	}
+	nanosleep(&t,NULL); 
 }
-void keypress(struct s3d_evt *event)
+
+void keydown(struct s3d_evt *event)
 {
-	int key;
-	float xdif=0,ydif=0;
-	key=*((unsigned short *)event->buf);
-	switch (key)
+	struct s3d_key_event *keys=(struct s3d_key_event *)event->buf;
+	switch (keys->keysym)
 	{
 		case S3DK_F1:  ego_mode=(ego_mode+1)%2;
 				 printf("ego mode %d\n",ego_mode);
 				 break;
-		case 'w':ydif=-2;break;
-		case 'a':xdif=-2;break;
-		case 's':ydif= 2;break;
-		case 'd':xdif= 2;break;
-		default:
-			printf("unknown/not handled key %d\n", key);
+		case 'w':ydif+=-1.0;break;
+		case 'a':xdif+=-1.0;break;
+		case 's':ydif+= 1.0;break;
+		case 'd':xdif+= 1.0;break;
 	}
-	if (ego_mode)
+}
+void keyup(struct s3d_evt *event)
+{
+	struct s3d_key_event *keys=(struct s3d_key_event *)event->buf;
+	switch (keys->keysym)
 	{
-		campos.x+=ydif*sin((camrot.y*M_PI)/180);
-		campos.z+=ydif*cos((camrot.y*M_PI)/180);
-		campos.x+=xdif*cos((-camrot.y*M_PI)/180);
-		campos.z+=xdif*sin((-camrot.y*M_PI)/180);
-		campos.y+=ydif*sin((-camrot.x*M_PI)/180);
-		s3d_translate(	0,campos.x,campos.y,campos.z);
+		case 'w':ydif-=-1.0;break;
+		case 'a':xdif-=-1.0;break;
+		case 's':ydif-= 1.0;break;
+		case 'd':xdif-= 1.0;break;
 	}
+
 }
 
 int main (int argc, char **argv)
@@ -480,7 +496,8 @@
 	s3d_set_callback(S3D_EVENT_QUIT,stop);
 	s3d_set_callback(S3D_MCP_DEL_OBJECT,mcp_del_object);
 	s3d_set_callback(S3D_EVENT_OBJ_CLICK,object_click);
-	s3d_set_callback(S3D_EVENT_KEY,keypress);
+	s3d_set_callback(S3D_EVENT_KEYDOWN,keydown);
+	s3d_set_callback(S3D_EVENT_KEYUP,keyup);
 
 	if (!s3d_init(&argc,&argv,"mcp"))	
 	{



From dotslash at berlios.de  Sat Jun 10 19:57:09 2006
From: dotslash at berlios.de (dotslash at BerliOS)
Date: Sat, 10 Jun 2006 19:57:09 +0200
Subject: [S3d-svn] r354 - in trunk: . extras
Message-ID: <200606101757.k5AHv9g5005983@sheep.berlios.de>

Author: dotslash
Date: 2006-06-10 19:57:03 +0200 (Sat, 10 Jun 2006)
New Revision: 354

Added:
   trunk/extras/README
   trunk/extras/mplayer.1.0pre7try2.s3d.patch
Removed:
   trunk/extras/mplayer.1.0pre7.s3d.patch
Modified:
   trunk/
Log:
 r757 at balthasar:  dotslash | 2006-06-10 19:56:56 +0200
 - new mplayer patch



Property changes on: trunk
___________________________________________________________________
Name: svk:merge
   - bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:755
   + bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:757

Added: trunk/extras/README
===================================================================
--- trunk/extras/README	2006-06-10 16:58:14 UTC (rev 353)
+++ trunk/extras/README	2006-06-10 17:57:03 UTC (rev 354)
@@ -0,0 +1,13 @@
+INSTALL
+-------
+1. install the client library (or the whole s3d package)
+2. go into your mplayer-source directory
+3. use
+   $ patch -p1 < /path/to/mplayer.1.0pre7try2.s3d.patch
+   to patch the source
+4. do ./configure
+   In the summary, you should see "s3d" in the 
+   "Enabled optional drivers", "Video Output"
+5. install mplayer and watch videos like this:
+   mplayer -vo s3d movie.mpg
+6. enjoy ;)

Deleted: trunk/extras/mplayer.1.0pre7.s3d.patch
===================================================================
--- trunk/extras/mplayer.1.0pre7.s3d.patch	2006-06-10 16:58:14 UTC (rev 353)
+++ trunk/extras/mplayer.1.0pre7.s3d.patch	2006-06-10 17:57:03 UTC (rev 354)
@@ -1,279 +0,0 @@
-diff -Naur MPlayer-1.0pre7/configure MPlayer-1.0pre7.s3d/configure
---- MPlayer-1.0pre7/configure	2005-04-13 13:46:35.000000000 +0200
-+++ MPlayer-1.0pre7.s3d/configure	2005-05-22 18:19:08.000000000 +0200
-@@ -234,6 +234,7 @@
-   --disable-vidix        disable VIDIX [enable on x86 *nix]
-   --enable-gl            build with OpenGL render support [autodetect]
-   --enable-dga[=n]       build with DGA [n in {1, 2} ] support [autodetect]
-+  --enable-s3d           build with s3d support [autodetect]
-   --enable-vesa          build with VESA support [autodetect]
-   --enable-svga          build with SVGAlib support [autodetect]
-   --enable-sdl           build with SDL render support [autodetect]
-@@ -1288,6 +1289,7 @@
- _mencoder=yes
- _x11=auto
- _dga=auto	# 1 2 no auto
-+_s3d=auto
- _xv=auto
- _xvmc=no  #auto when complete
- _sdl=auto
-@@ -1444,6 +1446,8 @@
-   --disable-xvmc)       _xvmc=no        ;;
-   --enable-sdl)		_sdl=yes	;;
-   --disable-sdl)	_sdl=no		;;
-+  --enable-s3d)		_s3d=yes	;;
-+  --disable-s3d)	_s3d=no		;;
-   --enable-directx)     _directx=yes    ;;
-   --disable-directx)    _directx=no     ;;
-   --enable-win32waveout)  _win32waveout=yes ;;
-@@ -3798,6 +3802,27 @@
- fi
- echores "$_aa"
- 
-+echocheck "s3d"
-+if test "$_s3d" = auto ; then
-+  cat > $TMPC << EOF
-+#include <s3d.h>
-+int main(int argc, char **argv) { s3d_init( &argc, &argv, "mplayer_test"); s3d_quit(); return 0; }
-+EOF
-+  _s3d=no
-+  cc_check -ls3d && _s3d=yes
-+fi
-+if test "$_s3d" = yes ; then
-+  _def_s3d='#define HAVE_S3D 1'
-+  _ld_s3d='-ls3d'
-+  _vosrc="$_vosrc vo_s3d.c"
-+  _vomodules="s3d $_vomodules"
-+else
-+  _def_aa='#undef HAVE_S3D'
-+  _novomodules="s3d $_novomodules"
-+fi
-+echores "$_s3d"
-+
-+
- 
- echocheck "CACA"
- if test "$_caca" = auto ; then
-@@ -6769,6 +6794,7 @@
- SDL_LIB = $_ld_sdl
- SVGA_LIB = $_ld_svga
- AA_LIB = $_ld_aa
-+S3D_LIB = $_ld_s3d
- CACA_INC = $_inc_caca
- CACA_LIB = $_ld_caca
- 
-@@ -7484,6 +7510,7 @@
- $_def_vesa
- $_def_xdpms
- $_def_aa
-+$_def_s3d
- $_def_caca
- $_def_tga
- $_def_toolame
-diff -Naur MPlayer-1.0pre7/libvo/video_out.c MPlayer-1.0pre7.s3d/libvo/video_out.c
---- MPlayer-1.0pre7/libvo/video_out.c	2004-12-21 21:33:51.000000000 +0100
-+++ MPlayer-1.0pre7.s3d/libvo/video_out.c	2005-05-22 18:19:08.000000000 +0200
-@@ -84,6 +84,7 @@
- extern vo_functions_t video_out_png;
- extern vo_functions_t video_out_ggi;
- extern vo_functions_t video_out_aa;
-+extern vo_functions_t video_out_s3d;
- extern vo_functions_t video_out_caca;
- extern vo_functions_t video_out_mpegpes;
- extern vo_functions_t video_out_yuv4mpeg;
-@@ -192,6 +193,9 @@
- #ifdef HAVE_AA
- 	&video_out_aa,
- #endif
-+#ifdef HAVE_S3D
-+	&video_out_s3d,
-+#endif
- #ifdef HAVE_CACA
- 	&video_out_caca,
- #endif
-diff -Naur MPlayer-1.0pre7/libvo/vo_s3d.c MPlayer-1.0pre7.s3d/libvo/vo_s3d.c
---- MPlayer-1.0pre7/libvo/vo_s3d.c	1970-01-01 01:00:00.000000000 +0100
-+++ MPlayer-1.0pre7.s3d/libvo/vo_s3d.c	2006-03-19 20:56:19.000000000 +0100
-@@ -0,0 +1,169 @@
-+#include <stdio.h>
-+#include <stdlib.h>
-+#include <string.h>
-+#include <errno.h>
-+#include <s3d.h>
-+#include "config.h"
-+#include "video_out.h"
-+#include "video_out_internal.h"
-+#include "mp_msg.h"
-+
-+static vo_info_t info = 
-+{
-+	"s3d video output",
-+	"s3d",
-+	"<dotslash at packetmixer.de>",
-+	""
-+};
-+
-+LIBVO_EXTERN( s3d )
-+
-+static uint32_t image_width, image_height;
-+static int int_pause;
-+static uint32_t oid;
-+static char *data2;
-+
-+//static uint32_t
-+static uint32_t draw_slice(uint8_t *image[], int stride[], int w,int h,int x,int y)
-+{
-+//	int x2,y2;
-+//	unsigned char *data;
-+	// ignoring stride, as I don't know what it is O_o
-+    mp_msg (MSGT_VO, MSGL_INFO, "[s3d] calling stride: %dx%d image at %dx%d\n",w,h,x,y);
-+/*	data=*image;
-+	for (y2=x;y2<w;y2++)
-+	for (x2=y;x2<h;x2++)
-+	{
-+		data2[(y2*image_width+x2)*4+0]=data[(y2*image_width+x2)*3+0];
-+		data2[(y2*image_width+x2)*4+1]=data[(y2*image_width+x2)*3+1];
-+		data2[(y2*image_width+x2)*4+2]=data[(y2*image_width+x2)*3+2];
-+		data2[(y2*image_width+x2)*4+3]=255;
-+	}
-+	s3d_load_texture(oid,0,x,y,w,h,data2);
-+	return(0);*/
-+}
-+
-+static void draw_osd(void)
-+{
-+}
-+
-+static void
-+flip_page(void)
-+{
-+}
-+
-+static uint32_t
-+draw_frame(uint8_t *src[])
-+{
-+	uint32_t x,y;
-+	unsigned char *data;
-+	data=*src;
-+	for (y=0;y<image_height;y++)
-+		for (x=0;x<image_width;x++)
-+		{
-+			data2[(y*image_width+x)*4+0]=data[(y*image_width+x)*3+0];
-+			data2[(y*image_width+x)*4+1]=data[(y*image_width+x)*3+1];
-+			data2[(y*image_width+x)*4+2]=data[(y*image_width+x)*3+2];
-+			data2[(y*image_width+x)*4+3]=255;
-+		}
-+	s3d_load_texture(oid,0,0,0,image_width,image_height,data2);
-+	return VO_TRUE;
-+}
-+
-+static uint32_t
-+config(uint32_t width, uint32_t height, uint32_t d_width, uint32_t d_height, uint32_t fullscreen, char *title, uint32_t format)
-+{
-+	float aspect;
-+	image_width = width;
-+	image_height = height;
-+	printf("config!!\n\n");
-+	if (vo_config_count>0) 
-+	{
-+	} else {
-+		free(data2);
-+		s3d_pop_texture(oid,1);
-+		s3d_pop_vertex(oid,4);
-+	}
-+	aspect=((float) d_width)/((float) d_height);
-+	s3d_push_vertex(oid,-3*aspect,-3,0);
-+	s3d_push_vertex(oid, 3*aspect,-3,0);
-+	s3d_push_vertex(oid, 3*aspect, 3,0);
-+	s3d_push_vertex(oid,-3*aspect, 3,0);
-+
-+/*	s3d_scale(oid,(((float) d_width)/((float) d_height)),1.0,1.0);*/
-+	data2=malloc(width*height*4);
-+	memset(data2,128,width*height*4);
-+	s3d_push_texture(oid,image_width,image_height);		
-+   	mp_msg (MSGT_VO, MSGL_INFO,"[s3d] requesting a %d %d texture... \n",image_width,image_height);
-+   	mp_msg (MSGT_VO, MSGL_INFO,"[s3d] wanted size is %d %d... \n",d_width,d_height);
-+	s3d_pep_material_texture(oid,0);	// assign texture 0 to material 0
-+	return 0;
-+}
-+
-+static void
-+uninit(void)
-+{
-+	if (data2!=NULL)
-+		free(data2);
-+	s3d_quit();
-+}
-+
-+
-+static void check_events(void)
-+{
-+}
-+
-+static uint32_t preinit(const char *arg)
-+{
-+	int argc=0;
-+	char *arg1=NULL;
-+	char **argv=&arg1;
-+    mp_msg (MSGT_VO, MSGL_INFO, "[s3d] hello, i'm initing - darn it!\n");
-+	if (s3d_init(&argc,&argv,"mplayer"))
-+	{
-+    	mp_msg (MSGT_VO, MSGL_WARN, "[s3d] sorry, can't reach server.\n");
-+		return(ENOSYS);
-+	}
-+	oid=s3d_new_object();
-+	s3d_push_vertex(oid,-3,-3,0);
-+	s3d_push_vertex(oid, 3,-3,0);
-+	s3d_push_vertex(oid, 3, 3,0);
-+	s3d_push_vertex(oid,-3, 3,0);
-+	s3d_push_material_a(oid,
-+					0.8,	0.0,	0.0	,1.0,
-+					1.0,	1.0,	1.0	,1.0,
-+					0.8,	0.0,	0.0	,1.0);
-+	s3d_push_polygon(oid,0,1,2,0);
-+	s3d_pep_polygon_tex_coord(oid, 0.0,1.0, 
-+								   1.0,1.0,
-+								   1.0,0.0);
-+	s3d_push_polygon(oid,0,2,3,0);
-+	s3d_pep_polygon_tex_coord(oid, 0.0,1.0, 
-+								   1.0,0.0,
-+								   0.0,0.0);
-+	s3d_flags_on(oid,S3D_OF_VISIBLE);
-+    if(arg) 
-+    {
-+    	mp_msg (MSGT_VO, MSGL_WARN, "[s3d] what should I do with this arg? \n");
-+		return ENOSYS;
-+    }
-+    return 0;
-+}
-+
-+static uint32_t
-+query_format(uint32_t format)
-+{
-+    if (format == IMGFMT_RGB24)
-+        return VFCAP_CSP_SUPPORTED | VFCAP_CSP_SUPPORTED_BY_HW;
-+    return 0;
-+}
-+static uint32_t control(uint32_t request, void *data, ...)
-+{
-+  switch (request) {
-+  case VOCTRL_PAUSE: return (int_pause=1);
-+  case VOCTRL_RESUME: return (int_pause=0);
-+  case VOCTRL_QUERY_FORMAT:
-+    return query_format(*((uint32_t*)data));
-+  }
-+  return VO_NOTIMPL;
-+}
-diff -Naur MPlayer-1.0pre7/Makefile MPlayer-1.0pre7.s3d/Makefile
---- MPlayer-1.0pre7/Makefile	2005-04-16 22:18:12.000000000 +0200
-+++ MPlayer-1.0pre7.s3d/Makefile	2005-05-22 18:19:08.000000000 +0200
-@@ -30,7 +30,7 @@
- OBJS_MENCODER = $(SRCS_MENCODER:.c=.o)
- OBJS_MPLAYER = $(SRCS_MPLAYER:.c=.o)
- 
--VO_LIBS = $(AA_LIB) $(X_LIB) $(SDL_LIB) $(GGI_LIB) $(MP1E_LIB) $(MLIB_LIB) $(SVGA_LIB) $(DIRECTFB_LIB) $(CACA_LIB)
-+VO_LIBS = $(AA_LIB) $(X_LIB) $(SDL_LIB) $(GGI_LIB) $(MP1E_LIB) $(MLIB_LIB) $(SVGA_LIB) $(DIRECTFB_LIB) $(CACA_LIB) $(S3D_LIB)
- AO_LIBS = $(ARTS_LIB) $(ESD_LIB) $(JACK_LIB) $(NAS_LIB) $(SGIAUDIO_LIB) $(POLYP_LIB)
- CODEC_LIBS = $(AV_LIB) $(FAME_LIB) $(MAD_LIB) $(VORBIS_LIB) $(THEORA_LIB) $(FAAD_LIB) $(LIBLZO_LIB) $(DECORE_LIB) $(XVID_LIB) $(DTS_LIB) $(PNG_LIB) $(Z_LIB) $(JPEG_LIB) $(ALSA_LIB) $(XMMS_LIB) $(X264_LIB)
- COMMON_LIBS = libmpcodecs/libmpcodecs.a $(W32_LIB) $(DS_LIB) libaf/libaf.a libmpdemux/libmpdemux.a input/libinput.a postproc/libswscale.a osdep/libosdep.a $(DVDREAD_LIB) $(CODEC_LIBS) $(FREETYPE_LIB) $(TERMCAP_LIB) $(CDPARANOIA_LIB) $(MPLAYER_NETWORK_LIB) $(WIN32_LIB) $(GIF_LIB) $(MACOSX_FRAMEWORKS) $(SMBSUPPORT_LIB) $(FRIBIDI_LIB) $(FONTCONFIG_LIB) $(ENCA_LIB)
-

Added: trunk/extras/mplayer.1.0pre7try2.s3d.patch
===================================================================
--- trunk/extras/mplayer.1.0pre7try2.s3d.patch	2006-06-10 16:58:14 UTC (rev 353)
+++ trunk/extras/mplayer.1.0pre7try2.s3d.patch	2006-06-10 17:57:03 UTC (rev 354)
@@ -0,0 +1,278 @@
+diff -Naur MPlayer-1.0pre7try2/configure MPlayer-1.0pre7try2.s3d/configure
+--- MPlayer-1.0pre7try2/configure	2005-04-13 13:46:35.000000000 +0200
++++ MPlayer-1.0pre7try2.s3d/configure	2006-06-10 18:37:34.000000000 +0200
+@@ -234,6 +234,7 @@
+   --disable-vidix        disable VIDIX [enable on x86 *nix]
+   --enable-gl            build with OpenGL render support [autodetect]
+   --enable-dga[=n]       build with DGA [n in {1, 2} ] support [autodetect]
++  --enable-s3d           build with s3d support [autodetect]
+   --enable-vesa          build with VESA support [autodetect]
+   --enable-svga          build with SVGAlib support [autodetect]
+   --enable-sdl           build with SDL render support [autodetect]
+@@ -1288,6 +1289,7 @@
+ _mencoder=yes
+ _x11=auto
+ _dga=auto	# 1 2 no auto
++_s3d=auto
+ _xv=auto
+ _xvmc=no  #auto when complete
+ _sdl=auto
+@@ -1444,6 +1446,8 @@
+   --disable-xvmc)       _xvmc=no        ;;
+   --enable-sdl)		_sdl=yes	;;
+   --disable-sdl)	_sdl=no		;;
++  --enable-s3d)		_s3d=yes	;;
++  --disable-s3d)	_s3d=no		;;
+   --enable-directx)     _directx=yes    ;;
+   --disable-directx)    _directx=no     ;;
+   --enable-win32waveout)  _win32waveout=yes ;;
+@@ -3798,6 +3802,27 @@
+ fi
+ echores "$_aa"
+ 
++echocheck "s3d"
++if test "$_s3d" = auto ; then
++  cat > $TMPC << EOF
++#include <s3d.h>
++int main(int argc, char **argv) { s3d_init( &argc, &argv, "mplayer_test"); s3d_quit(); return 0; }
++EOF
++  _s3d=no
++  cc_check -ls3d && _s3d=yes
++fi
++if test "$_s3d" = yes ; then
++  _def_s3d='#define HAVE_S3D 1'
++  _ld_s3d='-ls3d'
++  _vosrc="$_vosrc vo_s3d.c"
++  _vomodules="s3d $_vomodules"
++else
++  _def_aa='#undef HAVE_S3D'
++  _novomodules="s3d $_novomodules"
++fi
++echores "$_s3d"
++
++
+ 
+ echocheck "CACA"
+ if test "$_caca" = auto ; then
+@@ -6769,6 +6794,7 @@
+ SDL_LIB = $_ld_sdl
+ SVGA_LIB = $_ld_svga
+ AA_LIB = $_ld_aa
++S3D_LIB = $_ld_s3d
+ CACA_INC = $_inc_caca
+ CACA_LIB = $_ld_caca
+ 
+@@ -7484,6 +7510,7 @@
+ $_def_vesa
+ $_def_xdpms
+ $_def_aa
++$_def_s3d
+ $_def_caca
+ $_def_tga
+ $_def_toolame
+diff -Naur MPlayer-1.0pre7try2/libvo/video_out.c MPlayer-1.0pre7try2.s3d/libvo/video_out.c
+--- MPlayer-1.0pre7try2/libvo/video_out.c	2004-12-21 21:33:51.000000000 +0100
++++ MPlayer-1.0pre7try2.s3d/libvo/video_out.c	2006-06-10 18:37:34.000000000 +0200
+@@ -84,6 +84,7 @@
+ extern vo_functions_t video_out_png;
+ extern vo_functions_t video_out_ggi;
+ extern vo_functions_t video_out_aa;
++extern vo_functions_t video_out_s3d;
+ extern vo_functions_t video_out_caca;
+ extern vo_functions_t video_out_mpegpes;
+ extern vo_functions_t video_out_yuv4mpeg;
+@@ -192,6 +193,9 @@
+ #ifdef HAVE_AA
+ 	&video_out_aa,
+ #endif
++#ifdef HAVE_S3D
++	&video_out_s3d,
++#endif
+ #ifdef HAVE_CACA
+ 	&video_out_caca,
+ #endif
+diff -Naur MPlayer-1.0pre7try2/libvo/vo_s3d.c MPlayer-1.0pre7try2.s3d/libvo/vo_s3d.c
+--- MPlayer-1.0pre7try2/libvo/vo_s3d.c	1970-01-01 01:00:00.000000000 +0100
++++ MPlayer-1.0pre7try2.s3d/libvo/vo_s3d.c	2006-06-10 19:48:51.000000000 +0200
+@@ -0,0 +1,169 @@
++#include <stdio.h>
++#include <stdlib.h>
++#include <string.h>
++#include <errno.h>
++#include <s3d.h>
++#include "config.h"
++#include "video_out.h"
++#include "video_out_internal.h"
++#include "mp_msg.h"
++
++static vo_info_t info = 
++{
++	"s3d video output",
++	"s3d",
++	"<dotslash at packetmixer.de>",
++	""
++};
++
++LIBVO_EXTERN( s3d )
++
++static uint32_t image_width, image_height;
++static int int_pause;
++static uint32_t oid;
++static char *data2;
++
++//static uint32_t
++static uint32_t draw_slice(uint8_t *image[], int stride[], int w,int h,int x,int y)
++{
++//	int x2,y2;
++//	unsigned char *data;
++	// ignoring stride, as I don't know what it is O_o
++    mp_msg (MSGT_VO, MSGL_INFO, "[s3d] calling stride: %dx%d image at %dx%d\n",w,h,x,y);
++/*	data=*image;
++	for (y2=x;y2<w;y2++)
++	for (x2=y;x2<h;x2++)
++	{
++		data2[(y2*image_width+x2)*4+0]=data[(y2*image_width+x2)*3+0];
++		data2[(y2*image_width+x2)*4+1]=data[(y2*image_width+x2)*3+1];
++		data2[(y2*image_width+x2)*4+2]=data[(y2*image_width+x2)*3+2];
++		data2[(y2*image_width+x2)*4+3]=255;
++	}
++	s3d_load_texture(oid,0,x,y,w,h,data2);
++	return(0);*/
++}
++
++static void draw_osd(void)
++{
++}
++
++static void
++flip_page(void)
++{
++}
++
++static uint32_t
++draw_frame(uint8_t *src[])
++{
++	uint32_t x,y;
++	unsigned char *data;
++	data=*src;
++	for (y=0;y<image_height;y++)
++		for (x=0;x<image_width;x++)
++		{
++			data2[(y*image_width+x)*4+0]=data[(y*image_width+x)*3+0];
++			data2[(y*image_width+x)*4+1]=data[(y*image_width+x)*3+1];
++			data2[(y*image_width+x)*4+2]=data[(y*image_width+x)*3+2];
++			data2[(y*image_width+x)*4+3]=255;
++		}
++	s3d_load_texture(oid,0,0,0,image_width,image_height,data2);
++	return VO_TRUE;
++}
++
++static uint32_t
++config(uint32_t width, uint32_t height, uint32_t d_width, uint32_t d_height, uint32_t fullscreen, char *title, uint32_t format)
++{
++	float aspect;
++	image_width = width;
++	image_height = height;
++	printf("config!!\n\n");
++	if (vo_config_count>0) 
++	{
++	} else {
++		free(data2);
++		s3d_pop_texture(oid,1);
++		s3d_pop_vertex(oid,4);
++	}
++	aspect=((float) d_width)/((float) d_height);
++	s3d_push_vertex(oid,-3*aspect,-3,0);
++	s3d_push_vertex(oid, 3*aspect,-3,0);
++	s3d_push_vertex(oid, 3*aspect, 3,0);
++	s3d_push_vertex(oid,-3*aspect, 3,0);
++
++/*	s3d_scale(oid,(((float) d_width)/((float) d_height)),1.0,1.0);*/
++	data2=malloc(width*height*4);
++	memset(data2,128,width*height*4);
++	s3d_push_texture(oid,image_width,image_height);		
++   	mp_msg (MSGT_VO, MSGL_INFO,"[s3d] requesting a %d %d texture... \n",image_width,image_height);
++   	mp_msg (MSGT_VO, MSGL_INFO,"[s3d] wanted size is %d %d... \n",d_width,d_height);
++	s3d_pep_material_texture(oid,0);	// assign texture 0 to material 0
++	return 0;
++}
++
++static void
++uninit(void)
++{
++	if (data2!=NULL)
++		free(data2);
++	s3d_quit();
++}
++
++
++static void check_events(void)
++{
++}
++
++static uint32_t preinit(const char *arg)
++{
++	int argc=0;
++	char *arg1=NULL;
++	char **argv=&arg1;
++    mp_msg (MSGT_VO, MSGL_INFO, "[s3d] hello, i'm initing - darn it!\n");
++	if (s3d_init(&argc,&argv,"mplayer"))
++	{
++    	mp_msg (MSGT_VO, MSGL_WARN, "[s3d] sorry, can't reach server.\n");
++		return(ENOSYS);
++	}
++	oid=s3d_new_object();
++	s3d_push_vertex(oid,-3,-3,0);
++	s3d_push_vertex(oid, 3,-3,0);
++	s3d_push_vertex(oid, 3, 3,0);
++	s3d_push_vertex(oid,-3, 3,0);
++	s3d_push_material_a(oid,
++					0.0,	0.0,	0.8	,1.0,
++					1.0,	1.0,	1.0	,1.0,
++					0.0,	0.0,	0.8	,1.0);
++	s3d_push_polygon(oid,0,2,1,0);
++	s3d_pep_polygon_tex_coord(oid, 0.0,1.0, 
++								   1.0,0.0,
++								   1.0,1.0);
++	s3d_push_polygon(oid,0,3,2,0);
++	s3d_pep_polygon_tex_coord(oid, 0.0,1.0, 
++								   0.0,0.0,
++								   1.0,0.0);
++	s3d_flags_on(oid,S3D_OF_VISIBLE);
++    if(arg) 
++    {
++    	mp_msg (MSGT_VO, MSGL_WARN, "[s3d] what should I do with this arg? \n");
++		return ENOSYS;
++    }
++    return 0;
++}
++
++static uint32_t
++query_format(uint32_t format)
++{
++    if (format == IMGFMT_RGB24)
++        return VFCAP_CSP_SUPPORTED | VFCAP_CSP_SUPPORTED_BY_HW;
++    return 0;
++}
++static uint32_t control(uint32_t request, void *data, ...)
++{
++  switch (request) {
++  case VOCTRL_PAUSE: return (int_pause=1);
++  case VOCTRL_RESUME: return (int_pause=0);
++  case VOCTRL_QUERY_FORMAT:
++    return query_format(*((uint32_t*)data));
++  }
++  return VO_NOTIMPL;
++}
+diff -Naur MPlayer-1.0pre7try2/Makefile MPlayer-1.0pre7try2.s3d/Makefile
+--- MPlayer-1.0pre7try2/Makefile	2005-04-16 22:18:12.000000000 +0200
++++ MPlayer-1.0pre7try2.s3d/Makefile	2006-06-10 18:37:34.000000000 +0200
+@@ -30,7 +30,7 @@
+ OBJS_MENCODER = $(SRCS_MENCODER:.c=.o)
+ OBJS_MPLAYER = $(SRCS_MPLAYER:.c=.o)
+ 
+-VO_LIBS = $(AA_LIB) $(X_LIB) $(SDL_LIB) $(GGI_LIB) $(MP1E_LIB) $(MLIB_LIB) $(SVGA_LIB) $(DIRECTFB_LIB) $(CACA_LIB)
++VO_LIBS = $(AA_LIB) $(X_LIB) $(SDL_LIB) $(GGI_LIB) $(MP1E_LIB) $(MLIB_LIB) $(SVGA_LIB) $(DIRECTFB_LIB) $(CACA_LIB) $(S3D_LIB)
+ AO_LIBS = $(ARTS_LIB) $(ESD_LIB) $(JACK_LIB) $(NAS_LIB) $(SGIAUDIO_LIB) $(POLYP_LIB)
+ CODEC_LIBS = $(AV_LIB) $(FAME_LIB) $(MAD_LIB) $(VORBIS_LIB) $(THEORA_LIB) $(FAAD_LIB) $(LIBLZO_LIB) $(DECORE_LIB) $(XVID_LIB) $(DTS_LIB) $(PNG_LIB) $(Z_LIB) $(JPEG_LIB) $(ALSA_LIB) $(XMMS_LIB) $(X264_LIB)
+ COMMON_LIBS = libmpcodecs/libmpcodecs.a $(W32_LIB) $(DS_LIB) libaf/libaf.a libmpdemux/libmpdemux.a input/libinput.a postproc/libswscale.a osdep/libosdep.a $(DVDREAD_LIB) $(CODEC_LIBS) $(FREETYPE_LIB) $(TERMCAP_LIB) $(CDPARANOIA_LIB) $(MPLAYER_NETWORK_LIB) $(WIN32_LIB) $(GIF_LIB) $(MACOSX_FRAMEWORKS) $(SMBSUPPORT_LIB) $(FRIBIDI_LIB) $(FONTCONFIG_LIB) $(ENCA_LIB)


Property changes on: trunk/extras/mplayer.1.0pre7try2.s3d.patch
___________________________________________________________________
Name: svn:mime-type
   + text/x-patch



From dotslash at berlios.de  Sun Jun 11 16:31:28 2006
From: dotslash at berlios.de (dotslash at BerliOS)
Date: Sun, 11 Jun 2006 16:31:28 +0200
Subject: [S3d-svn] r355 - in trunk: . libs3d
Message-ID: <200606111431.k5BEVSWT024546@sheep.berlios.de>

Author: dotslash
Date: 2006-06-11 16:31:27 +0200 (Sun, 11 Jun 2006)
New Revision: 355

Modified:
   trunk/
   trunk/libs3d/config.h
   trunk/libs3d/io.c
   trunk/libs3d/object_queue.c
   trunk/libs3d/tcp.c
Log:
 r759 at balthasar:  dotslash | 2006-06-11 16:31:17 +0200
 - WITH_SIGNALS -> SIGS, confused it ...
 - some cleanups
 - include ../config.h 



Property changes on: trunk
___________________________________________________________________
Name: svk:merge
   - bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:757
   + bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:759

Modified: trunk/libs3d/config.h
===================================================================
--- trunk/libs3d/config.h	2006-06-10 17:57:03 UTC (rev 354)
+++ trunk/libs3d/config.h	2006-06-11 14:31:27 UTC (rev 355)
@@ -22,6 +22,9 @@
  */
 
 
+/* use the global config.h */
+#include "../config.h" 
+
 /*  this is definitly the better way to pick fonts. */
 
 #define WITH_FONTCONFIG

Modified: trunk/libs3d/io.c
===================================================================
--- trunk/libs3d/io.c	2006-06-10 17:57:03 UTC (rev 354)
+++ trunk/libs3d/io.c	2006-06-11 14:31:27 UTC (rev 355)
@@ -33,8 +33,8 @@
 #include <errno.h>		 /*  errno */
 #include <sys/socket.h>  /*  socket() */
 #include <getopt.h>		 /*  getopt() */
-#include <fcntl.h>		 /*  fcntl() */
 #ifdef SIGS
+#include <fcntl.h>		 /*  fcntl() */
 #include <signal.h>		 /*  signal.h, SIG_PIPE */
 #endif
 #include <netinet/in.h>  /*  htons(),htonl() */
@@ -47,14 +47,6 @@
 /*  this file is the client-lib-implementation which holds the function to connect and control the server. */
 #ifdef SIGS
 int _s3d_sigio=0;
-void sigpipe_handler(int sig, int code)  /*  ... ? */
-{
-	errs("sigpipe_handler()","there is a broken pipe somewhere");
-}
-void sigio_handler(int sig, int code)  /*  ... ? */
-{
-	_s3d_sigio=1;
-}
 void sigint_handler(int sig, int code)  /*  ... ? */
 {
 	/*s3d_quit();*/ /* TODO: sometimes no clean quit ?!*/

Modified: trunk/libs3d/object_queue.c
===================================================================
--- trunk/libs3d/object_queue.c	2006-06-10 17:57:03 UTC (rev 354)
+++ trunk/libs3d/object_queue.c	2006-06-11 14:31:27 UTC (rev 355)
@@ -32,12 +32,13 @@
 /*  access when needed. this also makes things more asynchronous, */
 /*  therefore faster (I hope). */
 
-#define Q_UNUSED	-1				 /*  unused slot magic number */
-#define MAX_REQ		100				 /*  don't request more than that. */
-static unsigned int *queue;			 /*  the object id's */
-static int queue_size=0;			 /*  the size of the object queue */
-static int requested;				 /*  counter of how many addtional */
-									 /*  objects have been requested */
+#define Q_UNUSED	-1				 	/*  unused slot magic number */
+#define MAX_REQ		100				 	/*  don't request more than that. */
+static unsigned int *queue;			 	/*  the object id's */
+static int queue_size=0;			 	/*  the size of the object queue */
+static int requested;				 	/*  counter of how many addtional */
+									 	/*  objects have been requested */
+static struct timespec t={0,10*1000};	/* 10 micro seconds */
 /*  initializes the object queue */
 int _queue_init()
 {
@@ -71,6 +72,7 @@
 		{
 /* 			s3dprintf(LOW,"placing it at position %d",i); */
 			queue[i]=oid;
+			requested--;
 			return(0);
 		}
 	if (queue_size==0) return(-1);  /*  already quit. */
@@ -78,10 +80,10 @@
 /* 	s3dprintf(LOW,"no place for object, resizing stack.",i); */
 	queue=realloc(queue,sizeof(unsigned int)*(queue_size+1));
 	queue_size+=1;
+	requested--;
 	queue[queue_size-1]=oid;
 	return(0);
 }
-static struct timespec t={0,10*1000}; /* 10 micro seconds */
 /*  an object is requested!! give one out: */
 unsigned int _queue_want_object()
 {

Modified: trunk/libs3d/tcp.c
===================================================================
--- trunk/libs3d/tcp.c	2006-06-10 17:57:03 UTC (rev 354)
+++ trunk/libs3d/tcp.c	2006-06-11 14:31:27 UTC (rev 355)
@@ -27,7 +27,6 @@
 #include <stdlib.h>		 /*  malloc(), free() */
 #include <unistd.h>		 /*  read(), write() */
 #include <errno.h>		 /*  errno */
-
 #include <string.h> 	 /*  memcpy() */
 #include <sys/socket.h>
 #include <netinet/in.h>  /*  htons(),htonl() */
@@ -35,7 +34,23 @@
 	#include <sys/select.h>
 	#include <netdb.h>		 /*  gethostbyname()  */
 #endif
+#ifdef SIGS
+#include <fcntl.h>		 /*  fcntl */
+#include <signal.h>		 /*  signal(), SIGPIPE, SIGIO */
+extern int _s3d_sigio;
+#endif
+
 int s3d_socket;		 /*  this is the socket which holds the tcp-socket .... */
+void sigpipe_handler(int sig, int code)  /*  ... ? */
+{
+	errs("sigpipe_handler()","there is a broken pipe somewhere");
+}
+void sigio_handler(int sig, int code)  /*  ... ? */
+{
+	_s3d_sigio=1;
+}
+
+
 int _tcp_init(char *sv, int pn)
 {
 	int 	 			 sd;
@@ -43,7 +58,7 @@
 /*	char			 	*port=NULL;*/
 	struct sockaddr_in 	 sock;
 	struct hostent 		*server=0;
-#ifdef WITH_SIGNALS
+#ifdef SIGS
 	_s3d_sigio=0;
 #endif
 #ifdef WIN32 
@@ -77,7 +92,7 @@
 	}
 /*    if ( fcntl(sd, F_SETFL, O_ASYNC | O_NONBLOCK) < 0 ) */
 /* 		errn("fcntl()",errno); */
-#ifdef WITH_SIGNALS
+#ifdef SIGS 
    if ( fcntl(sd, F_SETFL, O_ASYNC ) < 0 )
 		errn("fcntl()",errno);
    if ( fcntl(sd, F_SETOWN, getpid()) < 0 )



From dotslash at berlios.de  Sun Jun 11 17:46:49 2006
From: dotslash at berlios.de (dotslash at BerliOS)
Date: Sun, 11 Jun 2006 17:46:49 +0200
Subject: [S3d-svn] r356 - in trunk: . extras libs3d
Message-ID: <200606111546.k5BFknIj000211@sheep.berlios.de>

Author: dotslash
Date: 2006-06-11 17:46:48 +0200 (Sun, 11 Jun 2006)
New Revision: 356

Modified:
   trunk/
   trunk/extras/mplayer.1.0pre7try2.s3d.patch
   trunk/libs3d/callback.c
   trunk/libs3d/s3d.h
   trunk/libs3d/s3dlib.h
Log:
 r761 at balthasar:  dotslash | 2006-06-11 17:46:43 +0200
 - fix mplayer patch (no crashing)
 - keyboard support in mplayer
 - s3d_net_check() in the "official" s3d.h (mplayer patch needs that)
 - some more ignores in the static callback list



Property changes on: trunk
___________________________________________________________________
Name: svk:merge
   - bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:759
   + bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:761

Modified: trunk/extras/mplayer.1.0pre7try2.s3d.patch
===================================================================
--- trunk/extras/mplayer.1.0pre7try2.s3d.patch	2006-06-11 14:31:27 UTC (rev 355)
+++ trunk/extras/mplayer.1.0pre7try2.s3d.patch	2006-06-11 15:46:48 UTC (rev 356)
@@ -93,17 +93,20 @@
  #endif
 diff -Naur MPlayer-1.0pre7try2/libvo/vo_s3d.c MPlayer-1.0pre7try2.s3d/libvo/vo_s3d.c
 --- MPlayer-1.0pre7try2/libvo/vo_s3d.c	1970-01-01 01:00:00.000000000 +0100
-+++ MPlayer-1.0pre7try2.s3d/libvo/vo_s3d.c	2006-06-10 19:48:51.000000000 +0200
-@@ -0,0 +1,169 @@
++++ MPlayer-1.0pre7try2.s3d/libvo/vo_s3d.c	2006-06-11 17:44:27.000000000 +0200
+@@ -0,0 +1,262 @@
 +#include <stdio.h>
 +#include <stdlib.h>
 +#include <string.h>
 +#include <errno.h>
 +#include <s3d.h>
++#include <s3d_keysym.h>
 +#include "config.h"
 +#include "video_out.h"
 +#include "video_out_internal.h"
 +#include "mp_msg.h"
++#include "input/mouse.h"
++#include "input/input.h"
 +
 +static vo_info_t info = 
 +{
@@ -138,6 +141,7 @@
 +	}
 +	s3d_load_texture(oid,0,x,y,w,h,data2);
 +	return(0);*/
++	return(0);
 +}
 +
 +static void draw_osd(void)
@@ -205,17 +209,106 @@
 +	s3d_quit();
 +}
 +
++#include "osdep/keycodes.h"
++extern void mplayer_put_key(int code);
 +
 +static void check_events(void)
 +{
++	s3d_net_check();
 +}
++#define shift_key (ki->modifier==(S3D_KMOD_LSHIFT||S3D_KMOD_RSHIFT)) 
++void s3dmp_key(struct s3d_evt *evt)
++{
++	struct s3d_key_event *ki=(struct s3d_key_event *)evt->buf;
++	switch (ki->keysym)
++	{
++		case S3DK_RETURN: mplayer_put_key(KEY_ENTER);break;
++        case S3DK_ESCAPE: mplayer_put_key(KEY_ESC);break;
++		case S3DK_q: mplayer_put_key('q');break;
++ 		case S3DK_F1: mplayer_put_key(KEY_F+1);break;
++ 		case S3DK_F2: mplayer_put_key(KEY_F+2);break;
++ 		case S3DK_F3: mplayer_put_key(KEY_F+3);break;
++ 		case S3DK_F4: mplayer_put_key(KEY_F+4);break;
++ 		case S3DK_F5: mplayer_put_key(KEY_F+5);break;
++ 		case S3DK_F6: mplayer_put_key(KEY_F+6);break;
++ 		case S3DK_F7: mplayer_put_key(KEY_F+7);break;
++ 		case S3DK_F8: mplayer_put_key(KEY_F+8);break;
++ 		case S3DK_F9: mplayer_put_key(KEY_F+9);break;
++ 		case S3DK_F10: mplayer_put_key(KEY_F+10);break;
++ 		case S3DK_F11: mplayer_put_key(KEY_F+11);break;
++ 		case S3DK_F12: mplayer_put_key(KEY_F+12);break;
++                                /*case S3DK_o: mplayer_put_key('o');break;
++                                case S3DK_SPACE: mplayer_put_key(' ');break;
++                                case S3DK_p: mplayer_put_key('p');break;*/
++		case S3DK_7: mplayer_put_key(shift_key?'/':'7');
++        case S3DK_PLUS: mplayer_put_key(shift_key?'*':'+');
++        case S3DK_KP_PLUS: mplayer_put_key('+');break;
++        case S3DK_MINUS:
++        case S3DK_KP_MINUS: mplayer_put_key('-');break;
++		case S3DK_TAB: mplayer_put_key('\t');break;
++		case S3DK_PAGEUP: mplayer_put_key(KEY_PAGE_UP);break;
++		case S3DK_PAGEDOWN: mplayer_put_key(KEY_PAGE_DOWN);break;  
++		case S3DK_UP: mplayer_put_key(KEY_UP);break;
++        case S3DK_DOWN: mplayer_put_key(KEY_DOWN);break;
++        case S3DK_LEFT: mplayer_put_key(KEY_LEFT);break;
++        case S3DK_RIGHT: mplayer_put_key(KEY_RIGHT);break;
++        case S3DK_LESS: mplayer_put_key(shift_key?'>':'<'); break;
++        case S3DK_GREATER: mplayer_put_key('>'); break;
++        case S3DK_ASTERISK:
++		case S3DK_KP_MULTIPLY: mplayer_put_key('*'); break;
++		case S3DK_SLASH:
++		case S3DK_KP_DIVIDE: mplayer_put_key('/'); break;
++		case S3DK_KP0: mplayer_put_key(KEY_KP0); break;
++		case S3DK_KP1: mplayer_put_key(KEY_KP1); break;
++		case S3DK_KP2: mplayer_put_key(KEY_KP2); break;
++		case S3DK_KP3: mplayer_put_key(KEY_KP3); break;
++		case S3DK_KP4: mplayer_put_key(KEY_KP4); break;
++		case S3DK_KP5: mplayer_put_key(KEY_KP5); break;
++		case S3DK_KP6: mplayer_put_key(KEY_KP6); break;
++		case S3DK_KP7: mplayer_put_key(KEY_KP7); break;
++		case S3DK_KP8: mplayer_put_key(KEY_KP8); break;
++		case S3DK_KP9: mplayer_put_key(KEY_KP9); break;
++		case S3DK_KP_PERIOD: mplayer_put_key(KEY_KPDEC); break;
++		case S3DK_KP_ENTER: mplayer_put_key(KEY_KPENTER); break;
++		default:
++			mplayer_put_key(ki->keysym);
++			break;
 +
++	}
++	
++}
++int mbutton;
++void s3dmp_mbutton(struct s3d_evt *evt)
++{
++	struct s3d_but_info *bi=(struct s3d_but_info *)evt->buf;
++	mbutton=-1;
++	if ((bi->state==0) && (!vo_nomouse_input))
++		mbutton=bi->button;
++}
++void s3dmp_obj_click(struct s3d_evt *evt)
++{
++	uint32_t coid=*((uint32_t *)evt->buf);
++	if (coid==oid)
++	{
++		mplayer_put_key(MOUSE_BASE+mbutton-1);
++	}
++	mbutton=-1;
++}
++
++
++
++
 +static uint32_t preinit(const char *arg)
 +{
 +	int argc=0;
 +	char *arg1=NULL;
 +	char **argv=&arg1;
 +    mp_msg (MSGT_VO, MSGL_INFO, "[s3d] hello, i'm initing - darn it!\n");
++	mbutton=-1;
++    s3d_set_callback(S3D_EVENT_MBUTTON,s3dmp_mbutton);
++    s3d_set_callback(S3D_EVENT_OBJ_CLICK,s3dmp_obj_click);
++    s3d_set_callback(S3D_EVENT_KEY,s3dmp_key);
++
 +	if (s3d_init(&argc,&argv,"mplayer"))
 +	{
 +    	mp_msg (MSGT_VO, MSGL_WARN, "[s3d] sorry, can't reach server.\n");

Modified: trunk/libs3d/callback.c
===================================================================
--- trunk/libs3d/callback.c	2006-06-11 14:31:27 UTC (rev 355)
+++ trunk/libs3d/callback.c	2006-06-11 15:46:48 UTC (rev 356)
@@ -26,11 +26,13 @@
 #include "s3dlib.h"
 static void _s3d_ignore(struct s3d_evt *evt);
 /*  the s3d callback list */
+/* i know it's ugly, but it's better to have ugly code somewhere than provoke
+ * race conditions in the applications code */
 s3d_cb s3d_cb_list[MAX_CB]={
-			NULL,_s3d_ignore,_s3d_ignore,_s3d_ignore, NULL,NULL,NULL,NULL, NULL,NULL,NULL,NULL, NULL,NULL,NULL,NULL,
+			NULL,_s3d_ignore,_s3d_ignore,_s3d_ignore, _s3d_ignore,_s3d_ignore,NULL,NULL, NULL,NULL,NULL,NULL, NULL,NULL,NULL,NULL,
 			_s3d_ignore,_s3d_ignore,NULL,NULL, NULL,NULL,NULL,NULL, NULL,NULL,NULL,NULL, NULL,NULL,NULL,NULL,
+			_s3d_ignore,NULL,NULL,NULL, NULL,NULL,NULL,NULL, NULL,NULL,NULL,NULL, NULL,NULL,NULL,NULL,
 			NULL,NULL,NULL,NULL, NULL,NULL,NULL,NULL, NULL,NULL,NULL,NULL, NULL,NULL,NULL,NULL,
-			NULL,NULL,NULL,NULL, NULL,NULL,NULL,NULL, NULL,NULL,NULL,NULL, NULL,NULL,NULL,NULL,
 
 			NULL,NULL,NULL,NULL, NULL,NULL,NULL,NULL, NULL,NULL,NULL,NULL, NULL,NULL,NULL,NULL,
 			NULL,NULL,NULL,NULL, NULL,NULL,NULL,NULL, NULL,NULL,NULL,NULL, NULL,NULL,NULL,NULL,

Modified: trunk/libs3d/s3d.h
===================================================================
--- trunk/libs3d/s3d.h	2006-06-11 14:31:27 UTC (rev 355)
+++ trunk/libs3d/s3d.h	2006-06-11 15:46:48 UTC (rev 356)
@@ -70,7 +70,8 @@
 };
 struct s3d_but_info
 {
-	unsigned char button, state;
+	unsigned char button; /* 0 = left, 1 = middle, 2 = right */
+	unsigned char state;  /* 0 = down, 1 = up, 2 = moving */
 };
 struct s3d_key_event
 {
@@ -178,3 +179,5 @@
 /* mcp special */
 int s3d_mcp_focus(int object);
 
+/* for apps which don't employ s3d_mainloop() */
+int s3d_net_check();

Modified: trunk/libs3d/s3dlib.h
===================================================================
--- trunk/libs3d/s3dlib.h	2006-06-11 14:31:27 UTC (rev 355)
+++ trunk/libs3d/s3dlib.h	2006-06-11 15:46:48 UTC (rev 356)
@@ -65,7 +65,6 @@
 unsigned int _queue_want_object();
 int _queue_quit();
 /*  network.c */
-int s3d_net_check();
 int net_send(unsigned char opcode, char *buf, unsigned short length);
 int s3d_net_init(char *urlc);
 #ifdef TCP



From dotslash at berlios.de  Sun Jun 11 17:47:35 2006
From: dotslash at berlios.de (dotslash at BerliOS)
Date: Sun, 11 Jun 2006 17:47:35 +0200
Subject: [S3d-svn] r357 - in trunk: . server
Message-ID: <200606111547.k5BFlZOD000380@sheep.berlios.de>

Author: dotslash
Date: 2006-06-11 17:47:35 +0200 (Sun, 11 Jun 2006)
New Revision: 357

Modified:
   trunk/
   trunk/server/main.c
Log:
 r763 at balthasar:  dotslash | 2006-06-11 17:47:30 +0200
 - cosmetic changes



Property changes on: trunk
___________________________________________________________________
Name: svk:merge
   - bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:761
   + bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:763

Modified: trunk/server/main.c
===================================================================
--- trunk/server/main.c	2006-06-11 15:46:48 UTC (rev 356)
+++ trunk/server/main.c	2006-06-11 15:47:35 UTC (rev 357)
@@ -164,9 +164,9 @@
 	running=1;
 #ifdef SIGS
     if (signal(SIGINT, sigint_handler) == SIG_ERR) 
-	        errn("network_init():signal()",errno);
+	        errn("init():signal()",errno);
     if (signal(SIGTERM, sigint_handler) == SIG_ERR) 
-	        errn("network_init():signal()",errno);
+	        errn("init():signal()",errno);
 #endif
 	return(0);
 }



From dotslash at berlios.de  Sun Jun 18 19:16:15 2006
From: dotslash at berlios.de (dotslash at BerliOS)
Date: Sun, 18 Jun 2006 19:16:15 +0200
Subject: [S3d-svn] r358 - in trunk: . apps/s3dfm
Message-ID: <200606181716.k5IHGFwQ001526@sheep.berlios.de>

Author: dotslash
Date: 2006-06-18 19:16:09 +0200 (Sun, 18 Jun 2006)
New Revision: 358

Modified:
   trunk/
   trunk/apps/s3dfm/Makefile.am
   trunk/apps/s3dfm/animation.c
   trunk/apps/s3dfm/box.c
   trunk/apps/s3dfm/main.c
   trunk/apps/s3dfm/s3dfm.h
Log:
 r809 at balthasar:  dotslash | 2006-06-18 19:15:57 +0200
 - filesystem routines
 - press F1 to get information about your focused directory



Property changes on: trunk
___________________________________________________________________
Name: svk:merge
   - bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:763
   + bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:809

Modified: trunk/apps/s3dfm/Makefile.am
===================================================================
--- trunk/apps/s3dfm/Makefile.am	2006-06-11 15:47:35 UTC (rev 357)
+++ trunk/apps/s3dfm/Makefile.am	2006-06-18 17:16:09 UTC (rev 358)
@@ -5,9 +5,10 @@
 s3dfminclude_HEADERS =  \
 	s3dfm.h
 s3dfm_SOURCES =  \
-	main.c box.c animation.c
+	main.c box.c animation.c \
+	fs.c dialog.c
 
-s3dfm_CPPFLAGS=	-I${top_srcdir}/libs3d
-s3dfm_LDADD=		${top_builddir}/libs3d/libs3d.la
+s3dfm_CPPFLAGS=		-I${top_srcdir}/libs3d -I${top_srcdir}/libs3dw
+s3dfm_LDADD=		${top_builddir}/libs3d/libs3d.la ${top_builddir}/libs3dw/libs3dw.la
 
 

Modified: trunk/apps/s3dfm/animation.c
===================================================================
--- trunk/apps/s3dfm/animation.c	2006-06-11 15:47:35 UTC (rev 357)
+++ trunk/apps/s3dfm/animation.c	2006-06-18 17:16:09 UTC (rev 358)
@@ -27,13 +27,13 @@
 #define SCALE 	1
 
 /* the animation stack */
-static struct t_item *ani_s[MAXANI];
+static t_item *ani_s[MAXANI];
 static int ani_n=0;
-extern struct t_item root,cam;
+extern t_item root,cam;
 int moveon=1;
 
 /* get the scale for the rootbox zoom */
-float ani_get_scale(struct t_item *f)
+float ani_get_scale(t_item *f)
 {
 	float scale,s;
 	s=0.2;
@@ -52,7 +52,7 @@
 	return(scale);
 }
 /* center f for the viewer, therefore moving the root box ... */
-void ani_focus(struct t_item *f)
+void ani_focus(t_item *f)
 {
 	root.px=0.0;
 	root.py=0.0;
@@ -76,7 +76,7 @@
 	}
 }
 /* is item f already on stack? */
-int ani_onstack(struct t_item *f)
+int ani_onstack(t_item *f)
 {
 	int i;
 	for (i=0;i<ani_n;i++)
@@ -86,7 +86,7 @@
 
 }
 /* add an item on the animation stack */
-void ani_add(struct t_item *f)
+void ani_add(t_item *f)
 {
 	if (ani_n<MAXANI)
 	{
@@ -113,14 +113,14 @@
 	}
 }
 /* well ... */
-void ani_doit(struct t_item *f)
+void ani_doit(t_item *f)
 {
 	s3d_translate(	f->block, f->dpx,f->dpy,f->dpz);
 	s3d_scale(		f->block, f->dscale);
 }
 
 /* finish an animation on the stack, stack index i */
-void ani_finish(struct t_item *f, int i)
+void ani_finish(t_item *f, int i)
 {
 	f->dpx= f->px;
 	f->dpy= f->py;
@@ -130,7 +130,7 @@
 	if (i!=-1)
 		ani_del(i);
 }
-void ani_iterate(struct t_item *f)
+void ani_iterate(t_item *f)
 {
 	f->dpx=(f->px + f->dpx*ZOOMS)/(ZOOMS+1);
 	f->dpy=(f->py + f->dpy*ZOOMS)/(ZOOMS+1);
@@ -140,7 +140,7 @@
 }
 
 /* checks if f is good enough */
-int ani_check(struct t_item *f)
+int ani_check(t_item *f)
 {
 	float x,y,z;
 	x=f->dpx - f->px;
@@ -154,7 +154,7 @@
 void ani_mate()
 {
 	int i;
-	struct t_item *f;
+	t_item *f;
 	for (i=0;i<ani_n;i++)
 	{
 		f=ani_s[i];

Modified: trunk/apps/s3dfm/box.c
===================================================================
--- trunk/apps/s3dfm/box.c	2006-06-11 15:47:35 UTC (rev 357)
+++ trunk/apps/s3dfm/box.c	2006-06-18 17:16:09 UTC (rev 358)
@@ -27,7 +27,7 @@
 #include <string.h>  /*  strlen() */
 
 /* clear the dirs attributes */
-int box_init(struct t_item *dir)
+int box_init(t_item *dir)
 {
 	dir->parent=NULL;
 	dir->list=NULL;
@@ -54,7 +54,7 @@
 	return(0);
 }
 /* draws icon i in the block of dir */
-int box_icon(struct t_item *dir,int i)
+int box_icon(t_item *dir,int i)
 {
 	float vertices[]={	-1,-0.5,0,
 						-1, 0.5,0,
@@ -125,7 +125,7 @@
 
 
 /* places the string at the left side of the cube */
-void box_sidelabel(struct t_item *dir)
+void box_sidelabel(t_item *dir)
 {
 
 	s3d_rotate(dir->str,0,90,0);
@@ -137,11 +137,11 @@
 }
 
 /* creates a big block which will hold files and subdirs on top */
-int box_buildblock(struct t_item *dir)
+int box_buildblock(t_item *dir)
 {
 	char fname[30];
 	char *fullname=fname;
-	struct t_item *d;
+	t_item *d;
 	int i,j;
 	float len;
 	float vertices[]=
@@ -292,7 +292,7 @@
 }
 
 /* display a directoy on the top of another, draw it's icons etc ... */
-int box_expand(struct t_item *dir)
+int box_expand(t_item *dir)
 {
 	int i;
 	float  px,pz;
@@ -342,11 +342,11 @@
 }
 
 /* undisplay a directory, thus recursively removing the kids.*/
-int box_collapse(struct t_item *dir,int force)
+int box_collapse(t_item *dir,int force)
 {
 	int i;
 	int ret;
-	struct t_item *par;
+	t_item *par;
 	if (&root==dir)
 	{
 		printf("won't undisplay root window ... \n");
@@ -401,10 +401,10 @@
 	return(ret);
 }
 /* only display dir and its kids, but nothing below. */
-int box_collapse_grandkids(struct t_item *dir)
+int box_collapse_grandkids(t_item *dir)
 {
 	int i,j;
-	struct t_item *kid;
+	t_item *kid;
 	for (i=0;i<dir->n_item;i++)
 		if (dir->list[i].disp)
 		{
@@ -416,7 +416,7 @@
 }
 /* orders the directory objects on top of its parent objects 
  * to be called after adding or removing things ...*/
-void box_position_kids(struct t_item *dir)
+void box_position_kids(t_item *dir)
 {
 	int i,j;
 /*	printf("placeontop dir %s, %d\n",dir->name,dir->dirs_opened);*/
@@ -453,7 +453,7 @@
 			}
 	}
 }
-void box_select(struct t_item *dir)
+void box_select(t_item *dir)
 {
 	dir->detached=dir->detached?0:1; /* swapping, not sure if !dir->detached would do the same .. */
 	if ((dir->type==T_FOLDER) && dir->disp)

Modified: trunk/apps/s3dfm/main.c
===================================================================
--- trunk/apps/s3dfm/main.c	2006-06-11 15:47:35 UTC (rev 357)
+++ trunk/apps/s3dfm/main.c	2006-06-18 17:16:09 UTC (rev 358)
@@ -23,27 +23,54 @@
 
 
 #include "s3dfm.h"
+#include <s3dw.h>	 /* s3dw_ani_mate() */
 #include <stdio.h> 	 /*  printf() */
 #include <dirent.h>  /*  dirent */
 #include <stdlib.h>	 /*  malloc() */
 #include <string.h>  /*  strlen(), strncmp(), strrchr() */
 #include <time.h>	/* nanosleep() */
 static struct timespec t={0,33*1000*1000}; 
-struct t_item root,cam;
+t_item root,cam,*focus;
 
-void get_path(struct t_item *dir, char *path)
+/* save concatting 2 strings, this version takes argument n
+ * as the size of the buffer of dest. */
+char *mstrncat(char *dest, const char *src, int n)
 {
+	int i,j;
+	dest[n-1]=0;						/* for malformed destinations */
+	j=0;
+	for (i=strlen(dest);i<(n-1);i++)
+	{
+		dest[i]=src[j]; 
+		if (dest[i]==0) break;
+		j++;
+	}
+	for (;i<n;i++)
+		dest[i]=0; /* pad the rest with zero */
+	return(dest);
+}
+/* same as strncpy, but have a terminating zero even if
+ * source is too big */
+char *mstrncpy(char *dest, const char *src, int n)
+{
+	strncpy(dest,src,n);
+	dest[n-1]=0;
+	return(dest);
+}
+/* writes the path of dir into *path. path should be of type path[M_DIR] */
+void get_path(t_item *dir, char *path)
+{
 	if (dir->parent!=NULL)
 	{
 		get_path(dir->parent,path);
-		strncat(path,dir->name,M_DIR);
-		strncat(path,"/",M_DIR);
+		mstrncat(path,dir->name,M_DIR);
+		mstrncat(path,"/",M_DIR);
 	} else
-		strncpy(path,dir->name,M_DIR);
+		mstrncpy(path,dir->name,M_DIR);
 }
-int parse_dir(struct t_item *dir)
+int parse_dir(t_item *dir)
 {
-	struct t_item *list;
+	t_item *list;
 	struct dirent **namelist;
 	int n,i;
 	char *ext,*nstr;
@@ -61,7 +88,7 @@
 	} else {
 		if (dir->n_item>0)
 			free(dir->list); /* this is a refresh, free old items */
-		list=malloc(sizeof(struct t_item)*i);
+		list=malloc(sizeof(t_item)*i);
 		dir->list=list;
 		dir->n_item=n;
 /*		printf("found %d items, processing ...\n",n);*/
@@ -99,10 +126,10 @@
 	return(0);
 }
 /* finds an item in the tree by oid */
-struct t_item *finditem(struct t_item *t, int oid)
+t_item *finditem(t_item *t, int oid)
 {
 	int i;
-	struct t_item *f;
+	t_item *f;
 	if (t->block==oid)		return(t);
 	if (t->str==oid)		return(t);
 	if (t->close==oid)		return(t);
@@ -128,42 +155,10 @@
 	}
 
 }
-/* object click handler */
-void object_click(struct s3d_evt *evt)
-{
-	int oid;
-	struct t_item *f;
-	oid=(int)*((unsigned long *)evt->buf);
-	if (NULL!=(f=finditem(&root,oid)))
-	{
-		if (f->close==oid)
-		{
-			box_collapse(f,1);
-/*			if (f->parent!=NULL)
-				ani_focus(f->parent);*/
-			return;
-		}
-		if (f->select==oid)
-		{
-			printf("[S]electing %s\n",f->name);
-			box_select(f);
-			return;
-		}
-		if (f->type==T_FOLDER)
-		{
-			printf("[F]ound, expanding %s\n",f->name);
-			parse_dir(f);
-			box_expand(f);
-			ani_focus(f);
-		} else
-			printf("[F]ound, but is %s no folder\n",f->name);
-	} else {
-		printf("[C]ould not find :/\n");
-	}
-}
 void mainloop()
 {
 	ani_mate();
+	s3dw_ani_mate();
 	nanosleep(&t,NULL); 
 }
 int main (int argc, char **argv)
@@ -171,13 +166,16 @@
 
 	s3d_set_callback(S3D_EVENT_OBJ_CLICK,object_click);
 	s3d_set_callback(S3D_EVENT_OBJ_INFO,object_info);
+	s3d_set_callback(S3D_EVENT_KEY,key_handler);
 	if (!s3d_init(&argc,&argv,"s3dfm"))	
 	{
 		s3d_select_font("vera");
+
 		
 		/* set up file system representation */
 		box_init(&root);
 		strncpy(root.name,"/",M_NAME);
+		focus=&root;
 		root.dscale=0.1;
 		root.type=T_FOLDER;
 		root.str=s3d_draw_string(root.name,&root.len);

Modified: trunk/apps/s3dfm/s3dfm.h
===================================================================
--- trunk/apps/s3dfm/s3dfm.h	2006-06-11 15:47:35 UTC (rev 357)
+++ trunk/apps/s3dfm/s3dfm.h	2006-06-18 17:16:09 UTC (rev 358)
@@ -45,47 +45,68 @@
 #define ZOOMS 		10
 /* zoomspeed */
 
-struct t_item {
+struct _t_item {
 	int str,close,select,title,titlestr;	/* object ids ...*/
 	int block;								/* oid of the block */
 	int dirs_opened;						/* how many directories are on the block */
 	int detached;							/* if it's detached ... */
 	char name[M_NAME];						/* name (e.g. file name) */
 	float len;
-	struct t_item *parent;					/* parent item */
-	struct t_item *list;					/* list of items  (if it's a subdir)*/
+	struct _t_item *parent;					/* parent item */
+	struct _t_item *list;					/* list of items  (if it's a subdir)*/
 	float px ,py ,pz ,scale;				/* state after animation */
 	float dpx,dpy,dpz,dscale;				/* current state in animation */
 	int n_item;								/* number of items in list ( = -1 for normal or not-expanded files) */
 	int type;								/* type, determined by extension or file type like dir, pipe, link etc */
 	int disp;
 };
+struct _filelist {
+	char **p;
+	int n;
+};
+typedef struct _filelist filelist;
+typedef struct _t_item   t_item;
 
-extern struct t_item root;
+
+extern t_item root;
 /* main.c */
-void get_path(struct t_item *dir, char *path);
-int parse_dir(struct t_item *dir);
-struct t_item *finditem(struct t_item *t, int oid);
-void object_click(struct s3d_evt *evt);
+void get_path(t_item *dir, char *path);
+int parse_dir(t_item *dir);
+t_item *finditem(t_item *t, int oid);
 void mainloop();
 /* animation.c */
-float ani_get_scale(struct t_item *f);
-void ani_focus(struct t_item *f);
+float ani_get_scale(t_item *f);
+void ani_focus(t_item *f);
 void ani_mate();
-void ani_add(struct t_item *f);
+void ani_add(t_item *f);
 void ani_del(int i);
-void ani_doit(struct t_item *f);
-void ani_finish(struct t_item *f, int i);
-void ani_iterate(struct t_item *f);
-int ani_check(struct t_item *f);
-int ani_onstack(struct t_item *f);
-/* display.c */
-int box_collapse(struct t_item *dir,int force);
-int box_collapse_grandkids(struct t_item *dir);
-int box_expand(struct t_item *dir);
-int box_buildblock(struct t_item *dir);
-int box_icon(struct t_item *dir,int i);
-int box_init(struct t_item *dir);
-void box_sidelabel(struct t_item *dir);
-void box_position_kids(struct t_item *dir);
-void box_select(struct t_item *dir);
+void ani_doit(t_item *f);
+void ani_finish(t_item *f, int i);
+void ani_iterate(t_item *f);
+int ani_check(t_item *f);
+int ani_onstack(t_item *f);
+/* box.c */
+int box_collapse(t_item *dir,int force);
+int box_collapse_grandkids(t_item *dir);
+int box_expand(t_item *dir);
+int box_buildblock(t_item *dir);
+int box_icon(t_item *dir,int i);
+int box_init(t_item *dir);
+void box_sidelabel(t_item *dir);
+void box_position_kids(t_item *dir);
+void box_select(t_item *dir);
+/* fs.c */
+filelist *fl_new(char *path);
+void fl_del(filelist *fl);
+int fs_copy(char *source, char *dest);
+int fs_move(char *source, char *dest);
+int fs_unlink(char *dest);
+void fs_approx(char *source, int *files, int *dirs, int *bytes);
+int fs_fl_copy(filelist *fl, char *dest);
+int fs_fl_move(filelist *fl, char *dest);
+int fs_fl_unlink(filelist *fl);
+void fs_fl_approx(filelist *fl, int *files, int *dirs, int *bytes);
+/* dialog.c */
+void key_handler(struct s3d_evt *evt);
+void object_click(struct s3d_evt *evt);
+void info_window(char *path);



From dotslash at berlios.de  Sun Jun 18 20:26:14 2006
From: dotslash at berlios.de (dotslash at BerliOS)
Date: Sun, 18 Jun 2006 20:26:14 +0200
Subject: [S3d-svn] r359 - in trunk: . apps/s3dfm
Message-ID: <200606181826.k5IIQECI023049@sheep.berlios.de>

Author: dotslash
Date: 2006-06-18 20:26:12 +0200 (Sun, 18 Jun 2006)
New Revision: 359

Added:
   trunk/apps/s3dfm/dialog.c
   trunk/apps/s3dfm/fs.c
Modified:
   trunk/
Log:
 r811 at balthasar:  dotslash | 2006-06-18 20:26:03 +0200
 - as always, I forget to add new files ...



Property changes on: trunk
___________________________________________________________________
Name: svk:merge
   - bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:809
   + bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:811

Added: trunk/apps/s3dfm/dialog.c
===================================================================
--- trunk/apps/s3dfm/dialog.c	2006-06-18 17:16:09 UTC (rev 358)
+++ trunk/apps/s3dfm/dialog.c	2006-06-18 18:26:12 UTC (rev 359)
@@ -0,0 +1,111 @@
+/*
+ * dialog.c
+ * Copyright (C) 2004-2006 Simon Wunderlich <dotslash at packetmixer.de>
+ *
+ * This file is part of s3dfm, a s3d file manager.
+ * See http://s3d.berlios.de/ for more updates.
+ * 
+ * s3dfm is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2 of the License, or
+ * (at your option) any later version.
+ * 
+ * s3dfm is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ * 
+ * You should have received a copy of the GNU General Public License
+ * along with s3dfm; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
+ */
+
+
+#include "s3dfm.h"
+#include <s3d_keysym.h>
+#include <s3dw.h>
+#include <stdio.h> 	/* NULL, printf() */
+#include <string.h> /* strlen() */
+extern t_item *focus;
+/* keyevent handler */
+void key_handler(struct s3d_evt *evt)
+{
+	struct s3d_key_event *keys=(struct s3d_key_event *)evt->buf;
+	switch (keys->keysym)
+	{
+		case S3DK_F1:
+				{
+				char path[M_DIR];
+				get_path(focus,path);
+				info_window(path);
+				}
+	}
+	s3dw_handle_key(evt);
+}
+
+/* object click handler */
+void object_click(struct s3d_evt *evt)
+{
+	int oid;
+	t_item *f;
+	s3dw_handle_click(evt);
+	oid=(int)*((unsigned long *)evt->buf);
+	if (NULL!=(f=finditem(&root,oid)))
+	{
+		if (f->close==oid)
+		{
+			box_collapse(f,1);
+/*			if (f->parent!=NULL)
+				ani_focus(f->parent);*/
+			return;
+		}
+		if (f->select==oid)
+		{
+			printf("[S]electing %s\n",f->name);
+			box_select(f);
+			return;
+		}
+		if (f->type==T_FOLDER)
+		{
+			printf("[F]ound, expanding %s\n",f->name);
+			parse_dir(f);
+			box_expand(f);
+			focus=f;
+			ani_focus(f);
+		} else
+			printf("[F]ound, but is %s no folder\n",f->name);
+	} else {
+		printf("[C]ould not find :/\n");
+	}
+}
+void close_win(s3dw_widget *button)
+{
+	s3dw_delete(button->parent); /* parent =surface. this means close containing window */
+}
+
+void info_window(char *path)
+{
+	s3dw_surface *infwin;
+	s3dw_button  *button;
+	char string1[M_DIR];
+	char string2[M_DIR];
+	int b,d,f;
+	float l;
+	snprintf(string1,M_DIR,"Info for %s",path);
+	fs_approx(path, &f, &d, &b);
+	snprintf(string2 ,M_DIR,"%d bytes in %d files and %d Directories",b,f,d);
+	
+	l=((strlen(string1)>strlen(string2)) ? strlen(string1) :strlen(string2))*0.7;
+	
+	infwin=s3dw_surface_new("Info Window",l,12);
+
+	s3dw_label_new(infwin,string1,1,2);
+	s3dw_label_new(infwin,string2,1,4);
+
+	button=s3dw_button_new(infwin,"OK",l/2-1,6);
+	/* clicking on the button will exit ... */
+	button->onclick=close_win;
+	/* of couse, show it */
+	s3dw_show(S3DWIDGET(infwin));
+
+}

Added: trunk/apps/s3dfm/fs.c
===================================================================
--- trunk/apps/s3dfm/fs.c	2006-06-18 17:16:09 UTC (rev 358)
+++ trunk/apps/s3dfm/fs.c	2006-06-18 18:26:12 UTC (rev 359)
@@ -0,0 +1,302 @@
+/*
+ * fs.c 
+ * Copyright (C) 2004-2006 Simon Wunderlich <dotslash at packetmixer.de>
+ *
+ * This file is part of s3dfm, a s3d file manager.
+ * See http://s3d.berlios.de/ for more updates.
+ * 
+ * s3dfm is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2 of the License, or
+ * (at your option) any later version.
+ * 
+ * s3dfm is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ * 
+ * You should have received a copy of the GNU General Public License
+ * along with s3dfm; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
+ */
+
+#include "s3dfm.h"
+#include <stdio.h>	/*  printf() */
+#include <dirent.h>	/* scandir() */
+#include <stdlib.h>	/*  malloc() */
+
+/* we want GNU version of basename */
+#define _GNU_SOURCE 
+#include <string.h>	/*  strlen(), strncmp(), strrchr() */
+#include <libgen.h> /* basename() */
+
+#include <sys/types.h>
+#include <sys/stat.h>
+#include <unistd.h>
+
+#include <errno.h>
+
+
+
+
+/* generates the file list */
+filelist *fl_new(char *path)
+{
+	struct dirent **namelist;
+	filelist *fl;
+	int n,i,j;
+	char *name;
+
+	fl=malloc(sizeof(filelist));
+	fl->p=NULL;
+	fl->n=0;
+    n = scandir(path, &namelist, 0, alphasort);
+    if (n <= 2) /* . and .. is always included. */
+	{
+		if (n<0)
+	        perror("scandir");
+	} else {
+		j=0;
+		fl->n=n-2 ; /* ignore . and .. */
+		fl->p=malloc(sizeof(char *)*fl->n);
+		for (i=0;i<n;i++)
+		{
+			name=namelist[i]->d_name;
+			if (!((strcmp(name,".")==0) || (strcmp(name,"..")==0))) /* ignore */
+			{
+				fl->p[j]=malloc(strlen(name)+strlen(path)+2);
+				strcpy(fl->p[j],path);
+				strcat(fl->p[j],"/");
+				strcat(fl->p[j],name);
+				j++;
+			}
+			free(namelist[i]);
+		}
+		if (j!=fl->n)
+		{
+			printf("assertion failed\n");
+			exit(-1);
+		}
+		free (namelist);
+	}
+	return(fl);	
+}
+/* delete the filelist */
+void fl_del(filelist *fl)
+{
+	int i;
+	for (i=0;i<fl->n;i++)
+	{
+		free(fl->p[i]);
+	}
+	free(fl);
+}
+/* approximate the heaviness of a single */
+void fs_approx(char *source, int *files, int *dirs, int *bytes)
+{
+	int sfiles,sdirs,sbytes; 	/* for subdirs */
+	filelist *fl;
+	struct stat s;
+
+	*files=	sfiles=	0;
+	*dirs=	sdirs=	0;
+	*bytes=	sbytes=	0;
+
+	printf("start: %d files, %d dirs, %d bytes in %s\n",*files,*dirs,*bytes,source);
+	if (-1==stat(source,&s))
+		return;
+/*	printf("%s: %08x (%db)\n",source,s.st_mode,(int)s.st_size);*/
+	if ((s.st_mode&S_IFMT) == S_IFDIR)
+	{
+		
+		fl=fl_new(source);
+		if (fl->n>0)
+			fs_fl_approx(fl,&sfiles,&sdirs,&sbytes);
+		fl_del(fl);
+		printf("%d files, %d dirs, %d bytes in %s\n",sfiles,sdirs,sbytes,source);
+
+		*files=		sfiles;
+		*bytes+=	sbytes;
+		*dirs=		sdirs;
+		*dirs+=		1;
+	} else 
+		*files=		1;
+	*bytes+=s.st_size;
+	printf("end: %d files, %d dirs, %d bytes in %s\n",*files,*dirs,*bytes,source);
+}
+/* approximate the heaviness of our source ...*/
+void fs_fl_approx(filelist *fl, int *files, int *dirs, int *bytes)
+{
+	int i;
+	int sfiles,sdirs,sbytes; 	/* for subdirs */
+
+	*files=0;
+	*dirs=0;
+	*bytes=0;
+
+	for (i=0;i<fl->n;i++)
+	{
+		fs_approx(fl->p[i],&sfiles,&sdirs,&sbytes);
+		*files+=		sfiles;
+		*dirs+=			sdirs;
+		*bytes+=		sbytes;
+	}
+}
+/* copy a certain file */
+int fs_copy(char *source, char *dest)
+{
+	FILE *fps, *fpd;
+	filelist *fl;
+	struct stat s;
+	char buf[1024];
+	int n;
+	if (-1==stat(source,&s))
+		return(0);
+	switch (s.st_mode&S_IFMT)
+	{
+		case S_IFDIR:
+			fl=fl_new(source);
+		
+			printf("mkdir %s\n",dest);
+			mkdir(dest,0777);
+		
+			fs_fl_copy(fl, dest);
+
+			fl_del(fl);
+			break;
+		case S_IFIFO:
+			printf("link the fifo\n");
+
+			link(source,dest);
+			break;
+		default:
+			printf("atomic copy ... from %s to %s\n", source, dest);
+			if (NULL==(fps=fopen(source,"r"))) return(-1);
+			if (NULL==(fpd=fopen(dest,"w"))) return(-1);
+			/* TODO: overwrite protection etc */
+		
+			while (!feof(fps))
+			{
+				n=fread(buf,1,1024,fps);
+				fwrite(buf,1,n,fpd);
+			}
+			fclose(fps);
+			fclose(fpd);
+
+	}
+	return(0);
+}
+/* copy the source to the destination, destination should be a directory. */
+int fs_fl_copy(filelist *fl, char *dest)
+{
+	int i;
+	int r;
+	char *sdest;
+	char *bname;
+	r=0;
+	for (i=0;i<fl->n;i++)
+	{
+		bname=basename(fl->p[i]);
+		sdest=malloc(strlen(dest)+strlen(bname)+2);
+
+		strcpy(sdest,dest);
+		strcat(sdest,"/");
+		strcat(sdest,bname);
+		r|=fs_copy(fl->p[i],sdest);
+
+		free(sdest);
+	}
+
+	return(r);
+}
+/* recursively unlink a dir or file. */
+int fs_unlink(char *dest)
+{
+	filelist *fl;
+	struct stat s;
+	
+	if (-1==stat(dest,&s))		return(-1);
+	if ((s.st_mode&S_IFMT) == S_IFDIR)
+	{
+		printf("%s is a dir, removing below ...\n",dest);
+		fl=fl_new(dest);
+		if (fs_fl_unlink(fl)) {
+			fl_del(fl);
+			return(-1);
+		} else {
+			fl_del(fl);
+			printf("removing %s\n",dest);
+			if (rmdir(dest)==-1)
+			{
+				perror("fs_fl_unlink(): rmdir()");
+				return(-1);
+			}
+		}
+	} else {
+		if (unlink(dest)==-1)
+		{
+			perror("fs_fl_unlink(): unlink()");
+			return(-1);
+		}
+	}
+	return(0);
+}
+/* remove a lot of files */
+int fs_fl_unlink(filelist *fl)
+{
+	int i,r;
+	r=0;
+	for (i=0;i<fl->n;i++)
+	{
+		printf("-> atomic unlink %s\n",fl->p[i]);
+		r|=fs_unlink(fl->p[i]);
+	}
+	return(r);
+
+}
+int fs_move(char *source, char *dest)
+{
+	if (!rename(source,dest))
+	{
+		switch (errno)
+		{
+			case EXDEV:
+				fs_copy(source,dest);
+				fs_unlink(source);
+				break;
+			default: 
+				perror("fs_move()");
+				return(-1); /* can't help it */
+			
+		}
+	}
+	return(0);	
+}
+
+/* moves the source to the destination */
+int fs_fl_move(filelist *fl, char *dest)
+{
+	int i;
+	int r;
+	char *sdest;
+	char *bname;
+	r=0;
+	for (i=0;i<fl->n;i++)
+	{
+		bname=basename(fl->p[i]);
+		sdest=malloc(strlen(dest)+strlen(bname)+2);
+
+		strcpy(sdest,dest);
+		strcat(sdest,"/");
+		strcat(sdest,bname);
+		r|=fs_move(fl->p[i],sdest);
+
+		free(sdest);
+	}
+
+	return(r);
+
+	return(0);
+}
+
+



From dotslash at berlios.de  Sun Jun 25 14:11:57 2006
From: dotslash at berlios.de (dotslash at BerliOS)
Date: Sun, 25 Jun 2006 14:11:57 +0200
Subject: [S3d-svn] r360 - in trunk: . libs3d/libg3d
Message-ID: <200606251211.k5PCBvra023221@sheep.berlios.de>

Author: dotslash
Date: 2006-06-25 14:11:51 +0200 (Sun, 25 Jun 2006)
New Revision: 360

Removed:
   trunk/libs3d/libg3d/configure
Modified:
   trunk/
Log:
 r827 at balthasar:  dotslash | 2006-06-25 14:11:35 +0200
 - delete g3d-configure, we use autogen from s3d-root



Property changes on: trunk
___________________________________________________________________
Name: svk:merge
   - bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:811
   + bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:827

Deleted: trunk/libs3d/libg3d/configure
===================================================================
--- trunk/libs3d/libg3d/configure	2006-06-18 18:26:12 UTC (rev 359)
+++ trunk/libs3d/libg3d/configure	2006-06-25 12:11:51 UTC (rev 360)
@@ -1,21532 +0,0 @@
-#! /bin/sh
-# Guess values for system-dependent variables and create Makefiles.
-# Generated by GNU Autoconf 2.59.
-#
-# Copyright (C) 2003 Free Software Foundation, Inc.
-# This configure script is free software; the Free Software Foundation
-# gives unlimited permission to copy, distribute and modify it.
-## --------------------- ##
-## M4sh Initialization.  ##
-## --------------------- ##
-
-# Be Bourne compatible
-if test -n "${ZSH_VERSION+set}" && (emulate sh) >/dev/null 2>&1; then
-  emulate sh
-  NULLCMD=:
-  # Zsh 3.x and 4.x performs word splitting on ${1+"$@"}, which
-  # is contrary to our usage.  Disable this feature.
-  alias -g '${1+"$@"}'='"$@"'
-elif test -n "${BASH_VERSION+set}" && (set -o posix) >/dev/null 2>&1; then
-  set -o posix
-fi
-DUALCASE=1; export DUALCASE # for MKS sh
-
-# Support unset when possible.
-if ( (MAIL=60; unset MAIL) || exit) >/dev/null 2>&1; then
-  as_unset=unset
-else
-  as_unset=false
-fi
-
-
-# Work around bugs in pre-3.0 UWIN ksh.
-$as_unset ENV MAIL MAILPATH
-PS1='$ '
-PS2='> '
-PS4='+ '
-
-# NLS nuisances.
-for as_var in \
-  LANG LANGUAGE LC_ADDRESS LC_ALL LC_COLLATE LC_CTYPE LC_IDENTIFICATION \
-  LC_MEASUREMENT LC_MESSAGES LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER \
-  LC_TELEPHONE LC_TIME
-do
-  if (set +x; test -z "`(eval $as_var=C; export $as_var) 2>&1`"); then
-    eval $as_var=C; export $as_var
-  else
-    $as_unset $as_var
-  fi
-done
-
-# Required to use basename.
-if expr a : '\(a\)' >/dev/null 2>&1; then
-  as_expr=expr
-else
-  as_expr=false
-fi
-
-if (basename /) >/dev/null 2>&1 && test "X`basename / 2>&1`" = "X/"; then
-  as_basename=basename
-else
-  as_basename=false
-fi
-
-
-# Name of the executable.
-as_me=`$as_basename "$0" ||
-$as_expr X/"$0" : '.*/\([^/][^/]*\)/*$' \| \
-	 X"$0" : 'X\(//\)$' \| \
-	 X"$0" : 'X\(/\)$' \| \
-	 .     : '\(.\)' 2>/dev/null ||
-echo X/"$0" |
-    sed '/^.*\/\([^/][^/]*\)\/*$/{ s//\1/; q; }
-  	  /^X\/\(\/\/\)$/{ s//\1/; q; }
-  	  /^X\/\(\/\).*/{ s//\1/; q; }
-  	  s/.*/./; q'`
-
-
-# PATH needs CR, and LINENO needs CR and PATH.
-# Avoid depending upon Character Ranges.
-as_cr_letters='abcdefghijklmnopqrstuvwxyz'
-as_cr_LETTERS='ABCDEFGHIJKLMNOPQRSTUVWXYZ'
-as_cr_Letters=$as_cr_letters$as_cr_LETTERS
-as_cr_digits='0123456789'
-as_cr_alnum=$as_cr_Letters$as_cr_digits
-
-# The user is always right.
-if test "${PATH_SEPARATOR+set}" != set; then
-  echo "#! /bin/sh" >conf$$.sh
-  echo  "exit 0"   >>conf$$.sh
-  chmod +x conf$$.sh
-  if (PATH="/nonexistent;."; conf$$.sh) >/dev/null 2>&1; then
-    PATH_SEPARATOR=';'
-  else
-    PATH_SEPARATOR=:
-  fi
-  rm -f conf$$.sh
-fi
-
-
-  as_lineno_1=$LINENO
-  as_lineno_2=$LINENO
-  as_lineno_3=`(expr $as_lineno_1 + 1) 2>/dev/null`
-  test "x$as_lineno_1" != "x$as_lineno_2" &&
-  test "x$as_lineno_3"  = "x$as_lineno_2"  || {
-  # Find who we are.  Look in the path if we contain no path at all
-  # relative or not.
-  case $0 in
-    *[\\/]* ) as_myself=$0 ;;
-    *) as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  test -r "$as_dir/$0" && as_myself=$as_dir/$0 && break
-done
-
-       ;;
-  esac
-  # We did not find ourselves, most probably we were run as `sh COMMAND'
-  # in which case we are not to be found in the path.
-  if test "x$as_myself" = x; then
-    as_myself=$0
-  fi
-  if test ! -f "$as_myself"; then
-    { echo "$as_me: error: cannot find myself; rerun with an absolute path" >&2
-   { (exit 1); exit 1; }; }
-  fi
-  case $CONFIG_SHELL in
-  '')
-    as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in /bin$PATH_SEPARATOR/usr/bin$PATH_SEPARATOR$PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for as_base in sh bash ksh sh5; do
-	 case $as_dir in
-	 /*)
-	   if ("$as_dir/$as_base" -c '
-  as_lineno_1=$LINENO
-  as_lineno_2=$LINENO
-  as_lineno_3=`(expr $as_lineno_1 + 1) 2>/dev/null`
-  test "x$as_lineno_1" != "x$as_lineno_2" &&
-  test "x$as_lineno_3"  = "x$as_lineno_2" ') 2>/dev/null; then
-	     $as_unset BASH_ENV || test "${BASH_ENV+set}" != set || { BASH_ENV=; export BASH_ENV; }
-	     $as_unset ENV || test "${ENV+set}" != set || { ENV=; export ENV; }
-	     CONFIG_SHELL=$as_dir/$as_base
-	     export CONFIG_SHELL
-	     exec "$CONFIG_SHELL" "$0" ${1+"$@"}
-	   fi;;
-	 esac
-       done
-done
-;;
-  esac
-
-  # Create $as_me.lineno as a copy of $as_myself, but with $LINENO
-  # uniformly replaced by the line number.  The first 'sed' inserts a
-  # line-number line before each line; the second 'sed' does the real
-  # work.  The second script uses 'N' to pair each line-number line
-  # with the numbered line, and appends trailing '-' during
-  # substitution so that $LINENO is not a special case at line end.
-  # (Raja R Harinath suggested sed '=', and Paul Eggert wrote the
-  # second 'sed' script.  Blame Lee E. McMahon for sed's syntax.  :-)
-  sed '=' <$as_myself |
-    sed '
-      N
-      s,$,-,
-      : loop
-      s,^\(['$as_cr_digits']*\)\(.*\)[$]LINENO\([^'$as_cr_alnum'_]\),\1\2\1\3,
-      t loop
-      s,-$,,
-      s,^['$as_cr_digits']*\n,,
-    ' >$as_me.lineno &&
-  chmod +x $as_me.lineno ||
-    { echo "$as_me: error: cannot create $as_me.lineno; rerun with a POSIX shell" >&2
-   { (exit 1); exit 1; }; }
-
-  # Don't try to exec as it changes $[0], causing all sort of problems
-  # (the dirname of $[0] is not the place where we might find the
-  # original and so on.  Autoconf is especially sensible to this).
-  . ./$as_me.lineno
-  # Exit status is that of the last command.
-  exit
-}
-
-
-case `echo "testing\c"; echo 1,2,3`,`echo -n testing; echo 1,2,3` in
-  *c*,-n*) ECHO_N= ECHO_C='
-' ECHO_T='	' ;;
-  *c*,*  ) ECHO_N=-n ECHO_C= ECHO_T= ;;
-  *)       ECHO_N= ECHO_C='\c' ECHO_T= ;;
-esac
-
-if expr a : '\(a\)' >/dev/null 2>&1; then
-  as_expr=expr
-else
-  as_expr=false
-fi
-
-rm -f conf$$ conf$$.exe conf$$.file
-echo >conf$$.file
-if ln -s conf$$.file conf$$ 2>/dev/null; then
-  # We could just check for DJGPP; but this test a) works b) is more generic
-  # and c) will remain valid once DJGPP supports symlinks (DJGPP 2.04).
-  if test -f conf$$.exe; then
-    # Don't use ln at all; we don't have any links
-    as_ln_s='cp -p'
-  else
-    as_ln_s='ln -s'
-  fi
-elif ln conf$$.file conf$$ 2>/dev/null; then
-  as_ln_s=ln
-else
-  as_ln_s='cp -p'
-fi
-rm -f conf$$ conf$$.exe conf$$.file
-
-if mkdir -p . 2>/dev/null; then
-  as_mkdir_p=:
-else
-  test -d ./-p && rmdir ./-p
-  as_mkdir_p=false
-fi
-
-as_executable_p="test -f"
-
-# Sed expression to map a string onto a valid CPP name.
-as_tr_cpp="eval sed 'y%*$as_cr_letters%P$as_cr_LETTERS%;s%[^_$as_cr_alnum]%_%g'"
-
-# Sed expression to map a string onto a valid variable name.
-as_tr_sh="eval sed 'y%*+%pp%;s%[^_$as_cr_alnum]%_%g'"
-
-
-# IFS
-# We need space, tab and new line, in precisely that order.
-as_nl='
-'
-IFS=" 	$as_nl"
-
-# CDPATH.
-$as_unset CDPATH
-
-
-
-# Check that we are running under the correct shell.
-SHELL=${CONFIG_SHELL-/bin/sh}
-
-case X$ECHO in
-X*--fallback-echo)
-  # Remove one level of quotation (which was required for Make).
-  ECHO=`echo "$ECHO" | sed 's,\\\\\$\\$0,'$0','`
-  ;;
-esac
-
-echo=${ECHO-echo}
-if test "X$1" = X--no-reexec; then
-  # Discard the --no-reexec flag, and continue.
-  shift
-elif test "X$1" = X--fallback-echo; then
-  # Avoid inline document here, it may be left over
-  :
-elif test "X`($echo '\t') 2>/dev/null`" = 'X\t' ; then
-  # Yippee, $echo works!
-  :
-else
-  # Restart under the correct shell.
-  exec $SHELL "$0" --no-reexec ${1+"$@"}
-fi
-
-if test "X$1" = X--fallback-echo; then
-  # used as fallback echo
-  shift
-  cat <<EOF
-$*
-EOF
-  exit 0
-fi
-
-# The HP-UX ksh and POSIX shell print the target directory to stdout
-# if CDPATH is set.
-if test "X${CDPATH+set}" = Xset; then CDPATH=:; export CDPATH; fi
-
-if test -z "$ECHO"; then
-if test "X${echo_test_string+set}" != Xset; then
-# find a string as large as possible, as long as the shell can cope with it
-  for cmd in 'sed 50q "$0"' 'sed 20q "$0"' 'sed 10q "$0"' 'sed 2q "$0"' 'echo test'; do
-    # expected sizes: less than 2Kb, 1Kb, 512 bytes, 16 bytes, ...
-    if (echo_test_string="`eval $cmd`") 2>/dev/null &&
-       echo_test_string="`eval $cmd`" &&
-       (test "X$echo_test_string" = "X$echo_test_string") 2>/dev/null
-    then
-      break
-    fi
-  done
-fi
-
-if test "X`($echo '\t') 2>/dev/null`" = 'X\t' &&
-   echo_testing_string=`($echo "$echo_test_string") 2>/dev/null` &&
-   test "X$echo_testing_string" = "X$echo_test_string"; then
-  :
-else
-  # The Solaris, AIX, and Digital Unix default echo programs unquote
-  # backslashes.  This makes it impossible to quote backslashes using
-  #   echo "$something" | sed 's/\\/\\\\/g'
-  #
-  # So, first we look for a working echo in the user's PATH.
-
-  lt_save_ifs="$IFS"; IFS=$PATH_SEPARATOR
-  for dir in $PATH /usr/ucb; do
-    IFS="$lt_save_ifs"
-    if (test -f $dir/echo || test -f $dir/echo$ac_exeext) &&
-       test "X`($dir/echo '\t') 2>/dev/null`" = 'X\t' &&
-       echo_testing_string=`($dir/echo "$echo_test_string") 2>/dev/null` &&
-       test "X$echo_testing_string" = "X$echo_test_string"; then
-      echo="$dir/echo"
-      break
-    fi
-  done
-  IFS="$lt_save_ifs"
-
-  if test "X$echo" = Xecho; then
-    # We didn't find a better echo, so look for alternatives.
-    if test "X`(print -r '\t') 2>/dev/null`" = 'X\t' &&
-       echo_testing_string=`(print -r "$echo_test_string") 2>/dev/null` &&
-       test "X$echo_testing_string" = "X$echo_test_string"; then
-      # This shell has a builtin print -r that does the trick.
-      echo='print -r'
-    elif (test -f /bin/ksh || test -f /bin/ksh$ac_exeext) &&
-	 test "X$CONFIG_SHELL" != X/bin/ksh; then
-      # If we have ksh, try running configure again with it.
-      ORIGINAL_CONFIG_SHELL=${CONFIG_SHELL-/bin/sh}
-      export ORIGINAL_CONFIG_SHELL
-      CONFIG_SHELL=/bin/ksh
-      export CONFIG_SHELL
-      exec $CONFIG_SHELL "$0" --no-reexec ${1+"$@"}
-    else
-      # Try using printf.
-      echo='printf %s\n'
-      if test "X`($echo '\t') 2>/dev/null`" = 'X\t' &&
-	 echo_testing_string=`($echo "$echo_test_string") 2>/dev/null` &&
-	 test "X$echo_testing_string" = "X$echo_test_string"; then
-	# Cool, printf works
-	:
-      elif echo_testing_string=`($ORIGINAL_CONFIG_SHELL "$0" --fallback-echo '\t') 2>/dev/null` &&
-	   test "X$echo_testing_string" = 'X\t' &&
-	   echo_testing_string=`($ORIGINAL_CONFIG_SHELL "$0" --fallback-echo "$echo_test_string") 2>/dev/null` &&
-	   test "X$echo_testing_string" = "X$echo_test_string"; then
-	CONFIG_SHELL=$ORIGINAL_CONFIG_SHELL
-	export CONFIG_SHELL
-	SHELL="$CONFIG_SHELL"
-	export SHELL
-	echo="$CONFIG_SHELL $0 --fallback-echo"
-      elif echo_testing_string=`($CONFIG_SHELL "$0" --fallback-echo '\t') 2>/dev/null` &&
-	   test "X$echo_testing_string" = 'X\t' &&
-	   echo_testing_string=`($CONFIG_SHELL "$0" --fallback-echo "$echo_test_string") 2>/dev/null` &&
-	   test "X$echo_testing_string" = "X$echo_test_string"; then
-	echo="$CONFIG_SHELL $0 --fallback-echo"
-      else
-	# maybe with a smaller string...
-	prev=:
-
-	for cmd in 'echo test' 'sed 2q "$0"' 'sed 10q "$0"' 'sed 20q "$0"' 'sed 50q "$0"'; do
-	  if (test "X$echo_test_string" = "X`eval $cmd`") 2>/dev/null
-	  then
-	    break
-	  fi
-	  prev="$cmd"
-	done
-
-	if test "$prev" != 'sed 50q "$0"'; then
-	  echo_test_string=`eval $prev`
-	  export echo_test_string
-	  exec ${ORIGINAL_CONFIG_SHELL-${CONFIG_SHELL-/bin/sh}} "$0" ${1+"$@"}
-	else
-	  # Oops.  We lost completely, so just stick with echo.
-	  echo=echo
-	fi
-      fi
-    fi
-  fi
-fi
-fi
-
-# Copy echo and quote the copy suitably for passing to libtool from
-# the Makefile, instead of quoting the original, which is used later.
-ECHO=$echo
-if test "X$ECHO" = "X$CONFIG_SHELL $0 --fallback-echo"; then
-   ECHO="$CONFIG_SHELL \\\$\$0 --fallback-echo"
-fi
-
-
-
-
-tagnames=${tagnames+${tagnames},}CXX
-
-tagnames=${tagnames+${tagnames},}F77
-
-# Name of the host.
-# hostname on some systems (SVR3.2, Linux) returns a bogus exit status,
-# so uname gets run too.
-ac_hostname=`(hostname || uname -n) 2>/dev/null | sed 1q`
-
-exec 6>&1
-
-#
-# Initializations.
-#
-ac_default_prefix=/usr/local
-ac_config_libobj_dir=.
-cross_compiling=no
-subdirs=
-MFLAGS=
-MAKEFLAGS=
-SHELL=${CONFIG_SHELL-/bin/sh}
-
-# Maximum number of lines to put in a shell here document.
-# This variable seems obsolete.  It should probably be removed, and
-# only ac_max_sed_lines should be used.
-: ${ac_max_here_lines=38}
-
-# Identity of this package.
-PACKAGE_NAME=
-PACKAGE_TARNAME=
-PACKAGE_VERSION=
-PACKAGE_STRING=
-PACKAGE_BUGREPORT=
-
-ac_unique_file="configure.in"
-# Factoring default headers for most tests.
-ac_includes_default="\
-#include <stdio.h>
-#if HAVE_SYS_TYPES_H
-# include <sys/types.h>
-#endif
-#if HAVE_SYS_STAT_H
-# include <sys/stat.h>
-#endif
-#if STDC_HEADERS
-# include <stdlib.h>
-# include <stddef.h>
-#else
-# if HAVE_STDLIB_H
-#  include <stdlib.h>
-# endif
-#endif
-#if HAVE_STRING_H
-# if !STDC_HEADERS && HAVE_MEMORY_H
-#  include <memory.h>
-# endif
-# include <string.h>
-#endif
-#if HAVE_STRINGS_H
-# include <strings.h>
-#endif
-#if HAVE_INTTYPES_H
-# include <inttypes.h>
-#else
-# if HAVE_STDINT_H
-#  include <stdint.h>
-# endif
-#endif
-#if HAVE_UNISTD_H
-# include <unistd.h>
-#endif"
-
-ac_subst_vars='SHELL PATH_SEPARATOR PACKAGE_NAME PACKAGE_TARNAME PACKAGE_VERSION PACKAGE_STRING PACKAGE_BUGREPORT exec_prefix prefix program_transform_name bindir sbindir libexecdir datadir sysconfdir sharedstatedir localstatedir libdir includedir oldincludedir infodir mandir build_alias host_alias target_alias DEFS ECHO_C ECHO_N ECHO_T LIBS INSTALL_PROGRAM INSTALL_SCRIPT INSTALL_DATA CYGPATH_W PACKAGE VERSION ACLOCAL AUTOCONF AUTOMAKE AUTOHEADER MAKEINFO AMTAR install_sh STRIP ac_ct_STRIP INSTALL_STRIP_PROGRAM AWK SET_MAKE am__leading_dot CC CFLAGS LDFLAGS CPPFLAGS ac_ct_CC EXEEXT OBJEXT DEPDIR am__include am__quote AMDEP_TRUE AMDEP_FALSE AMDEPBACKSLASH CCDEPMODE am__fastdepCC_TRUE am__fastdepCC_FALSE LEX LEXLIB LEX_OUTPUT_ROOT CPP EGREP build build_cpu build_vendor build_os host host_cpu host_vendor host_os LN_S ECHO AR ac_ct_AR RANLIB ac_ct_RANLIB CXX CXXFLAGS ac_ct_CXX CXXDEPMODE am__fastdepCXX_TRUE am__fastdepCXX_FALSE CXXCPP F77 FFLAGS ac_ct_F77 LIBTOOL HTML_DIR PKG_C!
 ONFIG ENABLE_GTK_DOC_TRUE ENABLE_GTK_DOC_FALSE GTK_DOC_USE_LIBTOOL_TRUE GTK_DOC_USE_LIBTOOL_FALSE GLIB_CFLAGS GLIB_LIBS GLIB_GENMARSHAL GOBJECT_QUERY GLIB_MKENUMS GTK_CFLAGS GTK_LIBS GDKPIXBUF_CFLAGS GDKPIXBUF_LIBS HAVE_GDKPIXBUF_TRUE HAVE_GDKPIXBUF_FALSE DEBUG DBG_CFLAGS PLUGINS_LDFLAGS LIBOBJS LTLIBOBJS'
-ac_subst_files=''
-
-# Initialize some variables set by options.
-ac_init_help=
-ac_init_version=false
-# The variables have the same names as the options, with
-# dashes changed to underlines.
-cache_file=/dev/null
-exec_prefix=NONE
-no_create=
-no_recursion=
-prefix=NONE
-program_prefix=NONE
-program_suffix=NONE
-program_transform_name=s,x,x,
-silent=
-site=
-srcdir=
-verbose=
-x_includes=NONE
-x_libraries=NONE
-
-# Installation directory options.
-# These are left unexpanded so users can "make install exec_prefix=/foo"
-# and all the variables that are supposed to be based on exec_prefix
-# by default will actually change.
-# Use braces instead of parens because sh, perl, etc. also accept them.
-bindir='${exec_prefix}/bin'
-sbindir='${exec_prefix}/sbin'
-libexecdir='${exec_prefix}/libexec'
-datadir='${prefix}/share'
-sysconfdir='${prefix}/etc'
-sharedstatedir='${prefix}/com'
-localstatedir='${prefix}/var'
-libdir='${exec_prefix}/lib'
-includedir='${prefix}/include'
-oldincludedir='/usr/include'
-infodir='${prefix}/info'
-mandir='${prefix}/man'
-
-ac_prev=
-for ac_option
-do
-  # If the previous option needs an argument, assign it.
-  if test -n "$ac_prev"; then
-    eval "$ac_prev=\$ac_option"
-    ac_prev=
-    continue
-  fi
-
-  ac_optarg=`expr "x$ac_option" : 'x[^=]*=\(.*\)'`
-
-  # Accept the important Cygnus configure options, so we can diagnose typos.
-
-  case $ac_option in
-
-  -bindir | --bindir | --bindi | --bind | --bin | --bi)
-    ac_prev=bindir ;;
-  -bindir=* | --bindir=* | --bindi=* | --bind=* | --bin=* | --bi=*)
-    bindir=$ac_optarg ;;
-
-  -build | --build | --buil | --bui | --bu)
-    ac_prev=build_alias ;;
-  -build=* | --build=* | --buil=* | --bui=* | --bu=*)
-    build_alias=$ac_optarg ;;
-
-  -cache-file | --cache-file | --cache-fil | --cache-fi \
-  | --cache-f | --cache- | --cache | --cach | --cac | --ca | --c)
-    ac_prev=cache_file ;;
-  -cache-file=* | --cache-file=* | --cache-fil=* | --cache-fi=* \
-  | --cache-f=* | --cache-=* | --cache=* | --cach=* | --cac=* | --ca=* | --c=*)
-    cache_file=$ac_optarg ;;
-
-  --config-cache | -C)
-    cache_file=config.cache ;;
-
-  -datadir | --datadir | --datadi | --datad | --data | --dat | --da)
-    ac_prev=datadir ;;
-  -datadir=* | --datadir=* | --datadi=* | --datad=* | --data=* | --dat=* \
-  | --da=*)
-    datadir=$ac_optarg ;;
-
-  -disable-* | --disable-*)
-    ac_feature=`expr "x$ac_option" : 'x-*disable-\(.*\)'`
-    # Reject names that are not valid shell variable names.
-    expr "x$ac_feature" : ".*[^-_$as_cr_alnum]" >/dev/null &&
-      { echo "$as_me: error: invalid feature name: $ac_feature" >&2
-   { (exit 1); exit 1; }; }
-    ac_feature=`echo $ac_feature | sed 's/-/_/g'`
-    eval "enable_$ac_feature=no" ;;
-
-  -enable-* | --enable-*)
-    ac_feature=`expr "x$ac_option" : 'x-*enable-\([^=]*\)'`
-    # Reject names that are not valid shell variable names.
-    expr "x$ac_feature" : ".*[^-_$as_cr_alnum]" >/dev/null &&
-      { echo "$as_me: error: invalid feature name: $ac_feature" >&2
-   { (exit 1); exit 1; }; }
-    ac_feature=`echo $ac_feature | sed 's/-/_/g'`
-    case $ac_option in
-      *=*) ac_optarg=`echo "$ac_optarg" | sed "s/'/'\\\\\\\\''/g"`;;
-      *) ac_optarg=yes ;;
-    esac
-    eval "enable_$ac_feature='$ac_optarg'" ;;
-
-  -exec-prefix | --exec_prefix | --exec-prefix | --exec-prefi \
-  | --exec-pref | --exec-pre | --exec-pr | --exec-p | --exec- \
-  | --exec | --exe | --ex)
-    ac_prev=exec_prefix ;;
-  -exec-prefix=* | --exec_prefix=* | --exec-prefix=* | --exec-prefi=* \
-  | --exec-pref=* | --exec-pre=* | --exec-pr=* | --exec-p=* | --exec-=* \
-  | --exec=* | --exe=* | --ex=*)
-    exec_prefix=$ac_optarg ;;
-
-  -gas | --gas | --ga | --g)
-    # Obsolete; use --with-gas.
-    with_gas=yes ;;
-
-  -help | --help | --hel | --he | -h)
-    ac_init_help=long ;;
-  -help=r* | --help=r* | --hel=r* | --he=r* | -hr*)
-    ac_init_help=recursive ;;
-  -help=s* | --help=s* | --hel=s* | --he=s* | -hs*)
-    ac_init_help=short ;;
-
-  -host | --host | --hos | --ho)
-    ac_prev=host_alias ;;
-  -host=* | --host=* | --hos=* | --ho=*)
-    host_alias=$ac_optarg ;;
-
-  -includedir | --includedir | --includedi | --included | --include \
-  | --includ | --inclu | --incl | --inc)
-    ac_prev=includedir ;;
-  -includedir=* | --includedir=* | --includedi=* | --included=* | --include=* \
-  | --includ=* | --inclu=* | --incl=* | --inc=*)
-    includedir=$ac_optarg ;;
-
-  -infodir | --infodir | --infodi | --infod | --info | --inf)
-    ac_prev=infodir ;;
-  -infodir=* | --infodir=* | --infodi=* | --infod=* | --info=* | --inf=*)
-    infodir=$ac_optarg ;;
-
-  -libdir | --libdir | --libdi | --libd)
-    ac_prev=libdir ;;
-  -libdir=* | --libdir=* | --libdi=* | --libd=*)
-    libdir=$ac_optarg ;;
-
-  -libexecdir | --libexecdir | --libexecdi | --libexecd | --libexec \
-  | --libexe | --libex | --libe)
-    ac_prev=libexecdir ;;
-  -libexecdir=* | --libexecdir=* | --libexecdi=* | --libexecd=* | --libexec=* \
-  | --libexe=* | --libex=* | --libe=*)
-    libexecdir=$ac_optarg ;;
-
-  -localstatedir | --localstatedir | --localstatedi | --localstated \
-  | --localstate | --localstat | --localsta | --localst \
-  | --locals | --local | --loca | --loc | --lo)
-    ac_prev=localstatedir ;;
-  -localstatedir=* | --localstatedir=* | --localstatedi=* | --localstated=* \
-  | --localstate=* | --localstat=* | --localsta=* | --localst=* \
-  | --locals=* | --local=* | --loca=* | --loc=* | --lo=*)
-    localstatedir=$ac_optarg ;;
-
-  -mandir | --mandir | --mandi | --mand | --man | --ma | --m)
-    ac_prev=mandir ;;
-  -mandir=* | --mandir=* | --mandi=* | --mand=* | --man=* | --ma=* | --m=*)
-    mandir=$ac_optarg ;;
-
-  -nfp | --nfp | --nf)
-    # Obsolete; use --without-fp.
-    with_fp=no ;;
-
-  -no-create | --no-create | --no-creat | --no-crea | --no-cre \
-  | --no-cr | --no-c | -n)
-    no_create=yes ;;
-
-  -no-recursion | --no-recursion | --no-recursio | --no-recursi \
-  | --no-recurs | --no-recur | --no-recu | --no-rec | --no-re | --no-r)
-    no_recursion=yes ;;
-
-  -oldincludedir | --oldincludedir | --oldincludedi | --oldincluded \
-  | --oldinclude | --oldinclud | --oldinclu | --oldincl | --oldinc \
-  | --oldin | --oldi | --old | --ol | --o)
-    ac_prev=oldincludedir ;;
-  -oldincludedir=* | --oldincludedir=* | --oldincludedi=* | --oldincluded=* \
-  | --oldinclude=* | --oldinclud=* | --oldinclu=* | --oldincl=* | --oldinc=* \
-  | --oldin=* | --oldi=* | --old=* | --ol=* | --o=*)
-    oldincludedir=$ac_optarg ;;
-
-  -prefix | --prefix | --prefi | --pref | --pre | --pr | --p)
-    ac_prev=prefix ;;
-  -prefix=* | --prefix=* | --prefi=* | --pref=* | --pre=* | --pr=* | --p=*)
-    prefix=$ac_optarg ;;
-
-  -program-prefix | --program-prefix | --program-prefi | --program-pref \
-  | --program-pre | --program-pr | --program-p)
-    ac_prev=program_prefix ;;
-  -program-prefix=* | --program-prefix=* | --program-prefi=* \
-  | --program-pref=* | --program-pre=* | --program-pr=* | --program-p=*)
-    program_prefix=$ac_optarg ;;
-
-  -program-suffix | --program-suffix | --program-suffi | --program-suff \
-  | --program-suf | --program-su | --program-s)
-    ac_prev=program_suffix ;;
-  -program-suffix=* | --program-suffix=* | --program-suffi=* \
-  | --program-suff=* | --program-suf=* | --program-su=* | --program-s=*)
-    program_suffix=$ac_optarg ;;
-
-  -program-transform-name | --program-transform-name \
-  | --program-transform-nam | --program-transform-na \
-  | --program-transform-n | --program-transform- \
-  | --program-transform | --program-transfor \
-  | --program-transfo | --program-transf \
-  | --program-trans | --program-tran \
-  | --progr-tra | --program-tr | --program-t)
-    ac_prev=program_transform_name ;;
-  -program-transform-name=* | --program-transform-name=* \
-  | --program-transform-nam=* | --program-transform-na=* \
-  | --program-transform-n=* | --program-transform-=* \
-  | --program-transform=* | --program-transfor=* \
-  | --program-transfo=* | --program-transf=* \
-  | --program-trans=* | --program-tran=* \
-  | --progr-tra=* | --program-tr=* | --program-t=*)
-    program_transform_name=$ac_optarg ;;
-
-  -q | -quiet | --quiet | --quie | --qui | --qu | --q \
-  | -silent | --silent | --silen | --sile | --sil)
-    silent=yes ;;
-
-  -sbindir | --sbindir | --sbindi | --sbind | --sbin | --sbi | --sb)
-    ac_prev=sbindir ;;
-  -sbindir=* | --sbindir=* | --sbindi=* | --sbind=* | --sbin=* \
-  | --sbi=* | --sb=*)
-    sbindir=$ac_optarg ;;
-
-  -sharedstatedir | --sharedstatedir | --sharedstatedi \
-  | --sharedstated | --sharedstate | --sharedstat | --sharedsta \
-  | --sharedst | --shareds | --shared | --share | --shar \
-  | --sha | --sh)
-    ac_prev=sharedstatedir ;;
-  -sharedstatedir=* | --sharedstatedir=* | --sharedstatedi=* \
-  | --sharedstated=* | --sharedstate=* | --sharedstat=* | --sharedsta=* \
-  | --sharedst=* | --shareds=* | --shared=* | --share=* | --shar=* \
-  | --sha=* | --sh=*)
-    sharedstatedir=$ac_optarg ;;
-
-  -site | --site | --sit)
-    ac_prev=site ;;
-  -site=* | --site=* | --sit=*)
-    site=$ac_optarg ;;
-
-  -srcdir | --srcdir | --srcdi | --srcd | --src | --sr)
-    ac_prev=srcdir ;;
-  -srcdir=* | --srcdir=* | --srcdi=* | --srcd=* | --src=* | --sr=*)
-    srcdir=$ac_optarg ;;
-
-  -sysconfdir | --sysconfdir | --sysconfdi | --sysconfd | --sysconf \
-  | --syscon | --sysco | --sysc | --sys | --sy)
-    ac_prev=sysconfdir ;;
-  -sysconfdir=* | --sysconfdir=* | --sysconfdi=* | --sysconfd=* | --sysconf=* \
-  | --syscon=* | --sysco=* | --sysc=* | --sys=* | --sy=*)
-    sysconfdir=$ac_optarg ;;
-
-  -target | --target | --targe | --targ | --tar | --ta | --t)
-    ac_prev=target_alias ;;
-  -target=* | --target=* | --targe=* | --targ=* | --tar=* | --ta=* | --t=*)
-    target_alias=$ac_optarg ;;
-
-  -v | -verbose | --verbose | --verbos | --verbo | --verb)
-    verbose=yes ;;
-
-  -version | --version | --versio | --versi | --vers | -V)
-    ac_init_version=: ;;
-
-  -with-* | --with-*)
-    ac_package=`expr "x$ac_option" : 'x-*with-\([^=]*\)'`
-    # Reject names that are not valid shell variable names.
-    expr "x$ac_package" : ".*[^-_$as_cr_alnum]" >/dev/null &&
-      { echo "$as_me: error: invalid package name: $ac_package" >&2
-   { (exit 1); exit 1; }; }
-    ac_package=`echo $ac_package| sed 's/-/_/g'`
-    case $ac_option in
-      *=*) ac_optarg=`echo "$ac_optarg" | sed "s/'/'\\\\\\\\''/g"`;;
-      *) ac_optarg=yes ;;
-    esac
-    eval "with_$ac_package='$ac_optarg'" ;;
-
-  -without-* | --without-*)
-    ac_package=`expr "x$ac_option" : 'x-*without-\(.*\)'`
-    # Reject names that are not valid shell variable names.
-    expr "x$ac_package" : ".*[^-_$as_cr_alnum]" >/dev/null &&
-      { echo "$as_me: error: invalid package name: $ac_package" >&2
-   { (exit 1); exit 1; }; }
-    ac_package=`echo $ac_package | sed 's/-/_/g'`
-    eval "with_$ac_package=no" ;;
-
-  --x)
-    # Obsolete; use --with-x.
-    with_x=yes ;;
-
-  -x-includes | --x-includes | --x-include | --x-includ | --x-inclu \
-  | --x-incl | --x-inc | --x-in | --x-i)
-    ac_prev=x_includes ;;
-  -x-includes=* | --x-includes=* | --x-include=* | --x-includ=* | --x-inclu=* \
-  | --x-incl=* | --x-inc=* | --x-in=* | --x-i=*)
-    x_includes=$ac_optarg ;;
-
-  -x-libraries | --x-libraries | --x-librarie | --x-librari \
-  | --x-librar | --x-libra | --x-libr | --x-lib | --x-li | --x-l)
-    ac_prev=x_libraries ;;
-  -x-libraries=* | --x-libraries=* | --x-librarie=* | --x-librari=* \
-  | --x-librar=* | --x-libra=* | --x-libr=* | --x-lib=* | --x-li=* | --x-l=*)
-    x_libraries=$ac_optarg ;;
-
-  -*) { echo "$as_me: error: unrecognized option: $ac_option
-Try \`$0 --help' for more information." >&2
-   { (exit 1); exit 1; }; }
-    ;;
-
-  *=*)
-    ac_envvar=`expr "x$ac_option" : 'x\([^=]*\)='`
-    # Reject names that are not valid shell variable names.
-    expr "x$ac_envvar" : ".*[^_$as_cr_alnum]" >/dev/null &&
-      { echo "$as_me: error: invalid variable name: $ac_envvar" >&2
-   { (exit 1); exit 1; }; }
-    ac_optarg=`echo "$ac_optarg" | sed "s/'/'\\\\\\\\''/g"`
-    eval "$ac_envvar='$ac_optarg'"
-    export $ac_envvar ;;
-
-  *)
-    # FIXME: should be removed in autoconf 3.0.
-    echo "$as_me: WARNING: you should use --build, --host, --target" >&2
-    expr "x$ac_option" : ".*[^-._$as_cr_alnum]" >/dev/null &&
-      echo "$as_me: WARNING: invalid host type: $ac_option" >&2
-    : ${build_alias=$ac_option} ${host_alias=$ac_option} ${target_alias=$ac_option}
-    ;;
-
-  esac
-done
-
-if test -n "$ac_prev"; then
-  ac_option=--`echo $ac_prev | sed 's/_/-/g'`
-  { echo "$as_me: error: missing argument to $ac_option" >&2
-   { (exit 1); exit 1; }; }
-fi
-
-# Be sure to have absolute paths.
-for ac_var in exec_prefix prefix
-do
-  eval ac_val=$`echo $ac_var`
-  case $ac_val in
-    [\\/$]* | ?:[\\/]* | NONE | '' ) ;;
-    *)  { echo "$as_me: error: expected an absolute directory name for --$ac_var: $ac_val" >&2
-   { (exit 1); exit 1; }; };;
-  esac
-done
-
-# Be sure to have absolute paths.
-for ac_var in bindir sbindir libexecdir datadir sysconfdir sharedstatedir \
-	      localstatedir libdir includedir oldincludedir infodir mandir
-do
-  eval ac_val=$`echo $ac_var`
-  case $ac_val in
-    [\\/$]* | ?:[\\/]* ) ;;
-    *)  { echo "$as_me: error: expected an absolute directory name for --$ac_var: $ac_val" >&2
-   { (exit 1); exit 1; }; };;
-  esac
-done
-
-# There might be people who depend on the old broken behavior: `$host'
-# used to hold the argument of --host etc.
-# FIXME: To remove some day.
-build=$build_alias
-host=$host_alias
-target=$target_alias
-
-# FIXME: To remove some day.
-if test "x$host_alias" != x; then
-  if test "x$build_alias" = x; then
-    cross_compiling=maybe
-    echo "$as_me: WARNING: If you wanted to set the --build type, don't use --host.
-    If a cross compiler is detected then cross compile mode will be used." >&2
-  elif test "x$build_alias" != "x$host_alias"; then
-    cross_compiling=yes
-  fi
-fi
-
-ac_tool_prefix=
-test -n "$host_alias" && ac_tool_prefix=$host_alias-
-
-test "$silent" = yes && exec 6>/dev/null
-
-
-# Find the source files, if location was not specified.
-if test -z "$srcdir"; then
-  ac_srcdir_defaulted=yes
-  # Try the directory containing this script, then its parent.
-  ac_confdir=`(dirname "$0") 2>/dev/null ||
-$as_expr X"$0" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
-	 X"$0" : 'X\(//\)[^/]' \| \
-	 X"$0" : 'X\(//\)$' \| \
-	 X"$0" : 'X\(/\)' \| \
-	 .     : '\(.\)' 2>/dev/null ||
-echo X"$0" |
-    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{ s//\1/; q; }
-  	  /^X\(\/\/\)[^/].*/{ s//\1/; q; }
-  	  /^X\(\/\/\)$/{ s//\1/; q; }
-  	  /^X\(\/\).*/{ s//\1/; q; }
-  	  s/.*/./; q'`
-  srcdir=$ac_confdir
-  if test ! -r $srcdir/$ac_unique_file; then
-    srcdir=..
-  fi
-else
-  ac_srcdir_defaulted=no
-fi
-if test ! -r $srcdir/$ac_unique_file; then
-  if test "$ac_srcdir_defaulted" = yes; then
-    { echo "$as_me: error: cannot find sources ($ac_unique_file) in $ac_confdir or .." >&2
-   { (exit 1); exit 1; }; }
-  else
-    { echo "$as_me: error: cannot find sources ($ac_unique_file) in $srcdir" >&2
-   { (exit 1); exit 1; }; }
-  fi
-fi
-(cd $srcdir && test -r ./$ac_unique_file) 2>/dev/null ||
-  { echo "$as_me: error: sources are in $srcdir, but \`cd $srcdir' does not work" >&2
-   { (exit 1); exit 1; }; }
-srcdir=`echo "$srcdir" | sed 's%\([^\\/]\)[\\/]*$%\1%'`
-ac_env_build_alias_set=${build_alias+set}
-ac_env_build_alias_value=$build_alias
-ac_cv_env_build_alias_set=${build_alias+set}
-ac_cv_env_build_alias_value=$build_alias
-ac_env_host_alias_set=${host_alias+set}
-ac_env_host_alias_value=$host_alias
-ac_cv_env_host_alias_set=${host_alias+set}
-ac_cv_env_host_alias_value=$host_alias
-ac_env_target_alias_set=${target_alias+set}
-ac_env_target_alias_value=$target_alias
-ac_cv_env_target_alias_set=${target_alias+set}
-ac_cv_env_target_alias_value=$target_alias
-ac_env_CC_set=${CC+set}
-ac_env_CC_value=$CC
-ac_cv_env_CC_set=${CC+set}
-ac_cv_env_CC_value=$CC
-ac_env_CFLAGS_set=${CFLAGS+set}
-ac_env_CFLAGS_value=$CFLAGS
-ac_cv_env_CFLAGS_set=${CFLAGS+set}
-ac_cv_env_CFLAGS_value=$CFLAGS
-ac_env_LDFLAGS_set=${LDFLAGS+set}
-ac_env_LDFLAGS_value=$LDFLAGS
-ac_cv_env_LDFLAGS_set=${LDFLAGS+set}
-ac_cv_env_LDFLAGS_value=$LDFLAGS
-ac_env_CPPFLAGS_set=${CPPFLAGS+set}
-ac_env_CPPFLAGS_value=$CPPFLAGS
-ac_cv_env_CPPFLAGS_set=${CPPFLAGS+set}
-ac_cv_env_CPPFLAGS_value=$CPPFLAGS
-ac_env_CPP_set=${CPP+set}
-ac_env_CPP_value=$CPP
-ac_cv_env_CPP_set=${CPP+set}
-ac_cv_env_CPP_value=$CPP
-ac_env_CXX_set=${CXX+set}
-ac_env_CXX_value=$CXX
-ac_cv_env_CXX_set=${CXX+set}
-ac_cv_env_CXX_value=$CXX
-ac_env_CXXFLAGS_set=${CXXFLAGS+set}
-ac_env_CXXFLAGS_value=$CXXFLAGS
-ac_cv_env_CXXFLAGS_set=${CXXFLAGS+set}
-ac_cv_env_CXXFLAGS_value=$CXXFLAGS
-ac_env_CXXCPP_set=${CXXCPP+set}
-ac_env_CXXCPP_value=$CXXCPP
-ac_cv_env_CXXCPP_set=${CXXCPP+set}
-ac_cv_env_CXXCPP_value=$CXXCPP
-ac_env_F77_set=${F77+set}
-ac_env_F77_value=$F77
-ac_cv_env_F77_set=${F77+set}
-ac_cv_env_F77_value=$F77
-ac_env_FFLAGS_set=${FFLAGS+set}
-ac_env_FFLAGS_value=$FFLAGS
-ac_cv_env_FFLAGS_set=${FFLAGS+set}
-ac_cv_env_FFLAGS_value=$FFLAGS
-
-#
-# Report the --help message.
-#
-if test "$ac_init_help" = "long"; then
-  # Omit some internal or obsolete options to make the list less imposing.
-  # This message is too long to be a string in the A/UX 3.1 sh.
-  cat <<_ACEOF
-\`configure' configures this package to adapt to many kinds of systems.
-
-Usage: $0 [OPTION]... [VAR=VALUE]...
-
-To assign environment variables (e.g., CC, CFLAGS...), specify them as
-VAR=VALUE.  See below for descriptions of some of the useful variables.
-
-Defaults for the options are specified in brackets.
-
-Configuration:
-  -h, --help              display this help and exit
-      --help=short        display options specific to this package
-      --help=recursive    display the short help of all the included packages
-  -V, --version           display version information and exit
-  -q, --quiet, --silent   do not print \`checking...' messages
-      --cache-file=FILE   cache test results in FILE [disabled]
-  -C, --config-cache      alias for \`--cache-file=config.cache'
-  -n, --no-create         do not create output files
-      --srcdir=DIR        find the sources in DIR [configure dir or \`..']
-
-_ACEOF
-
-  cat <<_ACEOF
-Installation directories:
-  --prefix=PREFIX         install architecture-independent files in PREFIX
-			  [$ac_default_prefix]
-  --exec-prefix=EPREFIX   install architecture-dependent files in EPREFIX
-			  [PREFIX]
-
-By default, \`make install' will install all the files in
-\`$ac_default_prefix/bin', \`$ac_default_prefix/lib' etc.  You can specify
-an installation prefix other than \`$ac_default_prefix' using \`--prefix',
-for instance \`--prefix=\$HOME'.
-
-For better control, use the options below.
-
-Fine tuning of the installation directories:
-  --bindir=DIR           user executables [EPREFIX/bin]
-  --sbindir=DIR          system admin executables [EPREFIX/sbin]
-  --libexecdir=DIR       program executables [EPREFIX/libexec]
-  --datadir=DIR          read-only architecture-independent data [PREFIX/share]
-  --sysconfdir=DIR       read-only single-machine data [PREFIX/etc]
-  --sharedstatedir=DIR   modifiable architecture-independent data [PREFIX/com]
-  --localstatedir=DIR    modifiable single-machine data [PREFIX/var]
-  --libdir=DIR           object code libraries [EPREFIX/lib]
-  --includedir=DIR       C header files [PREFIX/include]
-  --oldincludedir=DIR    C header files for non-gcc [/usr/include]
-  --infodir=DIR          info documentation [PREFIX/info]
-  --mandir=DIR           man documentation [PREFIX/man]
-_ACEOF
-
-  cat <<\_ACEOF
-
-Program names:
-  --program-prefix=PREFIX            prepend PREFIX to installed program names
-  --program-suffix=SUFFIX            append SUFFIX to installed program names
-  --program-transform-name=PROGRAM   run sed PROGRAM on installed program names
-
-System types:
-  --build=BUILD     configure for building on BUILD [guessed]
-  --host=HOST       cross-compile to build programs to run on HOST [BUILD]
-_ACEOF
-fi
-
-if test -n "$ac_init_help"; then
-
-  cat <<\_ACEOF
-
-Optional Features:
-  --disable-FEATURE       do not include FEATURE (same as --enable-FEATURE=no)
-  --enable-FEATURE[=ARG]  include FEATURE [ARG=yes]
-  --disable-dependency-tracking Speeds up one-time builds
-  --enable-dependency-tracking  Do not reject slow dependency extractors
-  --enable-static[=PKGS]
-                          build static libraries [default=no]
-  --enable-shared[=PKGS]
-                          build shared libraries [default=yes]
-  --enable-fast-install[=PKGS]
-                          optimize for fast installation [default=yes]
-  --disable-libtool-lock  avoid locking (might break parallel builds)
-  --enable-gtk-doc        use gtk-doc to build documentation default=no
-  --disable-glibtest      do not try to compile and run a test GLIB program
-  --disable-gtktest       do not try to compile and run a test GTK+ program
-  --enable-debug[=LVL]    enable debug level LVL or 1 (default is 0)
-
-Optional Packages:
-  --with-PACKAGE[=ARG]    use PACKAGE [ARG=yes]
-  --without-PACKAGE       do not use PACKAGE (same as --with-PACKAGE=no)
-  --with-gnu-ld           assume the C compiler uses GNU ld [default=no]
-  --with-pic              try to use only PIC/non-PIC objects [default=use
-                          both]
-  --with-tags[=TAGS]
-                          include additional configurations [automatic]
-  --with-html-dir=PATH    path to installed docs
-
-Some influential environment variables:
-  CC          C compiler command
-  CFLAGS      C compiler flags
-  LDFLAGS     linker flags, e.g. -L<lib dir> if you have libraries in a
-              nonstandard directory <lib dir>
-  CPPFLAGS    C/C++ preprocessor flags, e.g. -I<include dir> if you have
-              headers in a nonstandard directory <include dir>
-  CPP         C preprocessor
-  CXX         C++ compiler command
-  CXXFLAGS    C++ compiler flags
-  CXXCPP      C++ preprocessor
-  F77         Fortran 77 compiler command
-  FFLAGS      Fortran 77 compiler flags
-
-Use these variables to override the choices made by `configure' or to help
-it to find libraries and programs with nonstandard names/locations.
-
-_ACEOF
-fi
-
-if test "$ac_init_help" = "recursive"; then
-  # If there are subdirs, report their specific --help.
-  ac_popdir=`pwd`
-  for ac_dir in : $ac_subdirs_all; do test "x$ac_dir" = x: && continue
-    test -d $ac_dir || continue
-    ac_builddir=.
-
-if test "$ac_dir" != .; then
-  ac_dir_suffix=/`echo "$ac_dir" | sed 's,^\.[\\/],,'`
-  # A "../" for each directory in $ac_dir_suffix.
-  ac_top_builddir=`echo "$ac_dir_suffix" | sed 's,/[^\\/]*,../,g'`
-else
-  ac_dir_suffix= ac_top_builddir=
-fi
-
-case $srcdir in
-  .)  # No --srcdir option.  We are building in place.
-    ac_srcdir=.
-    if test -z "$ac_top_builddir"; then
-       ac_top_srcdir=.
-    else
-       ac_top_srcdir=`echo $ac_top_builddir | sed 's,/$,,'`
-    fi ;;
-  [\\/]* | ?:[\\/]* )  # Absolute path.
-    ac_srcdir=$srcdir$ac_dir_suffix;
-    ac_top_srcdir=$srcdir ;;
-  *) # Relative path.
-    ac_srcdir=$ac_top_builddir$srcdir$ac_dir_suffix
-    ac_top_srcdir=$ac_top_builddir$srcdir ;;
-esac
-
-# Do not use `cd foo && pwd` to compute absolute paths, because
-# the directories may not exist.
-case `pwd` in
-.) ac_abs_builddir="$ac_dir";;
-*)
-  case "$ac_dir" in
-  .) ac_abs_builddir=`pwd`;;
-  [\\/]* | ?:[\\/]* ) ac_abs_builddir="$ac_dir";;
-  *) ac_abs_builddir=`pwd`/"$ac_dir";;
-  esac;;
-esac
-case $ac_abs_builddir in
-.) ac_abs_top_builddir=${ac_top_builddir}.;;
-*)
-  case ${ac_top_builddir}. in
-  .) ac_abs_top_builddir=$ac_abs_builddir;;
-  [\\/]* | ?:[\\/]* ) ac_abs_top_builddir=${ac_top_builddir}.;;
-  *) ac_abs_top_builddir=$ac_abs_builddir/${ac_top_builddir}.;;
-  esac;;
-esac
-case $ac_abs_builddir in
-.) ac_abs_srcdir=$ac_srcdir;;
-*)
-  case $ac_srcdir in
-  .) ac_abs_srcdir=$ac_abs_builddir;;
-  [\\/]* | ?:[\\/]* ) ac_abs_srcdir=$ac_srcdir;;
-  *) ac_abs_srcdir=$ac_abs_builddir/$ac_srcdir;;
-  esac;;
-esac
-case $ac_abs_builddir in
-.) ac_abs_top_srcdir=$ac_top_srcdir;;
-*)
-  case $ac_top_srcdir in
-  .) ac_abs_top_srcdir=$ac_abs_builddir;;
-  [\\/]* | ?:[\\/]* ) ac_abs_top_srcdir=$ac_top_srcdir;;
-  *) ac_abs_top_srcdir=$ac_abs_builddir/$ac_top_srcdir;;
-  esac;;
-esac
-
-    cd $ac_dir
-    # Check for guested configure; otherwise get Cygnus style configure.
-    if test -f $ac_srcdir/configure.gnu; then
-      echo
-      $SHELL $ac_srcdir/configure.gnu  --help=recursive
-    elif test -f $ac_srcdir/configure; then
-      echo
-      $SHELL $ac_srcdir/configure  --help=recursive
-    elif test -f $ac_srcdir/configure.ac ||
-	   test -f $ac_srcdir/configure.in; then
-      echo
-      $ac_configure --help
-    else
-      echo "$as_me: WARNING: no configuration information is in $ac_dir" >&2
-    fi
-    cd "$ac_popdir"
-  done
-fi
-
-test -n "$ac_init_help" && exit 0
-if $ac_init_version; then
-  cat <<\_ACEOF
-
-Copyright (C) 2003 Free Software Foundation, Inc.
-This configure script is free software; the Free Software Foundation
-gives unlimited permission to copy, distribute and modify it.
-_ACEOF
-  exit 0
-fi
-exec 5>config.log
-cat >&5 <<_ACEOF
-This file contains any messages produced by compilers while
-running configure, to aid debugging if configure makes a mistake.
-
-It was created by $as_me, which was
-generated by GNU Autoconf 2.59.  Invocation command line was
-
-  $ $0 $@
-
-_ACEOF
-{
-cat <<_ASUNAME
-## --------- ##
-## Platform. ##
-## --------- ##
-
-hostname = `(hostname || uname -n) 2>/dev/null | sed 1q`
-uname -m = `(uname -m) 2>/dev/null || echo unknown`
-uname -r = `(uname -r) 2>/dev/null || echo unknown`
-uname -s = `(uname -s) 2>/dev/null || echo unknown`
-uname -v = `(uname -v) 2>/dev/null || echo unknown`
-
-/usr/bin/uname -p = `(/usr/bin/uname -p) 2>/dev/null || echo unknown`
-/bin/uname -X     = `(/bin/uname -X) 2>/dev/null     || echo unknown`
-
-/bin/arch              = `(/bin/arch) 2>/dev/null              || echo unknown`
-/usr/bin/arch -k       = `(/usr/bin/arch -k) 2>/dev/null       || echo unknown`
-/usr/convex/getsysinfo = `(/usr/convex/getsysinfo) 2>/dev/null || echo unknown`
-hostinfo               = `(hostinfo) 2>/dev/null               || echo unknown`
-/bin/machine           = `(/bin/machine) 2>/dev/null           || echo unknown`
-/usr/bin/oslevel       = `(/usr/bin/oslevel) 2>/dev/null       || echo unknown`
-/bin/universe          = `(/bin/universe) 2>/dev/null          || echo unknown`
-
-_ASUNAME
-
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  echo "PATH: $as_dir"
-done
-
-} >&5
-
-cat >&5 <<_ACEOF
-
-
-## ----------- ##
-## Core tests. ##
-## ----------- ##
-
-_ACEOF
-
-
-# Keep a trace of the command line.
-# Strip out --no-create and --no-recursion so they do not pile up.
-# Strip out --silent because we don't want to record it for future runs.
-# Also quote any args containing shell meta-characters.
-# Make two passes to allow for proper duplicate-argument suppression.
-ac_configure_args=
-ac_configure_args0=
-ac_configure_args1=
-ac_sep=
-ac_must_keep_next=false
-for ac_pass in 1 2
-do
-  for ac_arg
-  do
-    case $ac_arg in
-    -no-create | --no-c* | -n | -no-recursion | --no-r*) continue ;;
-    -q | -quiet | --quiet | --quie | --qui | --qu | --q \
-    | -silent | --silent | --silen | --sile | --sil)
-      continue ;;
-    *" "*|*"	"*|*[\[\]\~\#\$\^\&\*\(\)\{\}\\\|\;\<\>\?\"\']*)
-      ac_arg=`echo "$ac_arg" | sed "s/'/'\\\\\\\\''/g"` ;;
-    esac
-    case $ac_pass in
-    1) ac_configure_args0="$ac_configure_args0 '$ac_arg'" ;;
-    2)
-      ac_configure_args1="$ac_configure_args1 '$ac_arg'"
-      if test $ac_must_keep_next = true; then
-	ac_must_keep_next=false # Got value, back to normal.
-      else
-	case $ac_arg in
-	  *=* | --config-cache | -C | -disable-* | --disable-* \
-	  | -enable-* | --enable-* | -gas | --g* | -nfp | --nf* \
-	  | -q | -quiet | --q* | -silent | --sil* | -v | -verb* \
-	  | -with-* | --with-* | -without-* | --without-* | --x)
-	    case "$ac_configure_args0 " in
-	      "$ac_configure_args1"*" '$ac_arg' "* ) continue ;;
-	    esac
-	    ;;
-	  -* ) ac_must_keep_next=true ;;
-	esac
-      fi
-      ac_configure_args="$ac_configure_args$ac_sep'$ac_arg'"
-      # Get rid of the leading space.
-      ac_sep=" "
-      ;;
-    esac
-  done
-done
-$as_unset ac_configure_args0 || test "${ac_configure_args0+set}" != set || { ac_configure_args0=; export ac_configure_args0; }
-$as_unset ac_configure_args1 || test "${ac_configure_args1+set}" != set || { ac_configure_args1=; export ac_configure_args1; }
-
-# When interrupted or exit'd, cleanup temporary files, and complete
-# config.log.  We remove comments because anyway the quotes in there
-# would cause problems or look ugly.
-# WARNING: Be sure not to use single quotes in there, as some shells,
-# such as our DU 5.0 friend, will then `close' the trap.
-trap 'exit_status=$?
-  # Save into config.log some information that might help in debugging.
-  {
-    echo
-
-    cat <<\_ASBOX
-## ---------------- ##
-## Cache variables. ##
-## ---------------- ##
-_ASBOX
-    echo
-    # The following way of writing the cache mishandles newlines in values,
-{
-  (set) 2>&1 |
-    case `(ac_space='"'"' '"'"'; set | grep ac_space) 2>&1` in
-    *ac_space=\ *)
-      sed -n \
-	"s/'"'"'/'"'"'\\\\'"'"''"'"'/g;
-	  s/^\\([_$as_cr_alnum]*_cv_[_$as_cr_alnum]*\\)=\\(.*\\)/\\1='"'"'\\2'"'"'/p"
-      ;;
-    *)
-      sed -n \
-	"s/^\\([_$as_cr_alnum]*_cv_[_$as_cr_alnum]*\\)=\\(.*\\)/\\1=\\2/p"
-      ;;
-    esac;
-}
-    echo
-
-    cat <<\_ASBOX
-## ----------------- ##
-## Output variables. ##
-## ----------------- ##
-_ASBOX
-    echo
-    for ac_var in $ac_subst_vars
-    do
-      eval ac_val=$`echo $ac_var`
-      echo "$ac_var='"'"'$ac_val'"'"'"
-    done | sort
-    echo
-
-    if test -n "$ac_subst_files"; then
-      cat <<\_ASBOX
-## ------------- ##
-## Output files. ##
-## ------------- ##
-_ASBOX
-      echo
-      for ac_var in $ac_subst_files
-      do
-	eval ac_val=$`echo $ac_var`
-	echo "$ac_var='"'"'$ac_val'"'"'"
-      done | sort
-      echo
-    fi
-
-    if test -s confdefs.h; then
-      cat <<\_ASBOX
-## ----------- ##
-## confdefs.h. ##
-## ----------- ##
-_ASBOX
-      echo
-      sed "/^$/d" confdefs.h | sort
-      echo
-    fi
-    test "$ac_signal" != 0 &&
-      echo "$as_me: caught signal $ac_signal"
-    echo "$as_me: exit $exit_status"
-  } >&5
-  rm -f core *.core &&
-  rm -rf conftest* confdefs* conf$$* $ac_clean_files &&
-    exit $exit_status
-     ' 0
-for ac_signal in 1 2 13 15; do
-  trap 'ac_signal='$ac_signal'; { (exit 1); exit 1; }' $ac_signal
-done
-ac_signal=0
-
-# confdefs.h avoids OS command line length limits that DEFS can exceed.
-rm -rf conftest* confdefs.h
-# AIX cpp loses on an empty file, so make sure it contains at least a newline.
-echo >confdefs.h
-
-# Predefined preprocessor variables.
-
-cat >>confdefs.h <<_ACEOF
-#define PACKAGE_NAME "$PACKAGE_NAME"
-_ACEOF
-
-
-cat >>confdefs.h <<_ACEOF
-#define PACKAGE_TARNAME "$PACKAGE_TARNAME"
-_ACEOF
-
-
-cat >>confdefs.h <<_ACEOF
-#define PACKAGE_VERSION "$PACKAGE_VERSION"
-_ACEOF
-
-
-cat >>confdefs.h <<_ACEOF
-#define PACKAGE_STRING "$PACKAGE_STRING"
-_ACEOF
-
-
-cat >>confdefs.h <<_ACEOF
-#define PACKAGE_BUGREPORT "$PACKAGE_BUGREPORT"
-_ACEOF
-
-
-# Let the site file select an alternate cache file if it wants to.
-# Prefer explicitly selected file to automatically selected ones.
-if test -z "$CONFIG_SITE"; then
-  if test "x$prefix" != xNONE; then
-    CONFIG_SITE="$prefix/share/config.site $prefix/etc/config.site"
-  else
-    CONFIG_SITE="$ac_default_prefix/share/config.site $ac_default_prefix/etc/config.site"
-  fi
-fi
-for ac_site_file in $CONFIG_SITE; do
-  if test -r "$ac_site_file"; then
-    { echo "$as_me:$LINENO: loading site script $ac_site_file" >&5
-echo "$as_me: loading site script $ac_site_file" >&6;}
-    sed 's/^/| /' "$ac_site_file" >&5
-    . "$ac_site_file"
-  fi
-done
-
-if test -r "$cache_file"; then
-  # Some versions of bash will fail to source /dev/null (special
-  # files actually), so we avoid doing that.
-  if test -f "$cache_file"; then
-    { echo "$as_me:$LINENO: loading cache $cache_file" >&5
-echo "$as_me: loading cache $cache_file" >&6;}
-    case $cache_file in
-      [\\/]* | ?:[\\/]* ) . $cache_file;;
-      *)                      . ./$cache_file;;
-    esac
-  fi
-else
-  { echo "$as_me:$LINENO: creating cache $cache_file" >&5
-echo "$as_me: creating cache $cache_file" >&6;}
-  >$cache_file
-fi
-
-# Check that the precious variables saved in the cache have kept the same
-# value.
-ac_cache_corrupted=false
-for ac_var in `(set) 2>&1 |
-	       sed -n 's/^ac_env_\([a-zA-Z_0-9]*\)_set=.*/\1/p'`; do
-  eval ac_old_set=\$ac_cv_env_${ac_var}_set
-  eval ac_new_set=\$ac_env_${ac_var}_set
-  eval ac_old_val="\$ac_cv_env_${ac_var}_value"
-  eval ac_new_val="\$ac_env_${ac_var}_value"
-  case $ac_old_set,$ac_new_set in
-    set,)
-      { echo "$as_me:$LINENO: error: \`$ac_var' was set to \`$ac_old_val' in the previous run" >&5
-echo "$as_me: error: \`$ac_var' was set to \`$ac_old_val' in the previous run" >&2;}
-      ac_cache_corrupted=: ;;
-    ,set)
-      { echo "$as_me:$LINENO: error: \`$ac_var' was not set in the previous run" >&5
-echo "$as_me: error: \`$ac_var' was not set in the previous run" >&2;}
-      ac_cache_corrupted=: ;;
-    ,);;
-    *)
-      if test "x$ac_old_val" != "x$ac_new_val"; then
-	{ echo "$as_me:$LINENO: error: \`$ac_var' has changed since the previous run:" >&5
-echo "$as_me: error: \`$ac_var' has changed since the previous run:" >&2;}
-	{ echo "$as_me:$LINENO:   former value:  $ac_old_val" >&5
-echo "$as_me:   former value:  $ac_old_val" >&2;}
-	{ echo "$as_me:$LINENO:   current value: $ac_new_val" >&5
-echo "$as_me:   current value: $ac_new_val" >&2;}
-	ac_cache_corrupted=:
-      fi;;
-  esac
-  # Pass precious variables to config.status.
-  if test "$ac_new_set" = set; then
-    case $ac_new_val in
-    *" "*|*"	"*|*[\[\]\~\#\$\^\&\*\(\)\{\}\\\|\;\<\>\?\"\']*)
-      ac_arg=$ac_var=`echo "$ac_new_val" | sed "s/'/'\\\\\\\\''/g"` ;;
-    *) ac_arg=$ac_var=$ac_new_val ;;
-    esac
-    case " $ac_configure_args " in
-      *" '$ac_arg' "*) ;; # Avoid dups.  Use of quotes ensures accuracy.
-      *) ac_configure_args="$ac_configure_args '$ac_arg'" ;;
-    esac
-  fi
-done
-if $ac_cache_corrupted; then
-  { echo "$as_me:$LINENO: error: changes in the environment can compromise the build" >&5
-echo "$as_me: error: changes in the environment can compromise the build" >&2;}
-  { { echo "$as_me:$LINENO: error: run \`make distclean' and/or \`rm $cache_file' and start over" >&5
-echo "$as_me: error: run \`make distclean' and/or \`rm $cache_file' and start over" >&2;}
-   { (exit 1); exit 1; }; }
-fi
-
-ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-ac_aux_dir=
-for ac_dir in config $srcdir/config; do
-  if test -f $ac_dir/install-sh; then
-    ac_aux_dir=$ac_dir
-    ac_install_sh="$ac_aux_dir/install-sh -c"
-    break
-  elif test -f $ac_dir/install.sh; then
-    ac_aux_dir=$ac_dir
-    ac_install_sh="$ac_aux_dir/install.sh -c"
-    break
-  elif test -f $ac_dir/shtool; then
-    ac_aux_dir=$ac_dir
-    ac_install_sh="$ac_aux_dir/shtool install -c"
-    break
-  fi
-done
-if test -z "$ac_aux_dir"; then
-  { { echo "$as_me:$LINENO: error: cannot find install-sh or install.sh in config $srcdir/config" >&5
-echo "$as_me: error: cannot find install-sh or install.sh in config $srcdir/config" >&2;}
-   { (exit 1); exit 1; }; }
-fi
-ac_config_guess="$SHELL $ac_aux_dir/config.guess"
-ac_config_sub="$SHELL $ac_aux_dir/config.sub"
-ac_configure="$SHELL $ac_aux_dir/configure" # This should be Cygnus configure.
-
-
-VERSION=0.0.3
-PACKAGE=libg3d
-
-am__api_version="1.7"
-# Find a good install program.  We prefer a C program (faster),
-# so one script is as good as another.  But avoid the broken or
-# incompatible versions:
-# SysV /etc/install, /usr/sbin/install
-# SunOS /usr/etc/install
-# IRIX /sbin/install
-# AIX /bin/install
-# AmigaOS /C/install, which installs bootblocks on floppy discs
-# AIX 4 /usr/bin/installbsd, which doesn't work without a -g flag
-# AFS /usr/afsws/bin/install, which mishandles nonexistent args
-# SVR4 /usr/ucb/install, which tries to use the nonexistent group "staff"
-# OS/2's system install, which has a completely different semantic
-# ./install, which can be erroneously created by make from ./install.sh.
-echo "$as_me:$LINENO: checking for a BSD-compatible install" >&5
-echo $ECHO_N "checking for a BSD-compatible install... $ECHO_C" >&6
-if test -z "$INSTALL"; then
-if test "${ac_cv_path_install+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  # Account for people who put trailing slashes in PATH elements.
-case $as_dir/ in
-  ./ | .// | /cC/* | \
-  /etc/* | /usr/sbin/* | /usr/etc/* | /sbin/* | /usr/afsws/bin/* | \
-  ?:\\/os2\\/install\\/* | ?:\\/OS2\\/INSTALL\\/* | \
-  /usr/ucb/* ) ;;
-  *)
-    # OSF1 and SCO ODT 3.0 have their own names for install.
-    # Don't use installbsd from OSF since it installs stuff as root
-    # by default.
-    for ac_prog in ginstall scoinst install; do
-      for ac_exec_ext in '' $ac_executable_extensions; do
-	if $as_executable_p "$as_dir/$ac_prog$ac_exec_ext"; then
-	  if test $ac_prog = install &&
-	    grep dspmsg "$as_dir/$ac_prog$ac_exec_ext" >/dev/null 2>&1; then
-	    # AIX install.  It has an incompatible calling convention.
-	    :
-	  elif test $ac_prog = install &&
-	    grep pwplus "$as_dir/$ac_prog$ac_exec_ext" >/dev/null 2>&1; then
-	    # program-specific install script used by HP pwplus--don't use.
-	    :
-	  else
-	    ac_cv_path_install="$as_dir/$ac_prog$ac_exec_ext -c"
-	    break 3
-	  fi
-	fi
-      done
-    done
-    ;;
-esac
-done
-
-
-fi
-  if test "${ac_cv_path_install+set}" = set; then
-    INSTALL=$ac_cv_path_install
-  else
-    # As a last resort, use the slow shell script.  We don't cache a
-    # path for INSTALL within a source directory, because that will
-    # break other packages using the cache if that directory is
-    # removed, or if the path is relative.
-    INSTALL=$ac_install_sh
-  fi
-fi
-echo "$as_me:$LINENO: result: $INSTALL" >&5
-echo "${ECHO_T}$INSTALL" >&6
-
-# Use test -z because SunOS4 sh mishandles braces in ${var-val}.
-# It thinks the first close brace ends the variable substitution.
-test -z "$INSTALL_PROGRAM" && INSTALL_PROGRAM='${INSTALL}'
-
-test -z "$INSTALL_SCRIPT" && INSTALL_SCRIPT='${INSTALL}'
-
-test -z "$INSTALL_DATA" && INSTALL_DATA='${INSTALL} -m 644'
-
-echo "$as_me:$LINENO: checking whether build environment is sane" >&5
-echo $ECHO_N "checking whether build environment is sane... $ECHO_C" >&6
-# Just in case
-sleep 1
-echo timestamp > conftest.file
-# Do `set' in a subshell so we don't clobber the current shell's
-# arguments.  Must try -L first in case configure is actually a
-# symlink; some systems play weird games with the mod time of symlinks
-# (eg FreeBSD returns the mod time of the symlink's containing
-# directory).
-if (
-   set X `ls -Lt $srcdir/configure conftest.file 2> /dev/null`
-   if test "$*" = "X"; then
-      # -L didn't work.
-      set X `ls -t $srcdir/configure conftest.file`
-   fi
-   rm -f conftest.file
-   if test "$*" != "X $srcdir/configure conftest.file" \
-      && test "$*" != "X conftest.file $srcdir/configure"; then
-
-      # If neither matched, then we have a broken ls.  This can happen
-      # if, for instance, CONFIG_SHELL is bash and it inherits a
-      # broken ls alias from the environment.  This has actually
-      # happened.  Such a system could not be considered "sane".
-      { { echo "$as_me:$LINENO: error: ls -t appears to fail.  Make sure there is not a broken
-alias in your environment" >&5
-echo "$as_me: error: ls -t appears to fail.  Make sure there is not a broken
-alias in your environment" >&2;}
-   { (exit 1); exit 1; }; }
-   fi
-
-   test "$2" = conftest.file
-   )
-then
-   # Ok.
-   :
-else
-   { { echo "$as_me:$LINENO: error: newly created file is older than distributed files!
-Check your system clock" >&5
-echo "$as_me: error: newly created file is older than distributed files!
-Check your system clock" >&2;}
-   { (exit 1); exit 1; }; }
-fi
-echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
-test "$program_prefix" != NONE &&
-  program_transform_name="s,^,$program_prefix,;$program_transform_name"
-# Use a double $ so make ignores it.
-test "$program_suffix" != NONE &&
-  program_transform_name="s,\$,$program_suffix,;$program_transform_name"
-# Double any \ or $.  echo might interpret backslashes.
-# By default was `s,x,x', remove it if useless.
-cat <<\_ACEOF >conftest.sed
-s/[\\$]/&&/g;s/;s,x,x,$//
-_ACEOF
-program_transform_name=`echo $program_transform_name | sed -f conftest.sed`
-rm conftest.sed
-
-
-# expand $ac_aux_dir to an absolute path
-am_aux_dir=`cd $ac_aux_dir && pwd`
-
-test x"${MISSING+set}" = xset || MISSING="\${SHELL} $am_aux_dir/missing"
-# Use eval to expand $SHELL
-if eval "$MISSING --run true"; then
-  am_missing_run="$MISSING --run "
-else
-  am_missing_run=
-  { echo "$as_me:$LINENO: WARNING: \`missing' script is too old or missing" >&5
-echo "$as_me: WARNING: \`missing' script is too old or missing" >&2;}
-fi
-
-for ac_prog in gawk mawk nawk awk
-do
-  # Extract the first word of "$ac_prog", so it can be a program name with args.
-set dummy $ac_prog; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_prog_AWK+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$AWK"; then
-  ac_cv_prog_AWK="$AWK" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_prog_AWK="$ac_prog"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
-fi
-fi
-AWK=$ac_cv_prog_AWK
-if test -n "$AWK"; then
-  echo "$as_me:$LINENO: result: $AWK" >&5
-echo "${ECHO_T}$AWK" >&6
-else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi
-
-  test -n "$AWK" && break
-done
-
-echo "$as_me:$LINENO: checking whether ${MAKE-make} sets \$(MAKE)" >&5
-echo $ECHO_N "checking whether ${MAKE-make} sets \$(MAKE)... $ECHO_C" >&6
-set dummy ${MAKE-make}; ac_make=`echo "$2" | sed 'y,:./+-,___p_,'`
-if eval "test \"\${ac_cv_prog_make_${ac_make}_set+set}\" = set"; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  cat >conftest.make <<\_ACEOF
-all:
-	@echo 'ac_maketemp="$(MAKE)"'
-_ACEOF
-# GNU make sometimes prints "make[1]: Entering...", which would confuse us.
-eval `${MAKE-make} -f conftest.make 2>/dev/null | grep temp=`
-if test -n "$ac_maketemp"; then
-  eval ac_cv_prog_make_${ac_make}_set=yes
-else
-  eval ac_cv_prog_make_${ac_make}_set=no
-fi
-rm -f conftest.make
-fi
-if eval "test \"`echo '$ac_cv_prog_make_'${ac_make}_set`\" = yes"; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
-  SET_MAKE=
-else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-  SET_MAKE="MAKE=${MAKE-make}"
-fi
-
-rm -rf .tst 2>/dev/null
-mkdir .tst 2>/dev/null
-if test -d .tst; then
-  am__leading_dot=.
-else
-  am__leading_dot=_
-fi
-rmdir .tst 2>/dev/null
-
- # test to see if srcdir already configured
-if test "`cd $srcdir && pwd`" != "`pwd`" &&
-   test -f $srcdir/config.status; then
-  { { echo "$as_me:$LINENO: error: source directory already configured; run \"make distclean\" there first" >&5
-echo "$as_me: error: source directory already configured; run \"make distclean\" there first" >&2;}
-   { (exit 1); exit 1; }; }
-fi
-
-# test whether we have cygpath
-if test -z "$CYGPATH_W"; then
-  if (cygpath --version) >/dev/null 2>/dev/null; then
-    CYGPATH_W='cygpath -w'
-  else
-    CYGPATH_W=echo
-  fi
-fi
-
-
-# Define the identity of the package.
- PACKAGE=$PACKAGE
- VERSION=$VERSION
-
-
-# Some tools Automake needs.
-
-ACLOCAL=${ACLOCAL-"${am_missing_run}aclocal-${am__api_version}"}
-
-
-AUTOCONF=${AUTOCONF-"${am_missing_run}autoconf"}
-
-
-AUTOMAKE=${AUTOMAKE-"${am_missing_run}automake-${am__api_version}"}
-
-
-AUTOHEADER=${AUTOHEADER-"${am_missing_run}autoheader"}
-
-
-MAKEINFO=${MAKEINFO-"${am_missing_run}makeinfo"}
-
-
-AMTAR=${AMTAR-"${am_missing_run}tar"}
-
-install_sh=${install_sh-"$am_aux_dir/install-sh"}
-
-# Installed binaries are usually stripped using `strip' when the user
-# run `make install-strip'.  However `strip' might not be the right
-# tool to use in cross-compilation environments, therefore Automake
-# will honor the `STRIP' environment variable to overrule this program.
-if test "$cross_compiling" != no; then
-  if test -n "$ac_tool_prefix"; then
-  # Extract the first word of "${ac_tool_prefix}strip", so it can be a program name with args.
-set dummy ${ac_tool_prefix}strip; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_prog_STRIP+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$STRIP"; then
-  ac_cv_prog_STRIP="$STRIP" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_prog_STRIP="${ac_tool_prefix}strip"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
-fi
-fi
-STRIP=$ac_cv_prog_STRIP
-if test -n "$STRIP"; then
-  echo "$as_me:$LINENO: result: $STRIP" >&5
-echo "${ECHO_T}$STRIP" >&6
-else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi
-
-fi
-if test -z "$ac_cv_prog_STRIP"; then
-  ac_ct_STRIP=$STRIP
-  # Extract the first word of "strip", so it can be a program name with args.
-set dummy strip; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_prog_ac_ct_STRIP+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$ac_ct_STRIP"; then
-  ac_cv_prog_ac_ct_STRIP="$ac_ct_STRIP" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_prog_ac_ct_STRIP="strip"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
-  test -z "$ac_cv_prog_ac_ct_STRIP" && ac_cv_prog_ac_ct_STRIP=":"
-fi
-fi
-ac_ct_STRIP=$ac_cv_prog_ac_ct_STRIP
-if test -n "$ac_ct_STRIP"; then
-  echo "$as_me:$LINENO: result: $ac_ct_STRIP" >&5
-echo "${ECHO_T}$ac_ct_STRIP" >&6
-else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi
-
-  STRIP=$ac_ct_STRIP
-else
-  STRIP="$ac_cv_prog_STRIP"
-fi
-
-fi
-INSTALL_STRIP_PROGRAM="\${SHELL} \$(install_sh) -c -s"
-
-# We need awk for the "check" target.  The system "awk" is bad on
-# some platforms.
-
-
-
-
-
-          ac_config_headers="$ac_config_headers include/g3d/config.h"
-
-
-ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-if test -n "$ac_tool_prefix"; then
-  # Extract the first word of "${ac_tool_prefix}gcc", so it can be a program name with args.
-set dummy ${ac_tool_prefix}gcc; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_prog_CC+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$CC"; then
-  ac_cv_prog_CC="$CC" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_prog_CC="${ac_tool_prefix}gcc"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
-fi
-fi
-CC=$ac_cv_prog_CC
-if test -n "$CC"; then
-  echo "$as_me:$LINENO: result: $CC" >&5
-echo "${ECHO_T}$CC" >&6
-else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi
-
-fi
-if test -z "$ac_cv_prog_CC"; then
-  ac_ct_CC=$CC
-  # Extract the first word of "gcc", so it can be a program name with args.
-set dummy gcc; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_prog_ac_ct_CC+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$ac_ct_CC"; then
-  ac_cv_prog_ac_ct_CC="$ac_ct_CC" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_prog_ac_ct_CC="gcc"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
-fi
-fi
-ac_ct_CC=$ac_cv_prog_ac_ct_CC
-if test -n "$ac_ct_CC"; then
-  echo "$as_me:$LINENO: result: $ac_ct_CC" >&5
-echo "${ECHO_T}$ac_ct_CC" >&6
-else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi
-
-  CC=$ac_ct_CC
-else
-  CC="$ac_cv_prog_CC"
-fi
-
-if test -z "$CC"; then
-  if test -n "$ac_tool_prefix"; then
-  # Extract the first word of "${ac_tool_prefix}cc", so it can be a program name with args.
-set dummy ${ac_tool_prefix}cc; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_prog_CC+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$CC"; then
-  ac_cv_prog_CC="$CC" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_prog_CC="${ac_tool_prefix}cc"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
-fi
-fi
-CC=$ac_cv_prog_CC
-if test -n "$CC"; then
-  echo "$as_me:$LINENO: result: $CC" >&5
-echo "${ECHO_T}$CC" >&6
-else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi
-
-fi
-if test -z "$ac_cv_prog_CC"; then
-  ac_ct_CC=$CC
-  # Extract the first word of "cc", so it can be a program name with args.
-set dummy cc; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_prog_ac_ct_CC+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$ac_ct_CC"; then
-  ac_cv_prog_ac_ct_CC="$ac_ct_CC" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_prog_ac_ct_CC="cc"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
-fi
-fi
-ac_ct_CC=$ac_cv_prog_ac_ct_CC
-if test -n "$ac_ct_CC"; then
-  echo "$as_me:$LINENO: result: $ac_ct_CC" >&5
-echo "${ECHO_T}$ac_ct_CC" >&6
-else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi
-
-  CC=$ac_ct_CC
-else
-  CC="$ac_cv_prog_CC"
-fi
-
-fi
-if test -z "$CC"; then
-  # Extract the first word of "cc", so it can be a program name with args.
-set dummy cc; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_prog_CC+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$CC"; then
-  ac_cv_prog_CC="$CC" # Let the user override the test.
-else
-  ac_prog_rejected=no
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    if test "$as_dir/$ac_word$ac_exec_ext" = "/usr/ucb/cc"; then
-       ac_prog_rejected=yes
-       continue
-     fi
-    ac_cv_prog_CC="cc"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
-if test $ac_prog_rejected = yes; then
-  # We found a bogon in the path, so make sure we never use it.
-  set dummy $ac_cv_prog_CC
-  shift
-  if test $# != 0; then
-    # We chose a different compiler from the bogus one.
-    # However, it has the same basename, so the bogon will be chosen
-    # first if we set CC to just the basename; use the full file name.
-    shift
-    ac_cv_prog_CC="$as_dir/$ac_word${1+' '}$@"
-  fi
-fi
-fi
-fi
-CC=$ac_cv_prog_CC
-if test -n "$CC"; then
-  echo "$as_me:$LINENO: result: $CC" >&5
-echo "${ECHO_T}$CC" >&6
-else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi
-
-fi
-if test -z "$CC"; then
-  if test -n "$ac_tool_prefix"; then
-  for ac_prog in cl
-  do
-    # Extract the first word of "$ac_tool_prefix$ac_prog", so it can be a program name with args.
-set dummy $ac_tool_prefix$ac_prog; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_prog_CC+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$CC"; then
-  ac_cv_prog_CC="$CC" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_prog_CC="$ac_tool_prefix$ac_prog"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
-fi
-fi
-CC=$ac_cv_prog_CC
-if test -n "$CC"; then
-  echo "$as_me:$LINENO: result: $CC" >&5
-echo "${ECHO_T}$CC" >&6
-else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi
-
-    test -n "$CC" && break
-  done
-fi
-if test -z "$CC"; then
-  ac_ct_CC=$CC
-  for ac_prog in cl
-do
-  # Extract the first word of "$ac_prog", so it can be a program name with args.
-set dummy $ac_prog; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_prog_ac_ct_CC+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$ac_ct_CC"; then
-  ac_cv_prog_ac_ct_CC="$ac_ct_CC" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_prog_ac_ct_CC="$ac_prog"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
-fi
-fi
-ac_ct_CC=$ac_cv_prog_ac_ct_CC
-if test -n "$ac_ct_CC"; then
-  echo "$as_me:$LINENO: result: $ac_ct_CC" >&5
-echo "${ECHO_T}$ac_ct_CC" >&6
-else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi
-
-  test -n "$ac_ct_CC" && break
-done
-
-  CC=$ac_ct_CC
-fi
-
-fi
-
-
-test -z "$CC" && { { echo "$as_me:$LINENO: error: no acceptable C compiler found in \$PATH
-See \`config.log' for more details." >&5
-echo "$as_me: error: no acceptable C compiler found in \$PATH
-See \`config.log' for more details." >&2;}
-   { (exit 1); exit 1; }; }
-
-# Provide some information about the compiler.
-echo "$as_me:$LINENO:" \
-     "checking for C compiler version" >&5
-ac_compiler=`set X $ac_compile; echo $2`
-{ (eval echo "$as_me:$LINENO: \"$ac_compiler --version </dev/null >&5\"") >&5
-  (eval $ac_compiler --version </dev/null >&5) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }
-{ (eval echo "$as_me:$LINENO: \"$ac_compiler -v </dev/null >&5\"") >&5
-  (eval $ac_compiler -v </dev/null >&5) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }
-{ (eval echo "$as_me:$LINENO: \"$ac_compiler -V </dev/null >&5\"") >&5
-  (eval $ac_compiler -V </dev/null >&5) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }
-
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-ac_clean_files_save=$ac_clean_files
-ac_clean_files="$ac_clean_files a.out a.exe b.out"
-# Try to create an executable without -o first, disregard a.out.
-# It will help us diagnose broken compilers, and finding out an intuition
-# of exeext.
-echo "$as_me:$LINENO: checking for C compiler default output file name" >&5
-echo $ECHO_N "checking for C compiler default output file name... $ECHO_C" >&6
-ac_link_default=`echo "$ac_link" | sed 's/ -o *conftest[^ ]*//'`
-if { (eval echo "$as_me:$LINENO: \"$ac_link_default\"") >&5
-  (eval $ac_link_default) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; then
-  # Find the output, starting from the most likely.  This scheme is
-# not robust to junk in `.', hence go to wildcards (a.*) only as a last
-# resort.
-
-# Be careful to initialize this variable, since it used to be cached.
-# Otherwise an old cache value of `no' led to `EXEEXT = no' in a Makefile.
-ac_cv_exeext=
-# b.out is created by i960 compilers.
-for ac_file in a_out.exe a.exe conftest.exe a.out conftest a.* conftest.* b.out
-do
-  test -f "$ac_file" || continue
-  case $ac_file in
-    *.$ac_ext | *.xcoff | *.tds | *.d | *.pdb | *.xSYM | *.bb | *.bbg | *.o | *.obj )
-	;;
-    conftest.$ac_ext )
-	# This is the source file.
-	;;
-    [ab].out )
-	# We found the default executable, but exeext='' is most
-	# certainly right.
-	break;;
-    *.* )
-	ac_cv_exeext=`expr "$ac_file" : '[^.]*\(\..*\)'`
-	# FIXME: I believe we export ac_cv_exeext for Libtool,
-	# but it would be cool to find out if it's true.  Does anybody
-	# maintain Libtool? --akim.
-	export ac_cv_exeext
-	break;;
-    * )
-	break;;
-  esac
-done
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-{ { echo "$as_me:$LINENO: error: C compiler cannot create executables
-See \`config.log' for more details." >&5
-echo "$as_me: error: C compiler cannot create executables
-See \`config.log' for more details." >&2;}
-   { (exit 77); exit 77; }; }
-fi
-
-ac_exeext=$ac_cv_exeext
-echo "$as_me:$LINENO: result: $ac_file" >&5
-echo "${ECHO_T}$ac_file" >&6
-
-# Check the compiler produces executables we can run.  If not, either
-# the compiler is broken, or we cross compile.
-echo "$as_me:$LINENO: checking whether the C compiler works" >&5
-echo $ECHO_N "checking whether the C compiler works... $ECHO_C" >&6
-# FIXME: These cross compiler hacks should be removed for Autoconf 3.0
-# If not cross compiling, check that we can run a simple program.
-if test "$cross_compiling" != yes; then
-  if { ac_try='./$ac_file'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-    cross_compiling=no
-  else
-    if test "$cross_compiling" = maybe; then
-	cross_compiling=yes
-    else
-	{ { echo "$as_me:$LINENO: error: cannot run C compiled programs.
-If you meant to cross compile, use \`--host'.
-See \`config.log' for more details." >&5
-echo "$as_me: error: cannot run C compiled programs.
-If you meant to cross compile, use \`--host'.
-See \`config.log' for more details." >&2;}
-   { (exit 1); exit 1; }; }
-    fi
-  fi
-fi
-echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
-
-rm -f a.out a.exe conftest$ac_cv_exeext b.out
-ac_clean_files=$ac_clean_files_save
-# Check the compiler produces executables we can run.  If not, either
-# the compiler is broken, or we cross compile.
-echo "$as_me:$LINENO: checking whether we are cross compiling" >&5
-echo $ECHO_N "checking whether we are cross compiling... $ECHO_C" >&6
-echo "$as_me:$LINENO: result: $cross_compiling" >&5
-echo "${ECHO_T}$cross_compiling" >&6
-
-echo "$as_me:$LINENO: checking for suffix of executables" >&5
-echo $ECHO_N "checking for suffix of executables... $ECHO_C" >&6
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; then
-  # If both `conftest.exe' and `conftest' are `present' (well, observable)
-# catch `conftest.exe'.  For instance with Cygwin, `ls conftest' will
-# work properly (i.e., refer to `conftest.exe'), while it won't with
-# `rm'.
-for ac_file in conftest.exe conftest conftest.*; do
-  test -f "$ac_file" || continue
-  case $ac_file in
-    *.$ac_ext | *.xcoff | *.tds | *.d | *.pdb | *.xSYM | *.bb | *.bbg | *.o | *.obj ) ;;
-    *.* ) ac_cv_exeext=`expr "$ac_file" : '[^.]*\(\..*\)'`
-	  export ac_cv_exeext
-	  break;;
-    * ) break;;
-  esac
-done
-else
-  { { echo "$as_me:$LINENO: error: cannot compute suffix of executables: cannot compile and link
-See \`config.log' for more details." >&5
-echo "$as_me: error: cannot compute suffix of executables: cannot compile and link
-See \`config.log' for more details." >&2;}
-   { (exit 1); exit 1; }; }
-fi
-
-rm -f conftest$ac_cv_exeext
-echo "$as_me:$LINENO: result: $ac_cv_exeext" >&5
-echo "${ECHO_T}$ac_cv_exeext" >&6
-
-rm -f conftest.$ac_ext
-EXEEXT=$ac_cv_exeext
-ac_exeext=$EXEEXT
-echo "$as_me:$LINENO: checking for suffix of object files" >&5
-echo $ECHO_N "checking for suffix of object files... $ECHO_C" >&6
-if test "${ac_cv_objext+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.o conftest.obj
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; then
-  for ac_file in `(ls conftest.o conftest.obj; ls conftest.*) 2>/dev/null`; do
-  case $ac_file in
-    *.$ac_ext | *.xcoff | *.tds | *.d | *.pdb | *.xSYM | *.bb | *.bbg ) ;;
-    *) ac_cv_objext=`expr "$ac_file" : '.*\.\(.*\)'`
-       break;;
-  esac
-done
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-{ { echo "$as_me:$LINENO: error: cannot compute suffix of object files: cannot compile
-See \`config.log' for more details." >&5
-echo "$as_me: error: cannot compute suffix of object files: cannot compile
-See \`config.log' for more details." >&2;}
-   { (exit 1); exit 1; }; }
-fi
-
-rm -f conftest.$ac_cv_objext conftest.$ac_ext
-fi
-echo "$as_me:$LINENO: result: $ac_cv_objext" >&5
-echo "${ECHO_T}$ac_cv_objext" >&6
-OBJEXT=$ac_cv_objext
-ac_objext=$OBJEXT
-echo "$as_me:$LINENO: checking whether we are using the GNU C compiler" >&5
-echo $ECHO_N "checking whether we are using the GNU C compiler... $ECHO_C" >&6
-if test "${ac_cv_c_compiler_gnu+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-#ifndef __GNUC__
-       choke me
-#endif
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_compiler_gnu=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_compiler_gnu=no
-fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-ac_cv_c_compiler_gnu=$ac_compiler_gnu
-
-fi
-echo "$as_me:$LINENO: result: $ac_cv_c_compiler_gnu" >&5
-echo "${ECHO_T}$ac_cv_c_compiler_gnu" >&6
-GCC=`test $ac_compiler_gnu = yes && echo yes`
-ac_test_CFLAGS=${CFLAGS+set}
-ac_save_CFLAGS=$CFLAGS
-CFLAGS="-g"
-echo "$as_me:$LINENO: checking whether $CC accepts -g" >&5
-echo $ECHO_N "checking whether $CC accepts -g... $ECHO_C" >&6
-if test "${ac_cv_prog_cc_g+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_prog_cc_g=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_cv_prog_cc_g=no
-fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-fi
-echo "$as_me:$LINENO: result: $ac_cv_prog_cc_g" >&5
-echo "${ECHO_T}$ac_cv_prog_cc_g" >&6
-if test "$ac_test_CFLAGS" = set; then
-  CFLAGS=$ac_save_CFLAGS
-elif test $ac_cv_prog_cc_g = yes; then
-  if test "$GCC" = yes; then
-    CFLAGS="-g -O2"
-  else
-    CFLAGS="-g"
-  fi
-else
-  if test "$GCC" = yes; then
-    CFLAGS="-O2"
-  else
-    CFLAGS=
-  fi
-fi
-echo "$as_me:$LINENO: checking for $CC option to accept ANSI C" >&5
-echo $ECHO_N "checking for $CC option to accept ANSI C... $ECHO_C" >&6
-if test "${ac_cv_prog_cc_stdc+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  ac_cv_prog_cc_stdc=no
-ac_save_CC=$CC
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-#include <stdarg.h>
-#include <stdio.h>
-#include <sys/types.h>
-#include <sys/stat.h>
-/* Most of the following tests are stolen from RCS 5.7's src/conf.sh.  */
-struct buf { int x; };
-FILE * (*rcsopen) (struct buf *, struct stat *, int);
-static char *e (p, i)
-     char **p;
-     int i;
-{
-  return p[i];
-}
-static char *f (char * (*g) (char **, int), char **p, ...)
-{
-  char *s;
-  va_list v;
-  va_start (v,p);
-  s = g (p, va_arg (v,int));
-  va_end (v);
-  return s;
-}
-
-/* OSF 4.0 Compaq cc is some sort of almost-ANSI by default.  It has
-   function prototypes and stuff, but not '\xHH' hex character constants.
-   These don't provoke an error unfortunately, instead are silently treated
-   as 'x'.  The following induces an error, until -std1 is added to get
-   proper ANSI mode.  Curiously '\x00'!='x' always comes out true, for an
-   array size at least.  It's necessary to write '\x00'==0 to get something
-   that's true only with -std1.  */
-int osf4_cc_array ['\x00' == 0 ? 1 : -1];
-
-int test (int i, double x);
-struct s1 {int (*f) (int a);};
-struct s2 {int (*f) (double a);};
-int pairnames (int, char **, FILE *(*)(struct buf *, struct stat *, int), int, int);
-int argc;
-char **argv;
-int
-main ()
-{
-return f (e, argv, 0) != argv[0]  ||  f (e, argv, 1) != argv[1];
-  ;
-  return 0;
-}
-_ACEOF
-# Don't try gcc -ansi; that turns off useful extensions and
-# breaks some systems' header files.
-# AIX			-qlanglvl=ansi
-# Ultrix and OSF/1	-std1
-# HP-UX 10.20 and later	-Ae
-# HP-UX older versions	-Aa -D_HPUX_SOURCE
-# SVR4			-Xc -D__EXTENSIONS__
-for ac_arg in "" -qlanglvl=ansi -std1 -Ae "-Aa -D_HPUX_SOURCE" "-Xc -D__EXTENSIONS__"
-do
-  CC="$ac_save_CC $ac_arg"
-  rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_prog_cc_stdc=$ac_arg
-break
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-fi
-rm -f conftest.err conftest.$ac_objext
-done
-rm -f conftest.$ac_ext conftest.$ac_objext
-CC=$ac_save_CC
-
-fi
-
-case "x$ac_cv_prog_cc_stdc" in
-  x|xno)
-    echo "$as_me:$LINENO: result: none needed" >&5
-echo "${ECHO_T}none needed" >&6 ;;
-  *)
-    echo "$as_me:$LINENO: result: $ac_cv_prog_cc_stdc" >&5
-echo "${ECHO_T}$ac_cv_prog_cc_stdc" >&6
-    CC="$CC $ac_cv_prog_cc_stdc" ;;
-esac
-
-# Some people use a C++ compiler to compile C.  Since we use `exit',
-# in C++ we need to declare it.  In case someone uses the same compiler
-# for both compiling C and C++ we need to have the C++ compiler decide
-# the declaration of exit, since it's the most demanding environment.
-cat >conftest.$ac_ext <<_ACEOF
-#ifndef __cplusplus
-  choke me
-#endif
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  for ac_declaration in \
-   '' \
-   'extern "C" void std::exit (int) throw (); using std::exit;' \
-   'extern "C" void std::exit (int); using std::exit;' \
-   'extern "C" void exit (int) throw ();' \
-   'extern "C" void exit (int);' \
-   'void exit (int);'
-do
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-$ac_declaration
-#include <stdlib.h>
-int
-main ()
-{
-exit (42);
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  :
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-continue
-fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-$ac_declaration
-int
-main ()
-{
-exit (42);
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  break
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-done
-rm -f conftest*
-if test -n "$ac_declaration"; then
-  echo '#ifdef __cplusplus' >>confdefs.h
-  echo $ac_declaration      >>confdefs.h
-  echo '#endif'             >>confdefs.h
-fi
-
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-DEPDIR="${am__leading_dot}deps"
-
-          ac_config_commands="$ac_config_commands depfiles"
-
-
-am_make=${MAKE-make}
-cat > confinc << 'END'
-am__doit:
-	@echo done
-.PHONY: am__doit
-END
-# If we don't find an include directive, just comment out the code.
-echo "$as_me:$LINENO: checking for style of include used by $am_make" >&5
-echo $ECHO_N "checking for style of include used by $am_make... $ECHO_C" >&6
-am__include="#"
-am__quote=
-_am_result=none
-# First try GNU make style include.
-echo "include confinc" > confmf
-# We grep out `Entering directory' and `Leaving directory'
-# messages which can occur if `w' ends up in MAKEFLAGS.
-# In particular we don't look at `^make:' because GNU make might
-# be invoked under some other name (usually "gmake"), in which
-# case it prints its new name instead of `make'.
-if test "`$am_make -s -f confmf 2> /dev/null | grep -v 'ing directory'`" = "done"; then
-   am__include=include
-   am__quote=
-   _am_result=GNU
-fi
-# Now try BSD make style include.
-if test "$am__include" = "#"; then
-   echo '.include "confinc"' > confmf
-   if test "`$am_make -s -f confmf 2> /dev/null`" = "done"; then
-      am__include=.include
-      am__quote="\""
-      _am_result=BSD
-   fi
-fi
-
-
-echo "$as_me:$LINENO: result: $_am_result" >&5
-echo "${ECHO_T}$_am_result" >&6
-rm -f confinc confmf
-
-# Check whether --enable-dependency-tracking or --disable-dependency-tracking was given.
-if test "${enable_dependency_tracking+set}" = set; then
-  enableval="$enable_dependency_tracking"
-
-fi;
-if test "x$enable_dependency_tracking" != xno; then
-  am_depcomp="$ac_aux_dir/depcomp"
-  AMDEPBACKSLASH='\'
-fi
-
-
-if test "x$enable_dependency_tracking" != xno; then
-  AMDEP_TRUE=
-  AMDEP_FALSE='#'
-else
-  AMDEP_TRUE='#'
-  AMDEP_FALSE=
-fi
-
-
-
-
-depcc="$CC"   am_compiler_list=
-
-echo "$as_me:$LINENO: checking dependency style of $depcc" >&5
-echo $ECHO_N "checking dependency style of $depcc... $ECHO_C" >&6
-if test "${am_cv_CC_dependencies_compiler_type+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -z "$AMDEP_TRUE" && test -f "$am_depcomp"; then
-  # We make a subdir and do the tests there.  Otherwise we can end up
-  # making bogus files that we don't know about and never remove.  For
-  # instance it was reported that on HP-UX the gcc test will end up
-  # making a dummy file named `D' -- because `-MD' means `put the output
-  # in D'.
-  mkdir conftest.dir
-  # Copy depcomp to subdir because otherwise we won't find it if we're
-  # using a relative directory.
-  cp "$am_depcomp" conftest.dir
-  cd conftest.dir
-  # We will build objects and dependencies in a subdirectory because
-  # it helps to detect inapplicable dependency modes.  For instance
-  # both Tru64's cc and ICC support -MD to output dependencies as a
-  # side effect of compilation, but ICC will put the dependencies in
-  # the current directory while Tru64 will put them in the object
-  # directory.
-  mkdir sub
-
-  am_cv_CC_dependencies_compiler_type=none
-  if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
-  fi
-  for depmode in $am_compiler_list; do
-    # Setup a source with many dependencies, because some compilers
-    # like to wrap large dependency lists on column 80 (with \), and
-    # we should not choose a depcomp mode which is confused by this.
-    #
-    # We need to recreate these files for each test, as the compiler may
-    # overwrite some of them when testing with obscure command lines.
-    # This happens at least with the AIX C compiler.
-    : > sub/conftest.c
-    for i in 1 2 3 4 5 6; do
-      echo '#include "conftst'$i'.h"' >> sub/conftest.c
-      : > sub/conftst$i.h
-    done
-    echo "${am__include} ${am__quote}sub/conftest.Po${am__quote}" > confmf
-
-    case $depmode in
-    nosideeffect)
-      # after this tag, mechanisms are not by side-effect, so they'll
-      # only be used when explicitly requested
-      if test "x$enable_dependency_tracking" = xyes; then
-	continue
-      else
-	break
-      fi
-      ;;
-    none) break ;;
-    esac
-    # We check with `-c' and `-o' for the sake of the "dashmstdout"
-    # mode.  It turns out that the SunPro C++ compiler does not properly
-    # handle `-M -o', and we need to detect this.
-    if depmode=$depmode \
-       source=sub/conftest.c object=sub/conftest.${OBJEXT-o} \
-       depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
-       $SHELL ./depcomp $depcc -c -o sub/conftest.${OBJEXT-o} sub/conftest.c \
-         >/dev/null 2>conftest.err &&
-       grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
-       grep sub/conftest.${OBJEXT-o} sub/conftest.Po > /dev/null 2>&1 &&
-       ${MAKE-make} -s -f confmf > /dev/null 2>&1; then
-      # icc doesn't choke on unknown options, it will just issue warnings
-      # (even with -Werror).  So we grep stderr for any message
-      # that says an option was ignored.
-      if grep 'ignoring option' conftest.err >/dev/null 2>&1; then :; else
-        am_cv_CC_dependencies_compiler_type=$depmode
-        break
-      fi
-    fi
-  done
-
-  cd ..
-  rm -rf conftest.dir
-else
-  am_cv_CC_dependencies_compiler_type=none
-fi
-
-fi
-echo "$as_me:$LINENO: result: $am_cv_CC_dependencies_compiler_type" >&5
-echo "${ECHO_T}$am_cv_CC_dependencies_compiler_type" >&6
-CCDEPMODE=depmode=$am_cv_CC_dependencies_compiler_type
-
-
-
-if
-  test "x$enable_dependency_tracking" != xno \
-  && test "$am_cv_CC_dependencies_compiler_type" = gcc3; then
-  am__fastdepCC_TRUE=
-  am__fastdepCC_FALSE='#'
-else
-  am__fastdepCC_TRUE='#'
-  am__fastdepCC_FALSE=
-fi
-
-
-
-for ac_prog in flex lex
-do
-  # Extract the first word of "$ac_prog", so it can be a program name with args.
-set dummy $ac_prog; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_prog_LEX+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$LEX"; then
-  ac_cv_prog_LEX="$LEX" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_prog_LEX="$ac_prog"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
-fi
-fi
-LEX=$ac_cv_prog_LEX
-if test -n "$LEX"; then
-  echo "$as_me:$LINENO: result: $LEX" >&5
-echo "${ECHO_T}$LEX" >&6
-else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi
-
-  test -n "$LEX" && break
-done
-test -n "$LEX" || LEX=":"
-
-if test -z "$LEXLIB"
-then
-  echo "$as_me:$LINENO: checking for yywrap in -lfl" >&5
-echo $ECHO_N "checking for yywrap in -lfl... $ECHO_C" >&6
-if test "${ac_cv_lib_fl_yywrap+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  ac_check_lib_save_LIBS=$LIBS
-LIBS="-lfl  $LIBS"
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-/* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char yywrap ();
-int
-main ()
-{
-yywrap ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_lib_fl_yywrap=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_cv_lib_fl_yywrap=no
-fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_fl_yywrap" >&5
-echo "${ECHO_T}$ac_cv_lib_fl_yywrap" >&6
-if test $ac_cv_lib_fl_yywrap = yes; then
-  LEXLIB="-lfl"
-else
-  echo "$as_me:$LINENO: checking for yywrap in -ll" >&5
-echo $ECHO_N "checking for yywrap in -ll... $ECHO_C" >&6
-if test "${ac_cv_lib_l_yywrap+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  ac_check_lib_save_LIBS=$LIBS
-LIBS="-ll  $LIBS"
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-/* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char yywrap ();
-int
-main ()
-{
-yywrap ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_lib_l_yywrap=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_cv_lib_l_yywrap=no
-fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_l_yywrap" >&5
-echo "${ECHO_T}$ac_cv_lib_l_yywrap" >&6
-if test $ac_cv_lib_l_yywrap = yes; then
-  LEXLIB="-ll"
-fi
-
-fi
-
-fi
-
-if test "x$LEX" != "x:"; then
-  echo "$as_me:$LINENO: checking lex output file root" >&5
-echo $ECHO_N "checking lex output file root... $ECHO_C" >&6
-if test "${ac_cv_prog_lex_root+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  # The minimal lex program is just a single line: %%.  But some broken lexes
-# (Solaris, I think it was) want two %% lines, so accommodate them.
-cat >conftest.l <<_ACEOF
-%%
-%%
-_ACEOF
-{ (eval echo "$as_me:$LINENO: \"$LEX conftest.l\"") >&5
-  (eval $LEX conftest.l) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }
-if test -f lex.yy.c; then
-  ac_cv_prog_lex_root=lex.yy
-elif test -f lexyy.c; then
-  ac_cv_prog_lex_root=lexyy
-else
-  { { echo "$as_me:$LINENO: error: cannot find output from $LEX; giving up" >&5
-echo "$as_me: error: cannot find output from $LEX; giving up" >&2;}
-   { (exit 1); exit 1; }; }
-fi
-fi
-echo "$as_me:$LINENO: result: $ac_cv_prog_lex_root" >&5
-echo "${ECHO_T}$ac_cv_prog_lex_root" >&6
-rm -f conftest.l
-LEX_OUTPUT_ROOT=$ac_cv_prog_lex_root
-
-echo "$as_me:$LINENO: checking whether yytext is a pointer" >&5
-echo $ECHO_N "checking whether yytext is a pointer... $ECHO_C" >&6
-if test "${ac_cv_prog_lex_yytext_pointer+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  # POSIX says lex can declare yytext either as a pointer or an array; the
-# default is implementation-dependent. Figure out which it is, since
-# not all implementations provide the %pointer and %array declarations.
-ac_cv_prog_lex_yytext_pointer=no
-echo 'extern char *yytext;' >>$LEX_OUTPUT_ROOT.c
-ac_save_LIBS=$LIBS
-LIBS="$LIBS $LEXLIB"
-cat >conftest.$ac_ext <<_ACEOF
-`cat $LEX_OUTPUT_ROOT.c`
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_prog_lex_yytext_pointer=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_save_LIBS
-rm -f "${LEX_OUTPUT_ROOT}.c"
-
-fi
-echo "$as_me:$LINENO: result: $ac_cv_prog_lex_yytext_pointer" >&5
-echo "${ECHO_T}$ac_cv_prog_lex_yytext_pointer" >&6
-if test $ac_cv_prog_lex_yytext_pointer = yes; then
-
-cat >>confdefs.h <<\_ACEOF
-#define YYTEXT_POINTER 1
-_ACEOF
-
-fi
-
-fi
-if test "$LEX" = :; then
-  LEX=${am_missing_run}flex
-fi
-ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-echo "$as_me:$LINENO: checking how to run the C preprocessor" >&5
-echo $ECHO_N "checking how to run the C preprocessor... $ECHO_C" >&6
-# On Suns, sometimes $CPP names a directory.
-if test -n "$CPP" && test -d "$CPP"; then
-  CPP=
-fi
-if test -z "$CPP"; then
-  if test "${ac_cv_prog_CPP+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-      # Double quotes because CPP needs to be expanded
-    for CPP in "$CC -E" "$CC -E -traditional-cpp" "/lib/cpp"
-    do
-      ac_preproc_ok=false
-for ac_c_preproc_warn_flag in '' yes
-do
-  # Use a header file that comes with gcc, so configuring glibc
-  # with a fresh cross-compiler works.
-  # Prefer <limits.h> to <assert.h> if __STDC__ is defined, since
-  # <limits.h> exists even on freestanding compilers.
-  # On the NeXT, cc -E runs the code through the compiler's parser,
-  # not just through cpp. "Syntax error" is here to catch this case.
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-#ifdef __STDC__
-# include <limits.h>
-#else
-# include <assert.h>
-#endif
-		     Syntax error
-_ACEOF
-if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
-  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
-  if test -s conftest.err; then
-    ac_cpp_err=$ac_c_preproc_warn_flag
-    ac_cpp_err=$ac_cpp_err$ac_c_werror_flag
-  else
-    ac_cpp_err=
-  fi
-else
-  ac_cpp_err=yes
-fi
-if test -z "$ac_cpp_err"; then
-  :
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-  # Broken: fails on valid input.
-continue
-fi
-rm -f conftest.err conftest.$ac_ext
-
-  # OK, works on sane cases.  Now check whether non-existent headers
-  # can be detected and how.
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-#include <ac_nonexistent.h>
-_ACEOF
-if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
-  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
-  if test -s conftest.err; then
-    ac_cpp_err=$ac_c_preproc_warn_flag
-    ac_cpp_err=$ac_cpp_err$ac_c_werror_flag
-  else
-    ac_cpp_err=
-  fi
-else
-  ac_cpp_err=yes
-fi
-if test -z "$ac_cpp_err"; then
-  # Broken: success on invalid input.
-continue
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-  # Passes both tests.
-ac_preproc_ok=:
-break
-fi
-rm -f conftest.err conftest.$ac_ext
-
-done
-# Because of `break', _AC_PREPROC_IFELSE's cleaning code was skipped.
-rm -f conftest.err conftest.$ac_ext
-if $ac_preproc_ok; then
-  break
-fi
-
-    done
-    ac_cv_prog_CPP=$CPP
-
-fi
-  CPP=$ac_cv_prog_CPP
-else
-  ac_cv_prog_CPP=$CPP
-fi
-echo "$as_me:$LINENO: result: $CPP" >&5
-echo "${ECHO_T}$CPP" >&6
-ac_preproc_ok=false
-for ac_c_preproc_warn_flag in '' yes
-do
-  # Use a header file that comes with gcc, so configuring glibc
-  # with a fresh cross-compiler works.
-  # Prefer <limits.h> to <assert.h> if __STDC__ is defined, since
-  # <limits.h> exists even on freestanding compilers.
-  # On the NeXT, cc -E runs the code through the compiler's parser,
-  # not just through cpp. "Syntax error" is here to catch this case.
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-#ifdef __STDC__
-# include <limits.h>
-#else
-# include <assert.h>
-#endif
-		     Syntax error
-_ACEOF
-if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
-  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
-  if test -s conftest.err; then
-    ac_cpp_err=$ac_c_preproc_warn_flag
-    ac_cpp_err=$ac_cpp_err$ac_c_werror_flag
-  else
-    ac_cpp_err=
-  fi
-else
-  ac_cpp_err=yes
-fi
-if test -z "$ac_cpp_err"; then
-  :
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-  # Broken: fails on valid input.
-continue
-fi
-rm -f conftest.err conftest.$ac_ext
-
-  # OK, works on sane cases.  Now check whether non-existent headers
-  # can be detected and how.
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-#include <ac_nonexistent.h>
-_ACEOF
-if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
-  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
-  if test -s conftest.err; then
-    ac_cpp_err=$ac_c_preproc_warn_flag
-    ac_cpp_err=$ac_cpp_err$ac_c_werror_flag
-  else
-    ac_cpp_err=
-  fi
-else
-  ac_cpp_err=yes
-fi
-if test -z "$ac_cpp_err"; then
-  # Broken: success on invalid input.
-continue
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-  # Passes both tests.
-ac_preproc_ok=:
-break
-fi
-rm -f conftest.err conftest.$ac_ext
-
-done
-# Because of `break', _AC_PREPROC_IFELSE's cleaning code was skipped.
-rm -f conftest.err conftest.$ac_ext
-if $ac_preproc_ok; then
-  :
-else
-  { { echo "$as_me:$LINENO: error: C preprocessor \"$CPP\" fails sanity check
-See \`config.log' for more details." >&5
-echo "$as_me: error: C preprocessor \"$CPP\" fails sanity check
-See \`config.log' for more details." >&2;}
-   { (exit 1); exit 1; }; }
-fi
-
-ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-
-
-echo "$as_me:$LINENO: checking for egrep" >&5
-echo $ECHO_N "checking for egrep... $ECHO_C" >&6
-if test "${ac_cv_prog_egrep+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if echo a | (grep -E '(a|b)') >/dev/null 2>&1
-    then ac_cv_prog_egrep='grep -E'
-    else ac_cv_prog_egrep='egrep'
-    fi
-fi
-echo "$as_me:$LINENO: result: $ac_cv_prog_egrep" >&5
-echo "${ECHO_T}$ac_cv_prog_egrep" >&6
- EGREP=$ac_cv_prog_egrep
-
-
-echo "$as_me:$LINENO: checking for ANSI C header files" >&5
-echo $ECHO_N "checking for ANSI C header files... $ECHO_C" >&6
-if test "${ac_cv_header_stdc+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-#include <stdlib.h>
-#include <stdarg.h>
-#include <string.h>
-#include <float.h>
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_header_stdc=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_cv_header_stdc=no
-fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-
-if test $ac_cv_header_stdc = yes; then
-  # SunOS 4.x string.h does not declare mem*, contrary to ANSI.
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-#include <string.h>
-
-_ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "memchr" >/dev/null 2>&1; then
-  :
-else
-  ac_cv_header_stdc=no
-fi
-rm -f conftest*
-
-fi
-
-if test $ac_cv_header_stdc = yes; then
-  # ISC 2.0.2 stdlib.h does not declare free, contrary to ANSI.
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-#include <stdlib.h>
-
-_ACEOF
-if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
-  $EGREP "free" >/dev/null 2>&1; then
-  :
-else
-  ac_cv_header_stdc=no
-fi
-rm -f conftest*
-
-fi
-
-if test $ac_cv_header_stdc = yes; then
-  # /bin/cc in Irix-4.0.5 gets non-ANSI ctype macros unless using -ansi.
-  if test "$cross_compiling" = yes; then
-  :
-else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-#include <ctype.h>
-#if ((' ' & 0x0FF) == 0x020)
-# define ISLOWER(c) ('a' <= (c) && (c) <= 'z')
-# define TOUPPER(c) (ISLOWER(c) ? 'A' + ((c) - 'a') : (c))
-#else
-# define ISLOWER(c) \
-		   (('a' <= (c) && (c) <= 'i') \
-		     || ('j' <= (c) && (c) <= 'r') \
-		     || ('s' <= (c) && (c) <= 'z'))
-# define TOUPPER(c) (ISLOWER(c) ? ((c) | 0x40) : (c))
-#endif
-
-#define XOR(e, f) (((e) && !(f)) || (!(e) && (f)))
-int
-main ()
-{
-  int i;
-  for (i = 0; i < 256; i++)
-    if (XOR (islower (i), ISLOWER (i))
-	|| toupper (i) != TOUPPER (i))
-      exit(2);
-  exit (0);
-}
-_ACEOF
-rm -f conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && { ac_try='./conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  :
-else
-  echo "$as_me: program exited with status $ac_status" >&5
-echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-( exit $ac_status )
-ac_cv_header_stdc=no
-fi
-rm -f core *.core gmon.out bb.out conftest$ac_exeext conftest.$ac_objext conftest.$ac_ext
-fi
-fi
-fi
-echo "$as_me:$LINENO: result: $ac_cv_header_stdc" >&5
-echo "${ECHO_T}$ac_cv_header_stdc" >&6
-if test $ac_cv_header_stdc = yes; then
-
-cat >>confdefs.h <<\_ACEOF
-#define STDC_HEADERS 1
-_ACEOF
-
-fi
-
-
-# Check whether --enable-static or --disable-static was given.
-if test "${enable_static+set}" = set; then
-  enableval="$enable_static"
-  p=${PACKAGE-default}
-    case $enableval in
-    yes) enable_static=yes ;;
-    no) enable_static=no ;;
-    *)
-     enable_static=no
-      # Look at the argument we got.  We use all the common list separators.
-      lt_save_ifs="$IFS"; IFS="${IFS}$PATH_SEPARATOR,"
-      for pkg in $enableval; do
-	IFS="$lt_save_ifs"
-	if test "X$pkg" = "X$p"; then
-	  enable_static=yes
-	fi
-      done
-      IFS="$lt_save_ifs"
-      ;;
-    esac
-else
-  enable_static=no
-fi;
-
-
-# Check whether --enable-shared or --disable-shared was given.
-if test "${enable_shared+set}" = set; then
-  enableval="$enable_shared"
-  p=${PACKAGE-default}
-    case $enableval in
-    yes) enable_shared=yes ;;
-    no) enable_shared=no ;;
-    *)
-      enable_shared=no
-      # Look at the argument we got.  We use all the common list separators.
-      lt_save_ifs="$IFS"; IFS="${IFS}$PATH_SEPARATOR,"
-      for pkg in $enableval; do
-	IFS="$lt_save_ifs"
-	if test "X$pkg" = "X$p"; then
-	  enable_shared=yes
-	fi
-      done
-      IFS="$lt_save_ifs"
-      ;;
-    esac
-else
-  enable_shared=yes
-fi;
-
-# Check whether --enable-fast-install or --disable-fast-install was given.
-if test "${enable_fast_install+set}" = set; then
-  enableval="$enable_fast_install"
-  p=${PACKAGE-default}
-    case $enableval in
-    yes) enable_fast_install=yes ;;
-    no) enable_fast_install=no ;;
-    *)
-      enable_fast_install=no
-      # Look at the argument we got.  We use all the common list separators.
-      lt_save_ifs="$IFS"; IFS="${IFS}$PATH_SEPARATOR,"
-      for pkg in $enableval; do
-	IFS="$lt_save_ifs"
-	if test "X$pkg" = "X$p"; then
-	  enable_fast_install=yes
-	fi
-      done
-      IFS="$lt_save_ifs"
-      ;;
-    esac
-else
-  enable_fast_install=yes
-fi;
-
-# Make sure we can run config.sub.
-$ac_config_sub sun4 >/dev/null 2>&1 ||
-  { { echo "$as_me:$LINENO: error: cannot run $ac_config_sub" >&5
-echo "$as_me: error: cannot run $ac_config_sub" >&2;}
-   { (exit 1); exit 1; }; }
-
-echo "$as_me:$LINENO: checking build system type" >&5
-echo $ECHO_N "checking build system type... $ECHO_C" >&6
-if test "${ac_cv_build+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  ac_cv_build_alias=$build_alias
-test -z "$ac_cv_build_alias" &&
-  ac_cv_build_alias=`$ac_config_guess`
-test -z "$ac_cv_build_alias" &&
-  { { echo "$as_me:$LINENO: error: cannot guess build type; you must specify one" >&5
-echo "$as_me: error: cannot guess build type; you must specify one" >&2;}
-   { (exit 1); exit 1; }; }
-ac_cv_build=`$ac_config_sub $ac_cv_build_alias` ||
-  { { echo "$as_me:$LINENO: error: $ac_config_sub $ac_cv_build_alias failed" >&5
-echo "$as_me: error: $ac_config_sub $ac_cv_build_alias failed" >&2;}
-   { (exit 1); exit 1; }; }
-
-fi
-echo "$as_me:$LINENO: result: $ac_cv_build" >&5
-echo "${ECHO_T}$ac_cv_build" >&6
-build=$ac_cv_build
-build_cpu=`echo $ac_cv_build | sed 's/^\([^-]*\)-\([^-]*\)-\(.*\)$/\1/'`
-build_vendor=`echo $ac_cv_build | sed 's/^\([^-]*\)-\([^-]*\)-\(.*\)$/\2/'`
-build_os=`echo $ac_cv_build | sed 's/^\([^-]*\)-\([^-]*\)-\(.*\)$/\3/'`
-
-
-echo "$as_me:$LINENO: checking host system type" >&5
-echo $ECHO_N "checking host system type... $ECHO_C" >&6
-if test "${ac_cv_host+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  ac_cv_host_alias=$host_alias
-test -z "$ac_cv_host_alias" &&
-  ac_cv_host_alias=$ac_cv_build_alias
-ac_cv_host=`$ac_config_sub $ac_cv_host_alias` ||
-  { { echo "$as_me:$LINENO: error: $ac_config_sub $ac_cv_host_alias failed" >&5
-echo "$as_me: error: $ac_config_sub $ac_cv_host_alias failed" >&2;}
-   { (exit 1); exit 1; }; }
-
-fi
-echo "$as_me:$LINENO: result: $ac_cv_host" >&5
-echo "${ECHO_T}$ac_cv_host" >&6
-host=$ac_cv_host
-host_cpu=`echo $ac_cv_host | sed 's/^\([^-]*\)-\([^-]*\)-\(.*\)$/\1/'`
-host_vendor=`echo $ac_cv_host | sed 's/^\([^-]*\)-\([^-]*\)-\(.*\)$/\2/'`
-host_os=`echo $ac_cv_host | sed 's/^\([^-]*\)-\([^-]*\)-\(.*\)$/\3/'`
-
-
-echo "$as_me:$LINENO: checking for a sed that does not truncate output" >&5
-echo $ECHO_N "checking for a sed that does not truncate output... $ECHO_C" >&6
-if test "${lt_cv_path_SED+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  # Loop through the user's path and test for sed and gsed.
-# Then use that list of sed's as ones to test for truncation.
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for lt_ac_prog in sed gsed; do
-    for ac_exec_ext in '' $ac_executable_extensions; do
-      if $as_executable_p "$as_dir/$lt_ac_prog$ac_exec_ext"; then
-        lt_ac_sed_list="$lt_ac_sed_list $as_dir/$lt_ac_prog$ac_exec_ext"
-      fi
-    done
-  done
-done
-lt_ac_max=0
-lt_ac_count=0
-# Add /usr/xpg4/bin/sed as it is typically found on Solaris
-# along with /bin/sed that truncates output.
-for lt_ac_sed in $lt_ac_sed_list /usr/xpg4/bin/sed; do
-  test ! -f $lt_ac_sed && break
-  cat /dev/null > conftest.in
-  lt_ac_count=0
-  echo $ECHO_N "0123456789$ECHO_C" >conftest.in
-  # Check for GNU sed and select it if it is found.
-  if "$lt_ac_sed" --version 2>&1 < /dev/null | grep 'GNU' > /dev/null; then
-    lt_cv_path_SED=$lt_ac_sed
-    break
-  fi
-  while true; do
-    cat conftest.in conftest.in >conftest.tmp
-    mv conftest.tmp conftest.in
-    cp conftest.in conftest.nl
-    echo >>conftest.nl
-    $lt_ac_sed -e 's/a$//' < conftest.nl >conftest.out || break
-    cmp -s conftest.out conftest.nl || break
-    # 10000 chars as input seems more than enough
-    test $lt_ac_count -gt 10 && break
-    lt_ac_count=`expr $lt_ac_count + 1`
-    if test $lt_ac_count -gt $lt_ac_max; then
-      lt_ac_max=$lt_ac_count
-      lt_cv_path_SED=$lt_ac_sed
-    fi
-  done
-done
-SED=$lt_cv_path_SED
-
-fi
-
-echo "$as_me:$LINENO: result: $SED" >&5
-echo "${ECHO_T}$SED" >&6
-
-
-# Check whether --with-gnu-ld or --without-gnu-ld was given.
-if test "${with_gnu_ld+set}" = set; then
-  withval="$with_gnu_ld"
-  test "$withval" = no || with_gnu_ld=yes
-else
-  with_gnu_ld=no
-fi;
-ac_prog=ld
-if test "$GCC" = yes; then
-  # Check if gcc -print-prog-name=ld gives a path.
-  echo "$as_me:$LINENO: checking for ld used by $CC" >&5
-echo $ECHO_N "checking for ld used by $CC... $ECHO_C" >&6
-  case $host in
-  *-*-mingw*)
-    # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
-  *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
-  esac
-  case $ac_prog in
-    # Accept absolute paths.
-    [\\/]* | ?:[\\/]*)
-      re_direlt='/[^/][^/]*/\.\./'
-      # Canonicalize the pathname of ld
-      ac_prog=`echo $ac_prog| $SED 's%\\\\%/%g'`
-      while echo $ac_prog | grep "$re_direlt" > /dev/null 2>&1; do
-	ac_prog=`echo $ac_prog| $SED "s%$re_direlt%/%"`
-      done
-      test -z "$LD" && LD="$ac_prog"
-      ;;
-  "")
-    # If it fails, then pretend we aren't using GCC.
-    ac_prog=ld
-    ;;
-  *)
-    # If it is relative, then search for the first ld in PATH.
-    with_gnu_ld=unknown
-    ;;
-  esac
-elif test "$with_gnu_ld" = yes; then
-  echo "$as_me:$LINENO: checking for GNU ld" >&5
-echo $ECHO_N "checking for GNU ld... $ECHO_C" >&6
-else
-  echo "$as_me:$LINENO: checking for non-GNU ld" >&5
-echo $ECHO_N "checking for non-GNU ld... $ECHO_C" >&6
-fi
-if test "${lt_cv_path_LD+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -z "$LD"; then
-  lt_save_ifs="$IFS"; IFS=$PATH_SEPARATOR
-  for ac_dir in $PATH; do
-    IFS="$lt_save_ifs"
-    test -z "$ac_dir" && ac_dir=.
-    if test -f "$ac_dir/$ac_prog" || test -f "$ac_dir/$ac_prog$ac_exeext"; then
-      lt_cv_path_LD="$ac_dir/$ac_prog"
-      # Check to see if the program is GNU ld.  I'd rather use --version,
-      # but apparently some GNU ld's only accept -v.
-      # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
-      *GNU* | *'with BFD'*)
-	test "$with_gnu_ld" != no && break
-	;;
-      *)
-	test "$with_gnu_ld" != yes && break
-	;;
-      esac
-    fi
-  done
-  IFS="$lt_save_ifs"
-else
-  lt_cv_path_LD="$LD" # Let the user override the test with a path.
-fi
-fi
-
-LD="$lt_cv_path_LD"
-if test -n "$LD"; then
-  echo "$as_me:$LINENO: result: $LD" >&5
-echo "${ECHO_T}$LD" >&6
-else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi
-test -z "$LD" && { { echo "$as_me:$LINENO: error: no acceptable ld found in \$PATH" >&5
-echo "$as_me: error: no acceptable ld found in \$PATH" >&2;}
-   { (exit 1); exit 1; }; }
-echo "$as_me:$LINENO: checking if the linker ($LD) is GNU ld" >&5
-echo $ECHO_N "checking if the linker ($LD) is GNU ld... $ECHO_C" >&6
-if test "${lt_cv_prog_gnu_ld+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  # I'd rather use --version here, but apparently some GNU ld's only accept -v.
-case `$LD -v 2>&1 </dev/null` in
-*GNU* | *'with BFD'*)
-  lt_cv_prog_gnu_ld=yes
-  ;;
-*)
-  lt_cv_prog_gnu_ld=no
-  ;;
-esac
-fi
-echo "$as_me:$LINENO: result: $lt_cv_prog_gnu_ld" >&5
-echo "${ECHO_T}$lt_cv_prog_gnu_ld" >&6
-with_gnu_ld=$lt_cv_prog_gnu_ld
-
-
-echo "$as_me:$LINENO: checking for $LD option to reload object files" >&5
-echo $ECHO_N "checking for $LD option to reload object files... $ECHO_C" >&6
-if test "${lt_cv_ld_reload_flag+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  lt_cv_ld_reload_flag='-r'
-fi
-echo "$as_me:$LINENO: result: $lt_cv_ld_reload_flag" >&5
-echo "${ECHO_T}$lt_cv_ld_reload_flag" >&6
-reload_flag=$lt_cv_ld_reload_flag
-case $reload_flag in
-"" | " "*) ;;
-*) reload_flag=" $reload_flag" ;;
-esac
-reload_cmds='$LD$reload_flag -o $output$reload_objs'
-
-echo "$as_me:$LINENO: checking for BSD-compatible nm" >&5
-echo $ECHO_N "checking for BSD-compatible nm... $ECHO_C" >&6
-if test "${lt_cv_path_NM+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$NM"; then
-  # Let the user override the test.
-  lt_cv_path_NM="$NM"
-else
-  lt_save_ifs="$IFS"; IFS=$PATH_SEPARATOR
-  for ac_dir in $PATH /usr/ccs/bin /usr/ucb /bin; do
-    IFS="$lt_save_ifs"
-    test -z "$ac_dir" && ac_dir=.
-    tmp_nm="$ac_dir/${ac_tool_prefix}nm"
-    if test -f "$tmp_nm" || test -f "$tmp_nm$ac_exeext" ; then
-      # Check to see if the nm accepts a BSD-compat flag.
-      # Adding the `sed 1q' prevents false positives on HP-UX, which says:
-      #   nm: unknown option "B" ignored
-      # Tru64's nm complains that /dev/null is an invalid object file
-      case `"$tmp_nm" -B /dev/null 2>&1 | sed '1q'` in
-      */dev/null* | *'Invalid file or object type'*)
-	lt_cv_path_NM="$tmp_nm -B"
-	break
-        ;;
-      *)
-	case `"$tmp_nm" -p /dev/null 2>&1 | sed '1q'` in
-	*/dev/null*)
-	  lt_cv_path_NM="$tmp_nm -p"
-	  break
-	  ;;
-	*)
-	  lt_cv_path_NM=${lt_cv_path_NM="$tmp_nm"} # keep the first match, but
-	  continue # so that we can try to find one that supports BSD flags
-	  ;;
-	esac
-      esac
-    fi
-  done
-  IFS="$lt_save_ifs"
-  test -z "$lt_cv_path_NM" && lt_cv_path_NM=nm
-fi
-fi
-echo "$as_me:$LINENO: result: $lt_cv_path_NM" >&5
-echo "${ECHO_T}$lt_cv_path_NM" >&6
-NM="$lt_cv_path_NM"
-
-echo "$as_me:$LINENO: checking whether ln -s works" >&5
-echo $ECHO_N "checking whether ln -s works... $ECHO_C" >&6
-LN_S=$as_ln_s
-if test "$LN_S" = "ln -s"; then
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
-else
-  echo "$as_me:$LINENO: result: no, using $LN_S" >&5
-echo "${ECHO_T}no, using $LN_S" >&6
-fi
-
-echo "$as_me:$LINENO: checking how to recognise dependent libraries" >&5
-echo $ECHO_N "checking how to recognise dependent libraries... $ECHO_C" >&6
-if test "${lt_cv_deplibs_check_method+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  lt_cv_file_magic_cmd='$MAGIC_CMD'
-lt_cv_file_magic_test_file=
-lt_cv_deplibs_check_method='unknown'
-# Need to set the preceding variable on all platforms that support
-# interlibrary dependencies.
-# 'none' -- dependencies not supported.
-# `unknown' -- same as none, but documents that we really don't know.
-# 'pass_all' -- all dependencies passed with no checks.
-# 'test_compile' -- check by making test program.
-# 'file_magic [[regex]]' -- check by looking for files in library path
-# which responds to the $file_magic_cmd with a given extended regex.
-# If you have `file' or equivalent on your system and you're not sure
-# whether `pass_all' will *always* work, you probably want this one.
-
-case $host_os in
-aix4* | aix5*)
-  lt_cv_deplibs_check_method=pass_all
-  ;;
-
-beos*)
-  lt_cv_deplibs_check_method=pass_all
-  ;;
-
-bsdi4*)
-  lt_cv_deplibs_check_method='file_magic ELF [0-9][0-9]*-bit [ML]SB (shared object|dynamic lib)'
-  lt_cv_file_magic_cmd='/usr/bin/file -L'
-  lt_cv_file_magic_test_file=/shlib/libc.so
-  ;;
-
-cygwin*)
-  # func_win32_libid is a shell function defined in ltmain.sh
-  lt_cv_deplibs_check_method='file_magic ^x86 archive import|^x86 DLL'
-  lt_cv_file_magic_cmd='func_win32_libid'
-  ;;
-
-mingw* | pw32*)
-  # Base MSYS/MinGW do not provide the 'file' command needed by
-  # func_win32_libid shell function, so use a weaker test based on 'objdump'.
-  lt_cv_deplibs_check_method='file_magic file format pei*-i386(.*architecture: i386)?'
-  lt_cv_file_magic_cmd='$OBJDUMP -f'
-  ;;
-
-darwin* | rhapsody*)
-  lt_cv_deplibs_check_method=pass_all
-  ;;
-
-freebsd* | kfreebsd*-gnu)
-  if echo __ELF__ | $CC -E - | grep __ELF__ > /dev/null; then
-    case $host_cpu in
-    i*86 )
-      # Not sure whether the presence of OpenBSD here was a mistake.
-      # Let's accept both of them until this is cleared up.
-      lt_cv_deplibs_check_method='file_magic (FreeBSD|OpenBSD)/i[3-9]86 (compact )?demand paged shared library'
-      lt_cv_file_magic_cmd=/usr/bin/file
-      lt_cv_file_magic_test_file=`echo /usr/lib/libc.so.*`
-      ;;
-    esac
-  else
-    lt_cv_deplibs_check_method=pass_all
-  fi
-  ;;
-
-gnu*)
-  lt_cv_deplibs_check_method=pass_all
-  ;;
-
-hpux10.20* | hpux11*)
-  lt_cv_file_magic_cmd=/usr/bin/file
-  case "$host_cpu" in
-  ia64*)
-    lt_cv_deplibs_check_method='file_magic (s[0-9][0-9][0-9]|ELF-[0-9][0-9]) shared object file - IA64'
-    lt_cv_file_magic_test_file=/usr/lib/hpux32/libc.so
-    ;;
-  hppa*64*)
-    lt_cv_deplibs_check_method='file_magic (s[0-9][0-9][0-9]|ELF-[0-9][0-9]) shared object file - PA-RISC [0-9].[0-9]'
-    lt_cv_file_magic_test_file=/usr/lib/pa20_64/libc.sl
-    ;;
-  *)
-    lt_cv_deplibs_check_method='file_magic (s[0-9][0-9][0-9]|PA-RISC[0-9].[0-9]) shared library'
-    lt_cv_file_magic_test_file=/usr/lib/libc.sl
-    ;;
-  esac
-  ;;
-
-irix5* | irix6* | nonstopux*)
-  case $LD in
-  *-32|*"-32 ") libmagic=32-bit;;
-  *-n32|*"-n32 ") libmagic=N32;;
-  *-64|*"-64 ") libmagic=64-bit;;
-  *) libmagic=never-match;;
-  esac
-  lt_cv_deplibs_check_method=pass_all
-  ;;
-
-# This must be Linux ELF.
-linux*)
-  lt_cv_deplibs_check_method=pass_all
-  ;;
-
-netbsd* | netbsdelf*-gnu | knetbsd*-gnu)
-  if echo __ELF__ | $CC -E - | grep __ELF__ > /dev/null; then
-    lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
-  else
-    lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so|_pic\.a)$'
-  fi
-  ;;
-
-newos6*)
-  lt_cv_deplibs_check_method='file_magic ELF [0-9][0-9]*-bit [ML]SB (executable|dynamic lib)'
-  lt_cv_file_magic_cmd=/usr/bin/file
-  lt_cv_file_magic_test_file=/usr/lib/libnls.so
-  ;;
-
-nto-qnx*)
-  lt_cv_deplibs_check_method=unknown
-  ;;
-
-openbsd*)
-  lt_cv_file_magic_cmd=/usr/bin/file
-  lt_cv_file_magic_test_file=`echo /usr/lib/libc.so.*`
-  if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
-    lt_cv_deplibs_check_method='file_magic ELF [0-9][0-9]*-bit [LM]SB shared object'
-  else
-    lt_cv_deplibs_check_method='file_magic OpenBSD.* shared library'
-  fi
-  ;;
-
-osf3* | osf4* | osf5*)
-  lt_cv_deplibs_check_method=pass_all
-  ;;
-
-sco3.2v5*)
-  lt_cv_deplibs_check_method=pass_all
-  ;;
-
-solaris*)
-  lt_cv_deplibs_check_method=pass_all
-  ;;
-
-sysv4 | sysv4.2uw2* | sysv4.3* | sysv5*)
-  case $host_vendor in
-  motorola)
-    lt_cv_deplibs_check_method='file_magic ELF [0-9][0-9]*-bit [ML]SB (shared object|dynamic lib) M[0-9][0-9]* Version [0-9]'
-    lt_cv_file_magic_test_file=`echo /usr/lib/libc.so*`
-    ;;
-  ncr)
-    lt_cv_deplibs_check_method=pass_all
-    ;;
-  sequent)
-    lt_cv_file_magic_cmd='/bin/file'
-    lt_cv_deplibs_check_method='file_magic ELF [0-9][0-9]*-bit [LM]SB (shared object|dynamic lib )'
-    ;;
-  sni)
-    lt_cv_file_magic_cmd='/bin/file'
-    lt_cv_deplibs_check_method="file_magic ELF [0-9][0-9]*-bit [LM]SB dynamic lib"
-    lt_cv_file_magic_test_file=/lib/libc.so
-    ;;
-  siemens)
-    lt_cv_deplibs_check_method=pass_all
-    ;;
-  esac
-  ;;
-
-sysv5OpenUNIX8* | sysv5UnixWare7* | sysv5uw[78]* | unixware7* | sysv4*uw2*)
-  lt_cv_deplibs_check_method=pass_all
-  ;;
-esac
-
-fi
-echo "$as_me:$LINENO: result: $lt_cv_deplibs_check_method" >&5
-echo "${ECHO_T}$lt_cv_deplibs_check_method" >&6
-file_magic_cmd=$lt_cv_file_magic_cmd
-deplibs_check_method=$lt_cv_deplibs_check_method
-test -z "$deplibs_check_method" && deplibs_check_method=unknown
-
-
-
-
-# If no C compiler was specified, use CC.
-LTCC=${LTCC-"$CC"}
-
-# Allow CC to be a program name with arguments.
-compiler=$CC
-
-# Check whether --enable-libtool-lock or --disable-libtool-lock was given.
-if test "${enable_libtool_lock+set}" = set; then
-  enableval="$enable_libtool_lock"
-
-fi;
-test "x$enable_libtool_lock" != xno && enable_libtool_lock=yes
-
-# Some flags need to be propagated to the compiler or linker for good
-# libtool support.
-case $host in
-ia64-*-hpux*)
-  # Find out which ABI we are using.
-  echo 'int i;' > conftest.$ac_ext
-  if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; then
-    case `/usr/bin/file conftest.$ac_objext` in
-    *ELF-32*)
-      HPUX_IA64_MODE="32"
-      ;;
-    *ELF-64*)
-      HPUX_IA64_MODE="64"
-      ;;
-    esac
-  fi
-  rm -rf conftest*
-  ;;
-*-*-irix6*)
-  # Find out which ABI we are using.
-  echo '#line 4269 "configure"' > conftest.$ac_ext
-  if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; then
-   if test "$lt_cv_prog_gnu_ld" = yes; then
-    case `/usr/bin/file conftest.$ac_objext` in
-    *32-bit*)
-      LD="${LD-ld} -melf32bsmip"
-      ;;
-    *N32*)
-      LD="${LD-ld} -melf32bmipn32"
-      ;;
-    *64-bit*)
-      LD="${LD-ld} -melf64bmip"
-      ;;
-    esac
-   else
-    case `/usr/bin/file conftest.$ac_objext` in
-    *32-bit*)
-      LD="${LD-ld} -32"
-      ;;
-    *N32*)
-      LD="${LD-ld} -n32"
-      ;;
-    *64-bit*)
-      LD="${LD-ld} -64"
-      ;;
-    esac
-   fi
-  fi
-  rm -rf conftest*
-  ;;
-
-x86_64-*linux*|ppc*-*linux*|powerpc*-*linux*|s390*-*linux*|sparc*-*linux*)
-  # Find out which ABI we are using.
-  echo 'int i;' > conftest.$ac_ext
-  if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; then
-    case "`/usr/bin/file conftest.o`" in
-    *32-bit*)
-      case $host in
-        x86_64-*linux*)
-          LD="${LD-ld} -m elf_i386"
-          ;;
-        ppc64-*linux*|powerpc64-*linux*)
-          LD="${LD-ld} -m elf32ppclinux"
-          ;;
-        s390x-*linux*)
-          LD="${LD-ld} -m elf_s390"
-          ;;
-        sparc64-*linux*)
-          LD="${LD-ld} -m elf32_sparc"
-          ;;
-      esac
-      ;;
-    *64-bit*)
-      case $host in
-        x86_64-*linux*)
-          LD="${LD-ld} -m elf_x86_64"
-          ;;
-        ppc*-*linux*|powerpc*-*linux*)
-          LD="${LD-ld} -m elf64ppc"
-          ;;
-        s390*-*linux*)
-          LD="${LD-ld} -m elf64_s390"
-          ;;
-        sparc*-*linux*)
-          LD="${LD-ld} -m elf64_sparc"
-          ;;
-      esac
-      ;;
-    esac
-  fi
-  rm -rf conftest*
-  ;;
-
-*-*-sco3.2v5*)
-  # On SCO OpenServer 5, we need -belf to get full-featured binaries.
-  SAVE_CFLAGS="$CFLAGS"
-  CFLAGS="$CFLAGS -belf"
-  echo "$as_me:$LINENO: checking whether the C compiler needs -belf" >&5
-echo $ECHO_N "checking whether the C compiler needs -belf... $ECHO_C" >&6
-if test "${lt_cv_cc_needs_belf+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-
-     cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  lt_cv_cc_needs_belf=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-lt_cv_cc_needs_belf=no
-fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-     ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-
-fi
-echo "$as_me:$LINENO: result: $lt_cv_cc_needs_belf" >&5
-echo "${ECHO_T}$lt_cv_cc_needs_belf" >&6
-  if test x"$lt_cv_cc_needs_belf" != x"yes"; then
-    # this is probably gcc 2.8.0, egcs 1.0 or newer; no need for -belf
-    CFLAGS="$SAVE_CFLAGS"
-  fi
-  ;;
-
-esac
-
-need_locks="$enable_libtool_lock"
-
-
-# On IRIX 5.3, sys/types and inttypes.h are conflicting.
-
-
-
-
-
-
-
-
-
-for ac_header in sys/types.h sys/stat.h stdlib.h string.h memory.h strings.h \
-		  inttypes.h stdint.h unistd.h
-do
-as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
-echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-$ac_includes_default
-
-#include <$ac_header>
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  eval "$as_ac_Header=yes"
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-eval "$as_ac_Header=no"
-fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
-if test `eval echo '${'$as_ac_Header'}'` = yes; then
-  cat >>confdefs.h <<_ACEOF
-#define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
-_ACEOF
-
-fi
-
-done
-
-
-
-for ac_header in dlfcn.h
-do
-as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
-  echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
-else
-  # Is the header compilable?
-echo "$as_me:$LINENO: checking $ac_header usability" >&5
-echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-$ac_includes_default
-#include <$ac_header>
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_header_compiler=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_header_compiler=no
-fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
-echo "${ECHO_T}$ac_header_compiler" >&6
-
-# Is the header present?
-echo "$as_me:$LINENO: checking $ac_header presence" >&5
-echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-#include <$ac_header>
-_ACEOF
-if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
-  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
-  if test -s conftest.err; then
-    ac_cpp_err=$ac_c_preproc_warn_flag
-    ac_cpp_err=$ac_cpp_err$ac_c_werror_flag
-  else
-    ac_cpp_err=
-  fi
-else
-  ac_cpp_err=yes
-fi
-if test -z "$ac_cpp_err"; then
-  ac_header_preproc=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-  ac_header_preproc=no
-fi
-rm -f conftest.err conftest.$ac_ext
-echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
-echo "${ECHO_T}$ac_header_preproc" >&6
-
-# So?  What about this header?
-case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
-  yes:no: )
-    { echo "$as_me:$LINENO: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&5
-echo "$as_me: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the compiler's result" >&5
-echo "$as_me: WARNING: $ac_header: proceeding with the compiler's result" >&2;}
-    ac_header_preproc=yes
-    ;;
-  no:yes:* )
-    { echo "$as_me:$LINENO: WARNING: $ac_header: present but cannot be compiled" >&5
-echo "$as_me: WARNING: $ac_header: present but cannot be compiled" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header:     check for missing prerequisite headers?" >&5
-echo "$as_me: WARNING: $ac_header:     check for missing prerequisite headers?" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header: see the Autoconf documentation" >&5
-echo "$as_me: WARNING: $ac_header: see the Autoconf documentation" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&5
-echo "$as_me: WARNING: $ac_header:     section \"Present But Cannot Be Compiled\"" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the preprocessor's result" >&5
-echo "$as_me: WARNING: $ac_header: proceeding with the preprocessor's result" >&2;}
-    { echo "$as_me:$LINENO: WARNING: $ac_header: in the future, the compiler will take precedence" >&5
-echo "$as_me: WARNING: $ac_header: in the future, the compiler will take precedence" >&2;}
-    (
-      cat <<\_ASBOX
-## ------------------------------------------ ##
-## Report this to the AC_PACKAGE_NAME lists.  ##
-## ------------------------------------------ ##
-_ASBOX
-    ) |
-      sed "s/^/$as_me: WARNING:     /" >&2
-    ;;
-esac
-echo "$as_me:$LINENO: checking for $ac_header" >&5
-echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
-if eval "test \"\${$as_ac_Header+set}\" = set"; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  eval "$as_ac_Header=\$ac_header_preproc"
-fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
-
-fi
-if test `eval echo '${'$as_ac_Header'}'` = yes; then
-  cat >>confdefs.h <<_ACEOF
-#define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
-_ACEOF
-
-fi
-
-done
-
-ac_ext=cc
-ac_cpp='$CXXCPP $CPPFLAGS'
-ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
-if test -n "$ac_tool_prefix"; then
-  for ac_prog in $CCC g++ c++ gpp aCC CC cxx cc++ cl FCC KCC RCC xlC_r xlC
-  do
-    # Extract the first word of "$ac_tool_prefix$ac_prog", so it can be a program name with args.
-set dummy $ac_tool_prefix$ac_prog; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_prog_CXX+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$CXX"; then
-  ac_cv_prog_CXX="$CXX" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_prog_CXX="$ac_tool_prefix$ac_prog"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
-fi
-fi
-CXX=$ac_cv_prog_CXX
-if test -n "$CXX"; then
-  echo "$as_me:$LINENO: result: $CXX" >&5
-echo "${ECHO_T}$CXX" >&6
-else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi
-
-    test -n "$CXX" && break
-  done
-fi
-if test -z "$CXX"; then
-  ac_ct_CXX=$CXX
-  for ac_prog in $CCC g++ c++ gpp aCC CC cxx cc++ cl FCC KCC RCC xlC_r xlC
-do
-  # Extract the first word of "$ac_prog", so it can be a program name with args.
-set dummy $ac_prog; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_prog_ac_ct_CXX+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$ac_ct_CXX"; then
-  ac_cv_prog_ac_ct_CXX="$ac_ct_CXX" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_prog_ac_ct_CXX="$ac_prog"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
-fi
-fi
-ac_ct_CXX=$ac_cv_prog_ac_ct_CXX
-if test -n "$ac_ct_CXX"; then
-  echo "$as_me:$LINENO: result: $ac_ct_CXX" >&5
-echo "${ECHO_T}$ac_ct_CXX" >&6
-else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi
-
-  test -n "$ac_ct_CXX" && break
-done
-test -n "$ac_ct_CXX" || ac_ct_CXX="g++"
-
-  CXX=$ac_ct_CXX
-fi
-
-
-# Provide some information about the compiler.
-echo "$as_me:$LINENO:" \
-     "checking for C++ compiler version" >&5
-ac_compiler=`set X $ac_compile; echo $2`
-{ (eval echo "$as_me:$LINENO: \"$ac_compiler --version </dev/null >&5\"") >&5
-  (eval $ac_compiler --version </dev/null >&5) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }
-{ (eval echo "$as_me:$LINENO: \"$ac_compiler -v </dev/null >&5\"") >&5
-  (eval $ac_compiler -v </dev/null >&5) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }
-{ (eval echo "$as_me:$LINENO: \"$ac_compiler -V </dev/null >&5\"") >&5
-  (eval $ac_compiler -V </dev/null >&5) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }
-
-echo "$as_me:$LINENO: checking whether we are using the GNU C++ compiler" >&5
-echo $ECHO_N "checking whether we are using the GNU C++ compiler... $ECHO_C" >&6
-if test "${ac_cv_cxx_compiler_gnu+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-#ifndef __GNUC__
-       choke me
-#endif
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_cxx_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_compiler_gnu=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_compiler_gnu=no
-fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-ac_cv_cxx_compiler_gnu=$ac_compiler_gnu
-
-fi
-echo "$as_me:$LINENO: result: $ac_cv_cxx_compiler_gnu" >&5
-echo "${ECHO_T}$ac_cv_cxx_compiler_gnu" >&6
-GXX=`test $ac_compiler_gnu = yes && echo yes`
-ac_test_CXXFLAGS=${CXXFLAGS+set}
-ac_save_CXXFLAGS=$CXXFLAGS
-CXXFLAGS="-g"
-echo "$as_me:$LINENO: checking whether $CXX accepts -g" >&5
-echo $ECHO_N "checking whether $CXX accepts -g... $ECHO_C" >&6
-if test "${ac_cv_prog_cxx_g+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_cxx_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_prog_cxx_g=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_cv_prog_cxx_g=no
-fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-fi
-echo "$as_me:$LINENO: result: $ac_cv_prog_cxx_g" >&5
-echo "${ECHO_T}$ac_cv_prog_cxx_g" >&6
-if test "$ac_test_CXXFLAGS" = set; then
-  CXXFLAGS=$ac_save_CXXFLAGS
-elif test $ac_cv_prog_cxx_g = yes; then
-  if test "$GXX" = yes; then
-    CXXFLAGS="-g -O2"
-  else
-    CXXFLAGS="-g"
-  fi
-else
-  if test "$GXX" = yes; then
-    CXXFLAGS="-O2"
-  else
-    CXXFLAGS=
-  fi
-fi
-for ac_declaration in \
-   '' \
-   'extern "C" void std::exit (int) throw (); using std::exit;' \
-   'extern "C" void std::exit (int); using std::exit;' \
-   'extern "C" void exit (int) throw ();' \
-   'extern "C" void exit (int);' \
-   'void exit (int);'
-do
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-$ac_declaration
-#include <stdlib.h>
-int
-main ()
-{
-exit (42);
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_cxx_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  :
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-continue
-fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-$ac_declaration
-int
-main ()
-{
-exit (42);
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_cxx_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  break
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-done
-rm -f conftest*
-if test -n "$ac_declaration"; then
-  echo '#ifdef __cplusplus' >>confdefs.h
-  echo $ac_declaration      >>confdefs.h
-  echo '#endif'             >>confdefs.h
-fi
-
-ac_ext=cc
-ac_cpp='$CXXCPP $CPPFLAGS'
-ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
-
-depcc="$CXX"  am_compiler_list=
-
-echo "$as_me:$LINENO: checking dependency style of $depcc" >&5
-echo $ECHO_N "checking dependency style of $depcc... $ECHO_C" >&6
-if test "${am_cv_CXX_dependencies_compiler_type+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -z "$AMDEP_TRUE" && test -f "$am_depcomp"; then
-  # We make a subdir and do the tests there.  Otherwise we can end up
-  # making bogus files that we don't know about and never remove.  For
-  # instance it was reported that on HP-UX the gcc test will end up
-  # making a dummy file named `D' -- because `-MD' means `put the output
-  # in D'.
-  mkdir conftest.dir
-  # Copy depcomp to subdir because otherwise we won't find it if we're
-  # using a relative directory.
-  cp "$am_depcomp" conftest.dir
-  cd conftest.dir
-  # We will build objects and dependencies in a subdirectory because
-  # it helps to detect inapplicable dependency modes.  For instance
-  # both Tru64's cc and ICC support -MD to output dependencies as a
-  # side effect of compilation, but ICC will put the dependencies in
-  # the current directory while Tru64 will put them in the object
-  # directory.
-  mkdir sub
-
-  am_cv_CXX_dependencies_compiler_type=none
-  if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
-  fi
-  for depmode in $am_compiler_list; do
-    # Setup a source with many dependencies, because some compilers
-    # like to wrap large dependency lists on column 80 (with \), and
-    # we should not choose a depcomp mode which is confused by this.
-    #
-    # We need to recreate these files for each test, as the compiler may
-    # overwrite some of them when testing with obscure command lines.
-    # This happens at least with the AIX C compiler.
-    : > sub/conftest.c
-    for i in 1 2 3 4 5 6; do
-      echo '#include "conftst'$i'.h"' >> sub/conftest.c
-      : > sub/conftst$i.h
-    done
-    echo "${am__include} ${am__quote}sub/conftest.Po${am__quote}" > confmf
-
-    case $depmode in
-    nosideeffect)
-      # after this tag, mechanisms are not by side-effect, so they'll
-      # only be used when explicitly requested
-      if test "x$enable_dependency_tracking" = xyes; then
-	continue
-      else
-	break
-      fi
-      ;;
-    none) break ;;
-    esac
-    # We check with `-c' and `-o' for the sake of the "dashmstdout"
-    # mode.  It turns out that the SunPro C++ compiler does not properly
-    # handle `-M -o', and we need to detect this.
-    if depmode=$depmode \
-       source=sub/conftest.c object=sub/conftest.${OBJEXT-o} \
-       depfile=sub/conftest.Po tmpdepfile=sub/conftest.TPo \
-       $SHELL ./depcomp $depcc -c -o sub/conftest.${OBJEXT-o} sub/conftest.c \
-         >/dev/null 2>conftest.err &&
-       grep sub/conftst6.h sub/conftest.Po > /dev/null 2>&1 &&
-       grep sub/conftest.${OBJEXT-o} sub/conftest.Po > /dev/null 2>&1 &&
-       ${MAKE-make} -s -f confmf > /dev/null 2>&1; then
-      # icc doesn't choke on unknown options, it will just issue warnings
-      # (even with -Werror).  So we grep stderr for any message
-      # that says an option was ignored.
-      if grep 'ignoring option' conftest.err >/dev/null 2>&1; then :; else
-        am_cv_CXX_dependencies_compiler_type=$depmode
-        break
-      fi
-    fi
-  done
-
-  cd ..
-  rm -rf conftest.dir
-else
-  am_cv_CXX_dependencies_compiler_type=none
-fi
-
-fi
-echo "$as_me:$LINENO: result: $am_cv_CXX_dependencies_compiler_type" >&5
-echo "${ECHO_T}$am_cv_CXX_dependencies_compiler_type" >&6
-CXXDEPMODE=depmode=$am_cv_CXX_dependencies_compiler_type
-
-
-
-if
-  test "x$enable_dependency_tracking" != xno \
-  && test "$am_cv_CXX_dependencies_compiler_type" = gcc3; then
-  am__fastdepCXX_TRUE=
-  am__fastdepCXX_FALSE='#'
-else
-  am__fastdepCXX_TRUE='#'
-  am__fastdepCXX_FALSE=
-fi
-
-
-ac_ext=cc
-ac_cpp='$CXXCPP $CPPFLAGS'
-ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
-echo "$as_me:$LINENO: checking how to run the C++ preprocessor" >&5
-echo $ECHO_N "checking how to run the C++ preprocessor... $ECHO_C" >&6
-if test -z "$CXXCPP"; then
-  if test "${ac_cv_prog_CXXCPP+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-      # Double quotes because CXXCPP needs to be expanded
-    for CXXCPP in "$CXX -E" "/lib/cpp"
-    do
-      ac_preproc_ok=false
-for ac_cxx_preproc_warn_flag in '' yes
-do
-  # Use a header file that comes with gcc, so configuring glibc
-  # with a fresh cross-compiler works.
-  # Prefer <limits.h> to <assert.h> if __STDC__ is defined, since
-  # <limits.h> exists even on freestanding compilers.
-  # On the NeXT, cc -E runs the code through the compiler's parser,
-  # not just through cpp. "Syntax error" is here to catch this case.
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-#ifdef __STDC__
-# include <limits.h>
-#else
-# include <assert.h>
-#endif
-		     Syntax error
-_ACEOF
-if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
-  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
-  if test -s conftest.err; then
-    ac_cpp_err=$ac_cxx_preproc_warn_flag
-    ac_cpp_err=$ac_cpp_err$ac_cxx_werror_flag
-  else
-    ac_cpp_err=
-  fi
-else
-  ac_cpp_err=yes
-fi
-if test -z "$ac_cpp_err"; then
-  :
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-  # Broken: fails on valid input.
-continue
-fi
-rm -f conftest.err conftest.$ac_ext
-
-  # OK, works on sane cases.  Now check whether non-existent headers
-  # can be detected and how.
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-#include <ac_nonexistent.h>
-_ACEOF
-if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
-  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
-  if test -s conftest.err; then
-    ac_cpp_err=$ac_cxx_preproc_warn_flag
-    ac_cpp_err=$ac_cpp_err$ac_cxx_werror_flag
-  else
-    ac_cpp_err=
-  fi
-else
-  ac_cpp_err=yes
-fi
-if test -z "$ac_cpp_err"; then
-  # Broken: success on invalid input.
-continue
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-  # Passes both tests.
-ac_preproc_ok=:
-break
-fi
-rm -f conftest.err conftest.$ac_ext
-
-done
-# Because of `break', _AC_PREPROC_IFELSE's cleaning code was skipped.
-rm -f conftest.err conftest.$ac_ext
-if $ac_preproc_ok; then
-  break
-fi
-
-    done
-    ac_cv_prog_CXXCPP=$CXXCPP
-
-fi
-  CXXCPP=$ac_cv_prog_CXXCPP
-else
-  ac_cv_prog_CXXCPP=$CXXCPP
-fi
-echo "$as_me:$LINENO: result: $CXXCPP" >&5
-echo "${ECHO_T}$CXXCPP" >&6
-ac_preproc_ok=false
-for ac_cxx_preproc_warn_flag in '' yes
-do
-  # Use a header file that comes with gcc, so configuring glibc
-  # with a fresh cross-compiler works.
-  # Prefer <limits.h> to <assert.h> if __STDC__ is defined, since
-  # <limits.h> exists even on freestanding compilers.
-  # On the NeXT, cc -E runs the code through the compiler's parser,
-  # not just through cpp. "Syntax error" is here to catch this case.
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-#ifdef __STDC__
-# include <limits.h>
-#else
-# include <assert.h>
-#endif
-		     Syntax error
-_ACEOF
-if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
-  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
-  if test -s conftest.err; then
-    ac_cpp_err=$ac_cxx_preproc_warn_flag
-    ac_cpp_err=$ac_cpp_err$ac_cxx_werror_flag
-  else
-    ac_cpp_err=
-  fi
-else
-  ac_cpp_err=yes
-fi
-if test -z "$ac_cpp_err"; then
-  :
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-  # Broken: fails on valid input.
-continue
-fi
-rm -f conftest.err conftest.$ac_ext
-
-  # OK, works on sane cases.  Now check whether non-existent headers
-  # can be detected and how.
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-#include <ac_nonexistent.h>
-_ACEOF
-if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
-  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
-  if test -s conftest.err; then
-    ac_cpp_err=$ac_cxx_preproc_warn_flag
-    ac_cpp_err=$ac_cpp_err$ac_cxx_werror_flag
-  else
-    ac_cpp_err=
-  fi
-else
-  ac_cpp_err=yes
-fi
-if test -z "$ac_cpp_err"; then
-  # Broken: success on invalid input.
-continue
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-  # Passes both tests.
-ac_preproc_ok=:
-break
-fi
-rm -f conftest.err conftest.$ac_ext
-
-done
-# Because of `break', _AC_PREPROC_IFELSE's cleaning code was skipped.
-rm -f conftest.err conftest.$ac_ext
-if $ac_preproc_ok; then
-  :
-else
-  { { echo "$as_me:$LINENO: error: C++ preprocessor \"$CXXCPP\" fails sanity check
-See \`config.log' for more details." >&5
-echo "$as_me: error: C++ preprocessor \"$CXXCPP\" fails sanity check
-See \`config.log' for more details." >&2;}
-   { (exit 1); exit 1; }; }
-fi
-
-ac_ext=cc
-ac_cpp='$CXXCPP $CPPFLAGS'
-ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
-
-
-ac_ext=f
-ac_compile='$F77 -c $FFLAGS conftest.$ac_ext >&5'
-ac_link='$F77 -o conftest$ac_exeext $FFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_f77_compiler_gnu
-if test -n "$ac_tool_prefix"; then
-  for ac_prog in g77 f77 xlf frt pgf77 fort77 fl32 af77 f90 xlf90 pgf90 epcf90 f95 fort xlf95 ifc efc pgf95 lf95 gfortran
-  do
-    # Extract the first word of "$ac_tool_prefix$ac_prog", so it can be a program name with args.
-set dummy $ac_tool_prefix$ac_prog; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_prog_F77+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$F77"; then
-  ac_cv_prog_F77="$F77" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_prog_F77="$ac_tool_prefix$ac_prog"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
-fi
-fi
-F77=$ac_cv_prog_F77
-if test -n "$F77"; then
-  echo "$as_me:$LINENO: result: $F77" >&5
-echo "${ECHO_T}$F77" >&6
-else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi
-
-    test -n "$F77" && break
-  done
-fi
-if test -z "$F77"; then
-  ac_ct_F77=$F77
-  for ac_prog in g77 f77 xlf frt pgf77 fort77 fl32 af77 f90 xlf90 pgf90 epcf90 f95 fort xlf95 ifc efc pgf95 lf95 gfortran
-do
-  # Extract the first word of "$ac_prog", so it can be a program name with args.
-set dummy $ac_prog; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_prog_ac_ct_F77+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$ac_ct_F77"; then
-  ac_cv_prog_ac_ct_F77="$ac_ct_F77" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_prog_ac_ct_F77="$ac_prog"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
-fi
-fi
-ac_ct_F77=$ac_cv_prog_ac_ct_F77
-if test -n "$ac_ct_F77"; then
-  echo "$as_me:$LINENO: result: $ac_ct_F77" >&5
-echo "${ECHO_T}$ac_ct_F77" >&6
-else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi
-
-  test -n "$ac_ct_F77" && break
-done
-
-  F77=$ac_ct_F77
-fi
-
-
-# Provide some information about the compiler.
-echo "$as_me:5426:" \
-     "checking for Fortran 77 compiler version" >&5
-ac_compiler=`set X $ac_compile; echo $2`
-{ (eval echo "$as_me:$LINENO: \"$ac_compiler --version </dev/null >&5\"") >&5
-  (eval $ac_compiler --version </dev/null >&5) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }
-{ (eval echo "$as_me:$LINENO: \"$ac_compiler -v </dev/null >&5\"") >&5
-  (eval $ac_compiler -v </dev/null >&5) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }
-{ (eval echo "$as_me:$LINENO: \"$ac_compiler -V </dev/null >&5\"") >&5
-  (eval $ac_compiler -V </dev/null >&5) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }
-rm -f a.out
-
-# If we don't use `.F' as extension, the preprocessor is not run on the
-# input file.  (Note that this only needs to work for GNU compilers.)
-ac_save_ext=$ac_ext
-ac_ext=F
-echo "$as_me:$LINENO: checking whether we are using the GNU Fortran 77 compiler" >&5
-echo $ECHO_N "checking whether we are using the GNU Fortran 77 compiler... $ECHO_C" >&6
-if test "${ac_cv_f77_compiler_gnu+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  cat >conftest.$ac_ext <<_ACEOF
-      program main
-#ifndef __GNUC__
-       choke me
-#endif
-
-      end
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_f77_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_compiler_gnu=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_compiler_gnu=no
-fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-ac_cv_f77_compiler_gnu=$ac_compiler_gnu
-
-fi
-echo "$as_me:$LINENO: result: $ac_cv_f77_compiler_gnu" >&5
-echo "${ECHO_T}$ac_cv_f77_compiler_gnu" >&6
-ac_ext=$ac_save_ext
-ac_test_FFLAGS=${FFLAGS+set}
-ac_save_FFLAGS=$FFLAGS
-FFLAGS=
-echo "$as_me:$LINENO: checking whether $F77 accepts -g" >&5
-echo $ECHO_N "checking whether $F77 accepts -g... $ECHO_C" >&6
-if test "${ac_cv_prog_f77_g+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  FFLAGS=-g
-cat >conftest.$ac_ext <<_ACEOF
-      program main
-
-      end
-_ACEOF
-rm -f conftest.$ac_objext
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_f77_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_prog_f77_g=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_cv_prog_f77_g=no
-fi
-rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
-
-fi
-echo "$as_me:$LINENO: result: $ac_cv_prog_f77_g" >&5
-echo "${ECHO_T}$ac_cv_prog_f77_g" >&6
-if test "$ac_test_FFLAGS" = set; then
-  FFLAGS=$ac_save_FFLAGS
-elif test $ac_cv_prog_f77_g = yes; then
-  if test "x$ac_cv_f77_compiler_gnu" = xyes; then
-    FFLAGS="-g -O2"
-  else
-    FFLAGS="-g"
-  fi
-else
-  if test "x$ac_cv_f77_compiler_gnu" = xyes; then
-    FFLAGS="-O2"
-  else
-    FFLAGS=
-  fi
-fi
-
-G77=`test $ac_compiler_gnu = yes && echo yes`
-ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-
-
-
-# Autoconf 2.13's AC_OBJEXT and AC_EXEEXT macros only works for C compilers!
-
-# find the maximum length of command line arguments
-echo "$as_me:$LINENO: checking the maximum length of command line arguments" >&5
-echo $ECHO_N "checking the maximum length of command line arguments... $ECHO_C" >&6
-if test "${lt_cv_sys_max_cmd_len+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-    i=0
-  teststring="ABCD"
-
-  case $build_os in
-  msdosdjgpp*)
-    # On DJGPP, this test can blow up pretty badly due to problems in libc
-    # (any single argument exceeding 2000 bytes causes a buffer overrun
-    # during glob expansion).  Even if it were fixed, the result of this
-    # check would be larger than it should be.
-    lt_cv_sys_max_cmd_len=12288;    # 12K is about right
-    ;;
-
-  gnu*)
-    # Under GNU Hurd, this test is not required because there is
-    # no limit to the length of command line arguments.
-    # Libtool will interpret -1 as no limit whatsoever
-    lt_cv_sys_max_cmd_len=-1;
-    ;;
-
-  cygwin* | mingw*)
-    # On Win9x/ME, this test blows up -- it succeeds, but takes
-    # about 5 minutes as the teststring grows exponentially.
-    # Worse, since 9x/ME are not pre-emptively multitasking,
-    # you end up with a "frozen" computer, even though with patience
-    # the test eventually succeeds (with a max line length of 256k).
-    # Instead, let's just punt: use the minimum linelength reported by
-    # all of the supported platforms: 8192 (on NT/2K/XP).
-    lt_cv_sys_max_cmd_len=8192;
-    ;;
-
-  amigaos*)
-    # On AmigaOS with pdksh, this test takes hours, literally.
-    # So we just punt and use a minimum line length of 8192.
-    lt_cv_sys_max_cmd_len=8192;
-    ;;
-
- *)
-    # If test is not a shell built-in, we'll probably end up computing a
-    # maximum length that is only half of the actual maximum length, but
-    # we can't tell.
-    while (test "X"`$CONFIG_SHELL $0 --fallback-echo "X$teststring" 2>/dev/null` \
-	       = "XX$teststring") >/dev/null 2>&1 &&
-	    new_result=`expr "X$teststring" : ".*" 2>&1` &&
-	    lt_cv_sys_max_cmd_len=$new_result &&
-	    test $i != 17 # 1/2 MB should be enough
-    do
-      i=`expr $i + 1`
-      teststring=$teststring$teststring
-    done
-    teststring=
-    # Add a significant safety factor because C++ compilers can tack on massive
-    # amounts of additional arguments before passing them to the linker.
-    # It appears as though 1/2 is a usable value.
-    lt_cv_sys_max_cmd_len=`expr $lt_cv_sys_max_cmd_len \/ 2`
-    ;;
-  esac
-
-fi
-
-if test -n $lt_cv_sys_max_cmd_len ; then
-  echo "$as_me:$LINENO: result: $lt_cv_sys_max_cmd_len" >&5
-echo "${ECHO_T}$lt_cv_sys_max_cmd_len" >&6
-else
-  echo "$as_me:$LINENO: result: none" >&5
-echo "${ECHO_T}none" >&6
-fi
-
-
-
-
-# Check for command to grab the raw symbol name followed by C symbol from nm.
-echo "$as_me:$LINENO: checking command to parse $NM output from $compiler object" >&5
-echo $ECHO_N "checking command to parse $NM output from $compiler object... $ECHO_C" >&6
-if test "${lt_cv_sys_global_symbol_pipe+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-
-# These are sane defaults that work on at least a few old systems.
-# [They come from Ultrix.  What could be older than Ultrix?!! ;)]
-
-# Character class describing NM global symbol codes.
-symcode='[BCDEGRST]'
-
-# Regexp to match symbols that can be accessed directly from C.
-sympat='\([_A-Za-z][_A-Za-z0-9]*\)'
-
-# Transform the above into a raw symbol and a C symbol.
-symxfrm='\1 \2\3 \3'
-
-# Transform an extracted symbol line into a proper C declaration
-lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^. .* \(.*\)$/extern int \1;/p'"
-
-# Transform an extracted symbol line into symbol name and symbol address
-lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (lt_ptr) 0},/p' -e 's/^$symcode \([^ ]*\) \([^ ]*\)$/  {\"\2\", (lt_ptr) \&\2},/p'"
-
-# Define system-specific variables.
-case $host_os in
-aix*)
-  symcode='[BCDT]'
-  ;;
-cygwin* | mingw* | pw32*)
-  symcode='[ABCDGISTW]'
-  ;;
-hpux*) # Its linker distinguishes data from code symbols
-  if test "$host_cpu" = ia64; then
-    symcode='[ABCDEGRST]'
-  fi
-  lt_cv_sys_global_symbol_to_cdecl="sed -n -e 's/^T .* \(.*\)$/extern int \1();/p' -e 's/^$symcode* .* \(.*\)$/extern char \1;/p'"
-  lt_cv_sys_global_symbol_to_c_name_address="sed -n -e 's/^: \([^ ]*\) $/  {\\\"\1\\\", (lt_ptr) 0},/p' -e 's/^$symcode* \([^ ]*\) \([^ ]*\)$/  {\"\2\", (lt_ptr) \&\2},/p'"
-  ;;
-irix* | nonstopux*)
-  symcode='[BCDEGRST]'
-  ;;
-osf*)
-  symcode='[BCDEGQRST]'
-  ;;
-solaris* | sysv5*)
-  symcode='[BDRT]'
-  ;;
-sysv4)
-  symcode='[DFNSTU]'
-  ;;
-esac
-
-# Handle CRLF in mingw tool chain
-opt_cr=
-case $build_os in
-mingw*)
-  opt_cr=`echo 'x\{0,1\}' | tr x '\015'` # option cr in regexp
-  ;;
-esac
-
-# If we're using GNU nm, then use its standard symbol codes.
-case `$NM -V 2>&1` in
-*GNU* | *'with BFD'*)
-  symcode='[ABCDGIRSTW]' ;;
-esac
-
-# Try without a prefix undercore, then with it.
-for ac_symprfx in "" "_"; do
-
-  # Write the raw and C identifiers.
-  lt_cv_sys_global_symbol_pipe="sed -n -e 's/^.*[ 	]\($symcode$symcode*\)[ 	][ 	]*\($ac_symprfx\)$sympat$opt_cr$/$symxfrm/p'"
-
-  # Check to see that the pipe works correctly.
-  pipe_works=no
-
-  rm -f conftest*
-  cat > conftest.$ac_ext <<EOF
-#ifdef __cplusplus
-extern "C" {
-#endif
-char nm_test_var;
-void nm_test_func(){}
-#ifdef __cplusplus
-}
-#endif
-int main(){nm_test_var='a';nm_test_func();return(0);}
-EOF
-
-  if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; then
-    # Now try to grab the symbols.
-    nlist=conftest.nm
-    if { (eval echo "$as_me:$LINENO: \"$NM conftest.$ac_objext \| $lt_cv_sys_global_symbol_pipe \> $nlist\"") >&5
-  (eval $NM conftest.$ac_objext \| $lt_cv_sys_global_symbol_pipe \> $nlist) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && test -s "$nlist"; then
-      # Try sorting and uniquifying the output.
-      if sort "$nlist" | uniq > "$nlist"T; then
-	mv -f "$nlist"T "$nlist"
-      else
-	rm -f "$nlist"T
-      fi
-
-      # Make sure that we snagged all the symbols we need.
-      if grep ' nm_test_var$' "$nlist" >/dev/null; then
-	if grep ' nm_test_func$' "$nlist" >/dev/null; then
-	  cat <<EOF > conftest.$ac_ext
-#ifdef __cplusplus
-extern "C" {
-#endif
-
-EOF
-	  # Now generate the symbol file.
-	  eval "$lt_cv_sys_global_symbol_to_cdecl"' < "$nlist" | grep -v main >> conftest.$ac_ext'
-
-	  cat <<EOF >> conftest.$ac_ext
-#if defined (__STDC__) && __STDC__
-# define lt_ptr_t void *
-#else
-# define lt_ptr_t char *
-# define const
-#endif
-
-/* The mapping between symbol names and symbols. */
-const struct {
-  const char *name;
-  lt_ptr_t address;
-}
-lt_preloaded_symbols[] =
-{
-EOF
-	  $SED "s/^$symcode$symcode* \(.*\) \(.*\)$/  {\"\2\", (lt_ptr_t) \&\2},/" < "$nlist" | grep -v main >> conftest.$ac_ext
-	  cat <<\EOF >> conftest.$ac_ext
-  {0, (lt_ptr_t) 0}
-};
-
-#ifdef __cplusplus
-}
-#endif
-EOF
-	  # Now try linking the two files.
-	  mv conftest.$ac_objext conftstm.$ac_objext
-	  lt_save_LIBS="$LIBS"
-	  lt_save_CFLAGS="$CFLAGS"
-	  LIBS="conftstm.$ac_objext"
-	  CFLAGS="$CFLAGS$lt_prog_compiler_no_builtin_flag"
-	  if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && test -s conftest${ac_exeext}; then
-	    pipe_works=yes
-	  fi
-	  LIBS="$lt_save_LIBS"
-	  CFLAGS="$lt_save_CFLAGS"
-	else
-	  echo "cannot find nm_test_func in $nlist" >&5
-	fi
-      else
-	echo "cannot find nm_test_var in $nlist" >&5
-      fi
-    else
-      echo "cannot run $lt_cv_sys_global_symbol_pipe" >&5
-    fi
-  else
-    echo "$progname: failed program was:" >&5
-    cat conftest.$ac_ext >&5
-  fi
-  rm -f conftest* conftst*
-
-  # Do not use the global_symbol_pipe unless it works.
-  if test "$pipe_works" = yes; then
-    break
-  else
-    lt_cv_sys_global_symbol_pipe=
-  fi
-done
-
-fi
-
-if test -z "$lt_cv_sys_global_symbol_pipe"; then
-  lt_cv_sys_global_symbol_to_cdecl=
-fi
-if test -z "$lt_cv_sys_global_symbol_pipe$lt_cv_sys_global_symbol_to_cdecl"; then
-  echo "$as_me:$LINENO: result: failed" >&5
-echo "${ECHO_T}failed" >&6
-else
-  echo "$as_me:$LINENO: result: ok" >&5
-echo "${ECHO_T}ok" >&6
-fi
-
-echo "$as_me:$LINENO: checking for objdir" >&5
-echo $ECHO_N "checking for objdir... $ECHO_C" >&6
-if test "${lt_cv_objdir+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  rm -f .libs 2>/dev/null
-mkdir .libs 2>/dev/null
-if test -d .libs; then
-  lt_cv_objdir=.libs
-else
-  # MS-DOS does not allow filenames that begin with a dot.
-  lt_cv_objdir=_libs
-fi
-rmdir .libs 2>/dev/null
-fi
-echo "$as_me:$LINENO: result: $lt_cv_objdir" >&5
-echo "${ECHO_T}$lt_cv_objdir" >&6
-objdir=$lt_cv_objdir
-
-
-
-
-
-case $host_os in
-aix3*)
-  # AIX sometimes has problems with the GCC collect2 program.  For some
-  # reason, if we set the COLLECT_NAMES environment variable, the problems
-  # vanish in a puff of smoke.
-  if test "X${COLLECT_NAMES+set}" != Xset; then
-    COLLECT_NAMES=
-    export COLLECT_NAMES
-  fi
-  ;;
-esac
-
-# Sed substitution that helps us do robust quoting.  It backslashifies
-# metacharacters that are still active within double-quoted strings.
-Xsed='sed -e s/^X//'
-sed_quote_subst='s/\([\\"\\`$\\\\]\)/\\\1/g'
-
-# Same as above, but do not quote variable references.
-double_quote_subst='s/\([\\"\\`\\\\]\)/\\\1/g'
-
-# Sed substitution to delay expansion of an escaped shell variable in a
-# double_quote_subst'ed string.
-delay_variable_subst='s/\\\\\\\\\\\$/\\\\\\$/g'
-
-# Sed substitution to avoid accidental globbing in evaled expressions
-no_glob_subst='s/\*/\\\*/g'
-
-# Constants:
-rm="rm -f"
-
-# Global variables:
-default_ofile=libtool
-can_build_shared=yes
-
-# All known linkers require a `.a' archive for static linking (except M$VC,
-# which needs '.lib').
-libext=a
-ltmain="$ac_aux_dir/ltmain.sh"
-ofile="$default_ofile"
-with_gnu_ld="$lt_cv_prog_gnu_ld"
-
-if test -n "$ac_tool_prefix"; then
-  # Extract the first word of "${ac_tool_prefix}ar", so it can be a program name with args.
-set dummy ${ac_tool_prefix}ar; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_prog_AR+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$AR"; then
-  ac_cv_prog_AR="$AR" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_prog_AR="${ac_tool_prefix}ar"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
-fi
-fi
-AR=$ac_cv_prog_AR
-if test -n "$AR"; then
-  echo "$as_me:$LINENO: result: $AR" >&5
-echo "${ECHO_T}$AR" >&6
-else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi
-
-fi
-if test -z "$ac_cv_prog_AR"; then
-  ac_ct_AR=$AR
-  # Extract the first word of "ar", so it can be a program name with args.
-set dummy ar; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_prog_ac_ct_AR+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$ac_ct_AR"; then
-  ac_cv_prog_ac_ct_AR="$ac_ct_AR" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_prog_ac_ct_AR="ar"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
-  test -z "$ac_cv_prog_ac_ct_AR" && ac_cv_prog_ac_ct_AR="false"
-fi
-fi
-ac_ct_AR=$ac_cv_prog_ac_ct_AR
-if test -n "$ac_ct_AR"; then
-  echo "$as_me:$LINENO: result: $ac_ct_AR" >&5
-echo "${ECHO_T}$ac_ct_AR" >&6
-else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi
-
-  AR=$ac_ct_AR
-else
-  AR="$ac_cv_prog_AR"
-fi
-
-if test -n "$ac_tool_prefix"; then
-  # Extract the first word of "${ac_tool_prefix}ranlib", so it can be a program name with args.
-set dummy ${ac_tool_prefix}ranlib; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_prog_RANLIB+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$RANLIB"; then
-  ac_cv_prog_RANLIB="$RANLIB" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_prog_RANLIB="${ac_tool_prefix}ranlib"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
-fi
-fi
-RANLIB=$ac_cv_prog_RANLIB
-if test -n "$RANLIB"; then
-  echo "$as_me:$LINENO: result: $RANLIB" >&5
-echo "${ECHO_T}$RANLIB" >&6
-else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi
-
-fi
-if test -z "$ac_cv_prog_RANLIB"; then
-  ac_ct_RANLIB=$RANLIB
-  # Extract the first word of "ranlib", so it can be a program name with args.
-set dummy ranlib; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_prog_ac_ct_RANLIB+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$ac_ct_RANLIB"; then
-  ac_cv_prog_ac_ct_RANLIB="$ac_ct_RANLIB" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_prog_ac_ct_RANLIB="ranlib"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
-  test -z "$ac_cv_prog_ac_ct_RANLIB" && ac_cv_prog_ac_ct_RANLIB=":"
-fi
-fi
-ac_ct_RANLIB=$ac_cv_prog_ac_ct_RANLIB
-if test -n "$ac_ct_RANLIB"; then
-  echo "$as_me:$LINENO: result: $ac_ct_RANLIB" >&5
-echo "${ECHO_T}$ac_ct_RANLIB" >&6
-else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi
-
-  RANLIB=$ac_ct_RANLIB
-else
-  RANLIB="$ac_cv_prog_RANLIB"
-fi
-
-if test -n "$ac_tool_prefix"; then
-  # Extract the first word of "${ac_tool_prefix}strip", so it can be a program name with args.
-set dummy ${ac_tool_prefix}strip; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_prog_STRIP+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$STRIP"; then
-  ac_cv_prog_STRIP="$STRIP" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_prog_STRIP="${ac_tool_prefix}strip"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
-fi
-fi
-STRIP=$ac_cv_prog_STRIP
-if test -n "$STRIP"; then
-  echo "$as_me:$LINENO: result: $STRIP" >&5
-echo "${ECHO_T}$STRIP" >&6
-else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi
-
-fi
-if test -z "$ac_cv_prog_STRIP"; then
-  ac_ct_STRIP=$STRIP
-  # Extract the first word of "strip", so it can be a program name with args.
-set dummy strip; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_prog_ac_ct_STRIP+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$ac_ct_STRIP"; then
-  ac_cv_prog_ac_ct_STRIP="$ac_ct_STRIP" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_prog_ac_ct_STRIP="strip"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
-  test -z "$ac_cv_prog_ac_ct_STRIP" && ac_cv_prog_ac_ct_STRIP=":"
-fi
-fi
-ac_ct_STRIP=$ac_cv_prog_ac_ct_STRIP
-if test -n "$ac_ct_STRIP"; then
-  echo "$as_me:$LINENO: result: $ac_ct_STRIP" >&5
-echo "${ECHO_T}$ac_ct_STRIP" >&6
-else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi
-
-  STRIP=$ac_ct_STRIP
-else
-  STRIP="$ac_cv_prog_STRIP"
-fi
-
-
-old_CC="$CC"
-old_CFLAGS="$CFLAGS"
-
-# Set sane defaults for various variables
-test -z "$AR" && AR=ar
-test -z "$AR_FLAGS" && AR_FLAGS=cru
-test -z "$AS" && AS=as
-test -z "$CC" && CC=cc
-test -z "$LTCC" && LTCC=$CC
-test -z "$DLLTOOL" && DLLTOOL=dlltool
-test -z "$LD" && LD=ld
-test -z "$LN_S" && LN_S="ln -s"
-test -z "$MAGIC_CMD" && MAGIC_CMD=file
-test -z "$NM" && NM=nm
-test -z "$SED" && SED=sed
-test -z "$OBJDUMP" && OBJDUMP=objdump
-test -z "$RANLIB" && RANLIB=:
-test -z "$STRIP" && STRIP=:
-test -z "$ac_objext" && ac_objext=o
-
-# Determine commands to create old-style static archives.
-old_archive_cmds='$AR $AR_FLAGS $oldlib$oldobjs$old_deplibs'
-old_postinstall_cmds='chmod 644 $oldlib'
-old_postuninstall_cmds=
-
-if test -n "$RANLIB"; then
-  case $host_os in
-  openbsd*)
-    old_postinstall_cmds="\$RANLIB -t \$oldlib~$old_postinstall_cmds"
-    ;;
-  *)
-    old_postinstall_cmds="\$RANLIB \$oldlib~$old_postinstall_cmds"
-    ;;
-  esac
-  old_archive_cmds="$old_archive_cmds~\$RANLIB \$oldlib"
-fi
-
-# Only perform the check for file, if the check method requires it
-case $deplibs_check_method in
-file_magic*)
-  if test "$file_magic_cmd" = '$MAGIC_CMD'; then
-    echo "$as_me:$LINENO: checking for ${ac_tool_prefix}file" >&5
-echo $ECHO_N "checking for ${ac_tool_prefix}file... $ECHO_C" >&6
-if test "${lt_cv_path_MAGIC_CMD+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  case $MAGIC_CMD in
-[\\/*] |  ?:[\\/]*)
-  lt_cv_path_MAGIC_CMD="$MAGIC_CMD" # Let the user override the test with a path.
-  ;;
-*)
-  lt_save_MAGIC_CMD="$MAGIC_CMD"
-  lt_save_ifs="$IFS"; IFS=$PATH_SEPARATOR
-  ac_dummy="/usr/bin$PATH_SEPARATOR$PATH"
-  for ac_dir in $ac_dummy; do
-    IFS="$lt_save_ifs"
-    test -z "$ac_dir" && ac_dir=.
-    if test -f $ac_dir/${ac_tool_prefix}file; then
-      lt_cv_path_MAGIC_CMD="$ac_dir/${ac_tool_prefix}file"
-      if test -n "$file_magic_test_file"; then
-	case $deplibs_check_method in
-	"file_magic "*)
-	  file_magic_regex="`expr \"$deplibs_check_method\" : \"file_magic \(.*\)\"`"
-	  MAGIC_CMD="$lt_cv_path_MAGIC_CMD"
-	  if eval $file_magic_cmd \$file_magic_test_file 2> /dev/null |
-	    $EGREP "$file_magic_regex" > /dev/null; then
-	    :
-	  else
-	    cat <<EOF 1>&2
-
-*** Warning: the command libtool uses to detect shared libraries,
-*** $file_magic_cmd, produces output that libtool cannot recognize.
-*** The result is that libtool may fail to recognize shared libraries
-*** as such.  This will affect the creation of libtool libraries that
-*** depend on shared libraries, but programs linked with such libtool
-*** libraries will work regardless of this problem.  Nevertheless, you
-*** may want to report the problem to your system manager and/or to
-*** bug-libtool at gnu.org
-
-EOF
-	  fi ;;
-	esac
-      fi
-      break
-    fi
-  done
-  IFS="$lt_save_ifs"
-  MAGIC_CMD="$lt_save_MAGIC_CMD"
-  ;;
-esac
-fi
-
-MAGIC_CMD="$lt_cv_path_MAGIC_CMD"
-if test -n "$MAGIC_CMD"; then
-  echo "$as_me:$LINENO: result: $MAGIC_CMD" >&5
-echo "${ECHO_T}$MAGIC_CMD" >&6
-else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi
-
-if test -z "$lt_cv_path_MAGIC_CMD"; then
-  if test -n "$ac_tool_prefix"; then
-    echo "$as_me:$LINENO: checking for file" >&5
-echo $ECHO_N "checking for file... $ECHO_C" >&6
-if test "${lt_cv_path_MAGIC_CMD+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  case $MAGIC_CMD in
-[\\/*] |  ?:[\\/]*)
-  lt_cv_path_MAGIC_CMD="$MAGIC_CMD" # Let the user override the test with a path.
-  ;;
-*)
-  lt_save_MAGIC_CMD="$MAGIC_CMD"
-  lt_save_ifs="$IFS"; IFS=$PATH_SEPARATOR
-  ac_dummy="/usr/bin$PATH_SEPARATOR$PATH"
-  for ac_dir in $ac_dummy; do
-    IFS="$lt_save_ifs"
-    test -z "$ac_dir" && ac_dir=.
-    if test -f $ac_dir/file; then
-      lt_cv_path_MAGIC_CMD="$ac_dir/file"
-      if test -n "$file_magic_test_file"; then
-	case $deplibs_check_method in
-	"file_magic "*)
-	  file_magic_regex="`expr \"$deplibs_check_method\" : \"file_magic \(.*\)\"`"
-	  MAGIC_CMD="$lt_cv_path_MAGIC_CMD"
-	  if eval $file_magic_cmd \$file_magic_test_file 2> /dev/null |
-	    $EGREP "$file_magic_regex" > /dev/null; then
-	    :
-	  else
-	    cat <<EOF 1>&2
-
-*** Warning: the command libtool uses to detect shared libraries,
-*** $file_magic_cmd, produces output that libtool cannot recognize.
-*** The result is that libtool may fail to recognize shared libraries
-*** as such.  This will affect the creation of libtool libraries that
-*** depend on shared libraries, but programs linked with such libtool
-*** libraries will work regardless of this problem.  Nevertheless, you
-*** may want to report the problem to your system manager and/or to
-*** bug-libtool at gnu.org
-
-EOF
-	  fi ;;
-	esac
-      fi
-      break
-    fi
-  done
-  IFS="$lt_save_ifs"
-  MAGIC_CMD="$lt_save_MAGIC_CMD"
-  ;;
-esac
-fi
-
-MAGIC_CMD="$lt_cv_path_MAGIC_CMD"
-if test -n "$MAGIC_CMD"; then
-  echo "$as_me:$LINENO: result: $MAGIC_CMD" >&5
-echo "${ECHO_T}$MAGIC_CMD" >&6
-else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi
-
-  else
-    MAGIC_CMD=:
-  fi
-fi
-
-  fi
-  ;;
-esac
-
-enable_dlopen=no
-enable_win32_dll=no
-
-# Check whether --enable-libtool-lock or --disable-libtool-lock was given.
-if test "${enable_libtool_lock+set}" = set; then
-  enableval="$enable_libtool_lock"
-
-fi;
-test "x$enable_libtool_lock" != xno && enable_libtool_lock=yes
-
-
-# Check whether --with-pic or --without-pic was given.
-if test "${with_pic+set}" = set; then
-  withval="$with_pic"
-  pic_mode="$withval"
-else
-  pic_mode=default
-fi;
-test -z "$pic_mode" && pic_mode=default
-
-# Use C for the default configuration in the libtool script
-tagname=
-lt_save_CC="$CC"
-ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-
-
-# Source file extension for C test sources.
-ac_ext=c
-
-# Object file extension for compiled C test sources.
-objext=o
-objext=$objext
-
-# Code to be used in simple compile tests
-lt_simple_compile_test_code="int some_variable = 0;\n"
-
-# Code to be used in simple link tests
-lt_simple_link_test_code='int main(){return(0);}\n'
-
-
-# If no C compiler was specified, use CC.
-LTCC=${LTCC-"$CC"}
-
-# Allow CC to be a program name with arguments.
-compiler=$CC
-
-
-#
-# Check for any special shared library compilation flags.
-#
-lt_prog_cc_shlib=
-if test "$GCC" = no; then
-  case $host_os in
-  sco3.2v5*)
-    lt_prog_cc_shlib='-belf'
-    ;;
-  esac
-fi
-if test -n "$lt_prog_cc_shlib"; then
-  { echo "$as_me:$LINENO: WARNING: \`$CC' requires \`$lt_prog_cc_shlib' to build shared libraries" >&5
-echo "$as_me: WARNING: \`$CC' requires \`$lt_prog_cc_shlib' to build shared libraries" >&2;}
-  if echo "$old_CC $old_CFLAGS " | grep "[ 	]$lt_prog_cc_shlib[ 	]" >/dev/null; then :
-  else
-    { echo "$as_me:$LINENO: WARNING: add \`$lt_prog_cc_shlib' to the CC or CFLAGS env variable and reconfigure" >&5
-echo "$as_me: WARNING: add \`$lt_prog_cc_shlib' to the CC or CFLAGS env variable and reconfigure" >&2;}
-    lt_cv_prog_cc_can_build_shared=no
-  fi
-fi
-
-
-#
-# Check to make sure the static flag actually works.
-#
-echo "$as_me:$LINENO: checking if $compiler static flag $lt_prog_compiler_static works" >&5
-echo $ECHO_N "checking if $compiler static flag $lt_prog_compiler_static works... $ECHO_C" >&6
-if test "${lt_prog_compiler_static_works+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  lt_prog_compiler_static_works=no
-   save_LDFLAGS="$LDFLAGS"
-   LDFLAGS="$LDFLAGS $lt_prog_compiler_static"
-   printf "$lt_simple_link_test_code" > conftest.$ac_ext
-   if (eval $ac_link 2>conftest.err) && test -s conftest$ac_exeext; then
-     # The compiler can only warn and ignore the option if not recognized
-     # So say no if there are warnings
-     if test -s conftest.err; then
-       # Append any errors to the config.log.
-       cat conftest.err 1>&5
-     else
-       lt_prog_compiler_static_works=yes
-     fi
-   fi
-   $rm conftest*
-   LDFLAGS="$save_LDFLAGS"
-
-fi
-echo "$as_me:$LINENO: result: $lt_prog_compiler_static_works" >&5
-echo "${ECHO_T}$lt_prog_compiler_static_works" >&6
-
-if test x"$lt_prog_compiler_static_works" = xyes; then
-    :
-else
-    lt_prog_compiler_static=
-fi
-
-
-
-
-lt_prog_compiler_no_builtin_flag=
-
-if test "$GCC" = yes; then
-  lt_prog_compiler_no_builtin_flag=' -fno-builtin'
-
-
-echo "$as_me:$LINENO: checking if $compiler supports -fno-rtti -fno-exceptions" >&5
-echo $ECHO_N "checking if $compiler supports -fno-rtti -fno-exceptions... $ECHO_C" >&6
-if test "${lt_cv_prog_compiler_rtti_exceptions+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  lt_cv_prog_compiler_rtti_exceptions=no
-  ac_outfile=conftest.$ac_objext
-   printf "$lt_simple_compile_test_code" > conftest.$ac_ext
-   lt_compiler_flag="-fno-rtti -fno-exceptions"
-   # Insert the option either (1) after the last *FLAGS variable, or
-   # (2) before a word containing "conftest.", or (3) at the end.
-   # Note that $ac_compile itself does not contain backslashes and begins
-   # with a dollar sign (not a hyphen), so the echo should work correctly.
-   # The option is referenced via a variable to avoid confusing sed.
-   lt_compile=`echo "$ac_compile" | $SED \
-   -e 's:.*FLAGS}? :&$lt_compiler_flag :; t' \
-   -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
-   -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:6458: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
-   ac_status=$?
-   cat conftest.err >&5
-   echo "$as_me:6462: \$? = $ac_status" >&5
-   if (exit $ac_status) && test -s "$ac_outfile"; then
-     # The compiler can only warn and ignore the option if not recognized
-     # So say no if there are warnings
-     if test ! -s conftest.err; then
-       lt_cv_prog_compiler_rtti_exceptions=yes
-     fi
-   fi
-   $rm conftest*
-
-fi
-echo "$as_me:$LINENO: result: $lt_cv_prog_compiler_rtti_exceptions" >&5
-echo "${ECHO_T}$lt_cv_prog_compiler_rtti_exceptions" >&6
-
-if test x"$lt_cv_prog_compiler_rtti_exceptions" = xyes; then
-    lt_prog_compiler_no_builtin_flag="$lt_prog_compiler_no_builtin_flag -fno-rtti -fno-exceptions"
-else
-    :
-fi
-
-fi
-
-lt_prog_compiler_wl=
-lt_prog_compiler_pic=
-lt_prog_compiler_static=
-
-echo "$as_me:$LINENO: checking for $compiler option to produce PIC" >&5
-echo $ECHO_N "checking for $compiler option to produce PIC... $ECHO_C" >&6
-
-  if test "$GCC" = yes; then
-    lt_prog_compiler_wl='-Wl,'
-    lt_prog_compiler_static='-static'
-
-    case $host_os in
-      aix*)
-      # All AIX code is PIC.
-      if test "$host_cpu" = ia64; then
-	# AIX 5 now supports IA64 processor
-	lt_prog_compiler_static='-Bstatic'
-      fi
-      ;;
-
-    amigaos*)
-      # FIXME: we need at least 68020 code to build shared libraries, but
-      # adding the `-m68020' flag to GCC prevents building anything better,
-      # like `-m68040'.
-      lt_prog_compiler_pic='-m68020 -resident32 -malways-restore-a4'
-      ;;
-
-    beos* | cygwin* | irix5* | irix6* | nonstopux* | osf3* | osf4* | osf5*)
-      # PIC is the default for these OSes.
-      ;;
-
-    mingw* | pw32* | os2*)
-      # This hack is so that the source file can tell whether it is being
-      # built for inclusion in a dll (and should export symbols for example).
-      lt_prog_compiler_pic='-DDLL_EXPORT'
-      ;;
-
-    darwin* | rhapsody*)
-      # PIC is the default on this platform
-      # Common symbols not allowed in MH_DYLIB files
-      lt_prog_compiler_pic='-fno-common'
-      ;;
-
-    msdosdjgpp*)
-      # Just because we use GCC doesn't mean we suddenly get shared libraries
-      # on systems that don't support them.
-      lt_prog_compiler_can_build_shared=no
-      enable_shared=no
-      ;;
-
-    sysv4*MP*)
-      if test -d /usr/nec; then
-	lt_prog_compiler_pic=-Kconform_pic
-      fi
-      ;;
-
-    hpux*)
-      # PIC is the default for IA64 HP-UX and 64-bit HP-UX, but
-      # not for PA HP-UX.
-      case "$host_cpu" in
-      hppa*64*|ia64*)
-	# +Z the default
-	;;
-      *)
-	lt_prog_compiler_pic='-fPIC'
-	;;
-      esac
-      ;;
-
-    *)
-      lt_prog_compiler_pic='-fPIC'
-      ;;
-    esac
-  else
-    # PORTME Check for flag to pass linker flags through the system compiler.
-    case $host_os in
-    aix*)
-      lt_prog_compiler_wl='-Wl,'
-      if test "$host_cpu" = ia64; then
-	# AIX 5 now supports IA64 processor
-	lt_prog_compiler_static='-Bstatic'
-      else
-	lt_prog_compiler_static='-bnso -bI:/lib/syscalls.exp'
-      fi
-      ;;
-
-    mingw* | pw32* | os2*)
-      # This hack is so that the source file can tell whether it is being
-      # built for inclusion in a dll (and should export symbols for example).
-      lt_prog_compiler_pic='-DDLL_EXPORT'
-      ;;
-
-    hpux9* | hpux10* | hpux11*)
-      lt_prog_compiler_wl='-Wl,'
-      # PIC is the default for IA64 HP-UX and 64-bit HP-UX, but
-      # not for PA HP-UX.
-      case "$host_cpu" in
-      hppa*64*|ia64*)
-	# +Z the default
-	;;
-      *)
-	lt_prog_compiler_pic='+Z'
-	;;
-      esac
-      # Is there a better lt_prog_compiler_static that works with the bundled CC?
-      lt_prog_compiler_static='${wl}-a ${wl}archive'
-      ;;
-
-    irix5* | irix6* | nonstopux*)
-      lt_prog_compiler_wl='-Wl,'
-      # PIC (with -KPIC) is the default.
-      lt_prog_compiler_static='-non_shared'
-      ;;
-
-    newsos6)
-      lt_prog_compiler_pic='-KPIC'
-      lt_prog_compiler_static='-Bstatic'
-      ;;
-
-    linux*)
-      case $CC in
-      icc* | ecc*)
-	lt_prog_compiler_wl='-Wl,'
-	lt_prog_compiler_pic='-KPIC'
-	lt_prog_compiler_static='-static'
-        ;;
-      ccc*)
-        lt_prog_compiler_wl='-Wl,'
-        # All Alpha code is PIC.
-        lt_prog_compiler_static='-non_shared'
-        ;;
-      esac
-      ;;
-
-    osf3* | osf4* | osf5*)
-      lt_prog_compiler_wl='-Wl,'
-      # All OSF/1 code is PIC.
-      lt_prog_compiler_static='-non_shared'
-      ;;
-
-    sco3.2v5*)
-      lt_prog_compiler_pic='-Kpic'
-      lt_prog_compiler_static='-dn'
-      ;;
-
-    solaris*)
-      lt_prog_compiler_wl='-Wl,'
-      lt_prog_compiler_pic='-KPIC'
-      lt_prog_compiler_static='-Bstatic'
-      ;;
-
-    sunos4*)
-      lt_prog_compiler_wl='-Qoption ld '
-      lt_prog_compiler_pic='-PIC'
-      lt_prog_compiler_static='-Bstatic'
-      ;;
-
-    sysv4 | sysv4.2uw2* | sysv4.3* | sysv5*)
-      lt_prog_compiler_wl='-Wl,'
-      lt_prog_compiler_pic='-KPIC'
-      lt_prog_compiler_static='-Bstatic'
-      ;;
-
-    sysv4*MP*)
-      if test -d /usr/nec ;then
-	lt_prog_compiler_pic='-Kconform_pic'
-	lt_prog_compiler_static='-Bstatic'
-      fi
-      ;;
-
-    uts4*)
-      lt_prog_compiler_pic='-pic'
-      lt_prog_compiler_static='-Bstatic'
-      ;;
-
-    *)
-      lt_prog_compiler_can_build_shared=no
-      ;;
-    esac
-  fi
-
-echo "$as_me:$LINENO: result: $lt_prog_compiler_pic" >&5
-echo "${ECHO_T}$lt_prog_compiler_pic" >&6
-
-#
-# Check to make sure the PIC flag actually works.
-#
-if test -n "$lt_prog_compiler_pic"; then
-
-echo "$as_me:$LINENO: checking if $compiler PIC flag $lt_prog_compiler_pic works" >&5
-echo $ECHO_N "checking if $compiler PIC flag $lt_prog_compiler_pic works... $ECHO_C" >&6
-if test "${lt_prog_compiler_pic_works+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  lt_prog_compiler_pic_works=no
-  ac_outfile=conftest.$ac_objext
-   printf "$lt_simple_compile_test_code" > conftest.$ac_ext
-   lt_compiler_flag="$lt_prog_compiler_pic -DPIC"
-   # Insert the option either (1) after the last *FLAGS variable, or
-   # (2) before a word containing "conftest.", or (3) at the end.
-   # Note that $ac_compile itself does not contain backslashes and begins
-   # with a dollar sign (not a hyphen), so the echo should work correctly.
-   # The option is referenced via a variable to avoid confusing sed.
-   lt_compile=`echo "$ac_compile" | $SED \
-   -e 's:.*FLAGS}? :&$lt_compiler_flag :; t' \
-   -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
-   -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:6691: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
-   ac_status=$?
-   cat conftest.err >&5
-   echo "$as_me:6695: \$? = $ac_status" >&5
-   if (exit $ac_status) && test -s "$ac_outfile"; then
-     # The compiler can only warn and ignore the option if not recognized
-     # So say no if there are warnings
-     if test ! -s conftest.err; then
-       lt_prog_compiler_pic_works=yes
-     fi
-   fi
-   $rm conftest*
-
-fi
-echo "$as_me:$LINENO: result: $lt_prog_compiler_pic_works" >&5
-echo "${ECHO_T}$lt_prog_compiler_pic_works" >&6
-
-if test x"$lt_prog_compiler_pic_works" = xyes; then
-    case $lt_prog_compiler_pic in
-     "" | " "*) ;;
-     *) lt_prog_compiler_pic=" $lt_prog_compiler_pic" ;;
-     esac
-else
-    lt_prog_compiler_pic=
-     lt_prog_compiler_can_build_shared=no
-fi
-
-fi
-case "$host_os" in
-  # For platforms which do not support PIC, -DPIC is meaningless:
-  *djgpp*)
-    lt_prog_compiler_pic=
-    ;;
-  *)
-    lt_prog_compiler_pic="$lt_prog_compiler_pic -DPIC"
-    ;;
-esac
-
-echo "$as_me:$LINENO: checking if $compiler supports -c -o file.$ac_objext" >&5
-echo $ECHO_N "checking if $compiler supports -c -o file.$ac_objext... $ECHO_C" >&6
-if test "${lt_cv_prog_compiler_c_o+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  lt_cv_prog_compiler_c_o=no
-   $rm -r conftest 2>/dev/null
-   mkdir conftest
-   cd conftest
-   mkdir out
-   printf "$lt_simple_compile_test_code" > conftest.$ac_ext
-
-   lt_compiler_flag="-o out/conftest2.$ac_objext"
-   # Insert the option either (1) after the last *FLAGS variable, or
-   # (2) before a word containing "conftest.", or (3) at the end.
-   # Note that $ac_compile itself does not contain backslashes and begins
-   # with a dollar sign (not a hyphen), so the echo should work correctly.
-   lt_compile=`echo "$ac_compile" | $SED \
-   -e 's:.*FLAGS}? :&$lt_compiler_flag :; t' \
-   -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
-   -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:6751: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
-   ac_status=$?
-   cat out/conftest.err >&5
-   echo "$as_me:6755: \$? = $ac_status" >&5
-   if (exit $ac_status) && test -s out/conftest2.$ac_objext
-   then
-     # The compiler can only warn and ignore the option if not recognized
-     # So say no if there are warnings
-     if test ! -s out/conftest.err; then
-       lt_cv_prog_compiler_c_o=yes
-     fi
-   fi
-   chmod u+w .
-   $rm conftest*
-   # SGI C++ compiler will create directory out/ii_files/ for
-   # template instantiation
-   test -d out/ii_files && $rm out/ii_files/* && rmdir out/ii_files
-   $rm out/* && rmdir out
-   cd ..
-   rmdir conftest
-   $rm conftest*
-
-fi
-echo "$as_me:$LINENO: result: $lt_cv_prog_compiler_c_o" >&5
-echo "${ECHO_T}$lt_cv_prog_compiler_c_o" >&6
-
-
-hard_links="nottested"
-if test "$lt_cv_prog_compiler_c_o" = no && test "$need_locks" != no; then
-  # do not overwrite the value of need_locks provided by the user
-  echo "$as_me:$LINENO: checking if we can lock with hard links" >&5
-echo $ECHO_N "checking if we can lock with hard links... $ECHO_C" >&6
-  hard_links=yes
-  $rm conftest*
-  ln conftest.a conftest.b 2>/dev/null && hard_links=no
-  touch conftest.a
-  ln conftest.a conftest.b 2>&5 || hard_links=no
-  ln conftest.a conftest.b 2>/dev/null && hard_links=no
-  echo "$as_me:$LINENO: result: $hard_links" >&5
-echo "${ECHO_T}$hard_links" >&6
-  if test "$hard_links" = no; then
-    { echo "$as_me:$LINENO: WARNING: \`$CC' does not support \`-c -o', so \`make -j' may be unsafe" >&5
-echo "$as_me: WARNING: \`$CC' does not support \`-c -o', so \`make -j' may be unsafe" >&2;}
-    need_locks=warn
-  fi
-else
-  need_locks=no
-fi
-
-echo "$as_me:$LINENO: checking whether the $compiler linker ($LD) supports shared libraries" >&5
-echo $ECHO_N "checking whether the $compiler linker ($LD) supports shared libraries... $ECHO_C" >&6
-
-  runpath_var=
-  allow_undefined_flag=
-  enable_shared_with_static_runtimes=no
-  archive_cmds=
-  archive_expsym_cmds=
-  old_archive_From_new_cmds=
-  old_archive_from_expsyms_cmds=
-  export_dynamic_flag_spec=
-  whole_archive_flag_spec=
-  thread_safe_flag_spec=
-  hardcode_libdir_flag_spec=
-  hardcode_libdir_flag_spec_ld=
-  hardcode_libdir_separator=
-  hardcode_direct=no
-  hardcode_minus_L=no
-  hardcode_shlibpath_var=unsupported
-  link_all_deplibs=unknown
-  hardcode_automatic=no
-  module_cmds=
-  module_expsym_cmds=
-  always_export_symbols=no
-  export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
-  # include_expsyms should be a list of space-separated symbols to be *always*
-  # included in the symbol list
-  include_expsyms=
-  # exclude_expsyms can be an extended regexp of symbols to exclude
-  # it will be wrapped by ` (' and `)$', so one must not match beginning or
-  # end of line.  Example: `a|bc|.*d.*' will exclude the symbols `a' and `bc',
-  # as well as any symbol that contains `d'.
-  exclude_expsyms="_GLOBAL_OFFSET_TABLE_"
-  # Although _GLOBAL_OFFSET_TABLE_ is a valid symbol C name, most a.out
-  # platforms (ab)use it in PIC code, but their linkers get confused if
-  # the symbol is explicitly referenced.  Since portable code cannot
-  # rely on this symbol name, it's probably fine to never include it in
-  # preloaded symbol tables.
-  extract_expsyms_cmds=
-
-  case $host_os in
-  cygwin* | mingw* | pw32*)
-    # FIXME: the MSVC++ port hasn't been tested in a loooong time
-    # When not using gcc, we currently assume that we are using
-    # Microsoft Visual C++.
-    if test "$GCC" != yes; then
-      with_gnu_ld=no
-    fi
-    ;;
-  openbsd*)
-    with_gnu_ld=no
-    ;;
-  esac
-
-  ld_shlibs=yes
-  if test "$with_gnu_ld" = yes; then
-    # If archive_cmds runs LD, not CC, wlarc should be empty
-    wlarc='${wl}'
-
-    # See if GNU ld supports shared libraries.
-    case $host_os in
-    aix3* | aix4* | aix5*)
-      # On AIX/PPC, the GNU linker is very broken
-      if test "$host_cpu" != ia64; then
-	ld_shlibs=no
-	cat <<EOF 1>&2
-
-*** Warning: the GNU linker, at least up to release 2.9.1, is reported
-*** to be unable to reliably create shared libraries on AIX.
-*** Therefore, libtool is disabling shared libraries support.  If you
-*** really care for shared libraries, you may want to modify your PATH
-*** so that a non-GNU linker is found, and then restart.
-
-EOF
-      fi
-      ;;
-
-    amigaos*)
-      archive_cmds='$rm $output_objdir/a2ixlibrary.data~$echo "#define NAME $libname" > $output_objdir/a2ixlibrary.data~$echo "#define LIBRARY_ID 1" >> $output_objdir/a2ixlibrary.data~$echo "#define VERSION $major" >> $output_objdir/a2ixlibrary.data~$echo "#define REVISION $revision" >> $output_objdir/a2ixlibrary.data~$AR $AR_FLAGS $lib $libobjs~$RANLIB $lib~(cd $output_objdir && a2ixlibrary -32)'
-      hardcode_libdir_flag_spec='-L$libdir'
-      hardcode_minus_L=yes
-
-      # Samuel A. Falvo II <kc5tja at dolphin.openprojects.net> reports
-      # that the semantics of dynamic libraries on AmigaOS, at least up
-      # to version 4, is to share data among multiple programs linked
-      # with the same dynamic library.  Since this doesn't match the
-      # behavior of shared libraries on other platforms, we can't use
-      # them.
-      ld_shlibs=no
-      ;;
-
-    beos*)
-      if $LD --help 2>&1 | grep ': supported targets:.* elf' > /dev/null; then
-	allow_undefined_flag=unsupported
-	# Joseph Beckenbach <jrb3 at best.com> says some releases of gcc
-	# support --undefined.  This deserves some investigation.  FIXME
-	archive_cmds='$CC -nostart $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
-      else
-	ld_shlibs=no
-      fi
-      ;;
-
-    cygwin* | mingw* | pw32*)
-      # _LT_AC_TAGVAR(hardcode_libdir_flag_spec, ) is actually meaningless,
-      # as there is no search path for DLLs.
-      hardcode_libdir_flag_spec='-L$libdir'
-      allow_undefined_flag=unsupported
-      always_export_symbols=no
-      enable_shared_with_static_runtimes=yes
-      export_symbols_cmds='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGS] /s/.* \([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW] /s/.* //'\'' | sort | uniq > $export_symbols'
-
-      if $LD --help 2>&1 | grep 'auto-import' > /dev/null; then
-        archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--image-base=0x10000000 ${wl}--out-implib,$lib'
-	# If the export-symbols file already is a .def file (1st line
-	# is EXPORTS), use it as is; otherwise, prepend...
-	archive_expsym_cmds='if test "x`$SED 1q $export_symbols`" = xEXPORTS; then
-	  cp $export_symbols $output_objdir/$soname.def;
-	else
-	  echo EXPORTS > $output_objdir/$soname.def;
-	  cat $export_symbols >> $output_objdir/$soname.def;
-	fi~
-	$CC -shared $output_objdir/$soname.def $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--image-base=0x10000000  ${wl}--out-implib,$lib'
-      else
-	ld_shlibs=no
-      fi
-      ;;
-
-    netbsd* | netbsdelf*-gnu | knetbsd*-gnu)
-      if echo __ELF__ | $CC -E - | grep __ELF__ >/dev/null; then
-	archive_cmds='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
-	wlarc=
-      else
-	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
-	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
-      fi
-      ;;
-
-    solaris* | sysv5*)
-      if $LD -v 2>&1 | grep 'BFD 2\.8' > /dev/null; then
-	ld_shlibs=no
-	cat <<EOF 1>&2
-
-*** Warning: The releases 2.8.* of the GNU linker cannot reliably
-*** create shared libraries on Solaris systems.  Therefore, libtool
-*** is disabling shared libraries support.  We urge you to upgrade GNU
-*** binutils to release 2.9.1 or newer.  Another option is to modify
-*** your PATH or compiler configuration so that the native linker is
-*** used, and then restart.
-
-EOF
-      elif $LD --help 2>&1 | grep ': supported targets:.* elf' > /dev/null; then
-	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
-	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
-      else
-	ld_shlibs=no
-      fi
-      ;;
-
-    sunos4*)
-      archive_cmds='$LD -assert pure-text -Bshareable -o $lib $libobjs $deplibs $linker_flags'
-      wlarc=
-      hardcode_direct=yes
-      hardcode_shlibpath_var=no
-      ;;
-
-  linux*)
-    if $LD --help 2>&1 | grep ': supported targets:.* elf' > /dev/null; then
-        tmp_archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
-	archive_cmds="$tmp_archive_cmds"
-      supports_anon_versioning=no
-      case `$LD -v 2>/dev/null` in
-        *\ 01.* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
-        *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
-        *\ 2.11.92.0.12\ *) supports_anon_versioning=yes ;; # Mandrake 8.2 ...
-        *\ 2.11.*) ;; # other 2.11 versions
-        *) supports_anon_versioning=yes ;;
-      esac
-      if test $supports_anon_versioning = yes; then
-        archive_expsym_cmds='$echo "{ global:" > $output_objdir/$libname.ver~
-cat $export_symbols | sed -e "s/\(.*\)/\1;/" >> $output_objdir/$libname.ver~
-$echo "local: *; };" >> $output_objdir/$libname.ver~
-        $CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'
-      else
-        archive_expsym_cmds="$tmp_archive_cmds"
-      fi
-      link_all_deplibs=no
-    else
-      ld_shlibs=no
-    fi
-    ;;
-
-    *)
-      if $LD --help 2>&1 | grep ': supported targets:.* elf' > /dev/null; then
-	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
-	archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
-      else
-	ld_shlibs=no
-      fi
-      ;;
-    esac
-
-    if test "$ld_shlibs" = yes; then
-      runpath_var=LD_RUN_PATH
-      hardcode_libdir_flag_spec='${wl}--rpath ${wl}$libdir'
-      export_dynamic_flag_spec='${wl}--export-dynamic'
-      # ancient GNU ld didn't support --whole-archive et. al.
-      if $LD --help 2>&1 | grep 'no-whole-archive' > /dev/null; then
- 	whole_archive_flag_spec="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
-      else
-  	whole_archive_flag_spec=
-      fi
-    fi
-  else
-    # PORTME fill in a description of your system's linker (not GNU ld)
-    case $host_os in
-    aix3*)
-      allow_undefined_flag=unsupported
-      always_export_symbols=yes
-      archive_expsym_cmds='$LD -o $output_objdir/$soname $libobjs $deplibs $linker_flags -bE:$export_symbols -T512 -H512 -bM:SRE~$AR $AR_FLAGS $lib $output_objdir/$soname'
-      # Note: this linker hardcodes the directories in LIBPATH if there
-      # are no directories specified by -L.
-      hardcode_minus_L=yes
-      if test "$GCC" = yes && test -z "$link_static_flag"; then
-	# Neither direct hardcoding nor static linking is supported with a
-	# broken collect2.
-	hardcode_direct=unsupported
-      fi
-      ;;
-
-    aix4* | aix5*)
-      if test "$host_cpu" = ia64; then
-	# On IA64, the linker does run time linking by default, so we don't
-	# have to do anything special.
-	aix_use_runtimelinking=no
-	exp_sym_flag='-Bexport'
-	no_entry_flag=""
-      else
-	# If we're using GNU nm, then we don't want the "-C" option.
-	# -C means demangle to AIX nm, but means don't demangle with GNU nm
-	if $NM -V 2>&1 | grep 'GNU' > /dev/null; then
-	  export_symbols_cmds='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$2 == "T") || (\$2 == "D") || (\$2 == "B")) && (substr(\$3,1,1) != ".")) { print \$3 } }'\'' | sort -u > $export_symbols'
-	else
-	  export_symbols_cmds='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$2 == "T") || (\$2 == "D") || (\$2 == "B")) && (substr(\$3,1,1) != ".")) { print \$3 } }'\'' | sort -u > $export_symbols'
-	fi
-	aix_use_runtimelinking=no
-
-	# Test if we are trying to use run time linking or normal
-	# AIX style linking. If -brtl is somewhere in LDFLAGS, we
-	# need to do runtime linking.
-	case $host_os in aix4.[23]|aix4.[23].*|aix5*)
-	  for ld_flag in $LDFLAGS; do
-  	  if (test $ld_flag = "-brtl" || test $ld_flag = "-Wl,-brtl"); then
-  	    aix_use_runtimelinking=yes
-  	    break
-  	  fi
-	  done
-	esac
-
-	exp_sym_flag='-bexport'
-	no_entry_flag='-bnoentry'
-      fi
-
-      # When large executables or shared objects are built, AIX ld can
-      # have problems creating the table of contents.  If linking a library
-      # or program results in "error TOC overflow" add -mminimal-toc to
-      # CXXFLAGS/CFLAGS for g++/gcc.  In the cases where that is not
-      # enough to fix the problem, add -Wl,-bbigtoc to LDFLAGS.
-
-      archive_cmds=''
-      hardcode_direct=yes
-      hardcode_libdir_separator=':'
-      link_all_deplibs=yes
-
-      if test "$GCC" = yes; then
-	case $host_os in aix4.012|aix4.012.*)
-	# We only want to do this on AIX 4.2 and lower, the check
-	# below for broken collect2 doesn't work under 4.3+
-	  collect2name=`${CC} -print-prog-name=collect2`
-	  if test -f "$collect2name" && \
-  	   strings "$collect2name" | grep resolve_lib_name >/dev/null
-	  then
-  	  # We have reworked collect2
-  	  hardcode_direct=yes
-	  else
-  	  # We have old collect2
-  	  hardcode_direct=unsupported
-  	  # It fails to find uninstalled libraries when the uninstalled
-  	  # path is not listed in the libpath.  Setting hardcode_minus_L
-  	  # to unsupported forces relinking
-  	  hardcode_minus_L=yes
-  	  hardcode_libdir_flag_spec='-L$libdir'
-  	  hardcode_libdir_separator=
-	  fi
-	esac
-	shared_flag='-shared'
-      else
-	# not using gcc
-	if test "$host_cpu" = ia64; then
-  	# VisualAge C++, Version 5.5 for AIX 5L for IA-64, Beta 3 Release
-  	# chokes on -Wl,-G. The following line is correct:
-	  shared_flag='-G'
-	else
-  	if test "$aix_use_runtimelinking" = yes; then
-	    shared_flag='${wl}-G'
-	  else
-	    shared_flag='${wl}-bM:SRE'
-  	fi
-	fi
-      fi
-
-      # It seems that -bexpall does not export symbols beginning with
-      # underscore (_), so it is better to generate a list of symbols to export.
-      always_export_symbols=yes
-      if test "$aix_use_runtimelinking" = yes; then
-	# Warning - without using the other runtime loading flags (-brtl),
-	# -berok will link without error, but may produce a broken library.
-	allow_undefined_flag='-berok'
-       # Determine the default libpath from the value encoded in an empty executable.
-       cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-
-aix_libpath=`dump -H conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
-}'`
-# Check for a 64-bit object if we didn't find anything.
-if test -z "$aix_libpath"; then aix_libpath=`dump -HX64 conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
-}'`; fi
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
-
-       hardcode_libdir_flag_spec='${wl}-blibpath:$libdir:'"$aix_libpath"
-	archive_expsym_cmds="\$CC"' -o $output_objdir/$soname $libobjs $deplibs $compiler_flags `if test "x${allow_undefined_flag}" != "x"; then echo "${wl}${allow_undefined_flag}"; else :; fi` '"\${wl}$no_entry_flag \${wl}$exp_sym_flag:\$export_symbols $shared_flag"
-       else
-	if test "$host_cpu" = ia64; then
-	  hardcode_libdir_flag_spec='${wl}-R $libdir:/usr/lib:/lib'
-	  allow_undefined_flag="-z nodefs"
-	  archive_expsym_cmds="\$CC $shared_flag"' -o $output_objdir/$soname $libobjs $deplibs $compiler_flags ${wl}${allow_undefined_flag} '"\${wl}$no_entry_flag \${wl}$exp_sym_flag:\$export_symbols"
-	else
-	 # Determine the default libpath from the value encoded in an empty executable.
-	 cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-
-aix_libpath=`dump -H conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
-}'`
-# Check for a 64-bit object if we didn't find anything.
-if test -z "$aix_libpath"; then aix_libpath=`dump -HX64 conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
-}'`; fi
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
-
-	 hardcode_libdir_flag_spec='${wl}-blibpath:$libdir:'"$aix_libpath"
-	  # Warning - without using the other run time loading flags,
-	  # -berok will link without error, but may produce a broken library.
-	  no_undefined_flag=' ${wl}-bernotok'
-	  allow_undefined_flag=' ${wl}-berok'
-	  # -bexpall does not export symbols beginning with underscore (_)
-	  always_export_symbols=yes
-	  # Exported symbols can be pulled into shared objects from archives
-	  whole_archive_flag_spec=' '
-	  archive_cmds_need_lc=yes
-	  # This is similar to how AIX traditionally builds it's shared libraries.
-	  archive_expsym_cmds="\$CC $shared_flag"' -o $output_objdir/$soname $libobjs $deplibs $compiler_flags ${wl}-bE:$export_symbols ${wl}-bnoentry${allow_undefined_flag}~$AR $AR_FLAGS $output_objdir/$libname$release.a $output_objdir/$soname'
-	fi
-      fi
-      ;;
-
-    amigaos*)
-      archive_cmds='$rm $output_objdir/a2ixlibrary.data~$echo "#define NAME $libname" > $output_objdir/a2ixlibrary.data~$echo "#define LIBRARY_ID 1" >> $output_objdir/a2ixlibrary.data~$echo "#define VERSION $major" >> $output_objdir/a2ixlibrary.data~$echo "#define REVISION $revision" >> $output_objdir/a2ixlibrary.data~$AR $AR_FLAGS $lib $libobjs~$RANLIB $lib~(cd $output_objdir && a2ixlibrary -32)'
-      hardcode_libdir_flag_spec='-L$libdir'
-      hardcode_minus_L=yes
-      # see comment about different semantics on the GNU ld section
-      ld_shlibs=no
-      ;;
-
-    bsdi4*)
-      export_dynamic_flag_spec=-rdynamic
-      ;;
-
-    cygwin* | mingw* | pw32*)
-      # When not using gcc, we currently assume that we are using
-      # Microsoft Visual C++.
-      # hardcode_libdir_flag_spec is actually meaningless, as there is
-      # no search path for DLLs.
-      hardcode_libdir_flag_spec=' '
-      allow_undefined_flag=unsupported
-      # Tell ltmain to make .lib files, not .a files.
-      libext=lib
-      # Tell ltmain to make .dll files, not .so files.
-      shrext_cmds=".dll"
-      # FIXME: Setting linknames here is a bad hack.
-      archive_cmds='$CC -o $lib $libobjs $compiler_flags `echo "$deplibs" | $SED -e '\''s/ -lc$//'\''` -link -dll~linknames='
-      # The linker will automatically build a .lib file if we build a DLL.
-      old_archive_From_new_cmds='true'
-      # FIXME: Should let the user specify the lib program.
-      old_archive_cmds='lib /OUT:$oldlib$oldobjs$old_deplibs'
-      fix_srcfile_path='`cygpath -w "$srcfile"`'
-      enable_shared_with_static_runtimes=yes
-      ;;
-
-    darwin* | rhapsody*)
-    if test "$GXX" = yes ; then
-      archive_cmds_need_lc=no
-      case "$host_os" in
-      rhapsody* | darwin1.[012])
-	allow_undefined_flag='-undefined suppress'
-	;;
-      *) # Darwin 1.3 on
-      if test -z ${MACOSX_DEPLOYMENT_TARGET} ; then
-      	allow_undefined_flag='-flat_namespace -undefined suppress'
-      else
-        case ${MACOSX_DEPLOYMENT_TARGET} in
-          10.[012])
-            allow_undefined_flag='-flat_namespace -undefined suppress'
-            ;;
-          10.*)
-            allow_undefined_flag='-undefined dynamic_lookup'
-            ;;
-        esac
-      fi
-	;;
-      esac
-    	lt_int_apple_cc_single_mod=no
-    	output_verbose_link_cmd='echo'
-    	if $CC -dumpspecs 2>&1 | grep 'single_module' >/dev/null ; then
-    	  lt_int_apple_cc_single_mod=yes
-    	fi
-    	if test "X$lt_int_apple_cc_single_mod" = Xyes ; then
-    	  archive_cmds='$CC -dynamiclib -single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring'
-    	else
-        archive_cmds='$CC -r ${wl}-bind_at_load -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs~$CC -dynamiclib $allow_undefined_flag -o $lib ${lib}-master.o $deplibs $compiler_flags -install_name $rpath/$soname $verstring'
-      fi
-      module_cmds='$CC ${wl}-bind_at_load $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
-      # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's
-        if test "X$lt_int_apple_cc_single_mod" = Xyes ; then
-          archive_expsym_cmds='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -dynamiclib -single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-        else
-          archive_expsym_cmds='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -r ${wl}-bind_at_load -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs~$CC -dynamiclib $allow_undefined_flag -o $lib ${lib}-master.o $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-        fi
-          module_expsym_cmds='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-      hardcode_direct=no
-      hardcode_automatic=yes
-      hardcode_shlibpath_var=unsupported
-      whole_archive_flag_spec='-all_load $convenience'
-      link_all_deplibs=yes
-    else
-      ld_shlibs=no
-    fi
-      ;;
-
-    dgux*)
-      archive_cmds='$LD -G -h $soname -o $lib $libobjs $deplibs $linker_flags'
-      hardcode_libdir_flag_spec='-L$libdir'
-      hardcode_shlibpath_var=no
-      ;;
-
-    freebsd1*)
-      ld_shlibs=no
-      ;;
-
-    # FreeBSD 2.2.[012] allows us to include c++rt0.o to get C++ constructor
-    # support.  Future versions do this automatically, but an explicit c++rt0.o
-    # does not break anything, and helps significantly (at the cost of a little
-    # extra space).
-    freebsd2.2*)
-      archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags /usr/lib/c++rt0.o'
-      hardcode_libdir_flag_spec='-R$libdir'
-      hardcode_direct=yes
-      hardcode_shlibpath_var=no
-      ;;
-
-    # Unfortunately, older versions of FreeBSD 2 do not have this feature.
-    freebsd2*)
-      archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'
-      hardcode_direct=yes
-      hardcode_minus_L=yes
-      hardcode_shlibpath_var=no
-      ;;
-
-    # FreeBSD 3 and greater uses gcc -shared to do shared libraries.
-    freebsd* | kfreebsd*-gnu)
-      archive_cmds='$CC -shared -o $lib $libobjs $deplibs $compiler_flags'
-      hardcode_libdir_flag_spec='-R$libdir'
-      hardcode_direct=yes
-      hardcode_shlibpath_var=no
-      ;;
-
-    hpux9*)
-      if test "$GCC" = yes; then
-	archive_cmds='$rm $output_objdir/$soname~$CC -shared -fPIC ${wl}+b ${wl}$install_libdir -o $output_objdir/$soname $libobjs $deplibs $compiler_flags~test $output_objdir/$soname = $lib || mv $output_objdir/$soname $lib'
-      else
-	archive_cmds='$rm $output_objdir/$soname~$LD -b +b $install_libdir -o $output_objdir/$soname $libobjs $deplibs $linker_flags~test $output_objdir/$soname = $lib || mv $output_objdir/$soname $lib'
-      fi
-      hardcode_libdir_flag_spec='${wl}+b ${wl}$libdir'
-      hardcode_libdir_separator=:
-      hardcode_direct=yes
-
-      # hardcode_minus_L: Not really in the search PATH,
-      # but as the default location of the library.
-      hardcode_minus_L=yes
-      export_dynamic_flag_spec='${wl}-E'
-      ;;
-
-    hpux10* | hpux11*)
-      if test "$GCC" = yes -a "$with_gnu_ld" = no; then
-	case "$host_cpu" in
-	hppa*64*|ia64*)
-	  archive_cmds='$CC -shared ${wl}+h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags'
-	  ;;
-	*)
-	  archive_cmds='$CC -shared -fPIC ${wl}+h ${wl}$soname ${wl}+b ${wl}$install_libdir -o $lib $libobjs $deplibs $compiler_flags'
-	  ;;
-	esac
-      else
-	case "$host_cpu" in
-	hppa*64*|ia64*)
-	  archive_cmds='$LD -b +h $soname -o $lib $libobjs $deplibs $linker_flags'
-	  ;;
-	*)
-	  archive_cmds='$LD -b +h $soname +b $install_libdir -o $lib $libobjs $deplibs $linker_flags'
-	  ;;
-	esac
-      fi
-      if test "$with_gnu_ld" = no; then
-	case "$host_cpu" in
-	hppa*64*)
-	  hardcode_libdir_flag_spec='${wl}+b ${wl}$libdir'
-	  hardcode_libdir_flag_spec_ld='+b $libdir'
-	  hardcode_libdir_separator=:
-	  hardcode_direct=no
-	  hardcode_shlibpath_var=no
-	  ;;
-	ia64*)
-	  hardcode_libdir_flag_spec='-L$libdir'
-	  hardcode_direct=no
-	  hardcode_shlibpath_var=no
-
-	  # hardcode_minus_L: Not really in the search PATH,
-	  # but as the default location of the library.
-	  hardcode_minus_L=yes
-	  ;;
-	*)
-	  hardcode_libdir_flag_spec='${wl}+b ${wl}$libdir'
-	  hardcode_libdir_separator=:
-	  hardcode_direct=yes
-	  export_dynamic_flag_spec='${wl}-E'
-
-	  # hardcode_minus_L: Not really in the search PATH,
-	  # but as the default location of the library.
-	  hardcode_minus_L=yes
-	  ;;
-	esac
-      fi
-      ;;
-
-    irix5* | irix6* | nonstopux*)
-      if test "$GCC" = yes; then
-	archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname ${wl}$soname `test -n "$verstring" && echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${output_objdir}/so_locations -o $lib'
-      else
-	archive_cmds='$LD -shared $libobjs $deplibs $linker_flags -soname $soname `test -n "$verstring" && echo -set_version $verstring` -update_registry ${output_objdir}/so_locations -o $lib'
-	hardcode_libdir_flag_spec_ld='-rpath $libdir'
-      fi
-      hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
-      hardcode_libdir_separator=:
-      link_all_deplibs=yes
-      ;;
-
-    netbsd* | netbsdelf*-gnu | knetbsd*-gnu)
-      if echo __ELF__ | $CC -E - | grep __ELF__ >/dev/null; then
-	archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
-      else
-	archive_cmds='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
-      fi
-      hardcode_libdir_flag_spec='-R$libdir'
-      hardcode_direct=yes
-      hardcode_shlibpath_var=no
-      ;;
-
-    newsos6)
-      archive_cmds='$LD -G -h $soname -o $lib $libobjs $deplibs $linker_flags'
-      hardcode_direct=yes
-      hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
-      hardcode_libdir_separator=:
-      hardcode_shlibpath_var=no
-      ;;
-
-    openbsd*)
-      hardcode_direct=yes
-      hardcode_shlibpath_var=no
-      if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
-	archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
-	hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
-	export_dynamic_flag_spec='${wl}-E'
-      else
-       case $host_os in
-	 openbsd[01].* | openbsd2.[0-7] | openbsd2.[0-7].*)
-	   archive_cmds='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'
-	   hardcode_libdir_flag_spec='-R$libdir'
-	   ;;
-	 *)
-	   archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
-	   hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
-	   ;;
-       esac
-      fi
-      ;;
-
-    os2*)
-      hardcode_libdir_flag_spec='-L$libdir'
-      hardcode_minus_L=yes
-      allow_undefined_flag=unsupported
-      archive_cmds='$echo "LIBRARY $libname INITINSTANCE" > $output_objdir/$libname.def~$echo "DESCRIPTION \"$libname\"" >> $output_objdir/$libname.def~$echo DATA >> $output_objdir/$libname.def~$echo " SINGLE NONSHARED" >> $output_objdir/$libname.def~$echo EXPORTS >> $output_objdir/$libname.def~emxexp $libobjs >> $output_objdir/$libname.def~$CC -Zdll -Zcrtdll -o $lib $libobjs $deplibs $compiler_flags $output_objdir/$libname.def'
-      old_archive_From_new_cmds='emximp -o $output_objdir/$libname.a $output_objdir/$libname.def'
-      ;;
-
-    osf3*)
-      if test "$GCC" = yes; then
-	allow_undefined_flag=' ${wl}-expect_unresolved ${wl}\*'
-	archive_cmds='$CC -shared${allow_undefined_flag} $libobjs $deplibs $compiler_flags ${wl}-soname ${wl}$soname `test -n "$verstring" && echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${output_objdir}/so_locations -o $lib'
-      else
-	allow_undefined_flag=' -expect_unresolved \*'
-	archive_cmds='$LD -shared${allow_undefined_flag} $libobjs $deplibs $linker_flags -soname $soname `test -n "$verstring" && echo -set_version $verstring` -update_registry ${output_objdir}/so_locations -o $lib'
-      fi
-      hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
-      hardcode_libdir_separator=:
-      ;;
-
-    osf4* | osf5*)	# as osf3* with the addition of -msym flag
-      if test "$GCC" = yes; then
-	allow_undefined_flag=' ${wl}-expect_unresolved ${wl}\*'
-	archive_cmds='$CC -shared${allow_undefined_flag} $libobjs $deplibs $compiler_flags ${wl}-msym ${wl}-soname ${wl}$soname `test -n "$verstring" && echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${output_objdir}/so_locations -o $lib'
-	hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'
-      else
-	allow_undefined_flag=' -expect_unresolved \*'
-	archive_cmds='$LD -shared${allow_undefined_flag} $libobjs $deplibs $linker_flags -msym -soname $soname `test -n "$verstring" && echo -set_version $verstring` -update_registry ${output_objdir}/so_locations -o $lib'
-	archive_expsym_cmds='for i in `cat $export_symbols`; do printf "%s %s\\n" -exported_symbol "\$i" >> $lib.exp; done; echo "-hidden">> $lib.exp~
-	$LD -shared${allow_undefined_flag} -input $lib.exp $linker_flags $libobjs $deplibs -soname $soname `test -n "$verstring" && echo -set_version $verstring` -update_registry ${objdir}/so_locations -o $lib~$rm $lib.exp'
-
-	# Both c and cxx compiler support -rpath directly
-	hardcode_libdir_flag_spec='-rpath $libdir'
-      fi
-      hardcode_libdir_separator=:
-      ;;
-
-    sco3.2v5*)
-      archive_cmds='$LD -G -h $soname -o $lib $libobjs $deplibs $linker_flags'
-      hardcode_shlibpath_var=no
-      export_dynamic_flag_spec='${wl}-Bexport'
-      runpath_var=LD_RUN_PATH
-      hardcode_runpath_var=yes
-      ;;
-
-    solaris*)
-      no_undefined_flag=' -z text'
-      if test "$GCC" = yes; then
-	archive_cmds='$CC -shared ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags'
-	archive_expsym_cmds='$echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~$echo "local: *; };" >> $lib.exp~
-	  $CC -shared ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$rm $lib.exp'
-      else
-	archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
-	archive_expsym_cmds='$echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~$echo "local: *; };" >> $lib.exp~
-  	$LD -G${allow_undefined_flag} -M $lib.exp -h $soname -o $lib $libobjs $deplibs $linker_flags~$rm $lib.exp'
-      fi
-      hardcode_libdir_flag_spec='-R$libdir'
-      hardcode_shlibpath_var=no
-      case $host_os in
-      solaris2.[0-5] | solaris2.[0-5].*) ;;
-      *) # Supported since Solaris 2.6 (maybe 2.5.1?)
-	whole_archive_flag_spec='-z allextract$convenience -z defaultextract' ;;
-      esac
-      link_all_deplibs=yes
-      ;;
-
-    sunos4*)
-      if test "x$host_vendor" = xsequent; then
-	# Use $CC to link under sequent, because it throws in some extra .o
-	# files that make .init and .fini sections work.
-	archive_cmds='$CC -G ${wl}-h $soname -o $lib $libobjs $deplibs $compiler_flags'
-      else
-	archive_cmds='$LD -assert pure-text -Bstatic -o $lib $libobjs $deplibs $linker_flags'
-      fi
-      hardcode_libdir_flag_spec='-L$libdir'
-      hardcode_direct=yes
-      hardcode_minus_L=yes
-      hardcode_shlibpath_var=no
-      ;;
-
-    sysv4)
-      case $host_vendor in
-	sni)
-	  archive_cmds='$LD -G -h $soname -o $lib $libobjs $deplibs $linker_flags'
-	  hardcode_direct=yes # is this really true???
-	;;
-	siemens)
-	  ## LD is ld it makes a PLAMLIB
-	  ## CC just makes a GrossModule.
-	  archive_cmds='$LD -G -o $lib $libobjs $deplibs $linker_flags'
-	  reload_cmds='$CC -r -o $output$reload_objs'
-	  hardcode_direct=no
-        ;;
-	motorola)
-	  archive_cmds='$LD -G -h $soname -o $lib $libobjs $deplibs $linker_flags'
-	  hardcode_direct=no #Motorola manual says yes, but my tests say they lie
-	;;
-      esac
-      runpath_var='LD_RUN_PATH'
-      hardcode_shlibpath_var=no
-      ;;
-
-    sysv4.3*)
-      archive_cmds='$LD -G -h $soname -o $lib $libobjs $deplibs $linker_flags'
-      hardcode_shlibpath_var=no
-      export_dynamic_flag_spec='-Bexport'
-      ;;
-
-    sysv4*MP*)
-      if test -d /usr/nec; then
-	archive_cmds='$LD -G -h $soname -o $lib $libobjs $deplibs $linker_flags'
-	hardcode_shlibpath_var=no
-	runpath_var=LD_RUN_PATH
-	hardcode_runpath_var=yes
-	ld_shlibs=yes
-      fi
-      ;;
-
-    sysv4.2uw2*)
-      archive_cmds='$LD -G -o $lib $libobjs $deplibs $linker_flags'
-      hardcode_direct=yes
-      hardcode_minus_L=no
-      hardcode_shlibpath_var=no
-      hardcode_runpath_var=yes
-      runpath_var=LD_RUN_PATH
-      ;;
-
-   sysv5OpenUNIX8* | sysv5UnixWare7* |  sysv5uw[78]* | unixware7*)
-      no_undefined_flag='${wl}-z ${wl}text'
-      if test "$GCC" = yes; then
-	archive_cmds='$CC -shared ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags'
-      else
-	archive_cmds='$CC -G ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags'
-      fi
-      runpath_var='LD_RUN_PATH'
-      hardcode_shlibpath_var=no
-      ;;
-
-    sysv5*)
-      no_undefined_flag=' -z text'
-      # $CC -shared without GNU ld will not create a library from C++
-      # object files and a static libstdc++, better avoid it by now
-      archive_cmds='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
-      archive_expsym_cmds='$echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~$echo "local: *; };" >> $lib.exp~
-  		$LD -G${allow_undefined_flag} -M $lib.exp -h $soname -o $lib $libobjs $deplibs $linker_flags~$rm $lib.exp'
-      hardcode_libdir_flag_spec=
-      hardcode_shlibpath_var=no
-      runpath_var='LD_RUN_PATH'
-      ;;
-
-    uts4*)
-      archive_cmds='$LD -G -h $soname -o $lib $libobjs $deplibs $linker_flags'
-      hardcode_libdir_flag_spec='-L$libdir'
-      hardcode_shlibpath_var=no
-      ;;
-
-    *)
-      ld_shlibs=no
-      ;;
-    esac
-  fi
-
-echo "$as_me:$LINENO: result: $ld_shlibs" >&5
-echo "${ECHO_T}$ld_shlibs" >&6
-test "$ld_shlibs" = no && can_build_shared=no
-
-variables_saved_for_relink="PATH $shlibpath_var $runpath_var"
-if test "$GCC" = yes; then
-  variables_saved_for_relink="$variables_saved_for_relink GCC_EXEC_PREFIX COMPILER_PATH LIBRARY_PATH"
-fi
-
-#
-# Do we need to explicitly link libc?
-#
-case "x$archive_cmds_need_lc" in
-x|xyes)
-  # Assume -lc should be added
-  archive_cmds_need_lc=yes
-
-  if test "$enable_shared" = yes && test "$GCC" = yes; then
-    case $archive_cmds in
-    *'~'*)
-      # FIXME: we may have to deal with multi-command sequences.
-      ;;
-    '$CC '*)
-      # Test whether the compiler implicitly links with -lc since on some
-      # systems, -lgcc has to come before -lc. If gcc already passes -lc
-      # to ld, don't add -lc before -lgcc.
-      echo "$as_me:$LINENO: checking whether -lc should be explicitly linked in" >&5
-echo $ECHO_N "checking whether -lc should be explicitly linked in... $ECHO_C" >&6
-      $rm conftest*
-      printf "$lt_simple_compile_test_code" > conftest.$ac_ext
-
-      if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } 2>conftest.err; then
-        soname=conftest
-        lib=conftest
-        libobjs=conftest.$ac_objext
-        deplibs=
-        wl=$lt_prog_compiler_wl
-        compiler_flags=-v
-        linker_flags=-v
-        verstring=
-        output_objdir=.
-        libname=conftest
-        lt_save_allow_undefined_flag=$allow_undefined_flag
-        allow_undefined_flag=
-        if { (eval echo "$as_me:$LINENO: \"$archive_cmds 2\>\&1 \| grep \" -lc \" \>/dev/null 2\>\&1\"") >&5
-  (eval $archive_cmds 2\>\&1 \| grep \" -lc \" \>/dev/null 2\>\&1) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }
-        then
-	  archive_cmds_need_lc=no
-        else
-	  archive_cmds_need_lc=yes
-        fi
-        allow_undefined_flag=$lt_save_allow_undefined_flag
-      else
-        cat conftest.err 1>&5
-      fi
-      $rm conftest*
-      echo "$as_me:$LINENO: result: $archive_cmds_need_lc" >&5
-echo "${ECHO_T}$archive_cmds_need_lc" >&6
-      ;;
-    esac
-  fi
-  ;;
-esac
-
-echo "$as_me:$LINENO: checking dynamic linker characteristics" >&5
-echo $ECHO_N "checking dynamic linker characteristics... $ECHO_C" >&6
-library_names_spec=
-libname_spec='lib$name'
-soname_spec=
-shrext_cmds=".so"
-postinstall_cmds=
-postuninstall_cmds=
-finish_cmds=
-finish_eval=
-shlibpath_var=
-shlibpath_overrides_runpath=unknown
-version_type=none
-dynamic_linker="$host_os ld.so"
-sys_lib_dlsearch_path_spec="/lib /usr/lib"
-if test "$GCC" = yes; then
-  sys_lib_search_path_spec=`$CC -print-search-dirs | grep "^libraries:" | $SED -e "s/^libraries://" -e "s,=/,/,g"`
-  if echo "$sys_lib_search_path_spec" | grep ';' >/dev/null ; then
-    # if the path contains ";" then we assume it to be the separator
-    # otherwise default to the standard path separator (i.e. ":") - it is
-    # assumed that no part of a normal pathname contains ";" but that should
-    # okay in the real world where ";" in dirpaths is itself problematic.
-    sys_lib_search_path_spec=`echo "$sys_lib_search_path_spec" | $SED -e 's/;/ /g'`
-  else
-    sys_lib_search_path_spec=`echo "$sys_lib_search_path_spec" | $SED  -e "s/$PATH_SEPARATOR/ /g"`
-  fi
-else
-  sys_lib_search_path_spec="/lib /usr/lib /usr/local/lib"
-fi
-need_lib_prefix=unknown
-hardcode_into_libs=no
-
-# when you set need_version to no, make sure it does not cause -set_version
-# flags to be left without arguments
-need_version=unknown
-
-case $host_os in
-aix3*)
-  version_type=linux
-  library_names_spec='${libname}${release}${shared_ext}$versuffix $libname.a'
-  shlibpath_var=LIBPATH
-
-  # AIX 3 has no versioning support, so we append a major version to the name.
-  soname_spec='${libname}${release}${shared_ext}$major'
-  ;;
-
-aix4* | aix5*)
-  version_type=linux
-  need_lib_prefix=no
-  need_version=no
-  hardcode_into_libs=yes
-  if test "$host_cpu" = ia64; then
-    # AIX 5 supports IA64
-    library_names_spec='${libname}${release}${shared_ext}$major ${libname}${release}${shared_ext}$versuffix $libname${shared_ext}'
-    shlibpath_var=LD_LIBRARY_PATH
-  else
-    # With GCC up to 2.95.x, collect2 would create an import file
-    # for dependence libraries.  The import file would start with
-    # the line `#! .'.  This would cause the generated library to
-    # depend on `.', always an invalid library.  This was fixed in
-    # development snapshots of GCC prior to 3.0.
-    case $host_os in
-      aix4 | aix4.[01] | aix4.[01].*)
-      if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
-	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | grep yes > /dev/null; then
-	:
-      else
-	can_build_shared=no
-      fi
-      ;;
-    esac
-    # AIX (on Power*) has no versioning support, so currently we can not hardcode correct
-    # soname into executable. Probably we can add versioning support to
-    # collect2, so additional links can be useful in future.
-    if test "$aix_use_runtimelinking" = yes; then
-      # If using run time linking (on AIX 4.2 or later) use lib<name>.so
-      # instead of lib<name>.a to let people know that these are not
-      # typical AIX shared libraries.
-      library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-    else
-      # We preserve .a as extension for shared libraries through AIX4.2
-      # and later when we are not doing run time linking.
-      library_names_spec='${libname}${release}.a $libname.a'
-      soname_spec='${libname}${release}${shared_ext}$major'
-    fi
-    shlibpath_var=LIBPATH
-  fi
-  ;;
-
-amigaos*)
-  library_names_spec='$libname.ixlibrary $libname.a'
-  # Create ${libname}_ixlibrary.a entries in /sys/libs.
-  finish_eval='for lib in `ls $libdir/*.ixlibrary 2>/dev/null`; do libname=`$echo "X$lib" | $Xsed -e '\''s%^.*/\([^/]*\)\.ixlibrary$%\1%'\''`; test $rm /sys/libs/${libname}_ixlibrary.a; $show "cd /sys/libs && $LN_S $lib ${libname}_ixlibrary.a"; cd /sys/libs && $LN_S $lib ${libname}_ixlibrary.a || exit 1; done'
-  ;;
-
-beos*)
-  library_names_spec='${libname}${shared_ext}'
-  dynamic_linker="$host_os ld.so"
-  shlibpath_var=LIBRARY_PATH
-  ;;
-
-bsdi4*)
-  version_type=linux
-  need_version=no
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-  soname_spec='${libname}${release}${shared_ext}$major'
-  finish_cmds='PATH="\$PATH:/sbin" ldconfig $libdir'
-  shlibpath_var=LD_LIBRARY_PATH
-  sys_lib_search_path_spec="/shlib /usr/lib /usr/X11/lib /usr/contrib/lib /lib /usr/local/lib"
-  sys_lib_dlsearch_path_spec="/shlib /usr/lib /usr/local/lib"
-  # the default ld.so.conf also contains /usr/contrib/lib and
-  # /usr/X11R6/lib (/usr/X11 is a link to /usr/X11R6), but let us allow
-  # libtool to hard-code these into programs
-  ;;
-
-cygwin* | mingw* | pw32*)
-  version_type=windows
-  shrext_cmds=".dll"
-  need_version=no
-  need_lib_prefix=no
-
-  case $GCC,$host_os in
-  yes,cygwin* | yes,mingw* | yes,pw32*)
-    library_names_spec='$libname.dll.a'
-    # DLL is installed to $(libdir)/../bin by postinstall_cmds
-    postinstall_cmds='base_file=`basename \${file}`~
-      dlpath=`$SHELL 2>&1 -c '\''. $dir/'\''\${base_file}'\''i;echo \$dlname'\''`~
-      dldir=$destdir/`dirname \$dlpath`~
-      test -d \$dldir || mkdir -p \$dldir~
-      $install_prog $dir/$dlname \$dldir/$dlname'
-    postuninstall_cmds='dldll=`$SHELL 2>&1 -c '\''. $file; echo \$dlname'\''`~
-      dlpath=$dir/\$dldll~
-       $rm \$dlpath'
-    shlibpath_overrides_runpath=yes
-
-    case $host_os in
-    cygwin*)
-      # Cygwin DLLs use 'cyg' prefix rather than 'lib'
-      soname_spec='`echo ${libname} | sed -e 's/^lib/cyg/'``echo ${release} | $SED -e 's/[.]/-/g'`${versuffix}${shared_ext}'
-      sys_lib_search_path_spec="/usr/lib /lib/w32api /lib /usr/local/lib"
-      ;;
-    mingw*)
-      # MinGW DLLs use traditional 'lib' prefix
-      soname_spec='${libname}`echo ${release} | $SED -e 's/[.]/-/g'`${versuffix}${shared_ext}'
-      sys_lib_search_path_spec=`$CC -print-search-dirs | grep "^libraries:" | $SED -e "s/^libraries://" -e "s,=/,/,g"`
-      if echo "$sys_lib_search_path_spec" | grep ';[c-zC-Z]:/' >/dev/null; then
-        # It is most probably a Windows format PATH printed by
-        # mingw gcc, but we are running on Cygwin. Gcc prints its search
-        # path with ; separators, and with drive letters. We can handle the
-        # drive letters (cygwin fileutils understands them), so leave them,
-        # especially as we might pass files found there to a mingw objdump,
-        # which wouldn't understand a cygwinified path. Ahh.
-        sys_lib_search_path_spec=`echo "$sys_lib_search_path_spec" | $SED -e 's/;/ /g'`
-      else
-        sys_lib_search_path_spec=`echo "$sys_lib_search_path_spec" | $SED  -e "s/$PATH_SEPARATOR/ /g"`
-      fi
-      ;;
-    pw32*)
-      # pw32 DLLs use 'pw' prefix rather than 'lib'
-      library_names_spec='`echo ${libname} | sed -e 's/^lib/pw/'``echo ${release} | $SED -e 's/./-/g'`${versuffix}${shared_ext}'
-      ;;
-    esac
-    ;;
-
-  *)
-    library_names_spec='${libname}`echo ${release} | $SED -e 's/[.]/-/g'`${versuffix}${shared_ext} $libname.lib'
-    ;;
-  esac
-  dynamic_linker='Win32 ld.exe'
-  # FIXME: first we should search . and the directory the executable is in
-  shlibpath_var=PATH
-  ;;
-
-darwin* | rhapsody*)
-  dynamic_linker="$host_os dyld"
-  version_type=darwin
-  need_lib_prefix=no
-  need_version=no
-  library_names_spec='${libname}${release}${versuffix}$shared_ext ${libname}${release}${major}$shared_ext ${libname}$shared_ext'
-  soname_spec='${libname}${release}${major}$shared_ext'
-  shlibpath_overrides_runpath=yes
-  shlibpath_var=DYLD_LIBRARY_PATH
-  shrext_cmds='$(test .$module = .yes && echo .so || echo .dylib)'
-  # Apple's gcc prints 'gcc -print-search-dirs' doesn't operate the same.
-  if test "$GCC" = yes; then
-    sys_lib_search_path_spec=`$CC -print-search-dirs | tr "\n" "$PATH_SEPARATOR" | sed -e 's/libraries:/@libraries:/' | tr "@" "\n" | grep "^libraries:" | sed -e "s/^libraries://" -e "s,=/,/,g" -e "s,$PATH_SEPARATOR, ,g" -e "s,.*,& /lib /usr/lib /usr/local/lib,g"`
-  else
-    sys_lib_search_path_spec='/lib /usr/lib /usr/local/lib'
-  fi
-  sys_lib_dlsearch_path_spec='/usr/local/lib /lib /usr/lib'
-  ;;
-
-dgux*)
-  version_type=linux
-  need_lib_prefix=no
-  need_version=no
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname$shared_ext'
-  soname_spec='${libname}${release}${shared_ext}$major'
-  shlibpath_var=LD_LIBRARY_PATH
-  ;;
-
-freebsd1*)
-  dynamic_linker=no
-  ;;
-
-kfreebsd*-gnu)
-  version_type=linux
-  need_lib_prefix=no
-  need_version=no
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${shared_ext}'
-  soname_spec='${libname}${release}${shared_ext}$major'
-  shlibpath_var=LD_LIBRARY_PATH
-  shlibpath_overrides_runpath=no
-  hardcode_into_libs=yes
-  dynamic_linker='GNU ld.so'
-  ;;
-
-freebsd*)
-  objformat=`test -x /usr/bin/objformat && /usr/bin/objformat || echo aout`
-  version_type=freebsd-$objformat
-  case $version_type in
-    freebsd-elf*)
-      library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext} $libname${shared_ext}'
-      need_version=no
-      need_lib_prefix=no
-      ;;
-    freebsd-*)
-      library_names_spec='${libname}${release}${shared_ext}$versuffix $libname${shared_ext}$versuffix'
-      need_version=yes
-      ;;
-  esac
-  shlibpath_var=LD_LIBRARY_PATH
-  case $host_os in
-  freebsd2*)
-    shlibpath_overrides_runpath=yes
-    ;;
-  freebsd3.01* | freebsdelf3.01*)
-    shlibpath_overrides_runpath=yes
-    hardcode_into_libs=yes
-    ;;
-  *) # from 3.2 on
-    shlibpath_overrides_runpath=no
-    hardcode_into_libs=yes
-    ;;
-  esac
-  ;;
-
-gnu*)
-  version_type=linux
-  need_lib_prefix=no
-  need_version=no
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}${major} ${libname}${shared_ext}'
-  soname_spec='${libname}${release}${shared_ext}$major'
-  shlibpath_var=LD_LIBRARY_PATH
-  hardcode_into_libs=yes
-  ;;
-
-hpux9* | hpux10* | hpux11*)
-  # Give a soname corresponding to the major version so that dld.sl refuses to
-  # link against other versions.
-  version_type=sunos
-  need_lib_prefix=no
-  need_version=no
-  case "$host_cpu" in
-  ia64*)
-    shrext_cmds='.so'
-    hardcode_into_libs=yes
-    dynamic_linker="$host_os dld.so"
-    shlibpath_var=LD_LIBRARY_PATH
-    shlibpath_overrides_runpath=yes # Unless +noenvvar is specified.
-    library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-    soname_spec='${libname}${release}${shared_ext}$major'
-    if test "X$HPUX_IA64_MODE" = X32; then
-      sys_lib_search_path_spec="/usr/lib/hpux32 /usr/local/lib/hpux32 /usr/local/lib"
-    else
-      sys_lib_search_path_spec="/usr/lib/hpux64 /usr/local/lib/hpux64"
-    fi
-    sys_lib_dlsearch_path_spec=$sys_lib_search_path_spec
-    ;;
-   hppa*64*)
-     shrext_cmds='.sl'
-     hardcode_into_libs=yes
-     dynamic_linker="$host_os dld.sl"
-     shlibpath_var=LD_LIBRARY_PATH # How should we handle SHLIB_PATH
-     shlibpath_overrides_runpath=yes # Unless +noenvvar is specified.
-     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-     soname_spec='${libname}${release}${shared_ext}$major'
-     sys_lib_search_path_spec="/usr/lib/pa20_64 /usr/ccs/lib/pa20_64"
-     sys_lib_dlsearch_path_spec=$sys_lib_search_path_spec
-     ;;
-   *)
-    shrext_cmds='.sl'
-    dynamic_linker="$host_os dld.sl"
-    shlibpath_var=SHLIB_PATH
-    shlibpath_overrides_runpath=no # +s is required to enable SHLIB_PATH
-    library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-    soname_spec='${libname}${release}${shared_ext}$major'
-    ;;
-  esac
-  # HP-UX runs *really* slowly unless shared libraries are mode 555.
-  postinstall_cmds='chmod 555 $lib'
-  ;;
-
-irix5* | irix6* | nonstopux*)
-  case $host_os in
-    nonstopux*) version_type=nonstopux ;;
-    *)
-	if test "$lt_cv_prog_gnu_ld" = yes; then
-		version_type=linux
-	else
-		version_type=irix
-	fi ;;
-  esac
-  need_lib_prefix=no
-  need_version=no
-  soname_spec='${libname}${release}${shared_ext}$major'
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${release}${shared_ext} $libname${shared_ext}'
-  case $host_os in
-  irix5* | nonstopux*)
-    libsuff= shlibsuff=
-    ;;
-  *)
-    case $LD in # libtool.m4 will add one of these switches to LD
-    *-32|*"-32 "|*-melf32bsmip|*"-melf32bsmip ")
-      libsuff= shlibsuff= libmagic=32-bit;;
-    *-n32|*"-n32 "|*-melf32bmipn32|*"-melf32bmipn32 ")
-      libsuff=32 shlibsuff=N32 libmagic=N32;;
-    *-64|*"-64 "|*-melf64bmip|*"-melf64bmip ")
-      libsuff=64 shlibsuff=64 libmagic=64-bit;;
-    *) libsuff= shlibsuff= libmagic=never-match;;
-    esac
-    ;;
-  esac
-  shlibpath_var=LD_LIBRARY${shlibsuff}_PATH
-  shlibpath_overrides_runpath=no
-  sys_lib_search_path_spec="/usr/lib${libsuff} /lib${libsuff} /usr/local/lib${libsuff}"
-  sys_lib_dlsearch_path_spec="/usr/lib${libsuff} /lib${libsuff}"
-  hardcode_into_libs=yes
-  ;;
-
-# No shared lib support for Linux oldld, aout, or coff.
-linux*oldld* | linux*aout* | linux*coff*)
-  dynamic_linker=no
-  ;;
-
-# This must be Linux ELF.
-linux*)
-  version_type=linux
-  need_lib_prefix=no
-  need_version=no
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-  soname_spec='${libname}${release}${shared_ext}$major'
-  finish_cmds='PATH="\$PATH:/sbin" ldconfig -n $libdir'
-  shlibpath_var=LD_LIBRARY_PATH
-  shlibpath_overrides_runpath=no
-  # This implies no fast_install, which is unacceptable.
-  # Some rework will be needed to allow for fast_install
-  # before this can be enabled.
-  hardcode_into_libs=yes
-
-  # Append ld.so.conf contents to the search path
-  if test -f /etc/ld.so.conf; then
-    lt_ld_extra=`$SED -e 's/:,\t/ /g;s/=^=*$//;s/=^= * / /g' /etc/ld.so.conf | tr '\n' ' '`
-    sys_lib_dlsearch_path_spec="/lib /usr/lib $lt_ld_extra"
-  fi
-
-  # We used to test for /lib/ld.so.1 and disable shared libraries on
-  # powerpc, because MkLinux only supported shared libraries with the
-  # GNU dynamic linker.  Since this was broken with cross compilers,
-  # most powerpc-linux boxes support dynamic linking these days and
-  # people can always --disable-shared, the test was removed, and we
-  # assume the GNU/Linux dynamic linker is in use.
-  dynamic_linker='GNU/Linux ld.so'
-  ;;
-
-netbsdelf*-gnu)
-  version_type=linux
-  need_lib_prefix=no
-  need_version=no
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${shared_ext}'
-  soname_spec='${libname}${release}${shared_ext}$major'
-  shlibpath_var=LD_LIBRARY_PATH
-  shlibpath_overrides_runpath=no
-  hardcode_into_libs=yes
-  dynamic_linker='NetBSD ld.elf_so'
-  ;;
-
-knetbsd*-gnu)
-  version_type=linux
-  need_lib_prefix=no
-  need_version=no
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${shared_ext}'
-  soname_spec='${libname}${release}${shared_ext}$major'
-  shlibpath_var=LD_LIBRARY_PATH
-  shlibpath_overrides_runpath=no
-  hardcode_into_libs=yes
-  dynamic_linker='GNU ld.so'
-  ;;
-
-netbsd*)
-  version_type=sunos
-  need_lib_prefix=no
-  need_version=no
-  if echo __ELF__ | $CC -E - | grep __ELF__ >/dev/null; then
-    library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
-    finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
-    dynamic_linker='NetBSD (a.out) ld.so'
-  else
-    library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${shared_ext}'
-    soname_spec='${libname}${release}${shared_ext}$major'
-    dynamic_linker='NetBSD ld.elf_so'
-  fi
-  shlibpath_var=LD_LIBRARY_PATH
-  shlibpath_overrides_runpath=yes
-  hardcode_into_libs=yes
-  ;;
-
-newsos6)
-  version_type=linux
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-  shlibpath_var=LD_LIBRARY_PATH
-  shlibpath_overrides_runpath=yes
-  ;;
-
-nto-qnx*)
-  version_type=linux
-  need_lib_prefix=no
-  need_version=no
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-  soname_spec='${libname}${release}${shared_ext}$major'
-  shlibpath_var=LD_LIBRARY_PATH
-  shlibpath_overrides_runpath=yes
-  ;;
-
-openbsd*)
-  version_type=sunos
-  need_lib_prefix=no
-  need_version=yes
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
-  finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
-  shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
-    case $host_os in
-      openbsd2.[89] | openbsd2.[89].*)
-	shlibpath_overrides_runpath=no
-	;;
-      *)
-	shlibpath_overrides_runpath=yes
-	;;
-      esac
-  else
-    shlibpath_overrides_runpath=yes
-  fi
-  ;;
-
-os2*)
-  libname_spec='$name'
-  shrext_cmds=".dll"
-  need_lib_prefix=no
-  library_names_spec='$libname${shared_ext} $libname.a'
-  dynamic_linker='OS/2 ld.exe'
-  shlibpath_var=LIBPATH
-  ;;
-
-osf3* | osf4* | osf5*)
-  version_type=osf
-  need_lib_prefix=no
-  need_version=no
-  soname_spec='${libname}${release}${shared_ext}$major'
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-  shlibpath_var=LD_LIBRARY_PATH
-  sys_lib_search_path_spec="/usr/shlib /usr/ccs/lib /usr/lib/cmplrs/cc /usr/lib /usr/local/lib /var/shlib"
-  sys_lib_dlsearch_path_spec="$sys_lib_search_path_spec"
-  ;;
-
-sco3.2v5*)
-  version_type=osf
-  soname_spec='${libname}${release}${shared_ext}$major'
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-  shlibpath_var=LD_LIBRARY_PATH
-  ;;
-
-solaris*)
-  version_type=linux
-  need_lib_prefix=no
-  need_version=no
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-  soname_spec='${libname}${release}${shared_ext}$major'
-  shlibpath_var=LD_LIBRARY_PATH
-  shlibpath_overrides_runpath=yes
-  hardcode_into_libs=yes
-  # ldd complains unless libraries are executable
-  postinstall_cmds='chmod +x $lib'
-  ;;
-
-sunos4*)
-  version_type=sunos
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
-  finish_cmds='PATH="\$PATH:/usr/etc" ldconfig $libdir'
-  shlibpath_var=LD_LIBRARY_PATH
-  shlibpath_overrides_runpath=yes
-  if test "$with_gnu_ld" = yes; then
-    need_lib_prefix=no
-  fi
-  need_version=yes
-  ;;
-
-sysv4 | sysv4.2uw2* | sysv4.3* | sysv5*)
-  version_type=linux
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-  soname_spec='${libname}${release}${shared_ext}$major'
-  shlibpath_var=LD_LIBRARY_PATH
-  case $host_vendor in
-    sni)
-      shlibpath_overrides_runpath=no
-      need_lib_prefix=no
-      export_dynamic_flag_spec='${wl}-Blargedynsym'
-      runpath_var=LD_RUN_PATH
-      ;;
-    siemens)
-      need_lib_prefix=no
-      ;;
-    motorola)
-      need_lib_prefix=no
-      need_version=no
-      shlibpath_overrides_runpath=no
-      sys_lib_search_path_spec='/lib /usr/lib /usr/ccs/lib'
-      ;;
-  esac
-  ;;
-
-sysv4*MP*)
-  if test -d /usr/nec ;then
-    version_type=linux
-    library_names_spec='$libname${shared_ext}.$versuffix $libname${shared_ext}.$major $libname${shared_ext}'
-    soname_spec='$libname${shared_ext}.$major'
-    shlibpath_var=LD_LIBRARY_PATH
-  fi
-  ;;
-
-uts4*)
-  version_type=linux
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-  soname_spec='${libname}${release}${shared_ext}$major'
-  shlibpath_var=LD_LIBRARY_PATH
-  ;;
-
-*)
-  dynamic_linker=no
-  ;;
-esac
-echo "$as_me:$LINENO: result: $dynamic_linker" >&5
-echo "${ECHO_T}$dynamic_linker" >&6
-test "$dynamic_linker" = no && can_build_shared=no
-
-echo "$as_me:$LINENO: checking how to hardcode library paths into programs" >&5
-echo $ECHO_N "checking how to hardcode library paths into programs... $ECHO_C" >&6
-hardcode_action=
-if test -n "$hardcode_libdir_flag_spec" || \
-   test -n "$runpath_var " || \
-   test "X$hardcode_automatic"="Xyes" ; then
-
-  # We can hardcode non-existant directories.
-  if test "$hardcode_direct" != no &&
-     # If the only mechanism to avoid hardcoding is shlibpath_var, we
-     # have to relink, otherwise we might link with an installed library
-     # when we should be linking with a yet-to-be-installed one
-     ## test "$_LT_AC_TAGVAR(hardcode_shlibpath_var, )" != no &&
-     test "$hardcode_minus_L" != no; then
-    # Linking always hardcodes the temporary library directory.
-    hardcode_action=relink
-  else
-    # We can link without hardcoding, and we can hardcode nonexisting dirs.
-    hardcode_action=immediate
-  fi
-else
-  # We cannot hardcode anything, or else we can only hardcode existing
-  # directories.
-  hardcode_action=unsupported
-fi
-echo "$as_me:$LINENO: result: $hardcode_action" >&5
-echo "${ECHO_T}$hardcode_action" >&6
-
-if test "$hardcode_action" = relink; then
-  # Fast installation is not supported
-  enable_fast_install=no
-elif test "$shlibpath_overrides_runpath" = yes ||
-     test "$enable_shared" = no; then
-  # Fast installation is not necessary
-  enable_fast_install=needless
-fi
-
-striplib=
-old_striplib=
-echo "$as_me:$LINENO: checking whether stripping libraries is possible" >&5
-echo $ECHO_N "checking whether stripping libraries is possible... $ECHO_C" >&6
-if test -n "$STRIP" && $STRIP -V 2>&1 | grep "GNU strip" >/dev/null; then
-  test -z "$old_striplib" && old_striplib="$STRIP --strip-debug"
-  test -z "$striplib" && striplib="$STRIP --strip-unneeded"
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
-else
-# FIXME - insert some real tests, host_os isn't really good enough
-  case $host_os in
-   darwin*)
-       if test -n "$STRIP" ; then
-         striplib="$STRIP -x"
-         echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
-       else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi
-       ;;
-   *)
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-    ;;
-  esac
-fi
-
-if test "x$enable_dlopen" != xyes; then
-  enable_dlopen=unknown
-  enable_dlopen_self=unknown
-  enable_dlopen_self_static=unknown
-else
-  lt_cv_dlopen=no
-  lt_cv_dlopen_libs=
-
-  case $host_os in
-  beos*)
-    lt_cv_dlopen="load_add_on"
-    lt_cv_dlopen_libs=
-    lt_cv_dlopen_self=yes
-    ;;
-
-  mingw* | pw32*)
-    lt_cv_dlopen="LoadLibrary"
-    lt_cv_dlopen_libs=
-   ;;
-
-  cygwin*)
-    lt_cv_dlopen="dlopen"
-    lt_cv_dlopen_libs=
-   ;;
-
-  darwin*)
-  # if libdl is installed we need to link against it
-    echo "$as_me:$LINENO: checking for dlopen in -ldl" >&5
-echo $ECHO_N "checking for dlopen in -ldl... $ECHO_C" >&6
-if test "${ac_cv_lib_dl_dlopen+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  ac_check_lib_save_LIBS=$LIBS
-LIBS="-ldl  $LIBS"
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-/* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char dlopen ();
-int
-main ()
-{
-dlopen ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_lib_dl_dlopen=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_cv_lib_dl_dlopen=no
-fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_dl_dlopen" >&5
-echo "${ECHO_T}$ac_cv_lib_dl_dlopen" >&6
-if test $ac_cv_lib_dl_dlopen = yes; then
-  lt_cv_dlopen="dlopen" lt_cv_dlopen_libs="-ldl"
-else
-
-    lt_cv_dlopen="dyld"
-    lt_cv_dlopen_libs=
-    lt_cv_dlopen_self=yes
-
-fi
-
-   ;;
-
-  *)
-    echo "$as_me:$LINENO: checking for shl_load" >&5
-echo $ECHO_N "checking for shl_load... $ECHO_C" >&6
-if test "${ac_cv_func_shl_load+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-/* Define shl_load to an innocuous variant, in case <limits.h> declares shl_load.
-   For example, HP-UX 11i <limits.h> declares gettimeofday.  */
-#define shl_load innocuous_shl_load
-
-/* System header to define __stub macros and hopefully few prototypes,
-    which can conflict with char shl_load (); below.
-    Prefer <limits.h> to <assert.h> if __STDC__ is defined, since
-    <limits.h> exists even on freestanding compilers.  */
-
-#ifdef __STDC__
-# include <limits.h>
-#else
-# include <assert.h>
-#endif
-
-#undef shl_load
-
-/* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-{
-#endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char shl_load ();
-/* The GNU C library defines this for functions which it implements
-    to always fail with ENOSYS.  Some functions are actually named
-    something starting with __ and the normal name is an alias.  */
-#if defined (__stub_shl_load) || defined (__stub___shl_load)
-choke me
-#else
-char (*f) () = shl_load;
-#endif
-#ifdef __cplusplus
-}
-#endif
-
-int
-main ()
-{
-return f != shl_load;
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_func_shl_load=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_cv_func_shl_load=no
-fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-fi
-echo "$as_me:$LINENO: result: $ac_cv_func_shl_load" >&5
-echo "${ECHO_T}$ac_cv_func_shl_load" >&6
-if test $ac_cv_func_shl_load = yes; then
-  lt_cv_dlopen="shl_load"
-else
-  echo "$as_me:$LINENO: checking for shl_load in -ldld" >&5
-echo $ECHO_N "checking for shl_load in -ldld... $ECHO_C" >&6
-if test "${ac_cv_lib_dld_shl_load+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  ac_check_lib_save_LIBS=$LIBS
-LIBS="-ldld  $LIBS"
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-/* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char shl_load ();
-int
-main ()
-{
-shl_load ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_lib_dld_shl_load=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_cv_lib_dld_shl_load=no
-fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_dld_shl_load" >&5
-echo "${ECHO_T}$ac_cv_lib_dld_shl_load" >&6
-if test $ac_cv_lib_dld_shl_load = yes; then
-  lt_cv_dlopen="shl_load" lt_cv_dlopen_libs="-dld"
-else
-  echo "$as_me:$LINENO: checking for dlopen" >&5
-echo $ECHO_N "checking for dlopen... $ECHO_C" >&6
-if test "${ac_cv_func_dlopen+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-/* Define dlopen to an innocuous variant, in case <limits.h> declares dlopen.
-   For example, HP-UX 11i <limits.h> declares gettimeofday.  */
-#define dlopen innocuous_dlopen
-
-/* System header to define __stub macros and hopefully few prototypes,
-    which can conflict with char dlopen (); below.
-    Prefer <limits.h> to <assert.h> if __STDC__ is defined, since
-    <limits.h> exists even on freestanding compilers.  */
-
-#ifdef __STDC__
-# include <limits.h>
-#else
-# include <assert.h>
-#endif
-
-#undef dlopen
-
-/* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-{
-#endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char dlopen ();
-/* The GNU C library defines this for functions which it implements
-    to always fail with ENOSYS.  Some functions are actually named
-    something starting with __ and the normal name is an alias.  */
-#if defined (__stub_dlopen) || defined (__stub___dlopen)
-choke me
-#else
-char (*f) () = dlopen;
-#endif
-#ifdef __cplusplus
-}
-#endif
-
-int
-main ()
-{
-return f != dlopen;
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_func_dlopen=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_cv_func_dlopen=no
-fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-fi
-echo "$as_me:$LINENO: result: $ac_cv_func_dlopen" >&5
-echo "${ECHO_T}$ac_cv_func_dlopen" >&6
-if test $ac_cv_func_dlopen = yes; then
-  lt_cv_dlopen="dlopen"
-else
-  echo "$as_me:$LINENO: checking for dlopen in -ldl" >&5
-echo $ECHO_N "checking for dlopen in -ldl... $ECHO_C" >&6
-if test "${ac_cv_lib_dl_dlopen+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  ac_check_lib_save_LIBS=$LIBS
-LIBS="-ldl  $LIBS"
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-/* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char dlopen ();
-int
-main ()
-{
-dlopen ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_lib_dl_dlopen=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_cv_lib_dl_dlopen=no
-fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_dl_dlopen" >&5
-echo "${ECHO_T}$ac_cv_lib_dl_dlopen" >&6
-if test $ac_cv_lib_dl_dlopen = yes; then
-  lt_cv_dlopen="dlopen" lt_cv_dlopen_libs="-ldl"
-else
-  echo "$as_me:$LINENO: checking for dlopen in -lsvld" >&5
-echo $ECHO_N "checking for dlopen in -lsvld... $ECHO_C" >&6
-if test "${ac_cv_lib_svld_dlopen+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  ac_check_lib_save_LIBS=$LIBS
-LIBS="-lsvld  $LIBS"
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-/* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char dlopen ();
-int
-main ()
-{
-dlopen ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_lib_svld_dlopen=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_cv_lib_svld_dlopen=no
-fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_svld_dlopen" >&5
-echo "${ECHO_T}$ac_cv_lib_svld_dlopen" >&6
-if test $ac_cv_lib_svld_dlopen = yes; then
-  lt_cv_dlopen="dlopen" lt_cv_dlopen_libs="-lsvld"
-else
-  echo "$as_me:$LINENO: checking for dld_link in -ldld" >&5
-echo $ECHO_N "checking for dld_link in -ldld... $ECHO_C" >&6
-if test "${ac_cv_lib_dld_dld_link+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  ac_check_lib_save_LIBS=$LIBS
-LIBS="-ldld  $LIBS"
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-/* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char dld_link ();
-int
-main ()
-{
-dld_link ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_lib_dld_dld_link=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_cv_lib_dld_dld_link=no
-fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_dld_dld_link" >&5
-echo "${ECHO_T}$ac_cv_lib_dld_dld_link" >&6
-if test $ac_cv_lib_dld_dld_link = yes; then
-  lt_cv_dlopen="dld_link" lt_cv_dlopen_libs="-dld"
-fi
-
-
-fi
-
-
-fi
-
-
-fi
-
-
-fi
-
-
-fi
-
-    ;;
-  esac
-
-  if test "x$lt_cv_dlopen" != xno; then
-    enable_dlopen=yes
-  else
-    enable_dlopen=no
-  fi
-
-  case $lt_cv_dlopen in
-  dlopen)
-    save_CPPFLAGS="$CPPFLAGS"
-    test "x$ac_cv_header_dlfcn_h" = xyes && CPPFLAGS="$CPPFLAGS -DHAVE_DLFCN_H"
-
-    save_LDFLAGS="$LDFLAGS"
-    eval LDFLAGS=\"\$LDFLAGS $export_dynamic_flag_spec\"
-
-    save_LIBS="$LIBS"
-    LIBS="$lt_cv_dlopen_libs $LIBS"
-
-    echo "$as_me:$LINENO: checking whether a program can dlopen itself" >&5
-echo $ECHO_N "checking whether a program can dlopen itself... $ECHO_C" >&6
-if test "${lt_cv_dlopen_self+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  	  if test "$cross_compiling" = yes; then :
-  lt_cv_dlopen_self=cross
-else
-  lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
-  lt_status=$lt_dlunknown
-  cat > conftest.$ac_ext <<EOF
-#line 8939 "configure"
-#include "confdefs.h"
-
-#if HAVE_DLFCN_H
-#include <dlfcn.h>
-#endif
-
-#include <stdio.h>
-
-#ifdef RTLD_GLOBAL
-#  define LT_DLGLOBAL		RTLD_GLOBAL
-#else
-#  ifdef DL_GLOBAL
-#    define LT_DLGLOBAL		DL_GLOBAL
-#  else
-#    define LT_DLGLOBAL		0
-#  endif
-#endif
-
-/* We may have to define LT_DLLAZY_OR_NOW in the command line if we
-   find out it does not work in some platform. */
-#ifndef LT_DLLAZY_OR_NOW
-#  ifdef RTLD_LAZY
-#    define LT_DLLAZY_OR_NOW		RTLD_LAZY
-#  else
-#    ifdef DL_LAZY
-#      define LT_DLLAZY_OR_NOW		DL_LAZY
-#    else
-#      ifdef RTLD_NOW
-#        define LT_DLLAZY_OR_NOW	RTLD_NOW
-#      else
-#        ifdef DL_NOW
-#          define LT_DLLAZY_OR_NOW	DL_NOW
-#        else
-#          define LT_DLLAZY_OR_NOW	0
-#        endif
-#      endif
-#    endif
-#  endif
-#endif
-
-#ifdef __cplusplus
-extern "C" void exit (int);
-#endif
-
-void fnord() { int i=42;}
-int main ()
-{
-  void *self = dlopen (0, LT_DLGLOBAL|LT_DLLAZY_OR_NOW);
-  int status = $lt_dlunknown;
-
-  if (self)
-    {
-      if (dlsym (self,"fnord"))       status = $lt_dlno_uscore;
-      else if (dlsym( self,"_fnord")) status = $lt_dlneed_uscore;
-      /* dlclose (self); */
-    }
-
-    exit (status);
-}
-EOF
-  if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && test -s conftest${ac_exeext} 2>/dev/null; then
-    (./conftest; exit; ) 2>/dev/null
-    lt_status=$?
-    case x$lt_status in
-      x$lt_dlno_uscore) lt_cv_dlopen_self=yes ;;
-      x$lt_dlneed_uscore) lt_cv_dlopen_self=yes ;;
-      x$lt_unknown|x*) lt_cv_dlopen_self=no ;;
-    esac
-  else :
-    # compilation failed
-    lt_cv_dlopen_self=no
-  fi
-fi
-rm -fr conftest*
-
-
-fi
-echo "$as_me:$LINENO: result: $lt_cv_dlopen_self" >&5
-echo "${ECHO_T}$lt_cv_dlopen_self" >&6
-
-    if test "x$lt_cv_dlopen_self" = xyes; then
-      LDFLAGS="$LDFLAGS $link_static_flag"
-      echo "$as_me:$LINENO: checking whether a statically linked program can dlopen itself" >&5
-echo $ECHO_N "checking whether a statically linked program can dlopen itself... $ECHO_C" >&6
-if test "${lt_cv_dlopen_self_static+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  	  if test "$cross_compiling" = yes; then :
-  lt_cv_dlopen_self_static=cross
-else
-  lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
-  lt_status=$lt_dlunknown
-  cat > conftest.$ac_ext <<EOF
-#line 9037 "configure"
-#include "confdefs.h"
-
-#if HAVE_DLFCN_H
-#include <dlfcn.h>
-#endif
-
-#include <stdio.h>
-
-#ifdef RTLD_GLOBAL
-#  define LT_DLGLOBAL		RTLD_GLOBAL
-#else
-#  ifdef DL_GLOBAL
-#    define LT_DLGLOBAL		DL_GLOBAL
-#  else
-#    define LT_DLGLOBAL		0
-#  endif
-#endif
-
-/* We may have to define LT_DLLAZY_OR_NOW in the command line if we
-   find out it does not work in some platform. */
-#ifndef LT_DLLAZY_OR_NOW
-#  ifdef RTLD_LAZY
-#    define LT_DLLAZY_OR_NOW		RTLD_LAZY
-#  else
-#    ifdef DL_LAZY
-#      define LT_DLLAZY_OR_NOW		DL_LAZY
-#    else
-#      ifdef RTLD_NOW
-#        define LT_DLLAZY_OR_NOW	RTLD_NOW
-#      else
-#        ifdef DL_NOW
-#          define LT_DLLAZY_OR_NOW	DL_NOW
-#        else
-#          define LT_DLLAZY_OR_NOW	0
-#        endif
-#      endif
-#    endif
-#  endif
-#endif
-
-#ifdef __cplusplus
-extern "C" void exit (int);
-#endif
-
-void fnord() { int i=42;}
-int main ()
-{
-  void *self = dlopen (0, LT_DLGLOBAL|LT_DLLAZY_OR_NOW);
-  int status = $lt_dlunknown;
-
-  if (self)
-    {
-      if (dlsym (self,"fnord"))       status = $lt_dlno_uscore;
-      else if (dlsym( self,"_fnord")) status = $lt_dlneed_uscore;
-      /* dlclose (self); */
-    }
-
-    exit (status);
-}
-EOF
-  if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && test -s conftest${ac_exeext} 2>/dev/null; then
-    (./conftest; exit; ) 2>/dev/null
-    lt_status=$?
-    case x$lt_status in
-      x$lt_dlno_uscore) lt_cv_dlopen_self_static=yes ;;
-      x$lt_dlneed_uscore) lt_cv_dlopen_self_static=yes ;;
-      x$lt_unknown|x*) lt_cv_dlopen_self_static=no ;;
-    esac
-  else :
-    # compilation failed
-    lt_cv_dlopen_self_static=no
-  fi
-fi
-rm -fr conftest*
-
-
-fi
-echo "$as_me:$LINENO: result: $lt_cv_dlopen_self_static" >&5
-echo "${ECHO_T}$lt_cv_dlopen_self_static" >&6
-    fi
-
-    CPPFLAGS="$save_CPPFLAGS"
-    LDFLAGS="$save_LDFLAGS"
-    LIBS="$save_LIBS"
-    ;;
-  esac
-
-  case $lt_cv_dlopen_self in
-  yes|no) enable_dlopen_self=$lt_cv_dlopen_self ;;
-  *) enable_dlopen_self=unknown ;;
-  esac
-
-  case $lt_cv_dlopen_self_static in
-  yes|no) enable_dlopen_self_static=$lt_cv_dlopen_self_static ;;
-  *) enable_dlopen_self_static=unknown ;;
-  esac
-fi
-
-
-# Report which librarie types wil actually be built
-echo "$as_me:$LINENO: checking if libtool supports shared libraries" >&5
-echo $ECHO_N "checking if libtool supports shared libraries... $ECHO_C" >&6
-echo "$as_me:$LINENO: result: $can_build_shared" >&5
-echo "${ECHO_T}$can_build_shared" >&6
-
-echo "$as_me:$LINENO: checking whether to build shared libraries" >&5
-echo $ECHO_N "checking whether to build shared libraries... $ECHO_C" >&6
-test "$can_build_shared" = "no" && enable_shared=no
-
-# On AIX, shared libraries and static libraries use the same namespace, and
-# are all built from PIC.
-case "$host_os" in
-aix3*)
-  test "$enable_shared" = yes && enable_static=no
-  if test -n "$RANLIB"; then
-    archive_cmds="$archive_cmds~\$RANLIB \$lib"
-    postinstall_cmds='$RANLIB $lib'
-  fi
-  ;;
-
-aix4* | aix5*)
-  if test "$host_cpu" != ia64 && test "$aix_use_runtimelinking" = no ; then
-    test "$enable_shared" = yes && enable_static=no
-  fi
-  ;;
-  darwin* | rhapsody*)
-  if test "$GCC" = yes; then
-    archive_cmds_need_lc=no
-    case "$host_os" in
-    rhapsody* | darwin1.[012])
-      allow_undefined_flag='-undefined suppress'
-      ;;
-    *) # Darwin 1.3 on
-      if test -z ${MACOSX_DEPLOYMENT_TARGET} ; then
-      	allow_undefined_flag='-flat_namespace -undefined suppress'
-      else
-        case ${MACOSX_DEPLOYMENT_TARGET} in
-          10.[012])
-            allow_undefined_flag='-flat_namespace -undefined suppress'
-            ;;
-          10.*)
-            allow_undefined_flag='-undefined dynamic_lookup'
-            ;;
-        esac
-      fi
-      ;;
-    esac
-    output_verbose_link_cmd='echo'
-    archive_cmds='$CC -dynamiclib $allow_undefined_flag -o $lib $libobjs $deplibs$compiler_flags -install_name $rpath/$soname $verstring'
-    module_cmds='$CC $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
-    # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's
-    archive_expsym_cmds='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -dynamiclib $allow_undefined_flag  -o $lib $libobjs $deplibs$compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-    module_expsym_cmds='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-    hardcode_direct=no
-    hardcode_automatic=yes
-    hardcode_shlibpath_var=unsupported
-    whole_archive_flag_spec='-all_load $convenience'
-    link_all_deplibs=yes
-  else
-    ld_shlibs=no
-  fi
-    ;;
-esac
-echo "$as_me:$LINENO: result: $enable_shared" >&5
-echo "${ECHO_T}$enable_shared" >&6
-
-echo "$as_me:$LINENO: checking whether to build static libraries" >&5
-echo $ECHO_N "checking whether to build static libraries... $ECHO_C" >&6
-# Make sure either enable_shared or enable_static is yes.
-test "$enable_shared" = yes || enable_static=yes
-echo "$as_me:$LINENO: result: $enable_static" >&5
-echo "${ECHO_T}$enable_static" >&6
-
-# The else clause should only fire when bootstrapping the
-# libtool distribution, otherwise you forgot to ship ltmain.sh
-# with your package, and you will get complaints that there are
-# no rules to generate ltmain.sh.
-if test -f "$ltmain"; then
-  # See if we are running on zsh, and set the options which allow our commands through
-  # without removal of \ escapes.
-  if test -n "${ZSH_VERSION+set}" ; then
-    setopt NO_GLOB_SUBST
-  fi
-  # Now quote all the things that may contain metacharacters while being
-  # careful not to overquote the AC_SUBSTed values.  We take copies of the
-  # variables and quote the copies for generation of the libtool script.
-  for var in echo old_CC old_CFLAGS AR AR_FLAGS EGREP RANLIB LN_S LTCC NM \
-    SED SHELL STRIP \
-    libname_spec library_names_spec soname_spec extract_expsyms_cmds \
-    old_striplib striplib file_magic_cmd finish_cmds finish_eval \
-    deplibs_check_method reload_flag reload_cmds need_locks \
-    lt_cv_sys_global_symbol_pipe lt_cv_sys_global_symbol_to_cdecl \
-    lt_cv_sys_global_symbol_to_c_name_address \
-    sys_lib_search_path_spec sys_lib_dlsearch_path_spec \
-    old_postinstall_cmds old_postuninstall_cmds \
-    compiler \
-    CC \
-    LD \
-    lt_prog_compiler_wl \
-    lt_prog_compiler_pic \
-    lt_prog_compiler_static \
-    lt_prog_compiler_no_builtin_flag \
-    export_dynamic_flag_spec \
-    thread_safe_flag_spec \
-    whole_archive_flag_spec \
-    enable_shared_with_static_runtimes \
-    old_archive_cmds \
-    old_archive_from_new_cmds \
-    predep_objects \
-    postdep_objects \
-    predeps \
-    postdeps \
-    compiler_lib_search_path \
-    archive_cmds \
-    archive_expsym_cmds \
-    postinstall_cmds \
-    postuninstall_cmds \
-    old_archive_from_expsyms_cmds \
-    allow_undefined_flag \
-    no_undefined_flag \
-    export_symbols_cmds \
-    hardcode_libdir_flag_spec \
-    hardcode_libdir_flag_spec_ld \
-    hardcode_libdir_separator \
-    hardcode_automatic \
-    module_cmds \
-    module_expsym_cmds \
-    lt_cv_prog_compiler_c_o \
-    exclude_expsyms \
-    include_expsyms; do
-
-    case $var in
-    old_archive_cmds | \
-    old_archive_from_new_cmds | \
-    archive_cmds | \
-    archive_expsym_cmds | \
-    module_cmds | \
-    module_expsym_cmds | \
-    old_archive_from_expsyms_cmds | \
-    export_symbols_cmds | \
-    extract_expsyms_cmds | reload_cmds | finish_cmds | \
-    postinstall_cmds | postuninstall_cmds | \
-    old_postinstall_cmds | old_postuninstall_cmds | \
-    sys_lib_search_path_spec | sys_lib_dlsearch_path_spec)
-      # Double-quote double-evaled strings.
-      eval "lt_$var=\\\"\`\$echo \"X\$$var\" | \$Xsed -e \"\$double_quote_subst\" -e \"\$sed_quote_subst\" -e \"\$delay_variable_subst\"\`\\\""
-      ;;
-    *)
-      eval "lt_$var=\\\"\`\$echo \"X\$$var\" | \$Xsed -e \"\$sed_quote_subst\"\`\\\""
-      ;;
-    esac
-  done
-
-  case $lt_echo in
-  *'\$0 --fallback-echo"')
-    lt_echo=`$echo "X$lt_echo" | $Xsed -e 's/\\\\\\\$0 --fallback-echo"$/$0 --fallback-echo"/'`
-    ;;
-  esac
-
-cfgfile="${ofile}T"
-  trap "$rm \"$cfgfile\"; exit 1" 1 2 15
-  $rm -f "$cfgfile"
-  { echo "$as_me:$LINENO: creating $ofile" >&5
-echo "$as_me: creating $ofile" >&6;}
-
-  cat <<__EOF__ >> "$cfgfile"
-#! $SHELL
-
-# `$echo "$cfgfile" | sed 's%^.*/%%'` - Provide generalized library-building support services.
-# Generated automatically by $PROGRAM (GNU $PACKAGE $VERSION$TIMESTAMP)
-# NOTE: Changes made to this file will be lost: look at ltmain.sh.
-#
-# Copyright (C) 1996, 1997, 1998, 1999, 2000, 2001
-# Free Software Foundation, Inc.
-#
-# This file is part of GNU Libtool:
-# Originally by Gordon Matzigkeit <gord at gnu.ai.mit.edu>, 1996
-#
-# This program is free software; you can redistribute it and/or modify
-# it under the terms of the GNU General Public License as published by
-# the Free Software Foundation; either version 2 of the License, or
-# (at your option) any later version.
-#
-# This program is distributed in the hope that it will be useful, but
-# WITHOUT ANY WARRANTY; without even the implied warranty of
-# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
-# General Public License for more details.
-#
-# You should have received a copy of the GNU General Public License
-# along with this program; if not, write to the Free Software
-# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
-#
-# As a special exception to the GNU General Public License, if you
-# distribute this file as part of a program that contains a
-# configuration script generated by Autoconf, you may include it under
-# the same distribution terms that you use for the rest of that program.
-
-# A sed program that does not truncate output.
-SED=$lt_SED
-
-# Sed that helps us avoid accidentally triggering echo(1) options like -n.
-Xsed="$SED -e s/^X//"
-
-# The HP-UX ksh and POSIX shell print the target directory to stdout
-# if CDPATH is set.
-if test "X\${CDPATH+set}" = Xset; then CDPATH=:; export CDPATH; fi
-
-# The names of the tagged configurations supported by this script.
-available_tags=
-
-# ### BEGIN LIBTOOL CONFIG
-
-# Libtool was configured on host `(hostname || uname -n) 2>/dev/null | sed 1q`:
-
-# Shell to use when invoking shell scripts.
-SHELL=$lt_SHELL
-
-# Whether or not to build shared libraries.
-build_libtool_libs=$enable_shared
-
-# Whether or not to build static libraries.
-build_old_libs=$enable_static
-
-# Whether or not to add -lc for building shared libraries.
-build_libtool_need_lc=$archive_cmds_need_lc
-
-# Whether or not to disallow shared libs when runtime libs are static
-allow_libtool_libs_with_static_runtimes=$enable_shared_with_static_runtimes
-
-# Whether or not to optimize for fast installation.
-fast_install=$enable_fast_install
-
-# The host system.
-host_alias=$host_alias
-host=$host
-
-# An echo program that does not interpret backslashes.
-echo=$lt_echo
-
-# The archiver.
-AR=$lt_AR
-AR_FLAGS=$lt_AR_FLAGS
-
-# A C compiler.
-LTCC=$lt_LTCC
-
-# A language-specific compiler.
-CC=$lt_compiler
-
-# Is the compiler the GNU C compiler?
-with_gcc=$GCC
-
-# An ERE matcher.
-EGREP=$lt_EGREP
-
-# The linker used to build libraries.
-LD=$lt_LD
-
-# Whether we need hard or soft links.
-LN_S=$lt_LN_S
-
-# A BSD-compatible nm program.
-NM=$lt_NM
-
-# A symbol stripping program
-STRIP=$lt_STRIP
-
-# Used to examine libraries when file_magic_cmd begins "file"
-MAGIC_CMD=$MAGIC_CMD
-
-# Used on cygwin: DLL creation program.
-DLLTOOL="$DLLTOOL"
-
-# Used on cygwin: object dumper.
-OBJDUMP="$OBJDUMP"
-
-# Used on cygwin: assembler.
-AS="$AS"
-
-# The name of the directory that contains temporary libtool files.
-objdir=$objdir
-
-# How to create reloadable object files.
-reload_flag=$lt_reload_flag
-reload_cmds=$lt_reload_cmds
-
-# How to pass a linker flag through the compiler.
-wl=$lt_lt_prog_compiler_wl
-
-# Object file suffix (normally "o").
-objext="$ac_objext"
-
-# Old archive suffix (normally "a").
-libext="$libext"
-
-# Shared library suffix (normally ".so").
-shrext_cmds='$shrext_cmds'
-
-# Executable file suffix (normally "").
-exeext="$exeext"
-
-# Additional compiler flags for building library objects.
-pic_flag=$lt_lt_prog_compiler_pic
-pic_mode=$pic_mode
-
-# What is the maximum length of a command?
-max_cmd_len=$lt_cv_sys_max_cmd_len
-
-# Does compiler simultaneously support -c and -o options?
-compiler_c_o=$lt_lt_cv_prog_compiler_c_o
-
-# Must we lock files when doing compilation ?
-need_locks=$lt_need_locks
-
-# Do we need the lib prefix for modules?
-need_lib_prefix=$need_lib_prefix
-
-# Do we need a version for libraries?
-need_version=$need_version
-
-# Whether dlopen is supported.
-dlopen_support=$enable_dlopen
-
-# Whether dlopen of programs is supported.
-dlopen_self=$enable_dlopen_self
-
-# Whether dlopen of statically linked programs is supported.
-dlopen_self_static=$enable_dlopen_self_static
-
-# Compiler flag to prevent dynamic linking.
-link_static_flag=$lt_lt_prog_compiler_static
-
-# Compiler flag to turn off builtin functions.
-no_builtin_flag=$lt_lt_prog_compiler_no_builtin_flag
-
-# Compiler flag to allow reflexive dlopens.
-export_dynamic_flag_spec=$lt_export_dynamic_flag_spec
-
-# Compiler flag to generate shared objects directly from archives.
-whole_archive_flag_spec=$lt_whole_archive_flag_spec
-
-# Compiler flag to generate thread-safe objects.
-thread_safe_flag_spec=$lt_thread_safe_flag_spec
-
-# Library versioning type.
-version_type=$version_type
-
-# Format of library name prefix.
-libname_spec=$lt_libname_spec
-
-# List of archive names.  First name is the real one, the rest are links.
-# The last name is the one that the linker finds with -lNAME.
-library_names_spec=$lt_library_names_spec
-
-# The coded name of the library, if different from the real name.
-soname_spec=$lt_soname_spec
-
-# Commands used to build and install an old-style archive.
-RANLIB=$lt_RANLIB
-old_archive_cmds=$lt_old_archive_cmds
-old_postinstall_cmds=$lt_old_postinstall_cmds
-old_postuninstall_cmds=$lt_old_postuninstall_cmds
-
-# Create an old-style archive from a shared archive.
-old_archive_from_new_cmds=$lt_old_archive_from_new_cmds
-
-# Create a temporary old-style archive to link instead of a shared archive.
-old_archive_from_expsyms_cmds=$lt_old_archive_from_expsyms_cmds
-
-# Commands used to build and install a shared archive.
-archive_cmds=$lt_archive_cmds
-archive_expsym_cmds=$lt_archive_expsym_cmds
-postinstall_cmds=$lt_postinstall_cmds
-postuninstall_cmds=$lt_postuninstall_cmds
-
-# Commands used to build a loadable module (assumed same as above if empty)
-module_cmds=$lt_module_cmds
-module_expsym_cmds=$lt_module_expsym_cmds
-
-# Commands to strip libraries.
-old_striplib=$lt_old_striplib
-striplib=$lt_striplib
-
-# Dependencies to place before the objects being linked to create a
-# shared library.
-predep_objects=$lt_predep_objects
-
-# Dependencies to place after the objects being linked to create a
-# shared library.
-postdep_objects=$lt_postdep_objects
-
-# Dependencies to place before the objects being linked to create a
-# shared library.
-predeps=$lt_predeps
-
-# Dependencies to place after the objects being linked to create a
-# shared library.
-postdeps=$lt_postdeps
-
-# The library search path used internally by the compiler when linking
-# a shared library.
-compiler_lib_search_path=$lt_compiler_lib_search_path
-
-# Method to check whether dependent libraries are shared objects.
-deplibs_check_method=$lt_deplibs_check_method
-
-# Command to use when deplibs_check_method == file_magic.
-file_magic_cmd=$lt_file_magic_cmd
-
-# Flag that allows shared libraries with undefined symbols to be built.
-allow_undefined_flag=$lt_allow_undefined_flag
-
-# Flag that forces no undefined symbols.
-no_undefined_flag=$lt_no_undefined_flag
-
-# Commands used to finish a libtool library installation in a directory.
-finish_cmds=$lt_finish_cmds
-
-# Same as above, but a single script fragment to be evaled but not shown.
-finish_eval=$lt_finish_eval
-
-# Take the output of nm and produce a listing of raw symbols and C names.
-global_symbol_pipe=$lt_lt_cv_sys_global_symbol_pipe
-
-# Transform the output of nm in a proper C declaration
-global_symbol_to_cdecl=$lt_lt_cv_sys_global_symbol_to_cdecl
-
-# Transform the output of nm in a C name address pair
-global_symbol_to_c_name_address=$lt_lt_cv_sys_global_symbol_to_c_name_address
-
-# This is the shared library runtime path variable.
-runpath_var=$runpath_var
-
-# This is the shared library path variable.
-shlibpath_var=$shlibpath_var
-
-# Is shlibpath searched before the hard-coded library search path?
-shlibpath_overrides_runpath=$shlibpath_overrides_runpath
-
-# How to hardcode a shared library path into an executable.
-hardcode_action=$hardcode_action
-
-# Whether we should hardcode library paths into libraries.
-hardcode_into_libs=$hardcode_into_libs
-
-# Flag to hardcode \$libdir into a binary during linking.
-# This must work even if \$libdir does not exist.
-hardcode_libdir_flag_spec=$lt_hardcode_libdir_flag_spec
-
-# If ld is used when linking, flag to hardcode \$libdir into
-# a binary during linking. This must work even if \$libdir does
-# not exist.
-hardcode_libdir_flag_spec_ld=$lt_hardcode_libdir_flag_spec_ld
-
-# Whether we need a single -rpath flag with a separated argument.
-hardcode_libdir_separator=$lt_hardcode_libdir_separator
-
-# Set to yes if using DIR/libNAME${shared_ext} during linking hardcodes DIR into the
-# resulting binary.
-hardcode_direct=$hardcode_direct
-
-# Set to yes if using the -LDIR flag during linking hardcodes DIR into the
-# resulting binary.
-hardcode_minus_L=$hardcode_minus_L
-
-# Set to yes if using SHLIBPATH_VAR=DIR during linking hardcodes DIR into
-# the resulting binary.
-hardcode_shlibpath_var=$hardcode_shlibpath_var
-
-# Set to yes if building a shared library automatically hardcodes DIR into the library
-# and all subsequent libraries and executables linked against it.
-hardcode_automatic=$hardcode_automatic
-
-# Variables whose values should be saved in libtool wrapper scripts and
-# restored at relink time.
-variables_saved_for_relink="$variables_saved_for_relink"
-
-# Whether libtool must link a program against all its dependency libraries.
-link_all_deplibs=$link_all_deplibs
-
-# Compile-time system search path for libraries
-sys_lib_search_path_spec=$lt_sys_lib_search_path_spec
-
-# Run-time system search path for libraries
-sys_lib_dlsearch_path_spec=$lt_sys_lib_dlsearch_path_spec
-
-# Fix the shell variable \$srcfile for the compiler.
-fix_srcfile_path="$fix_srcfile_path"
-
-# Set to yes if exported symbols are required.
-always_export_symbols=$always_export_symbols
-
-# The commands to list exported symbols.
-export_symbols_cmds=$lt_export_symbols_cmds
-
-# The commands to extract the exported symbol list from a shared archive.
-extract_expsyms_cmds=$lt_extract_expsyms_cmds
-
-# Symbols that should not be listed in the preloaded symbols.
-exclude_expsyms=$lt_exclude_expsyms
-
-# Symbols that must always be exported.
-include_expsyms=$lt_include_expsyms
-
-# ### END LIBTOOL CONFIG
-
-__EOF__
-
-
-  case $host_os in
-  aix3*)
-    cat <<\EOF >> "$cfgfile"
-
-# AIX sometimes has problems with the GCC collect2 program.  For some
-# reason, if we set the COLLECT_NAMES environment variable, the problems
-# vanish in a puff of smoke.
-if test "X${COLLECT_NAMES+set}" != Xset; then
-  COLLECT_NAMES=
-  export COLLECT_NAMES
-fi
-EOF
-    ;;
-  esac
-
-  # We use sed instead of cat because bash on DJGPP gets confused if
-  # if finds mixed CR/LF and LF-only lines.  Since sed operates in
-  # text mode, it properly converts lines to CR/LF.  This bash problem
-  # is reportedly fixed, but why not run on old versions too?
-  sed '$q' "$ltmain" >> "$cfgfile" || (rm -f "$cfgfile"; exit 1)
-
-  mv -f "$cfgfile" "$ofile" || \
-    (rm -f "$ofile" && cp "$cfgfile" "$ofile" && rm -f "$cfgfile")
-  chmod +x "$ofile"
-
-else
-  # If there is no Makefile yet, we rely on a make rule to execute
-  # `config.status --recheck' to rerun these tests and create the
-  # libtool script then.
-  ltmain_in=`echo $ltmain | sed -e 's/\.sh$/.in/'`
-  if test -f "$ltmain_in"; then
-    test -f Makefile && make "$ltmain"
-  fi
-fi
-
-
-ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-
-CC="$lt_save_CC"
-
-
-# Check whether --with-tags or --without-tags was given.
-if test "${with_tags+set}" = set; then
-  withval="$with_tags"
-  tagnames="$withval"
-fi;
-
-if test -f "$ltmain" && test -n "$tagnames"; then
-  if test ! -f "${ofile}"; then
-    { echo "$as_me:$LINENO: WARNING: output file \`$ofile' does not exist" >&5
-echo "$as_me: WARNING: output file \`$ofile' does not exist" >&2;}
-  fi
-
-  if test -z "$LTCC"; then
-    eval "`$SHELL ${ofile} --config | grep '^LTCC='`"
-    if test -z "$LTCC"; then
-      { echo "$as_me:$LINENO: WARNING: output file \`$ofile' does not look like a libtool script" >&5
-echo "$as_me: WARNING: output file \`$ofile' does not look like a libtool script" >&2;}
-    else
-      { echo "$as_me:$LINENO: WARNING: using \`LTCC=$LTCC', extracted from \`$ofile'" >&5
-echo "$as_me: WARNING: using \`LTCC=$LTCC', extracted from \`$ofile'" >&2;}
-    fi
-  fi
-
-  # Extract list of available tagged configurations in $ofile.
-  # Note that this assumes the entire list is on one line.
-  available_tags=`grep "^available_tags=" "${ofile}" | $SED -e 's/available_tags=\(.*$\)/\1/' -e 's/\"//g'`
-
-  lt_save_ifs="$IFS"; IFS="${IFS}$PATH_SEPARATOR,"
-  for tagname in $tagnames; do
-    IFS="$lt_save_ifs"
-    # Check whether tagname contains only valid characters
-    case `$echo "X$tagname" | $Xsed -e 's:[-_ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz1234567890,/]::g'` in
-    "") ;;
-    *)  { { echo "$as_me:$LINENO: error: invalid tag name: $tagname" >&5
-echo "$as_me: error: invalid tag name: $tagname" >&2;}
-   { (exit 1); exit 1; }; }
-	;;
-    esac
-
-    if grep "^# ### BEGIN LIBTOOL TAG CONFIG: $tagname$" < "${ofile}" > /dev/null
-    then
-      { { echo "$as_me:$LINENO: error: tag name \"$tagname\" already exists" >&5
-echo "$as_me: error: tag name \"$tagname\" already exists" >&2;}
-   { (exit 1); exit 1; }; }
-    fi
-
-    # Update the list of available tags.
-    if test -n "$tagname"; then
-      echo appending configuration tag \"$tagname\" to $ofile
-
-      case $tagname in
-      CXX)
-	if test -n "$CXX" && test "X$CXX" != "Xno"; then
-	  ac_ext=cc
-ac_cpp='$CXXCPP $CPPFLAGS'
-ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
-
-
-
-
-archive_cmds_need_lc_CXX=no
-allow_undefined_flag_CXX=
-always_export_symbols_CXX=no
-archive_expsym_cmds_CXX=
-export_dynamic_flag_spec_CXX=
-hardcode_direct_CXX=no
-hardcode_libdir_flag_spec_CXX=
-hardcode_libdir_flag_spec_ld_CXX=
-hardcode_libdir_separator_CXX=
-hardcode_minus_L_CXX=no
-hardcode_automatic_CXX=no
-module_cmds_CXX=
-module_expsym_cmds_CXX=
-link_all_deplibs_CXX=unknown
-old_archive_cmds_CXX=$old_archive_cmds
-no_undefined_flag_CXX=
-whole_archive_flag_spec_CXX=
-enable_shared_with_static_runtimes_CXX=no
-
-# Dependencies to place before and after the object being linked:
-predep_objects_CXX=
-postdep_objects_CXX=
-predeps_CXX=
-postdeps_CXX=
-compiler_lib_search_path_CXX=
-
-# Source file extension for C++ test sources.
-ac_ext=cc
-
-# Object file extension for compiled C++ test sources.
-objext=o
-objext_CXX=$objext
-
-# Code to be used in simple compile tests
-lt_simple_compile_test_code="int some_variable = 0;\n"
-
-# Code to be used in simple link tests
-lt_simple_link_test_code='int main(int, char *) { return(0); }\n'
-
-# ltmain only uses $CC for tagged configurations so make sure $CC is set.
-
-# If no C compiler was specified, use CC.
-LTCC=${LTCC-"$CC"}
-
-# Allow CC to be a program name with arguments.
-compiler=$CC
-
-
-# Allow CC to be a program name with arguments.
-lt_save_CC=$CC
-lt_save_LD=$LD
-lt_save_GCC=$GCC
-GCC=$GXX
-lt_save_with_gnu_ld=$with_gnu_ld
-lt_save_path_LD=$lt_cv_path_LD
-if test -n "${lt_cv_prog_gnu_ldcxx+set}"; then
-  lt_cv_prog_gnu_ld=$lt_cv_prog_gnu_ldcxx
-else
-  unset lt_cv_prog_gnu_ld
-fi
-if test -n "${lt_cv_path_LDCXX+set}"; then
-  lt_cv_path_LD=$lt_cv_path_LDCXX
-else
-  unset lt_cv_path_LD
-fi
-test -z "${LDCXX+set}" || LD=$LDCXX
-CC=${CXX-"c++"}
-compiler=$CC
-compiler_CXX=$CC
-cc_basename=`$echo X"$compiler" | $Xsed -e 's%^.*/%%'`
-
-# We don't want -fno-exception wen compiling C++ code, so set the
-# no_builtin_flag separately
-if test "$GXX" = yes; then
-  lt_prog_compiler_no_builtin_flag_CXX=' -fno-builtin'
-else
-  lt_prog_compiler_no_builtin_flag_CXX=
-fi
-
-if test "$GXX" = yes; then
-  # Set up default GNU C++ configuration
-
-
-# Check whether --with-gnu-ld or --without-gnu-ld was given.
-if test "${with_gnu_ld+set}" = set; then
-  withval="$with_gnu_ld"
-  test "$withval" = no || with_gnu_ld=yes
-else
-  with_gnu_ld=no
-fi;
-ac_prog=ld
-if test "$GCC" = yes; then
-  # Check if gcc -print-prog-name=ld gives a path.
-  echo "$as_me:$LINENO: checking for ld used by $CC" >&5
-echo $ECHO_N "checking for ld used by $CC... $ECHO_C" >&6
-  case $host in
-  *-*-mingw*)
-    # gcc leaves a trailing carriage return which upsets mingw
-    ac_prog=`($CC -print-prog-name=ld) 2>&5 | tr -d '\015'` ;;
-  *)
-    ac_prog=`($CC -print-prog-name=ld) 2>&5` ;;
-  esac
-  case $ac_prog in
-    # Accept absolute paths.
-    [\\/]* | ?:[\\/]*)
-      re_direlt='/[^/][^/]*/\.\./'
-      # Canonicalize the pathname of ld
-      ac_prog=`echo $ac_prog| $SED 's%\\\\%/%g'`
-      while echo $ac_prog | grep "$re_direlt" > /dev/null 2>&1; do
-	ac_prog=`echo $ac_prog| $SED "s%$re_direlt%/%"`
-      done
-      test -z "$LD" && LD="$ac_prog"
-      ;;
-  "")
-    # If it fails, then pretend we aren't using GCC.
-    ac_prog=ld
-    ;;
-  *)
-    # If it is relative, then search for the first ld in PATH.
-    with_gnu_ld=unknown
-    ;;
-  esac
-elif test "$with_gnu_ld" = yes; then
-  echo "$as_me:$LINENO: checking for GNU ld" >&5
-echo $ECHO_N "checking for GNU ld... $ECHO_C" >&6
-else
-  echo "$as_me:$LINENO: checking for non-GNU ld" >&5
-echo $ECHO_N "checking for non-GNU ld... $ECHO_C" >&6
-fi
-if test "${lt_cv_path_LD+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -z "$LD"; then
-  lt_save_ifs="$IFS"; IFS=$PATH_SEPARATOR
-  for ac_dir in $PATH; do
-    IFS="$lt_save_ifs"
-    test -z "$ac_dir" && ac_dir=.
-    if test -f "$ac_dir/$ac_prog" || test -f "$ac_dir/$ac_prog$ac_exeext"; then
-      lt_cv_path_LD="$ac_dir/$ac_prog"
-      # Check to see if the program is GNU ld.  I'd rather use --version,
-      # but apparently some GNU ld's only accept -v.
-      # Break only if it was the GNU/non-GNU ld that we prefer.
-      case `"$lt_cv_path_LD" -v 2>&1 </dev/null` in
-      *GNU* | *'with BFD'*)
-	test "$with_gnu_ld" != no && break
-	;;
-      *)
-	test "$with_gnu_ld" != yes && break
-	;;
-      esac
-    fi
-  done
-  IFS="$lt_save_ifs"
-else
-  lt_cv_path_LD="$LD" # Let the user override the test with a path.
-fi
-fi
-
-LD="$lt_cv_path_LD"
-if test -n "$LD"; then
-  echo "$as_me:$LINENO: result: $LD" >&5
-echo "${ECHO_T}$LD" >&6
-else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi
-test -z "$LD" && { { echo "$as_me:$LINENO: error: no acceptable ld found in \$PATH" >&5
-echo "$as_me: error: no acceptable ld found in \$PATH" >&2;}
-   { (exit 1); exit 1; }; }
-echo "$as_me:$LINENO: checking if the linker ($LD) is GNU ld" >&5
-echo $ECHO_N "checking if the linker ($LD) is GNU ld... $ECHO_C" >&6
-if test "${lt_cv_prog_gnu_ld+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  # I'd rather use --version here, but apparently some GNU ld's only accept -v.
-case `$LD -v 2>&1 </dev/null` in
-*GNU* | *'with BFD'*)
-  lt_cv_prog_gnu_ld=yes
-  ;;
-*)
-  lt_cv_prog_gnu_ld=no
-  ;;
-esac
-fi
-echo "$as_me:$LINENO: result: $lt_cv_prog_gnu_ld" >&5
-echo "${ECHO_T}$lt_cv_prog_gnu_ld" >&6
-with_gnu_ld=$lt_cv_prog_gnu_ld
-
-
-
-  # Check if GNU C++ uses GNU ld as the underlying linker, since the
-  # archiving commands below assume that GNU ld is being used.
-  if test "$with_gnu_ld" = yes; then
-    archive_cmds_CXX='$CC -shared -nostdlib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname -o $lib'
-    archive_expsym_cmds_CXX='$CC -shared -nostdlib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
-
-    hardcode_libdir_flag_spec_CXX='${wl}--rpath ${wl}$libdir'
-    export_dynamic_flag_spec_CXX='${wl}--export-dynamic'
-
-    # If archive_cmds runs LD, not CC, wlarc should be empty
-    # XXX I think wlarc can be eliminated in ltcf-cxx, but I need to
-    #     investigate it a little bit more. (MM)
-    wlarc='${wl}'
-
-    # ancient GNU ld didn't support --whole-archive et. al.
-    if eval "`$CC -print-prog-name=ld` --help 2>&1" | \
-	grep 'no-whole-archive' > /dev/null; then
-      whole_archive_flag_spec_CXX="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
-    else
-      whole_archive_flag_spec_CXX=
-    fi
-  else
-    with_gnu_ld=no
-    wlarc=
-
-    # A generic and very simple default shared library creation
-    # command for GNU C++ for the case where it uses the native
-    # linker, instead of GNU ld.  If possible, this setting should
-    # overridden to take advantage of the native linker features on
-    # the platform it is being used on.
-    archive_cmds_CXX='$CC -shared -nostdlib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $lib'
-  fi
-
-  # Commands to make compiler produce verbose output that lists
-  # what "hidden" libraries, object files and flags are used when
-  # linking a shared library.
-  output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | grep "\-L"'
-
-else
-  GXX=no
-  with_gnu_ld=no
-  wlarc=
-fi
-
-# PORTME: fill in a description of your system's C++ link characteristics
-echo "$as_me:$LINENO: checking whether the $compiler linker ($LD) supports shared libraries" >&5
-echo $ECHO_N "checking whether the $compiler linker ($LD) supports shared libraries... $ECHO_C" >&6
-ld_shlibs_CXX=yes
-case $host_os in
-  aix3*)
-    # FIXME: insert proper C++ library support
-    ld_shlibs_CXX=no
-    ;;
-  aix4* | aix5*)
-    if test "$host_cpu" = ia64; then
-      # On IA64, the linker does run time linking by default, so we don't
-      # have to do anything special.
-      aix_use_runtimelinking=no
-      exp_sym_flag='-Bexport'
-      no_entry_flag=""
-    else
-      aix_use_runtimelinking=no
-
-      # Test if we are trying to use run time linking or normal
-      # AIX style linking. If -brtl is somewhere in LDFLAGS, we
-      # need to do runtime linking.
-      case $host_os in aix4.[23]|aix4.[23].*|aix5*)
-	for ld_flag in $LDFLAGS; do
-	  case $ld_flag in
-	  *-brtl*)
-	    aix_use_runtimelinking=yes
-	    break
-	    ;;
-	  esac
-	done
-      esac
-
-      exp_sym_flag='-bexport'
-      no_entry_flag='-bnoentry'
-    fi
-
-    # When large executables or shared objects are built, AIX ld can
-    # have problems creating the table of contents.  If linking a library
-    # or program results in "error TOC overflow" add -mminimal-toc to
-    # CXXFLAGS/CFLAGS for g++/gcc.  In the cases where that is not
-    # enough to fix the problem, add -Wl,-bbigtoc to LDFLAGS.
-
-    archive_cmds_CXX=''
-    hardcode_direct_CXX=yes
-    hardcode_libdir_separator_CXX=':'
-    link_all_deplibs_CXX=yes
-
-    if test "$GXX" = yes; then
-      case $host_os in aix4.012|aix4.012.*)
-      # We only want to do this on AIX 4.2 and lower, the check
-      # below for broken collect2 doesn't work under 4.3+
-	collect2name=`${CC} -print-prog-name=collect2`
-	if test -f "$collect2name" && \
-	   strings "$collect2name" | grep resolve_lib_name >/dev/null
-	then
-	  # We have reworked collect2
-	  hardcode_direct_CXX=yes
-	else
-	  # We have old collect2
-	  hardcode_direct_CXX=unsupported
-	  # It fails to find uninstalled libraries when the uninstalled
-	  # path is not listed in the libpath.  Setting hardcode_minus_L
-	  # to unsupported forces relinking
-	  hardcode_minus_L_CXX=yes
-	  hardcode_libdir_flag_spec_CXX='-L$libdir'
-	  hardcode_libdir_separator_CXX=
-	fi
-      esac
-      shared_flag='-shared'
-    else
-      # not using gcc
-      if test "$host_cpu" = ia64; then
-	# VisualAge C++, Version 5.5 for AIX 5L for IA-64, Beta 3 Release
-	# chokes on -Wl,-G. The following line is correct:
-	shared_flag='-G'
-      else
-	if test "$aix_use_runtimelinking" = yes; then
-	  shared_flag='${wl}-G'
-	else
-	  shared_flag='${wl}-bM:SRE'
-	fi
-      fi
-    fi
-
-    # It seems that -bexpall does not export symbols beginning with
-    # underscore (_), so it is better to generate a list of symbols to export.
-    always_export_symbols_CXX=yes
-    if test "$aix_use_runtimelinking" = yes; then
-      # Warning - without using the other runtime loading flags (-brtl),
-      # -berok will link without error, but may produce a broken library.
-      allow_undefined_flag_CXX='-berok'
-      # Determine the default libpath from the value encoded in an empty executable.
-      cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_cxx_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-
-aix_libpath=`dump -H conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
-}'`
-# Check for a 64-bit object if we didn't find anything.
-if test -z "$aix_libpath"; then aix_libpath=`dump -HX64 conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
-}'`; fi
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
-
-      hardcode_libdir_flag_spec_CXX='${wl}-blibpath:$libdir:'"$aix_libpath"
-
-      archive_expsym_cmds_CXX="\$CC"' -o $output_objdir/$soname $libobjs $deplibs $compiler_flags `if test "x${allow_undefined_flag}" != "x"; then echo "${wl}${allow_undefined_flag}"; else :; fi` '"\${wl}$no_entry_flag \${wl}$exp_sym_flag:\$export_symbols $shared_flag"
-     else
-      if test "$host_cpu" = ia64; then
-	hardcode_libdir_flag_spec_CXX='${wl}-R $libdir:/usr/lib:/lib'
-	allow_undefined_flag_CXX="-z nodefs"
-	archive_expsym_cmds_CXX="\$CC $shared_flag"' -o $output_objdir/$soname $libobjs $deplibs $compiler_flags ${wl}${allow_undefined_flag} '"\${wl}$no_entry_flag \${wl}$exp_sym_flag:\$export_symbols"
-      else
-	# Determine the default libpath from the value encoded in an empty executable.
-	cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_cxx_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-
-aix_libpath=`dump -H conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
-}'`
-# Check for a 64-bit object if we didn't find anything.
-if test -z "$aix_libpath"; then aix_libpath=`dump -HX64 conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
-}'`; fi
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
-
-	hardcode_libdir_flag_spec_CXX='${wl}-blibpath:$libdir:'"$aix_libpath"
-	# Warning - without using the other run time loading flags,
-	# -berok will link without error, but may produce a broken library.
-	no_undefined_flag_CXX=' ${wl}-bernotok'
-	allow_undefined_flag_CXX=' ${wl}-berok'
-	# -bexpall does not export symbols beginning with underscore (_)
-	always_export_symbols_CXX=yes
-	# Exported symbols can be pulled into shared objects from archives
-	whole_archive_flag_spec_CXX=' '
-	archive_cmds_need_lc_CXX=yes
-	# This is similar to how AIX traditionally builds it's shared libraries.
-	archive_expsym_cmds_CXX="\$CC $shared_flag"' -o $output_objdir/$soname $libobjs $deplibs $compiler_flags ${wl}-bE:$export_symbols ${wl}-bnoentry${allow_undefined_flag}~$AR $AR_FLAGS $output_objdir/$libname$release.a $output_objdir/$soname'
-      fi
-    fi
-    ;;
-  chorus*)
-    case $cc_basename in
-      *)
-	# FIXME: insert proper C++ library support
-	ld_shlibs_CXX=no
-	;;
-    esac
-    ;;
-
-  cygwin* | mingw* | pw32*)
-    # _LT_AC_TAGVAR(hardcode_libdir_flag_spec, CXX) is actually meaningless,
-    # as there is no search path for DLLs.
-    hardcode_libdir_flag_spec_CXX='-L$libdir'
-    allow_undefined_flag_CXX=unsupported
-    always_export_symbols_CXX=no
-    enable_shared_with_static_runtimes_CXX=yes
-
-    if $LD --help 2>&1 | grep 'auto-import' > /dev/null; then
-      archive_cmds_CXX='$CC -shared -nostdlib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $output_objdir/$soname ${wl}--image-base=0x10000000 ${wl}--out-implib,$lib'
-      # If the export-symbols file already is a .def file (1st line
-      # is EXPORTS), use it as is; otherwise, prepend...
-      archive_expsym_cmds_CXX='if test "x`$SED 1q $export_symbols`" = xEXPORTS; then
-	cp $export_symbols $output_objdir/$soname.def;
-      else
-	echo EXPORTS > $output_objdir/$soname.def;
-	cat $export_symbols >> $output_objdir/$soname.def;
-      fi~
-      $CC -shared -nostdlib $output_objdir/$soname.def $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $output_objdir/$soname ${wl}--image-base=0x10000000 ${wl}--out-implib,$lib'
-    else
-      ld_shlibs_CXX=no
-    fi
-  ;;
-
-  darwin* | rhapsody*)
-  if test "$GXX" = yes; then
-    archive_cmds_need_lc_CXX=no
-    case "$host_os" in
-    rhapsody* | darwin1.[012])
-      allow_undefined_flag_CXX='-undefined suppress'
-      ;;
-    *) # Darwin 1.3 on
-      if test -z ${MACOSX_DEPLOYMENT_TARGET} ; then
-      	allow_undefined_flag_CXX='-flat_namespace -undefined suppress'
-      else
-        case ${MACOSX_DEPLOYMENT_TARGET} in
-          10.[012])
-            allow_undefined_flag_CXX='-flat_namespace -undefined suppress'
-            ;;
-          10.*)
-            allow_undefined_flag_CXX='-undefined dynamic_lookup'
-            ;;
-        esac
-      fi
-      ;;
-    esac
-    lt_int_apple_cc_single_mod=no
-    output_verbose_link_cmd='echo'
-    if $CC -dumpspecs 2>&1 | grep 'single_module' >/dev/null ; then
-      lt_int_apple_cc_single_mod=yes
-    fi
-    if test "X$lt_int_apple_cc_single_mod" = Xyes ; then
-      archive_cmds_CXX='$CC -dynamiclib -single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring'
-    else
-      archive_cmds_CXX='$CC -r ${wl}-bind_at_load -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs~$CC -dynamiclib $allow_undefined_flag -o $lib ${lib}-master.o $deplibs $compiler_flags -install_name $rpath/$soname $verstring'
-    fi
-    module_cmds_CXX='$CC ${wl}-bind_at_load $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
-
-    # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's
-    if test "X$lt_int_apple_cc_single_mod" = Xyes ; then
-      archive_expsym_cmds_CXX='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -dynamiclib -single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-    else
-      archive_expsym_cmds_CXX='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -r ${wl}-bind_at_load -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs~$CC -dynamiclib $allow_undefined_flag -o $lib ${lib}-master.o $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-    fi
-    module_expsym_cmds_CXX='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-    hardcode_direct_CXX=no
-    hardcode_automatic_CXX=yes
-    hardcode_shlibpath_var_CXX=unsupported
-    whole_archive_flag_spec_CXX='-all_load $convenience'
-    link_all_deplibs_CXX=yes
-  else
-    ld_shlibs_CXX=no
-  fi
-    ;;
-
-  dgux*)
-    case $cc_basename in
-      ec++)
-	# FIXME: insert proper C++ library support
-	ld_shlibs_CXX=no
-	;;
-      ghcx)
-	# Green Hills C++ Compiler
-	# FIXME: insert proper C++ library support
-	ld_shlibs_CXX=no
-	;;
-      *)
-	# FIXME: insert proper C++ library support
-	ld_shlibs_CXX=no
-	;;
-    esac
-    ;;
-  freebsd12*)
-    # C++ shared libraries reported to be fairly broken before switch to ELF
-    ld_shlibs_CXX=no
-    ;;
-  freebsd-elf*)
-    archive_cmds_need_lc_CXX=no
-    ;;
-  freebsd* | kfreebsd*-gnu)
-    # FreeBSD 3 and later use GNU C++ and GNU ld with standard ELF
-    # conventions
-    ld_shlibs_CXX=yes
-    ;;
-  gnu*)
-    ;;
-  hpux9*)
-    hardcode_libdir_flag_spec_CXX='${wl}+b ${wl}$libdir'
-    hardcode_libdir_separator_CXX=:
-    export_dynamic_flag_spec_CXX='${wl}-E'
-    hardcode_direct_CXX=yes
-    hardcode_minus_L_CXX=yes # Not in the search PATH,
-				# but as the default
-				# location of the library.
-
-    case $cc_basename in
-    CC)
-      # FIXME: insert proper C++ library support
-      ld_shlibs_CXX=no
-      ;;
-    aCC)
-      archive_cmds_CXX='$rm $output_objdir/$soname~$CC -b ${wl}+b ${wl}$install_libdir -o $output_objdir/$soname $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags~test $output_objdir/$soname = $lib || mv $output_objdir/$soname $lib'
-      # Commands to make compiler produce verbose output that lists
-      # what "hidden" libraries, object files and flags are used when
-      # linking a shared library.
-      #
-      # There doesn't appear to be a way to prevent this compiler from
-      # explicitly linking system object files so we need to strip them
-      # from the output so that they don't get included in the library
-      # dependencies.
-      output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | grep "-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; echo $list'
-      ;;
-    *)
-      if test "$GXX" = yes; then
-        archive_cmds_CXX='$rm $output_objdir/$soname~$CC -shared -nostdlib -fPIC ${wl}+b ${wl}$install_libdir -o $output_objdir/$soname $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags~test $output_objdir/$soname = $lib || mv $output_objdir/$soname $lib'
-      else
-        # FIXME: insert proper C++ library support
-        ld_shlibs_CXX=no
-      fi
-      ;;
-    esac
-    ;;
-  hpux10*|hpux11*)
-    if test $with_gnu_ld = no; then
-      case "$host_cpu" in
-      hppa*64*)
-	hardcode_libdir_flag_spec_CXX='${wl}+b ${wl}$libdir'
-	hardcode_libdir_flag_spec_ld_CXX='+b $libdir'
-	hardcode_libdir_separator_CXX=:
-        ;;
-      ia64*)
-	hardcode_libdir_flag_spec_CXX='-L$libdir'
-        ;;
-      *)
-	hardcode_libdir_flag_spec_CXX='${wl}+b ${wl}$libdir'
-	hardcode_libdir_separator_CXX=:
-	export_dynamic_flag_spec_CXX='${wl}-E'
-        ;;
-      esac
-    fi
-    case "$host_cpu" in
-    hppa*64*)
-      hardcode_direct_CXX=no
-      hardcode_shlibpath_var_CXX=no
-      ;;
-    ia64*)
-      hardcode_direct_CXX=no
-      hardcode_shlibpath_var_CXX=no
-      hardcode_minus_L_CXX=yes # Not in the search PATH,
-					      # but as the default
-					      # location of the library.
-      ;;
-    *)
-      hardcode_direct_CXX=yes
-      hardcode_minus_L_CXX=yes # Not in the search PATH,
-					      # but as the default
-					      # location of the library.
-      ;;
-    esac
-
-    case $cc_basename in
-      CC)
-	# FIXME: insert proper C++ library support
-	ld_shlibs_CXX=no
-	;;
-      aCC)
-	case "$host_cpu" in
-	hppa*64*|ia64*)
-	  archive_cmds_CXX='$LD -b +h $soname -o $lib $linker_flags $libobjs $deplibs'
-	  ;;
-	*)
-	  archive_cmds_CXX='$CC -b ${wl}+h ${wl}$soname ${wl}+b ${wl}$install_libdir -o $lib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags'
-	  ;;
-	esac
-	# Commands to make compiler produce verbose output that lists
-	# what "hidden" libraries, object files and flags are used when
-	# linking a shared library.
-	#
-	# There doesn't appear to be a way to prevent this compiler from
-	# explicitly linking system object files so we need to strip them
-	# from the output so that they don't get included in the library
-	# dependencies.
-	output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | grep "\-L"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; echo $list'
-	;;
-      *)
-	if test "$GXX" = yes; then
-	  if test $with_gnu_ld = no; then
-	    case "$host_cpu" in
-	    ia64*|hppa*64*)
-	      archive_cmds_CXX='$LD -b +h $soname -o $lib $linker_flags $libobjs $deplibs'
-	      ;;
-	    *)
-	      archive_cmds_CXX='$CC -shared -nostdlib -fPIC ${wl}+h ${wl}$soname ${wl}+b ${wl}$install_libdir -o $lib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags'
-	      ;;
-	    esac
-	  fi
-	else
-	  # FIXME: insert proper C++ library support
-	  ld_shlibs_CXX=no
-	fi
-	;;
-    esac
-    ;;
-  irix5* | irix6*)
-    case $cc_basename in
-      CC)
-	# SGI C++
-	archive_cmds_CXX='$CC -shared -all -multigot $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -soname $soname `test -n "$verstring" && echo -set_version $verstring` -update_registry ${objdir}/so_locations -o $lib'
-
-	# Archives containing C++ object files must be created using
-	# "CC -ar", where "CC" is the IRIX C++ compiler.  This is
-	# necessary to make sure instantiated templates are included
-	# in the archive.
-	old_archive_cmds_CXX='$CC -ar -WR,-u -o $oldlib $oldobjs'
-	;;
-      *)
-	if test "$GXX" = yes; then
-	  if test "$with_gnu_ld" = no; then
-	    archive_cmds_CXX='$CC -shared -nostdlib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname ${wl}$soname `test -n "$verstring" && echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${objdir}/so_locations -o $lib'
-	  else
-	    archive_cmds_CXX='$CC -shared -nostdlib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname ${wl}$soname `test -n "$verstring" && echo ${wl}-set_version ${wl}$verstring` -o $lib'
-	  fi
-	fi
-	link_all_deplibs_CXX=yes
-	;;
-    esac
-    hardcode_libdir_flag_spec_CXX='${wl}-rpath ${wl}$libdir'
-    hardcode_libdir_separator_CXX=:
-    ;;
-  linux*)
-    case $cc_basename in
-      KCC)
-	# Kuck and Associates, Inc. (KAI) C++ Compiler
-
-	# KCC will only create a shared library if the output file
-	# ends with ".so" (or ".sl" for HP-UX), so rename the library
-	# to its proper name (with version) after linking.
-	archive_cmds_CXX='tempext=`echo $shared_ext | $SED -e '\''s/\([^()0-9A-Za-z{}]\)/\\\\\1/g'\''`; templib=`echo $lib | $SED -e "s/\${tempext}\..*/.so/"`; $CC $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags --soname $soname -o \$templib; mv \$templib $lib'
-	archive_expsym_cmds_CXX='tempext=`echo $shared_ext | $SED -e '\''s/\([^()0-9A-Za-z{}]\)/\\\\\1/g'\''`; templib=`echo $lib | $SED -e "s/\${tempext}\..*/.so/"`; $CC $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags --soname $soname -o \$templib ${wl}-retain-symbols-file,$export_symbols; mv \$templib $lib'
-	# Commands to make compiler produce verbose output that lists
-	# what "hidden" libraries, object files and flags are used when
-	# linking a shared library.
-	#
-	# There doesn't appear to be a way to prevent this compiler from
-	# explicitly linking system object files so we need to strip them
-	# from the output so that they don't get included in the library
-	# dependencies.
-	output_verbose_link_cmd='templist=`$CC $CFLAGS -v conftest.$objext -o libconftest$shared_ext 2>&1 | grep "ld"`; rm -f libconftest$shared_ext; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; echo $list'
-
-	hardcode_libdir_flag_spec_CXX='${wl}--rpath,$libdir'
-	export_dynamic_flag_spec_CXX='${wl}--export-dynamic'
-
-	# Archives containing C++ object files must be created using
-	# "CC -Bstatic", where "CC" is the KAI C++ compiler.
-	old_archive_cmds_CXX='$CC -Bstatic -o $oldlib $oldobjs'
-	;;
-      icpc)
-	# Intel C++
-	with_gnu_ld=yes
-	archive_cmds_need_lc_CXX=no
-	archive_cmds_CXX='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname -o $lib'
-	archive_expsym_cmds_CXX='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
-	hardcode_libdir_flag_spec_CXX='${wl}-rpath,$libdir'
-	export_dynamic_flag_spec_CXX='${wl}--export-dynamic'
-	whole_archive_flag_spec_CXX='${wl}--whole-archive$convenience ${wl}--no-whole-archive'
-	;;
-      cxx)
-	# Compaq C++
-	archive_cmds_CXX='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname -o $lib'
-	archive_expsym_cmds_CXX='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname  -o $lib ${wl}-retain-symbols-file $wl$export_symbols'
-
-	runpath_var=LD_RUN_PATH
-	hardcode_libdir_flag_spec_CXX='-rpath $libdir'
-	hardcode_libdir_separator_CXX=:
-
-	# Commands to make compiler produce verbose output that lists
-	# what "hidden" libraries, object files and flags are used when
-	# linking a shared library.
-	#
-	# There doesn't appear to be a way to prevent this compiler from
-	# explicitly linking system object files so we need to strip them
-	# from the output so that they don't get included in the library
-	# dependencies.
-	output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | grep "ld"`; templist=`echo $templist | $SED "s/\(^.*ld.*\)\( .*ld .*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; echo $list'
-	;;
-    esac
-    ;;
-  lynxos*)
-    # FIXME: insert proper C++ library support
-    ld_shlibs_CXX=no
-    ;;
-  m88k*)
-    # FIXME: insert proper C++ library support
-    ld_shlibs_CXX=no
-    ;;
-  mvs*)
-    case $cc_basename in
-      cxx)
-	# FIXME: insert proper C++ library support
-	ld_shlibs_CXX=no
-	;;
-      *)
-	# FIXME: insert proper C++ library support
-	ld_shlibs_CXX=no
-	;;
-    esac
-    ;;
-  netbsd* | netbsdelf*-gnu | knetbsd*-gnu)
-    if echo __ELF__ | $CC -E - | grep __ELF__ >/dev/null; then
-      archive_cmds_CXX='$LD -Bshareable  -o $lib $predep_objects $libobjs $deplibs $postdep_objects $linker_flags'
-      wlarc=
-      hardcode_libdir_flag_spec_CXX='-R$libdir'
-      hardcode_direct_CXX=yes
-      hardcode_shlibpath_var_CXX=no
-    fi
-    # Workaround some broken pre-1.5 toolchains
-    output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | grep conftest.$objext | $SED -e "s:-lgcc -lc -lgcc::"'
-    ;;
-  osf3*)
-    case $cc_basename in
-      KCC)
-	# Kuck and Associates, Inc. (KAI) C++ Compiler
-
-	# KCC will only create a shared library if the output file
-	# ends with ".so" (or ".sl" for HP-UX), so rename the library
-	# to its proper name (with version) after linking.
-	archive_cmds_CXX='tempext=`echo $shared_ext | $SED -e '\''s/\([^()0-9A-Za-z{}]\)/\\\\\1/g'\''`; templib=`echo $lib | $SED -e "s/\${tempext}\..*/.so/"`; $CC $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags --soname $soname -o \$templib; mv \$templib $lib'
-
-	hardcode_libdir_flag_spec_CXX='${wl}-rpath,$libdir'
-	hardcode_libdir_separator_CXX=:
-
-	# Archives containing C++ object files must be created using
-	# "CC -Bstatic", where "CC" is the KAI C++ compiler.
-	old_archive_cmds_CXX='$CC -Bstatic -o $oldlib $oldobjs'
-
-	;;
-      RCC)
-	# Rational C++ 2.4.1
-	# FIXME: insert proper C++ library support
-	ld_shlibs_CXX=no
-	;;
-      cxx)
-	allow_undefined_flag_CXX=' ${wl}-expect_unresolved ${wl}\*'
-	archive_cmds_CXX='$CC -shared${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $soname `test -n "$verstring" && echo ${wl}-set_version $verstring` -update_registry ${objdir}/so_locations -o $lib'
-
-	hardcode_libdir_flag_spec_CXX='${wl}-rpath ${wl}$libdir'
-	hardcode_libdir_separator_CXX=:
-
-	# Commands to make compiler produce verbose output that lists
-	# what "hidden" libraries, object files and flags are used when
-	# linking a shared library.
-	#
-	# There doesn't appear to be a way to prevent this compiler from
-	# explicitly linking system object files so we need to strip them
-	# from the output so that they don't get included in the library
-	# dependencies.
-	output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | grep "ld" | grep -v "ld:"`; templist=`echo $templist | $SED "s/\(^.*ld.*\)\( .*ld.*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; echo $list'
-	;;
-      *)
-	if test "$GXX" = yes && test "$with_gnu_ld" = no; then
-	  allow_undefined_flag_CXX=' ${wl}-expect_unresolved ${wl}\*'
-	  archive_cmds_CXX='$CC -shared -nostdlib ${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname ${wl}$soname `test -n "$verstring" && echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${objdir}/so_locations -o $lib'
-
-	  hardcode_libdir_flag_spec_CXX='${wl}-rpath ${wl}$libdir'
-	  hardcode_libdir_separator_CXX=:
-
-	  # Commands to make compiler produce verbose output that lists
-	  # what "hidden" libraries, object files and flags are used when
-	  # linking a shared library.
-	  output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | grep "\-L"'
-
-	else
-	  # FIXME: insert proper C++ library support
-	  ld_shlibs_CXX=no
-	fi
-	;;
-    esac
-    ;;
-  osf4* | osf5*)
-    case $cc_basename in
-      KCC)
-	# Kuck and Associates, Inc. (KAI) C++ Compiler
-
-	# KCC will only create a shared library if the output file
-	# ends with ".so" (or ".sl" for HP-UX), so rename the library
-	# to its proper name (with version) after linking.
-	archive_cmds_CXX='tempext=`echo $shared_ext | $SED -e '\''s/\([^()0-9A-Za-z{}]\)/\\\\\1/g'\''`; templib=`echo $lib | $SED -e "s/\${tempext}\..*/.so/"`; $CC $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags --soname $soname -o \$templib; mv \$templib $lib'
-
-	hardcode_libdir_flag_spec_CXX='${wl}-rpath,$libdir'
-	hardcode_libdir_separator_CXX=:
-
-	# Archives containing C++ object files must be created using
-	# the KAI C++ compiler.
-	old_archive_cmds_CXX='$CC -o $oldlib $oldobjs'
-	;;
-      RCC)
-	# Rational C++ 2.4.1
-	# FIXME: insert proper C++ library support
-	ld_shlibs_CXX=no
-	;;
-      cxx)
-	allow_undefined_flag_CXX=' -expect_unresolved \*'
-	archive_cmds_CXX='$CC -shared${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -msym -soname $soname `test -n "$verstring" && echo -set_version $verstring` -update_registry ${objdir}/so_locations -o $lib'
-	archive_expsym_cmds_CXX='for i in `cat $export_symbols`; do printf "%s %s\\n" -exported_symbol "\$i" >> $lib.exp; done~
-	  echo "-hidden">> $lib.exp~
-	  $CC -shared$allow_undefined_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -msym -soname $soname -Wl,-input -Wl,$lib.exp  `test -n "$verstring" && echo -set_version	$verstring` -update_registry $objdir/so_locations -o $lib~
-	  $rm $lib.exp'
-
-	hardcode_libdir_flag_spec_CXX='-rpath $libdir'
-	hardcode_libdir_separator_CXX=:
-
-	# Commands to make compiler produce verbose output that lists
-	# what "hidden" libraries, object files and flags are used when
-	# linking a shared library.
-	#
-	# There doesn't appear to be a way to prevent this compiler from
-	# explicitly linking system object files so we need to strip them
-	# from the output so that they don't get included in the library
-	# dependencies.
-	output_verbose_link_cmd='templist=`$CC -shared $CFLAGS -v conftest.$objext 2>&1 | grep "ld" | grep -v "ld:"`; templist=`echo $templist | $SED "s/\(^.*ld.*\)\( .*ld.*$\)/\1/"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; echo $list'
-	;;
-      *)
-	if test "$GXX" = yes && test "$with_gnu_ld" = no; then
-	  allow_undefined_flag_CXX=' ${wl}-expect_unresolved ${wl}\*'
-	 archive_cmds_CXX='$CC -shared -nostdlib ${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-msym ${wl}-soname ${wl}$soname `test -n "$verstring" && echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${objdir}/so_locations -o $lib'
-
-	  hardcode_libdir_flag_spec_CXX='${wl}-rpath ${wl}$libdir'
-	  hardcode_libdir_separator_CXX=:
-
-	  # Commands to make compiler produce verbose output that lists
-	  # what "hidden" libraries, object files and flags are used when
-	  # linking a shared library.
-	  output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | grep "\-L"'
-
-	else
-	  # FIXME: insert proper C++ library support
-	  ld_shlibs_CXX=no
-	fi
-	;;
-    esac
-    ;;
-  psos*)
-    # FIXME: insert proper C++ library support
-    ld_shlibs_CXX=no
-    ;;
-  sco*)
-    archive_cmds_need_lc_CXX=no
-    case $cc_basename in
-      CC)
-	# FIXME: insert proper C++ library support
-	ld_shlibs_CXX=no
-	;;
-      *)
-	# FIXME: insert proper C++ library support
-	ld_shlibs_CXX=no
-	;;
-    esac
-    ;;
-  sunos4*)
-    case $cc_basename in
-      CC)
-	# Sun C++ 4.x
-	# FIXME: insert proper C++ library support
-	ld_shlibs_CXX=no
-	;;
-      lcc)
-	# Lucid
-	# FIXME: insert proper C++ library support
-	ld_shlibs_CXX=no
-	;;
-      *)
-	# FIXME: insert proper C++ library support
-	ld_shlibs_CXX=no
-	;;
-    esac
-    ;;
-  solaris*)
-    case $cc_basename in
-      CC)
-	# Sun C++ 4.2, 5.x and Centerline C++
-	no_undefined_flag_CXX=' -zdefs'
-	archive_cmds_CXX='$CC -G${allow_undefined_flag} -nolib -h$soname -o $lib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags'
-	archive_expsym_cmds_CXX='$echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~$echo "local: *; };" >> $lib.exp~
-	$CC -G${allow_undefined_flag} -nolib ${wl}-M ${wl}$lib.exp -h$soname -o $lib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags~$rm $lib.exp'
-
-	hardcode_libdir_flag_spec_CXX='-R$libdir'
-	hardcode_shlibpath_var_CXX=no
-	case $host_os in
-	  solaris2.0-5 | solaris2.0-5.*) ;;
-	  *)
-	    # The C++ compiler is used as linker so we must use $wl
-	    # flag to pass the commands to the underlying system
-	    # linker.
-	    # Supported since Solaris 2.6 (maybe 2.5.1?)
-	    whole_archive_flag_spec_CXX='${wl}-z ${wl}allextract$convenience ${wl}-z ${wl}defaultextract'
-	    ;;
-	esac
-	link_all_deplibs_CXX=yes
-
-	# Commands to make compiler produce verbose output that lists
-	# what "hidden" libraries, object files and flags are used when
-	# linking a shared library.
-	#
-	# There doesn't appear to be a way to prevent this compiler from
-	# explicitly linking system object files so we need to strip them
-	# from the output so that they don't get included in the library
-	# dependencies.
-	output_verbose_link_cmd='templist=`$CC -G $CFLAGS -v conftest.$objext 2>&1 | grep "\-[LR]"`; list=""; for z in $templist; do case $z in conftest.$objext) list="$list $z";; *.$objext);; *) list="$list $z";;esac; done; echo $list'
-
-	# Archives containing C++ object files must be created using
-	# "CC -xar", where "CC" is the Sun C++ compiler.  This is
-	# necessary to make sure instantiated templates are included
-	# in the archive.
-	old_archive_cmds_CXX='$CC -xar -o $oldlib $oldobjs'
-	;;
-      gcx)
-	# Green Hills C++ Compiler
-	archive_cmds_CXX='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-h $wl$soname -o $lib'
-
-	# The C++ compiler must be used to create the archive.
-	old_archive_cmds_CXX='$CC $LDFLAGS -archive -o $oldlib $oldobjs'
-	;;
-      *)
-	# GNU C++ compiler with Solaris linker
-	if test "$GXX" = yes && test "$with_gnu_ld" = no; then
-	  no_undefined_flag_CXX=' ${wl}-z ${wl}defs'
-	  if $CC --version | grep -v '^2\.7' > /dev/null; then
-	    archive_cmds_CXX='$CC -shared -nostdlib $LDFLAGS $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-h $wl$soname -o $lib'
-	    archive_expsym_cmds_CXX='$echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~$echo "local: *; };" >> $lib.exp~
-		$CC -shared -nostdlib ${wl}-M $wl$lib.exp -o $lib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags~$rm $lib.exp'
-
-	    # Commands to make compiler produce verbose output that lists
-	    # what "hidden" libraries, object files and flags are used when
-	    # linking a shared library.
-	    output_verbose_link_cmd="$CC -shared $CFLAGS -v conftest.$objext 2>&1 | grep \"\-L\""
-	  else
-	    # g++ 2.7 appears to require `-G' NOT `-shared' on this
-	    # platform.
-	    archive_cmds_CXX='$CC -G -nostdlib $LDFLAGS $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-h $wl$soname -o $lib'
-	    archive_expsym_cmds_CXX='$echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~$echo "local: *; };" >> $lib.exp~
-		$CC -G -nostdlib ${wl}-M $wl$lib.exp -o $lib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags~$rm $lib.exp'
-
-	    # Commands to make compiler produce verbose output that lists
-	    # what "hidden" libraries, object files and flags are used when
-	    # linking a shared library.
-	    output_verbose_link_cmd="$CC -G $CFLAGS -v conftest.$objext 2>&1 | grep \"\-L\""
-	  fi
-
-	  hardcode_libdir_flag_spec_CXX='${wl}-R $wl$libdir'
-	fi
-	;;
-    esac
-    ;;
-  sysv5OpenUNIX8* | sysv5UnixWare7* | sysv5uw[78]* | unixware7*)
-    archive_cmds_need_lc_CXX=no
-    ;;
-  tandem*)
-    case $cc_basename in
-      NCC)
-	# NonStop-UX NCC 3.20
-	# FIXME: insert proper C++ library support
-	ld_shlibs_CXX=no
-	;;
-      *)
-	# FIXME: insert proper C++ library support
-	ld_shlibs_CXX=no
-	;;
-    esac
-    ;;
-  vxworks*)
-    # FIXME: insert proper C++ library support
-    ld_shlibs_CXX=no
-    ;;
-  *)
-    # FIXME: insert proper C++ library support
-    ld_shlibs_CXX=no
-    ;;
-esac
-echo "$as_me:$LINENO: result: $ld_shlibs_CXX" >&5
-echo "${ECHO_T}$ld_shlibs_CXX" >&6
-test "$ld_shlibs_CXX" = no && can_build_shared=no
-
-GCC_CXX="$GXX"
-LD_CXX="$LD"
-
-
-cat > conftest.$ac_ext <<EOF
-class Foo
-{
-public:
-  Foo (void) { a = 0; }
-private:
-  int a;
-};
-EOF
-
-if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; then
-  # Parse the compiler output and extract the necessary
-  # objects, libraries and library flags.
-
-  # Sentinel used to keep track of whether or not we are before
-  # the conftest object file.
-  pre_test_object_deps_done=no
-
-  # The `*' in the case matches for architectures that use `case' in
-  # $output_verbose_cmd can trigger glob expansion during the loop
-  # eval without this substitution.
-  output_verbose_link_cmd="`$echo \"X$output_verbose_link_cmd\" | $Xsed -e \"$no_glob_subst\"`"
-
-  for p in `eval $output_verbose_link_cmd`; do
-    case $p in
-
-    -L* | -R* | -l*)
-       # Some compilers place space between "-{L,R}" and the path.
-       # Remove the space.
-       if test $p = "-L" \
-	  || test $p = "-R"; then
-	 prev=$p
-	 continue
-       else
-	 prev=
-       fi
-
-       if test "$pre_test_object_deps_done" = no; then
-	 case $p in
-	 -L* | -R*)
-	   # Internal compiler library paths should come after those
-	   # provided the user.  The postdeps already come after the
-	   # user supplied libs so there is no need to process them.
-	   if test -z "$compiler_lib_search_path_CXX"; then
-	     compiler_lib_search_path_CXX="${prev}${p}"
-	   else
-	     compiler_lib_search_path_CXX="${compiler_lib_search_path_CXX} ${prev}${p}"
-	   fi
-	   ;;
-	 # The "-l" case would never come before the object being
-	 # linked, so don't bother handling this case.
-	 esac
-       else
-	 if test -z "$postdeps_CXX"; then
-	   postdeps_CXX="${prev}${p}"
-	 else
-	   postdeps_CXX="${postdeps_CXX} ${prev}${p}"
-	 fi
-       fi
-       ;;
-
-    *.$objext)
-       # This assumes that the test object file only shows up
-       # once in the compiler output.
-       if test "$p" = "conftest.$objext"; then
-	 pre_test_object_deps_done=yes
-	 continue
-       fi
-
-       if test "$pre_test_object_deps_done" = no; then
-	 if test -z "$predep_objects_CXX"; then
-	   predep_objects_CXX="$p"
-	 else
-	   predep_objects_CXX="$predep_objects_CXX $p"
-	 fi
-       else
-	 if test -z "$postdep_objects_CXX"; then
-	   postdep_objects_CXX="$p"
-	 else
-	   postdep_objects_CXX="$postdep_objects_CXX $p"
-	 fi
-       fi
-       ;;
-
-    *) ;; # Ignore the rest.
-
-    esac
-  done
-
-  # Clean up.
-  rm -f a.out a.exe
-else
-  echo "libtool.m4: error: problem compiling CXX test program"
-fi
-
-$rm -f confest.$objext
-
-case " $postdeps_CXX " in
-*" -lc "*) archive_cmds_need_lc_CXX=no ;;
-esac
-
-lt_prog_compiler_wl_CXX=
-lt_prog_compiler_pic_CXX=
-lt_prog_compiler_static_CXX=
-
-echo "$as_me:$LINENO: checking for $compiler option to produce PIC" >&5
-echo $ECHO_N "checking for $compiler option to produce PIC... $ECHO_C" >&6
-
-  # C++ specific cases for pic, static, wl, etc.
-  if test "$GXX" = yes; then
-    lt_prog_compiler_wl_CXX='-Wl,'
-    lt_prog_compiler_static_CXX='-static'
-
-    case $host_os in
-    aix*)
-      # All AIX code is PIC.
-      if test "$host_cpu" = ia64; then
-	# AIX 5 now supports IA64 processor
-	lt_prog_compiler_static_CXX='-Bstatic'
-      fi
-      ;;
-    amigaos*)
-      # FIXME: we need at least 68020 code to build shared libraries, but
-      # adding the `-m68020' flag to GCC prevents building anything better,
-      # like `-m68040'.
-      lt_prog_compiler_pic_CXX='-m68020 -resident32 -malways-restore-a4'
-      ;;
-    beos* | cygwin* | irix5* | irix6* | nonstopux* | osf3* | osf4* | osf5*)
-      # PIC is the default for these OSes.
-      ;;
-    mingw* | os2* | pw32*)
-      # This hack is so that the source file can tell whether it is being
-      # built for inclusion in a dll (and should export symbols for example).
-      lt_prog_compiler_pic_CXX='-DDLL_EXPORT'
-      ;;
-    darwin* | rhapsody*)
-      # PIC is the default on this platform
-      # Common symbols not allowed in MH_DYLIB files
-      lt_prog_compiler_pic_CXX='-fno-common'
-      ;;
-    *djgpp*)
-      # DJGPP does not support shared libraries at all
-      lt_prog_compiler_pic_CXX=
-      ;;
-    sysv4*MP*)
-      if test -d /usr/nec; then
-	lt_prog_compiler_pic_CXX=-Kconform_pic
-      fi
-      ;;
-    hpux*)
-      # PIC is the default for IA64 HP-UX and 64-bit HP-UX, but
-      # not for PA HP-UX.
-      case "$host_cpu" in
-      hppa*64*|ia64*)
-	;;
-      *)
-	lt_prog_compiler_pic_CXX='-fPIC'
-	;;
-      esac
-      ;;
-    *)
-      lt_prog_compiler_pic_CXX='-fPIC'
-      ;;
-    esac
-  else
-    case $host_os in
-      aix4* | aix5*)
-	# All AIX code is PIC.
-	if test "$host_cpu" = ia64; then
-	  # AIX 5 now supports IA64 processor
-	  lt_prog_compiler_static_CXX='-Bstatic'
-	else
-	  lt_prog_compiler_static_CXX='-bnso -bI:/lib/syscalls.exp'
-	fi
-	;;
-      chorus*)
-	case $cc_basename in
-	cxch68)
-	  # Green Hills C++ Compiler
-	  # _LT_AC_TAGVAR(lt_prog_compiler_static, CXX)="--no_auto_instantiation -u __main -u __premain -u _abort -r $COOL_DIR/lib/libOrb.a $MVME_DIR/lib/CC/libC.a $MVME_DIR/lib/classix/libcx.s.a"
-	  ;;
-	esac
-	;;
-      dgux*)
-	case $cc_basename in
-	  ec++)
-	    lt_prog_compiler_pic_CXX='-KPIC'
-	    ;;
-	  ghcx)
-	    # Green Hills C++ Compiler
-	    lt_prog_compiler_pic_CXX='-pic'
-	    ;;
-	  *)
-	    ;;
-	esac
-	;;
-      freebsd* | kfreebsd*-gnu)
-	# FreeBSD uses GNU C++
-	;;
-      hpux9* | hpux10* | hpux11*)
-	case $cc_basename in
-	  CC)
-	    lt_prog_compiler_wl_CXX='-Wl,'
-	    lt_prog_compiler_static_CXX="${ac_cv_prog_cc_wl}-a ${ac_cv_prog_cc_wl}archive"
-	    if test "$host_cpu" != ia64; then
-	      lt_prog_compiler_pic_CXX='+Z'
-	    fi
-	    ;;
-	  aCC)
-	    lt_prog_compiler_wl_CXX='-Wl,'
-	    lt_prog_compiler_static_CXX="${ac_cv_prog_cc_wl}-a ${ac_cv_prog_cc_wl}archive"
-	    case "$host_cpu" in
-	    hppa*64*|ia64*)
-	      # +Z the default
-	      ;;
-	    *)
-	      lt_prog_compiler_pic_CXX='+Z'
-	      ;;
-	    esac
-	    ;;
-	  *)
-	    ;;
-	esac
-	;;
-      irix5* | irix6* | nonstopux*)
-	case $cc_basename in
-	  CC)
-	    lt_prog_compiler_wl_CXX='-Wl,'
-	    lt_prog_compiler_static_CXX='-non_shared'
-	    # CC pic flag -KPIC is the default.
-	    ;;
-	  *)
-	    ;;
-	esac
-	;;
-      linux*)
-	case $cc_basename in
-	  KCC)
-	    # KAI C++ Compiler
-	    lt_prog_compiler_wl_CXX='--backend -Wl,'
-	    lt_prog_compiler_pic_CXX='-fPIC'
-	    ;;
-	  icpc)
-	    # Intel C++
-	    lt_prog_compiler_wl_CXX='-Wl,'
-	    lt_prog_compiler_pic_CXX='-KPIC'
-	    lt_prog_compiler_static_CXX='-static'
-	    ;;
-	  cxx)
-	    # Compaq C++
-	    # Make sure the PIC flag is empty.  It appears that all Alpha
-	    # Linux and Compaq Tru64 Unix objects are PIC.
-	    lt_prog_compiler_pic_CXX=
-	    lt_prog_compiler_static_CXX='-non_shared'
-	    ;;
-	  *)
-	    ;;
-	esac
-	;;
-      lynxos*)
-	;;
-      m88k*)
-	;;
-      mvs*)
-	case $cc_basename in
-	  cxx)
-	    lt_prog_compiler_pic_CXX='-W c,exportall'
-	    ;;
-	  *)
-	    ;;
-	esac
-	;;
-      netbsd* | netbsdelf*-gnu | knetbsd*-gnu)
-	;;
-      osf3* | osf4* | osf5*)
-	case $cc_basename in
-	  KCC)
-	    lt_prog_compiler_wl_CXX='--backend -Wl,'
-	    ;;
-	  RCC)
-	    # Rational C++ 2.4.1
-	    lt_prog_compiler_pic_CXX='-pic'
-	    ;;
-	  cxx)
-	    # Digital/Compaq C++
-	    lt_prog_compiler_wl_CXX='-Wl,'
-	    # Make sure the PIC flag is empty.  It appears that all Alpha
-	    # Linux and Compaq Tru64 Unix objects are PIC.
-	    lt_prog_compiler_pic_CXX=
-	    lt_prog_compiler_static_CXX='-non_shared'
-	    ;;
-	  *)
-	    ;;
-	esac
-	;;
-      psos*)
-	;;
-      sco*)
-	case $cc_basename in
-	  CC)
-	    lt_prog_compiler_pic_CXX='-fPIC'
-	    ;;
-	  *)
-	    ;;
-	esac
-	;;
-      solaris*)
-	case $cc_basename in
-	  CC)
-	    # Sun C++ 4.2, 5.x and Centerline C++
-	    lt_prog_compiler_pic_CXX='-KPIC'
-	    lt_prog_compiler_static_CXX='-Bstatic'
-	    lt_prog_compiler_wl_CXX='-Qoption ld '
-	    ;;
-	  gcx)
-	    # Green Hills C++ Compiler
-	    lt_prog_compiler_pic_CXX='-PIC'
-	    ;;
-	  *)
-	    ;;
-	esac
-	;;
-      sunos4*)
-	case $cc_basename in
-	  CC)
-	    # Sun C++ 4.x
-	    lt_prog_compiler_pic_CXX='-pic'
-	    lt_prog_compiler_static_CXX='-Bstatic'
-	    ;;
-	  lcc)
-	    # Lucid
-	    lt_prog_compiler_pic_CXX='-pic'
-	    ;;
-	  *)
-	    ;;
-	esac
-	;;
-      tandem*)
-	case $cc_basename in
-	  NCC)
-	    # NonStop-UX NCC 3.20
-	    lt_prog_compiler_pic_CXX='-KPIC'
-	    ;;
-	  *)
-	    ;;
-	esac
-	;;
-      unixware*)
-	;;
-      vxworks*)
-	;;
-      *)
-	lt_prog_compiler_can_build_shared_CXX=no
-	;;
-    esac
-  fi
-
-echo "$as_me:$LINENO: result: $lt_prog_compiler_pic_CXX" >&5
-echo "${ECHO_T}$lt_prog_compiler_pic_CXX" >&6
-
-#
-# Check to make sure the PIC flag actually works.
-#
-if test -n "$lt_prog_compiler_pic_CXX"; then
-
-echo "$as_me:$LINENO: checking if $compiler PIC flag $lt_prog_compiler_pic_CXX works" >&5
-echo $ECHO_N "checking if $compiler PIC flag $lt_prog_compiler_pic_CXX works... $ECHO_C" >&6
-if test "${lt_prog_compiler_pic_works_CXX+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  lt_prog_compiler_pic_works_CXX=no
-  ac_outfile=conftest.$ac_objext
-   printf "$lt_simple_compile_test_code" > conftest.$ac_ext
-   lt_compiler_flag="$lt_prog_compiler_pic_CXX -DPIC"
-   # Insert the option either (1) after the last *FLAGS variable, or
-   # (2) before a word containing "conftest.", or (3) at the end.
-   # Note that $ac_compile itself does not contain backslashes and begins
-   # with a dollar sign (not a hyphen), so the echo should work correctly.
-   # The option is referenced via a variable to avoid confusing sed.
-   lt_compile=`echo "$ac_compile" | $SED \
-   -e 's:.*FLAGS}? :&$lt_compiler_flag :; t' \
-   -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
-   -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:11214: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
-   ac_status=$?
-   cat conftest.err >&5
-   echo "$as_me:11218: \$? = $ac_status" >&5
-   if (exit $ac_status) && test -s "$ac_outfile"; then
-     # The compiler can only warn and ignore the option if not recognized
-     # So say no if there are warnings
-     if test ! -s conftest.err; then
-       lt_prog_compiler_pic_works_CXX=yes
-     fi
-   fi
-   $rm conftest*
-
-fi
-echo "$as_me:$LINENO: result: $lt_prog_compiler_pic_works_CXX" >&5
-echo "${ECHO_T}$lt_prog_compiler_pic_works_CXX" >&6
-
-if test x"$lt_prog_compiler_pic_works_CXX" = xyes; then
-    case $lt_prog_compiler_pic_CXX in
-     "" | " "*) ;;
-     *) lt_prog_compiler_pic_CXX=" $lt_prog_compiler_pic_CXX" ;;
-     esac
-else
-    lt_prog_compiler_pic_CXX=
-     lt_prog_compiler_can_build_shared_CXX=no
-fi
-
-fi
-case "$host_os" in
-  # For platforms which do not support PIC, -DPIC is meaningless:
-  *djgpp*)
-    lt_prog_compiler_pic_CXX=
-    ;;
-  *)
-    lt_prog_compiler_pic_CXX="$lt_prog_compiler_pic_CXX -DPIC"
-    ;;
-esac
-
-echo "$as_me:$LINENO: checking if $compiler supports -c -o file.$ac_objext" >&5
-echo $ECHO_N "checking if $compiler supports -c -o file.$ac_objext... $ECHO_C" >&6
-if test "${lt_cv_prog_compiler_c_o_CXX+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  lt_cv_prog_compiler_c_o_CXX=no
-   $rm -r conftest 2>/dev/null
-   mkdir conftest
-   cd conftest
-   mkdir out
-   printf "$lt_simple_compile_test_code" > conftest.$ac_ext
-
-   lt_compiler_flag="-o out/conftest2.$ac_objext"
-   # Insert the option either (1) after the last *FLAGS variable, or
-   # (2) before a word containing "conftest.", or (3) at the end.
-   # Note that $ac_compile itself does not contain backslashes and begins
-   # with a dollar sign (not a hyphen), so the echo should work correctly.
-   lt_compile=`echo "$ac_compile" | $SED \
-   -e 's:.*FLAGS}? :&$lt_compiler_flag :; t' \
-   -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
-   -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:11274: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
-   ac_status=$?
-   cat out/conftest.err >&5
-   echo "$as_me:11278: \$? = $ac_status" >&5
-   if (exit $ac_status) && test -s out/conftest2.$ac_objext
-   then
-     # The compiler can only warn and ignore the option if not recognized
-     # So say no if there are warnings
-     if test ! -s out/conftest.err; then
-       lt_cv_prog_compiler_c_o_CXX=yes
-     fi
-   fi
-   chmod u+w .
-   $rm conftest*
-   # SGI C++ compiler will create directory out/ii_files/ for
-   # template instantiation
-   test -d out/ii_files && $rm out/ii_files/* && rmdir out/ii_files
-   $rm out/* && rmdir out
-   cd ..
-   rmdir conftest
-   $rm conftest*
-
-fi
-echo "$as_me:$LINENO: result: $lt_cv_prog_compiler_c_o_CXX" >&5
-echo "${ECHO_T}$lt_cv_prog_compiler_c_o_CXX" >&6
-
-
-hard_links="nottested"
-if test "$lt_cv_prog_compiler_c_o_CXX" = no && test "$need_locks" != no; then
-  # do not overwrite the value of need_locks provided by the user
-  echo "$as_me:$LINENO: checking if we can lock with hard links" >&5
-echo $ECHO_N "checking if we can lock with hard links... $ECHO_C" >&6
-  hard_links=yes
-  $rm conftest*
-  ln conftest.a conftest.b 2>/dev/null && hard_links=no
-  touch conftest.a
-  ln conftest.a conftest.b 2>&5 || hard_links=no
-  ln conftest.a conftest.b 2>/dev/null && hard_links=no
-  echo "$as_me:$LINENO: result: $hard_links" >&5
-echo "${ECHO_T}$hard_links" >&6
-  if test "$hard_links" = no; then
-    { echo "$as_me:$LINENO: WARNING: \`$CC' does not support \`-c -o', so \`make -j' may be unsafe" >&5
-echo "$as_me: WARNING: \`$CC' does not support \`-c -o', so \`make -j' may be unsafe" >&2;}
-    need_locks=warn
-  fi
-else
-  need_locks=no
-fi
-
-echo "$as_me:$LINENO: checking whether the $compiler linker ($LD) supports shared libraries" >&5
-echo $ECHO_N "checking whether the $compiler linker ($LD) supports shared libraries... $ECHO_C" >&6
-
-  export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
-  case $host_os in
-  aix4* | aix5*)
-    # If we're using GNU nm, then we don't want the "-C" option.
-    # -C means demangle to AIX nm, but means don't demangle with GNU nm
-    if $NM -V 2>&1 | grep 'GNU' > /dev/null; then
-      export_symbols_cmds_CXX='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$2 == "T") || (\$2 == "D") || (\$2 == "B")) && (substr(\$3,1,1) != ".")) { print \$3 } }'\'' | sort -u > $export_symbols'
-    else
-      export_symbols_cmds_CXX='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$2 == "T") || (\$2 == "D") || (\$2 == "B")) && (substr(\$3,1,1) != ".")) { print \$3 } }'\'' | sort -u > $export_symbols'
-    fi
-    ;;
-  pw32*)
-    export_symbols_cmds_CXX="$ltdll_cmds"
-  ;;
-  cygwin* | mingw*)
-    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGS] /s/.* \([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW] /s/.* //'\'' | sort | uniq > $export_symbols'
-  ;;
-  linux*)
-    link_all_deplibs_CXX=no
-  ;;
-  *)
-    export_symbols_cmds_CXX='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
-  ;;
-  esac
-
-echo "$as_me:$LINENO: result: $ld_shlibs_CXX" >&5
-echo "${ECHO_T}$ld_shlibs_CXX" >&6
-test "$ld_shlibs_CXX" = no && can_build_shared=no
-
-variables_saved_for_relink="PATH $shlibpath_var $runpath_var"
-if test "$GCC" = yes; then
-  variables_saved_for_relink="$variables_saved_for_relink GCC_EXEC_PREFIX COMPILER_PATH LIBRARY_PATH"
-fi
-
-#
-# Do we need to explicitly link libc?
-#
-case "x$archive_cmds_need_lc_CXX" in
-x|xyes)
-  # Assume -lc should be added
-  archive_cmds_need_lc_CXX=yes
-
-  if test "$enable_shared" = yes && test "$GCC" = yes; then
-    case $archive_cmds_CXX in
-    *'~'*)
-      # FIXME: we may have to deal with multi-command sequences.
-      ;;
-    '$CC '*)
-      # Test whether the compiler implicitly links with -lc since on some
-      # systems, -lgcc has to come before -lc. If gcc already passes -lc
-      # to ld, don't add -lc before -lgcc.
-      echo "$as_me:$LINENO: checking whether -lc should be explicitly linked in" >&5
-echo $ECHO_N "checking whether -lc should be explicitly linked in... $ECHO_C" >&6
-      $rm conftest*
-      printf "$lt_simple_compile_test_code" > conftest.$ac_ext
-
-      if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } 2>conftest.err; then
-        soname=conftest
-        lib=conftest
-        libobjs=conftest.$ac_objext
-        deplibs=
-        wl=$lt_prog_compiler_wl_CXX
-        compiler_flags=-v
-        linker_flags=-v
-        verstring=
-        output_objdir=.
-        libname=conftest
-        lt_save_allow_undefined_flag=$allow_undefined_flag_CXX
-        allow_undefined_flag_CXX=
-        if { (eval echo "$as_me:$LINENO: \"$archive_cmds_CXX 2\>\&1 \| grep \" -lc \" \>/dev/null 2\>\&1\"") >&5
-  (eval $archive_cmds_CXX 2\>\&1 \| grep \" -lc \" \>/dev/null 2\>\&1) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }
-        then
-	  archive_cmds_need_lc_CXX=no
-        else
-	  archive_cmds_need_lc_CXX=yes
-        fi
-        allow_undefined_flag_CXX=$lt_save_allow_undefined_flag
-      else
-        cat conftest.err 1>&5
-      fi
-      $rm conftest*
-      echo "$as_me:$LINENO: result: $archive_cmds_need_lc_CXX" >&5
-echo "${ECHO_T}$archive_cmds_need_lc_CXX" >&6
-      ;;
-    esac
-  fi
-  ;;
-esac
-
-echo "$as_me:$LINENO: checking dynamic linker characteristics" >&5
-echo $ECHO_N "checking dynamic linker characteristics... $ECHO_C" >&6
-library_names_spec=
-libname_spec='lib$name'
-soname_spec=
-shrext_cmds=".so"
-postinstall_cmds=
-postuninstall_cmds=
-finish_cmds=
-finish_eval=
-shlibpath_var=
-shlibpath_overrides_runpath=unknown
-version_type=none
-dynamic_linker="$host_os ld.so"
-sys_lib_dlsearch_path_spec="/lib /usr/lib"
-if test "$GCC" = yes; then
-  sys_lib_search_path_spec=`$CC -print-search-dirs | grep "^libraries:" | $SED -e "s/^libraries://" -e "s,=/,/,g"`
-  if echo "$sys_lib_search_path_spec" | grep ';' >/dev/null ; then
-    # if the path contains ";" then we assume it to be the separator
-    # otherwise default to the standard path separator (i.e. ":") - it is
-    # assumed that no part of a normal pathname contains ";" but that should
-    # okay in the real world where ";" in dirpaths is itself problematic.
-    sys_lib_search_path_spec=`echo "$sys_lib_search_path_spec" | $SED -e 's/;/ /g'`
-  else
-    sys_lib_search_path_spec=`echo "$sys_lib_search_path_spec" | $SED  -e "s/$PATH_SEPARATOR/ /g"`
-  fi
-else
-  sys_lib_search_path_spec="/lib /usr/lib /usr/local/lib"
-fi
-need_lib_prefix=unknown
-hardcode_into_libs=no
-
-# when you set need_version to no, make sure it does not cause -set_version
-# flags to be left without arguments
-need_version=unknown
-
-case $host_os in
-aix3*)
-  version_type=linux
-  library_names_spec='${libname}${release}${shared_ext}$versuffix $libname.a'
-  shlibpath_var=LIBPATH
-
-  # AIX 3 has no versioning support, so we append a major version to the name.
-  soname_spec='${libname}${release}${shared_ext}$major'
-  ;;
-
-aix4* | aix5*)
-  version_type=linux
-  need_lib_prefix=no
-  need_version=no
-  hardcode_into_libs=yes
-  if test "$host_cpu" = ia64; then
-    # AIX 5 supports IA64
-    library_names_spec='${libname}${release}${shared_ext}$major ${libname}${release}${shared_ext}$versuffix $libname${shared_ext}'
-    shlibpath_var=LD_LIBRARY_PATH
-  else
-    # With GCC up to 2.95.x, collect2 would create an import file
-    # for dependence libraries.  The import file would start with
-    # the line `#! .'.  This would cause the generated library to
-    # depend on `.', always an invalid library.  This was fixed in
-    # development snapshots of GCC prior to 3.0.
-    case $host_os in
-      aix4 | aix4.[01] | aix4.[01].*)
-      if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
-	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | grep yes > /dev/null; then
-	:
-      else
-	can_build_shared=no
-      fi
-      ;;
-    esac
-    # AIX (on Power*) has no versioning support, so currently we can not hardcode correct
-    # soname into executable. Probably we can add versioning support to
-    # collect2, so additional links can be useful in future.
-    if test "$aix_use_runtimelinking" = yes; then
-      # If using run time linking (on AIX 4.2 or later) use lib<name>.so
-      # instead of lib<name>.a to let people know that these are not
-      # typical AIX shared libraries.
-      library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-    else
-      # We preserve .a as extension for shared libraries through AIX4.2
-      # and later when we are not doing run time linking.
-      library_names_spec='${libname}${release}.a $libname.a'
-      soname_spec='${libname}${release}${shared_ext}$major'
-    fi
-    shlibpath_var=LIBPATH
-  fi
-  ;;
-
-amigaos*)
-  library_names_spec='$libname.ixlibrary $libname.a'
-  # Create ${libname}_ixlibrary.a entries in /sys/libs.
-  finish_eval='for lib in `ls $libdir/*.ixlibrary 2>/dev/null`; do libname=`$echo "X$lib" | $Xsed -e '\''s%^.*/\([^/]*\)\.ixlibrary$%\1%'\''`; test $rm /sys/libs/${libname}_ixlibrary.a; $show "cd /sys/libs && $LN_S $lib ${libname}_ixlibrary.a"; cd /sys/libs && $LN_S $lib ${libname}_ixlibrary.a || exit 1; done'
-  ;;
-
-beos*)
-  library_names_spec='${libname}${shared_ext}'
-  dynamic_linker="$host_os ld.so"
-  shlibpath_var=LIBRARY_PATH
-  ;;
-
-bsdi4*)
-  version_type=linux
-  need_version=no
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-  soname_spec='${libname}${release}${shared_ext}$major'
-  finish_cmds='PATH="\$PATH:/sbin" ldconfig $libdir'
-  shlibpath_var=LD_LIBRARY_PATH
-  sys_lib_search_path_spec="/shlib /usr/lib /usr/X11/lib /usr/contrib/lib /lib /usr/local/lib"
-  sys_lib_dlsearch_path_spec="/shlib /usr/lib /usr/local/lib"
-  # the default ld.so.conf also contains /usr/contrib/lib and
-  # /usr/X11R6/lib (/usr/X11 is a link to /usr/X11R6), but let us allow
-  # libtool to hard-code these into programs
-  ;;
-
-cygwin* | mingw* | pw32*)
-  version_type=windows
-  shrext_cmds=".dll"
-  need_version=no
-  need_lib_prefix=no
-
-  case $GCC,$host_os in
-  yes,cygwin* | yes,mingw* | yes,pw32*)
-    library_names_spec='$libname.dll.a'
-    # DLL is installed to $(libdir)/../bin by postinstall_cmds
-    postinstall_cmds='base_file=`basename \${file}`~
-      dlpath=`$SHELL 2>&1 -c '\''. $dir/'\''\${base_file}'\''i;echo \$dlname'\''`~
-      dldir=$destdir/`dirname \$dlpath`~
-      test -d \$dldir || mkdir -p \$dldir~
-      $install_prog $dir/$dlname \$dldir/$dlname'
-    postuninstall_cmds='dldll=`$SHELL 2>&1 -c '\''. $file; echo \$dlname'\''`~
-      dlpath=$dir/\$dldll~
-       $rm \$dlpath'
-    shlibpath_overrides_runpath=yes
-
-    case $host_os in
-    cygwin*)
-      # Cygwin DLLs use 'cyg' prefix rather than 'lib'
-      soname_spec='`echo ${libname} | sed -e 's/^lib/cyg/'``echo ${release} | $SED -e 's/[.]/-/g'`${versuffix}${shared_ext}'
-      sys_lib_search_path_spec="/usr/lib /lib/w32api /lib /usr/local/lib"
-      ;;
-    mingw*)
-      # MinGW DLLs use traditional 'lib' prefix
-      soname_spec='${libname}`echo ${release} | $SED -e 's/[.]/-/g'`${versuffix}${shared_ext}'
-      sys_lib_search_path_spec=`$CC -print-search-dirs | grep "^libraries:" | $SED -e "s/^libraries://" -e "s,=/,/,g"`
-      if echo "$sys_lib_search_path_spec" | grep ';[c-zC-Z]:/' >/dev/null; then
-        # It is most probably a Windows format PATH printed by
-        # mingw gcc, but we are running on Cygwin. Gcc prints its search
-        # path with ; separators, and with drive letters. We can handle the
-        # drive letters (cygwin fileutils understands them), so leave them,
-        # especially as we might pass files found there to a mingw objdump,
-        # which wouldn't understand a cygwinified path. Ahh.
-        sys_lib_search_path_spec=`echo "$sys_lib_search_path_spec" | $SED -e 's/;/ /g'`
-      else
-        sys_lib_search_path_spec=`echo "$sys_lib_search_path_spec" | $SED  -e "s/$PATH_SEPARATOR/ /g"`
-      fi
-      ;;
-    pw32*)
-      # pw32 DLLs use 'pw' prefix rather than 'lib'
-      library_names_spec='`echo ${libname} | sed -e 's/^lib/pw/'``echo ${release} | $SED -e 's/./-/g'`${versuffix}${shared_ext}'
-      ;;
-    esac
-    ;;
-
-  *)
-    library_names_spec='${libname}`echo ${release} | $SED -e 's/[.]/-/g'`${versuffix}${shared_ext} $libname.lib'
-    ;;
-  esac
-  dynamic_linker='Win32 ld.exe'
-  # FIXME: first we should search . and the directory the executable is in
-  shlibpath_var=PATH
-  ;;
-
-darwin* | rhapsody*)
-  dynamic_linker="$host_os dyld"
-  version_type=darwin
-  need_lib_prefix=no
-  need_version=no
-  library_names_spec='${libname}${release}${versuffix}$shared_ext ${libname}${release}${major}$shared_ext ${libname}$shared_ext'
-  soname_spec='${libname}${release}${major}$shared_ext'
-  shlibpath_overrides_runpath=yes
-  shlibpath_var=DYLD_LIBRARY_PATH
-  shrext_cmds='$(test .$module = .yes && echo .so || echo .dylib)'
-  # Apple's gcc prints 'gcc -print-search-dirs' doesn't operate the same.
-  if test "$GCC" = yes; then
-    sys_lib_search_path_spec=`$CC -print-search-dirs | tr "\n" "$PATH_SEPARATOR" | sed -e 's/libraries:/@libraries:/' | tr "@" "\n" | grep "^libraries:" | sed -e "s/^libraries://" -e "s,=/,/,g" -e "s,$PATH_SEPARATOR, ,g" -e "s,.*,& /lib /usr/lib /usr/local/lib,g"`
-  else
-    sys_lib_search_path_spec='/lib /usr/lib /usr/local/lib'
-  fi
-  sys_lib_dlsearch_path_spec='/usr/local/lib /lib /usr/lib'
-  ;;
-
-dgux*)
-  version_type=linux
-  need_lib_prefix=no
-  need_version=no
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname$shared_ext'
-  soname_spec='${libname}${release}${shared_ext}$major'
-  shlibpath_var=LD_LIBRARY_PATH
-  ;;
-
-freebsd1*)
-  dynamic_linker=no
-  ;;
-
-kfreebsd*-gnu)
-  version_type=linux
-  need_lib_prefix=no
-  need_version=no
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${shared_ext}'
-  soname_spec='${libname}${release}${shared_ext}$major'
-  shlibpath_var=LD_LIBRARY_PATH
-  shlibpath_overrides_runpath=no
-  hardcode_into_libs=yes
-  dynamic_linker='GNU ld.so'
-  ;;
-
-freebsd*)
-  objformat=`test -x /usr/bin/objformat && /usr/bin/objformat || echo aout`
-  version_type=freebsd-$objformat
-  case $version_type in
-    freebsd-elf*)
-      library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext} $libname${shared_ext}'
-      need_version=no
-      need_lib_prefix=no
-      ;;
-    freebsd-*)
-      library_names_spec='${libname}${release}${shared_ext}$versuffix $libname${shared_ext}$versuffix'
-      need_version=yes
-      ;;
-  esac
-  shlibpath_var=LD_LIBRARY_PATH
-  case $host_os in
-  freebsd2*)
-    shlibpath_overrides_runpath=yes
-    ;;
-  freebsd3.01* | freebsdelf3.01*)
-    shlibpath_overrides_runpath=yes
-    hardcode_into_libs=yes
-    ;;
-  *) # from 3.2 on
-    shlibpath_overrides_runpath=no
-    hardcode_into_libs=yes
-    ;;
-  esac
-  ;;
-
-gnu*)
-  version_type=linux
-  need_lib_prefix=no
-  need_version=no
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}${major} ${libname}${shared_ext}'
-  soname_spec='${libname}${release}${shared_ext}$major'
-  shlibpath_var=LD_LIBRARY_PATH
-  hardcode_into_libs=yes
-  ;;
-
-hpux9* | hpux10* | hpux11*)
-  # Give a soname corresponding to the major version so that dld.sl refuses to
-  # link against other versions.
-  version_type=sunos
-  need_lib_prefix=no
-  need_version=no
-  case "$host_cpu" in
-  ia64*)
-    shrext_cmds='.so'
-    hardcode_into_libs=yes
-    dynamic_linker="$host_os dld.so"
-    shlibpath_var=LD_LIBRARY_PATH
-    shlibpath_overrides_runpath=yes # Unless +noenvvar is specified.
-    library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-    soname_spec='${libname}${release}${shared_ext}$major'
-    if test "X$HPUX_IA64_MODE" = X32; then
-      sys_lib_search_path_spec="/usr/lib/hpux32 /usr/local/lib/hpux32 /usr/local/lib"
-    else
-      sys_lib_search_path_spec="/usr/lib/hpux64 /usr/local/lib/hpux64"
-    fi
-    sys_lib_dlsearch_path_spec=$sys_lib_search_path_spec
-    ;;
-   hppa*64*)
-     shrext_cmds='.sl'
-     hardcode_into_libs=yes
-     dynamic_linker="$host_os dld.sl"
-     shlibpath_var=LD_LIBRARY_PATH # How should we handle SHLIB_PATH
-     shlibpath_overrides_runpath=yes # Unless +noenvvar is specified.
-     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-     soname_spec='${libname}${release}${shared_ext}$major'
-     sys_lib_search_path_spec="/usr/lib/pa20_64 /usr/ccs/lib/pa20_64"
-     sys_lib_dlsearch_path_spec=$sys_lib_search_path_spec
-     ;;
-   *)
-    shrext_cmds='.sl'
-    dynamic_linker="$host_os dld.sl"
-    shlibpath_var=SHLIB_PATH
-    shlibpath_overrides_runpath=no # +s is required to enable SHLIB_PATH
-    library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-    soname_spec='${libname}${release}${shared_ext}$major'
-    ;;
-  esac
-  # HP-UX runs *really* slowly unless shared libraries are mode 555.
-  postinstall_cmds='chmod 555 $lib'
-  ;;
-
-irix5* | irix6* | nonstopux*)
-  case $host_os in
-    nonstopux*) version_type=nonstopux ;;
-    *)
-	if test "$lt_cv_prog_gnu_ld" = yes; then
-		version_type=linux
-	else
-		version_type=irix
-	fi ;;
-  esac
-  need_lib_prefix=no
-  need_version=no
-  soname_spec='${libname}${release}${shared_ext}$major'
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${release}${shared_ext} $libname${shared_ext}'
-  case $host_os in
-  irix5* | nonstopux*)
-    libsuff= shlibsuff=
-    ;;
-  *)
-    case $LD in # libtool.m4 will add one of these switches to LD
-    *-32|*"-32 "|*-melf32bsmip|*"-melf32bsmip ")
-      libsuff= shlibsuff= libmagic=32-bit;;
-    *-n32|*"-n32 "|*-melf32bmipn32|*"-melf32bmipn32 ")
-      libsuff=32 shlibsuff=N32 libmagic=N32;;
-    *-64|*"-64 "|*-melf64bmip|*"-melf64bmip ")
-      libsuff=64 shlibsuff=64 libmagic=64-bit;;
-    *) libsuff= shlibsuff= libmagic=never-match;;
-    esac
-    ;;
-  esac
-  shlibpath_var=LD_LIBRARY${shlibsuff}_PATH
-  shlibpath_overrides_runpath=no
-  sys_lib_search_path_spec="/usr/lib${libsuff} /lib${libsuff} /usr/local/lib${libsuff}"
-  sys_lib_dlsearch_path_spec="/usr/lib${libsuff} /lib${libsuff}"
-  hardcode_into_libs=yes
-  ;;
-
-# No shared lib support for Linux oldld, aout, or coff.
-linux*oldld* | linux*aout* | linux*coff*)
-  dynamic_linker=no
-  ;;
-
-# This must be Linux ELF.
-linux*)
-  version_type=linux
-  need_lib_prefix=no
-  need_version=no
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-  soname_spec='${libname}${release}${shared_ext}$major'
-  finish_cmds='PATH="\$PATH:/sbin" ldconfig -n $libdir'
-  shlibpath_var=LD_LIBRARY_PATH
-  shlibpath_overrides_runpath=no
-  # This implies no fast_install, which is unacceptable.
-  # Some rework will be needed to allow for fast_install
-  # before this can be enabled.
-  hardcode_into_libs=yes
-
-  # Append ld.so.conf contents to the search path
-  if test -f /etc/ld.so.conf; then
-    lt_ld_extra=`$SED -e 's/:,\t/ /g;s/=^=*$//;s/=^= * / /g' /etc/ld.so.conf | tr '\n' ' '`
-    sys_lib_dlsearch_path_spec="/lib /usr/lib $lt_ld_extra"
-  fi
-
-  # We used to test for /lib/ld.so.1 and disable shared libraries on
-  # powerpc, because MkLinux only supported shared libraries with the
-  # GNU dynamic linker.  Since this was broken with cross compilers,
-  # most powerpc-linux boxes support dynamic linking these days and
-  # people can always --disable-shared, the test was removed, and we
-  # assume the GNU/Linux dynamic linker is in use.
-  dynamic_linker='GNU/Linux ld.so'
-  ;;
-
-netbsdelf*-gnu)
-  version_type=linux
-  need_lib_prefix=no
-  need_version=no
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${shared_ext}'
-  soname_spec='${libname}${release}${shared_ext}$major'
-  shlibpath_var=LD_LIBRARY_PATH
-  shlibpath_overrides_runpath=no
-  hardcode_into_libs=yes
-  dynamic_linker='NetBSD ld.elf_so'
-  ;;
-
-knetbsd*-gnu)
-  version_type=linux
-  need_lib_prefix=no
-  need_version=no
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${shared_ext}'
-  soname_spec='${libname}${release}${shared_ext}$major'
-  shlibpath_var=LD_LIBRARY_PATH
-  shlibpath_overrides_runpath=no
-  hardcode_into_libs=yes
-  dynamic_linker='GNU ld.so'
-  ;;
-
-netbsd*)
-  version_type=sunos
-  need_lib_prefix=no
-  need_version=no
-  if echo __ELF__ | $CC -E - | grep __ELF__ >/dev/null; then
-    library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
-    finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
-    dynamic_linker='NetBSD (a.out) ld.so'
-  else
-    library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${shared_ext}'
-    soname_spec='${libname}${release}${shared_ext}$major'
-    dynamic_linker='NetBSD ld.elf_so'
-  fi
-  shlibpath_var=LD_LIBRARY_PATH
-  shlibpath_overrides_runpath=yes
-  hardcode_into_libs=yes
-  ;;
-
-newsos6)
-  version_type=linux
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-  shlibpath_var=LD_LIBRARY_PATH
-  shlibpath_overrides_runpath=yes
-  ;;
-
-nto-qnx*)
-  version_type=linux
-  need_lib_prefix=no
-  need_version=no
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-  soname_spec='${libname}${release}${shared_ext}$major'
-  shlibpath_var=LD_LIBRARY_PATH
-  shlibpath_overrides_runpath=yes
-  ;;
-
-openbsd*)
-  version_type=sunos
-  need_lib_prefix=no
-  need_version=yes
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
-  finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
-  shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
-    case $host_os in
-      openbsd2.[89] | openbsd2.[89].*)
-	shlibpath_overrides_runpath=no
-	;;
-      *)
-	shlibpath_overrides_runpath=yes
-	;;
-      esac
-  else
-    shlibpath_overrides_runpath=yes
-  fi
-  ;;
-
-os2*)
-  libname_spec='$name'
-  shrext_cmds=".dll"
-  need_lib_prefix=no
-  library_names_spec='$libname${shared_ext} $libname.a'
-  dynamic_linker='OS/2 ld.exe'
-  shlibpath_var=LIBPATH
-  ;;
-
-osf3* | osf4* | osf5*)
-  version_type=osf
-  need_lib_prefix=no
-  need_version=no
-  soname_spec='${libname}${release}${shared_ext}$major'
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-  shlibpath_var=LD_LIBRARY_PATH
-  sys_lib_search_path_spec="/usr/shlib /usr/ccs/lib /usr/lib/cmplrs/cc /usr/lib /usr/local/lib /var/shlib"
-  sys_lib_dlsearch_path_spec="$sys_lib_search_path_spec"
-  ;;
-
-sco3.2v5*)
-  version_type=osf
-  soname_spec='${libname}${release}${shared_ext}$major'
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-  shlibpath_var=LD_LIBRARY_PATH
-  ;;
-
-solaris*)
-  version_type=linux
-  need_lib_prefix=no
-  need_version=no
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-  soname_spec='${libname}${release}${shared_ext}$major'
-  shlibpath_var=LD_LIBRARY_PATH
-  shlibpath_overrides_runpath=yes
-  hardcode_into_libs=yes
-  # ldd complains unless libraries are executable
-  postinstall_cmds='chmod +x $lib'
-  ;;
-
-sunos4*)
-  version_type=sunos
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
-  finish_cmds='PATH="\$PATH:/usr/etc" ldconfig $libdir'
-  shlibpath_var=LD_LIBRARY_PATH
-  shlibpath_overrides_runpath=yes
-  if test "$with_gnu_ld" = yes; then
-    need_lib_prefix=no
-  fi
-  need_version=yes
-  ;;
-
-sysv4 | sysv4.2uw2* | sysv4.3* | sysv5*)
-  version_type=linux
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-  soname_spec='${libname}${release}${shared_ext}$major'
-  shlibpath_var=LD_LIBRARY_PATH
-  case $host_vendor in
-    sni)
-      shlibpath_overrides_runpath=no
-      need_lib_prefix=no
-      export_dynamic_flag_spec='${wl}-Blargedynsym'
-      runpath_var=LD_RUN_PATH
-      ;;
-    siemens)
-      need_lib_prefix=no
-      ;;
-    motorola)
-      need_lib_prefix=no
-      need_version=no
-      shlibpath_overrides_runpath=no
-      sys_lib_search_path_spec='/lib /usr/lib /usr/ccs/lib'
-      ;;
-  esac
-  ;;
-
-sysv4*MP*)
-  if test -d /usr/nec ;then
-    version_type=linux
-    library_names_spec='$libname${shared_ext}.$versuffix $libname${shared_ext}.$major $libname${shared_ext}'
-    soname_spec='$libname${shared_ext}.$major'
-    shlibpath_var=LD_LIBRARY_PATH
-  fi
-  ;;
-
-uts4*)
-  version_type=linux
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-  soname_spec='${libname}${release}${shared_ext}$major'
-  shlibpath_var=LD_LIBRARY_PATH
-  ;;
-
-*)
-  dynamic_linker=no
-  ;;
-esac
-echo "$as_me:$LINENO: result: $dynamic_linker" >&5
-echo "${ECHO_T}$dynamic_linker" >&6
-test "$dynamic_linker" = no && can_build_shared=no
-
-echo "$as_me:$LINENO: checking how to hardcode library paths into programs" >&5
-echo $ECHO_N "checking how to hardcode library paths into programs... $ECHO_C" >&6
-hardcode_action_CXX=
-if test -n "$hardcode_libdir_flag_spec_CXX" || \
-   test -n "$runpath_var CXX" || \
-   test "X$hardcode_automatic_CXX"="Xyes" ; then
-
-  # We can hardcode non-existant directories.
-  if test "$hardcode_direct_CXX" != no &&
-     # If the only mechanism to avoid hardcoding is shlibpath_var, we
-     # have to relink, otherwise we might link with an installed library
-     # when we should be linking with a yet-to-be-installed one
-     ## test "$_LT_AC_TAGVAR(hardcode_shlibpath_var, CXX)" != no &&
-     test "$hardcode_minus_L_CXX" != no; then
-    # Linking always hardcodes the temporary library directory.
-    hardcode_action_CXX=relink
-  else
-    # We can link without hardcoding, and we can hardcode nonexisting dirs.
-    hardcode_action_CXX=immediate
-  fi
-else
-  # We cannot hardcode anything, or else we can only hardcode existing
-  # directories.
-  hardcode_action_CXX=unsupported
-fi
-echo "$as_me:$LINENO: result: $hardcode_action_CXX" >&5
-echo "${ECHO_T}$hardcode_action_CXX" >&6
-
-if test "$hardcode_action_CXX" = relink; then
-  # Fast installation is not supported
-  enable_fast_install=no
-elif test "$shlibpath_overrides_runpath" = yes ||
-     test "$enable_shared" = no; then
-  # Fast installation is not necessary
-  enable_fast_install=needless
-fi
-
-striplib=
-old_striplib=
-echo "$as_me:$LINENO: checking whether stripping libraries is possible" >&5
-echo $ECHO_N "checking whether stripping libraries is possible... $ECHO_C" >&6
-if test -n "$STRIP" && $STRIP -V 2>&1 | grep "GNU strip" >/dev/null; then
-  test -z "$old_striplib" && old_striplib="$STRIP --strip-debug"
-  test -z "$striplib" && striplib="$STRIP --strip-unneeded"
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
-else
-# FIXME - insert some real tests, host_os isn't really good enough
-  case $host_os in
-   darwin*)
-       if test -n "$STRIP" ; then
-         striplib="$STRIP -x"
-         echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
-       else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi
-       ;;
-   *)
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-    ;;
-  esac
-fi
-
-if test "x$enable_dlopen" != xyes; then
-  enable_dlopen=unknown
-  enable_dlopen_self=unknown
-  enable_dlopen_self_static=unknown
-else
-  lt_cv_dlopen=no
-  lt_cv_dlopen_libs=
-
-  case $host_os in
-  beos*)
-    lt_cv_dlopen="load_add_on"
-    lt_cv_dlopen_libs=
-    lt_cv_dlopen_self=yes
-    ;;
-
-  mingw* | pw32*)
-    lt_cv_dlopen="LoadLibrary"
-    lt_cv_dlopen_libs=
-   ;;
-
-  cygwin*)
-    lt_cv_dlopen="dlopen"
-    lt_cv_dlopen_libs=
-   ;;
-
-  darwin*)
-  # if libdl is installed we need to link against it
-    echo "$as_me:$LINENO: checking for dlopen in -ldl" >&5
-echo $ECHO_N "checking for dlopen in -ldl... $ECHO_C" >&6
-if test "${ac_cv_lib_dl_dlopen+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  ac_check_lib_save_LIBS=$LIBS
-LIBS="-ldl  $LIBS"
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-/* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char dlopen ();
-int
-main ()
-{
-dlopen ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_cxx_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_lib_dl_dlopen=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_cv_lib_dl_dlopen=no
-fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_dl_dlopen" >&5
-echo "${ECHO_T}$ac_cv_lib_dl_dlopen" >&6
-if test $ac_cv_lib_dl_dlopen = yes; then
-  lt_cv_dlopen="dlopen" lt_cv_dlopen_libs="-ldl"
-else
-
-    lt_cv_dlopen="dyld"
-    lt_cv_dlopen_libs=
-    lt_cv_dlopen_self=yes
-
-fi
-
-   ;;
-
-  *)
-    echo "$as_me:$LINENO: checking for shl_load" >&5
-echo $ECHO_N "checking for shl_load... $ECHO_C" >&6
-if test "${ac_cv_func_shl_load+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-/* Define shl_load to an innocuous variant, in case <limits.h> declares shl_load.
-   For example, HP-UX 11i <limits.h> declares gettimeofday.  */
-#define shl_load innocuous_shl_load
-
-/* System header to define __stub macros and hopefully few prototypes,
-    which can conflict with char shl_load (); below.
-    Prefer <limits.h> to <assert.h> if __STDC__ is defined, since
-    <limits.h> exists even on freestanding compilers.  */
-
-#ifdef __STDC__
-# include <limits.h>
-#else
-# include <assert.h>
-#endif
-
-#undef shl_load
-
-/* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-{
-#endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char shl_load ();
-/* The GNU C library defines this for functions which it implements
-    to always fail with ENOSYS.  Some functions are actually named
-    something starting with __ and the normal name is an alias.  */
-#if defined (__stub_shl_load) || defined (__stub___shl_load)
-choke me
-#else
-char (*f) () = shl_load;
-#endif
-#ifdef __cplusplus
-}
-#endif
-
-int
-main ()
-{
-return f != shl_load;
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_cxx_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_func_shl_load=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_cv_func_shl_load=no
-fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-fi
-echo "$as_me:$LINENO: result: $ac_cv_func_shl_load" >&5
-echo "${ECHO_T}$ac_cv_func_shl_load" >&6
-if test $ac_cv_func_shl_load = yes; then
-  lt_cv_dlopen="shl_load"
-else
-  echo "$as_me:$LINENO: checking for shl_load in -ldld" >&5
-echo $ECHO_N "checking for shl_load in -ldld... $ECHO_C" >&6
-if test "${ac_cv_lib_dld_shl_load+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  ac_check_lib_save_LIBS=$LIBS
-LIBS="-ldld  $LIBS"
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-/* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char shl_load ();
-int
-main ()
-{
-shl_load ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_cxx_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_lib_dld_shl_load=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_cv_lib_dld_shl_load=no
-fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_dld_shl_load" >&5
-echo "${ECHO_T}$ac_cv_lib_dld_shl_load" >&6
-if test $ac_cv_lib_dld_shl_load = yes; then
-  lt_cv_dlopen="shl_load" lt_cv_dlopen_libs="-dld"
-else
-  echo "$as_me:$LINENO: checking for dlopen" >&5
-echo $ECHO_N "checking for dlopen... $ECHO_C" >&6
-if test "${ac_cv_func_dlopen+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-/* Define dlopen to an innocuous variant, in case <limits.h> declares dlopen.
-   For example, HP-UX 11i <limits.h> declares gettimeofday.  */
-#define dlopen innocuous_dlopen
-
-/* System header to define __stub macros and hopefully few prototypes,
-    which can conflict with char dlopen (); below.
-    Prefer <limits.h> to <assert.h> if __STDC__ is defined, since
-    <limits.h> exists even on freestanding compilers.  */
-
-#ifdef __STDC__
-# include <limits.h>
-#else
-# include <assert.h>
-#endif
-
-#undef dlopen
-
-/* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-{
-#endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char dlopen ();
-/* The GNU C library defines this for functions which it implements
-    to always fail with ENOSYS.  Some functions are actually named
-    something starting with __ and the normal name is an alias.  */
-#if defined (__stub_dlopen) || defined (__stub___dlopen)
-choke me
-#else
-char (*f) () = dlopen;
-#endif
-#ifdef __cplusplus
-}
-#endif
-
-int
-main ()
-{
-return f != dlopen;
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_cxx_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_func_dlopen=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_cv_func_dlopen=no
-fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-fi
-echo "$as_me:$LINENO: result: $ac_cv_func_dlopen" >&5
-echo "${ECHO_T}$ac_cv_func_dlopen" >&6
-if test $ac_cv_func_dlopen = yes; then
-  lt_cv_dlopen="dlopen"
-else
-  echo "$as_me:$LINENO: checking for dlopen in -ldl" >&5
-echo $ECHO_N "checking for dlopen in -ldl... $ECHO_C" >&6
-if test "${ac_cv_lib_dl_dlopen+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  ac_check_lib_save_LIBS=$LIBS
-LIBS="-ldl  $LIBS"
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-/* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char dlopen ();
-int
-main ()
-{
-dlopen ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_cxx_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_lib_dl_dlopen=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_cv_lib_dl_dlopen=no
-fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_dl_dlopen" >&5
-echo "${ECHO_T}$ac_cv_lib_dl_dlopen" >&6
-if test $ac_cv_lib_dl_dlopen = yes; then
-  lt_cv_dlopen="dlopen" lt_cv_dlopen_libs="-ldl"
-else
-  echo "$as_me:$LINENO: checking for dlopen in -lsvld" >&5
-echo $ECHO_N "checking for dlopen in -lsvld... $ECHO_C" >&6
-if test "${ac_cv_lib_svld_dlopen+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  ac_check_lib_save_LIBS=$LIBS
-LIBS="-lsvld  $LIBS"
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-/* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char dlopen ();
-int
-main ()
-{
-dlopen ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_cxx_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_lib_svld_dlopen=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_cv_lib_svld_dlopen=no
-fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_svld_dlopen" >&5
-echo "${ECHO_T}$ac_cv_lib_svld_dlopen" >&6
-if test $ac_cv_lib_svld_dlopen = yes; then
-  lt_cv_dlopen="dlopen" lt_cv_dlopen_libs="-lsvld"
-else
-  echo "$as_me:$LINENO: checking for dld_link in -ldld" >&5
-echo $ECHO_N "checking for dld_link in -ldld... $ECHO_C" >&6
-if test "${ac_cv_lib_dld_dld_link+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  ac_check_lib_save_LIBS=$LIBS
-LIBS="-ldld  $LIBS"
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-/* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char dld_link ();
-int
-main ()
-{
-dld_link ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_cxx_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_lib_dld_dld_link=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_cv_lib_dld_dld_link=no
-fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_dld_dld_link" >&5
-echo "${ECHO_T}$ac_cv_lib_dld_dld_link" >&6
-if test $ac_cv_lib_dld_dld_link = yes; then
-  lt_cv_dlopen="dld_link" lt_cv_dlopen_libs="-dld"
-fi
-
-
-fi
-
-
-fi
-
-
-fi
-
-
-fi
-
-
-fi
-
-    ;;
-  esac
-
-  if test "x$lt_cv_dlopen" != xno; then
-    enable_dlopen=yes
-  else
-    enable_dlopen=no
-  fi
-
-  case $lt_cv_dlopen in
-  dlopen)
-    save_CPPFLAGS="$CPPFLAGS"
-    test "x$ac_cv_header_dlfcn_h" = xyes && CPPFLAGS="$CPPFLAGS -DHAVE_DLFCN_H"
-
-    save_LDFLAGS="$LDFLAGS"
-    eval LDFLAGS=\"\$LDFLAGS $export_dynamic_flag_spec\"
-
-    save_LIBS="$LIBS"
-    LIBS="$lt_cv_dlopen_libs $LIBS"
-
-    echo "$as_me:$LINENO: checking whether a program can dlopen itself" >&5
-echo $ECHO_N "checking whether a program can dlopen itself... $ECHO_C" >&6
-if test "${lt_cv_dlopen_self+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  	  if test "$cross_compiling" = yes; then :
-  lt_cv_dlopen_self=cross
-else
-  lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
-  lt_status=$lt_dlunknown
-  cat > conftest.$ac_ext <<EOF
-#line 12643 "configure"
-#include "confdefs.h"
-
-#if HAVE_DLFCN_H
-#include <dlfcn.h>
-#endif
-
-#include <stdio.h>
-
-#ifdef RTLD_GLOBAL
-#  define LT_DLGLOBAL		RTLD_GLOBAL
-#else
-#  ifdef DL_GLOBAL
-#    define LT_DLGLOBAL		DL_GLOBAL
-#  else
-#    define LT_DLGLOBAL		0
-#  endif
-#endif
-
-/* We may have to define LT_DLLAZY_OR_NOW in the command line if we
-   find out it does not work in some platform. */
-#ifndef LT_DLLAZY_OR_NOW
-#  ifdef RTLD_LAZY
-#    define LT_DLLAZY_OR_NOW		RTLD_LAZY
-#  else
-#    ifdef DL_LAZY
-#      define LT_DLLAZY_OR_NOW		DL_LAZY
-#    else
-#      ifdef RTLD_NOW
-#        define LT_DLLAZY_OR_NOW	RTLD_NOW
-#      else
-#        ifdef DL_NOW
-#          define LT_DLLAZY_OR_NOW	DL_NOW
-#        else
-#          define LT_DLLAZY_OR_NOW	0
-#        endif
-#      endif
-#    endif
-#  endif
-#endif
-
-#ifdef __cplusplus
-extern "C" void exit (int);
-#endif
-
-void fnord() { int i=42;}
-int main ()
-{
-  void *self = dlopen (0, LT_DLGLOBAL|LT_DLLAZY_OR_NOW);
-  int status = $lt_dlunknown;
-
-  if (self)
-    {
-      if (dlsym (self,"fnord"))       status = $lt_dlno_uscore;
-      else if (dlsym( self,"_fnord")) status = $lt_dlneed_uscore;
-      /* dlclose (self); */
-    }
-
-    exit (status);
-}
-EOF
-  if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && test -s conftest${ac_exeext} 2>/dev/null; then
-    (./conftest; exit; ) 2>/dev/null
-    lt_status=$?
-    case x$lt_status in
-      x$lt_dlno_uscore) lt_cv_dlopen_self=yes ;;
-      x$lt_dlneed_uscore) lt_cv_dlopen_self=yes ;;
-      x$lt_unknown|x*) lt_cv_dlopen_self=no ;;
-    esac
-  else :
-    # compilation failed
-    lt_cv_dlopen_self=no
-  fi
-fi
-rm -fr conftest*
-
-
-fi
-echo "$as_me:$LINENO: result: $lt_cv_dlopen_self" >&5
-echo "${ECHO_T}$lt_cv_dlopen_self" >&6
-
-    if test "x$lt_cv_dlopen_self" = xyes; then
-      LDFLAGS="$LDFLAGS $link_static_flag"
-      echo "$as_me:$LINENO: checking whether a statically linked program can dlopen itself" >&5
-echo $ECHO_N "checking whether a statically linked program can dlopen itself... $ECHO_C" >&6
-if test "${lt_cv_dlopen_self_static+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  	  if test "$cross_compiling" = yes; then :
-  lt_cv_dlopen_self_static=cross
-else
-  lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
-  lt_status=$lt_dlunknown
-  cat > conftest.$ac_ext <<EOF
-#line 12741 "configure"
-#include "confdefs.h"
-
-#if HAVE_DLFCN_H
-#include <dlfcn.h>
-#endif
-
-#include <stdio.h>
-
-#ifdef RTLD_GLOBAL
-#  define LT_DLGLOBAL		RTLD_GLOBAL
-#else
-#  ifdef DL_GLOBAL
-#    define LT_DLGLOBAL		DL_GLOBAL
-#  else
-#    define LT_DLGLOBAL		0
-#  endif
-#endif
-
-/* We may have to define LT_DLLAZY_OR_NOW in the command line if we
-   find out it does not work in some platform. */
-#ifndef LT_DLLAZY_OR_NOW
-#  ifdef RTLD_LAZY
-#    define LT_DLLAZY_OR_NOW		RTLD_LAZY
-#  else
-#    ifdef DL_LAZY
-#      define LT_DLLAZY_OR_NOW		DL_LAZY
-#    else
-#      ifdef RTLD_NOW
-#        define LT_DLLAZY_OR_NOW	RTLD_NOW
-#      else
-#        ifdef DL_NOW
-#          define LT_DLLAZY_OR_NOW	DL_NOW
-#        else
-#          define LT_DLLAZY_OR_NOW	0
-#        endif
-#      endif
-#    endif
-#  endif
-#endif
-
-#ifdef __cplusplus
-extern "C" void exit (int);
-#endif
-
-void fnord() { int i=42;}
-int main ()
-{
-  void *self = dlopen (0, LT_DLGLOBAL|LT_DLLAZY_OR_NOW);
-  int status = $lt_dlunknown;
-
-  if (self)
-    {
-      if (dlsym (self,"fnord"))       status = $lt_dlno_uscore;
-      else if (dlsym( self,"_fnord")) status = $lt_dlneed_uscore;
-      /* dlclose (self); */
-    }
-
-    exit (status);
-}
-EOF
-  if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && test -s conftest${ac_exeext} 2>/dev/null; then
-    (./conftest; exit; ) 2>/dev/null
-    lt_status=$?
-    case x$lt_status in
-      x$lt_dlno_uscore) lt_cv_dlopen_self_static=yes ;;
-      x$lt_dlneed_uscore) lt_cv_dlopen_self_static=yes ;;
-      x$lt_unknown|x*) lt_cv_dlopen_self_static=no ;;
-    esac
-  else :
-    # compilation failed
-    lt_cv_dlopen_self_static=no
-  fi
-fi
-rm -fr conftest*
-
-
-fi
-echo "$as_me:$LINENO: result: $lt_cv_dlopen_self_static" >&5
-echo "${ECHO_T}$lt_cv_dlopen_self_static" >&6
-    fi
-
-    CPPFLAGS="$save_CPPFLAGS"
-    LDFLAGS="$save_LDFLAGS"
-    LIBS="$save_LIBS"
-    ;;
-  esac
-
-  case $lt_cv_dlopen_self in
-  yes|no) enable_dlopen_self=$lt_cv_dlopen_self ;;
-  *) enable_dlopen_self=unknown ;;
-  esac
-
-  case $lt_cv_dlopen_self_static in
-  yes|no) enable_dlopen_self_static=$lt_cv_dlopen_self_static ;;
-  *) enable_dlopen_self_static=unknown ;;
-  esac
-fi
-
-
-# The else clause should only fire when bootstrapping the
-# libtool distribution, otherwise you forgot to ship ltmain.sh
-# with your package, and you will get complaints that there are
-# no rules to generate ltmain.sh.
-if test -f "$ltmain"; then
-  # See if we are running on zsh, and set the options which allow our commands through
-  # without removal of \ escapes.
-  if test -n "${ZSH_VERSION+set}" ; then
-    setopt NO_GLOB_SUBST
-  fi
-  # Now quote all the things that may contain metacharacters while being
-  # careful not to overquote the AC_SUBSTed values.  We take copies of the
-  # variables and quote the copies for generation of the libtool script.
-  for var in echo old_CC old_CFLAGS AR AR_FLAGS EGREP RANLIB LN_S LTCC NM \
-    SED SHELL STRIP \
-    libname_spec library_names_spec soname_spec extract_expsyms_cmds \
-    old_striplib striplib file_magic_cmd finish_cmds finish_eval \
-    deplibs_check_method reload_flag reload_cmds need_locks \
-    lt_cv_sys_global_symbol_pipe lt_cv_sys_global_symbol_to_cdecl \
-    lt_cv_sys_global_symbol_to_c_name_address \
-    sys_lib_search_path_spec sys_lib_dlsearch_path_spec \
-    old_postinstall_cmds old_postuninstall_cmds \
-    compiler_CXX \
-    CC_CXX \
-    LD_CXX \
-    lt_prog_compiler_wl_CXX \
-    lt_prog_compiler_pic_CXX \
-    lt_prog_compiler_static_CXX \
-    lt_prog_compiler_no_builtin_flag_CXX \
-    export_dynamic_flag_spec_CXX \
-    thread_safe_flag_spec_CXX \
-    whole_archive_flag_spec_CXX \
-    enable_shared_with_static_runtimes_CXX \
-    old_archive_cmds_CXX \
-    old_archive_from_new_cmds_CXX \
-    predep_objects_CXX \
-    postdep_objects_CXX \
-    predeps_CXX \
-    postdeps_CXX \
-    compiler_lib_search_path_CXX \
-    archive_cmds_CXX \
-    archive_expsym_cmds_CXX \
-    postinstall_cmds_CXX \
-    postuninstall_cmds_CXX \
-    old_archive_from_expsyms_cmds_CXX \
-    allow_undefined_flag_CXX \
-    no_undefined_flag_CXX \
-    export_symbols_cmds_CXX \
-    hardcode_libdir_flag_spec_CXX \
-    hardcode_libdir_flag_spec_ld_CXX \
-    hardcode_libdir_separator_CXX \
-    hardcode_automatic_CXX \
-    module_cmds_CXX \
-    module_expsym_cmds_CXX \
-    lt_cv_prog_compiler_c_o_CXX \
-    exclude_expsyms_CXX \
-    include_expsyms_CXX; do
-
-    case $var in
-    old_archive_cmds_CXX | \
-    old_archive_from_new_cmds_CXX | \
-    archive_cmds_CXX | \
-    archive_expsym_cmds_CXX | \
-    module_cmds_CXX | \
-    module_expsym_cmds_CXX | \
-    old_archive_from_expsyms_cmds_CXX | \
-    export_symbols_cmds_CXX | \
-    extract_expsyms_cmds | reload_cmds | finish_cmds | \
-    postinstall_cmds | postuninstall_cmds | \
-    old_postinstall_cmds | old_postuninstall_cmds | \
-    sys_lib_search_path_spec | sys_lib_dlsearch_path_spec)
-      # Double-quote double-evaled strings.
-      eval "lt_$var=\\\"\`\$echo \"X\$$var\" | \$Xsed -e \"\$double_quote_subst\" -e \"\$sed_quote_subst\" -e \"\$delay_variable_subst\"\`\\\""
-      ;;
-    *)
-      eval "lt_$var=\\\"\`\$echo \"X\$$var\" | \$Xsed -e \"\$sed_quote_subst\"\`\\\""
-      ;;
-    esac
-  done
-
-  case $lt_echo in
-  *'\$0 --fallback-echo"')
-    lt_echo=`$echo "X$lt_echo" | $Xsed -e 's/\\\\\\\$0 --fallback-echo"$/$0 --fallback-echo"/'`
-    ;;
-  esac
-
-cfgfile="$ofile"
-
-  cat <<__EOF__ >> "$cfgfile"
-# ### BEGIN LIBTOOL TAG CONFIG: $tagname
-
-# Libtool was configured on host `(hostname || uname -n) 2>/dev/null | sed 1q`:
-
-# Shell to use when invoking shell scripts.
-SHELL=$lt_SHELL
-
-# Whether or not to build shared libraries.
-build_libtool_libs=$enable_shared
-
-# Whether or not to build static libraries.
-build_old_libs=$enable_static
-
-# Whether or not to add -lc for building shared libraries.
-build_libtool_need_lc=$archive_cmds_need_lc_CXX
-
-# Whether or not to disallow shared libs when runtime libs are static
-allow_libtool_libs_with_static_runtimes=$enable_shared_with_static_runtimes_CXX
-
-# Whether or not to optimize for fast installation.
-fast_install=$enable_fast_install
-
-# The host system.
-host_alias=$host_alias
-host=$host
-
-# An echo program that does not interpret backslashes.
-echo=$lt_echo
-
-# The archiver.
-AR=$lt_AR
-AR_FLAGS=$lt_AR_FLAGS
-
-# A C compiler.
-LTCC=$lt_LTCC
-
-# A language-specific compiler.
-CC=$lt_compiler_CXX
-
-# Is the compiler the GNU C compiler?
-with_gcc=$GCC_CXX
-
-# An ERE matcher.
-EGREP=$lt_EGREP
-
-# The linker used to build libraries.
-LD=$lt_LD_CXX
-
-# Whether we need hard or soft links.
-LN_S=$lt_LN_S
-
-# A BSD-compatible nm program.
-NM=$lt_NM
-
-# A symbol stripping program
-STRIP=$lt_STRIP
-
-# Used to examine libraries when file_magic_cmd begins "file"
-MAGIC_CMD=$MAGIC_CMD
-
-# Used on cygwin: DLL creation program.
-DLLTOOL="$DLLTOOL"
-
-# Used on cygwin: object dumper.
-OBJDUMP="$OBJDUMP"
-
-# Used on cygwin: assembler.
-AS="$AS"
-
-# The name of the directory that contains temporary libtool files.
-objdir=$objdir
-
-# How to create reloadable object files.
-reload_flag=$lt_reload_flag
-reload_cmds=$lt_reload_cmds
-
-# How to pass a linker flag through the compiler.
-wl=$lt_lt_prog_compiler_wl_CXX
-
-# Object file suffix (normally "o").
-objext="$ac_objext"
-
-# Old archive suffix (normally "a").
-libext="$libext"
-
-# Shared library suffix (normally ".so").
-shrext_cmds='$shrext_cmds'
-
-# Executable file suffix (normally "").
-exeext="$exeext"
-
-# Additional compiler flags for building library objects.
-pic_flag=$lt_lt_prog_compiler_pic_CXX
-pic_mode=$pic_mode
-
-# What is the maximum length of a command?
-max_cmd_len=$lt_cv_sys_max_cmd_len
-
-# Does compiler simultaneously support -c and -o options?
-compiler_c_o=$lt_lt_cv_prog_compiler_c_o_CXX
-
-# Must we lock files when doing compilation ?
-need_locks=$lt_need_locks
-
-# Do we need the lib prefix for modules?
-need_lib_prefix=$need_lib_prefix
-
-# Do we need a version for libraries?
-need_version=$need_version
-
-# Whether dlopen is supported.
-dlopen_support=$enable_dlopen
-
-# Whether dlopen of programs is supported.
-dlopen_self=$enable_dlopen_self
-
-# Whether dlopen of statically linked programs is supported.
-dlopen_self_static=$enable_dlopen_self_static
-
-# Compiler flag to prevent dynamic linking.
-link_static_flag=$lt_lt_prog_compiler_static_CXX
-
-# Compiler flag to turn off builtin functions.
-no_builtin_flag=$lt_lt_prog_compiler_no_builtin_flag_CXX
-
-# Compiler flag to allow reflexive dlopens.
-export_dynamic_flag_spec=$lt_export_dynamic_flag_spec_CXX
-
-# Compiler flag to generate shared objects directly from archives.
-whole_archive_flag_spec=$lt_whole_archive_flag_spec_CXX
-
-# Compiler flag to generate thread-safe objects.
-thread_safe_flag_spec=$lt_thread_safe_flag_spec_CXX
-
-# Library versioning type.
-version_type=$version_type
-
-# Format of library name prefix.
-libname_spec=$lt_libname_spec
-
-# List of archive names.  First name is the real one, the rest are links.
-# The last name is the one that the linker finds with -lNAME.
-library_names_spec=$lt_library_names_spec
-
-# The coded name of the library, if different from the real name.
-soname_spec=$lt_soname_spec
-
-# Commands used to build and install an old-style archive.
-RANLIB=$lt_RANLIB
-old_archive_cmds=$lt_old_archive_cmds_CXX
-old_postinstall_cmds=$lt_old_postinstall_cmds
-old_postuninstall_cmds=$lt_old_postuninstall_cmds
-
-# Create an old-style archive from a shared archive.
-old_archive_from_new_cmds=$lt_old_archive_from_new_cmds_CXX
-
-# Create a temporary old-style archive to link instead of a shared archive.
-old_archive_from_expsyms_cmds=$lt_old_archive_from_expsyms_cmds_CXX
-
-# Commands used to build and install a shared archive.
-archive_cmds=$lt_archive_cmds_CXX
-archive_expsym_cmds=$lt_archive_expsym_cmds_CXX
-postinstall_cmds=$lt_postinstall_cmds
-postuninstall_cmds=$lt_postuninstall_cmds
-
-# Commands used to build a loadable module (assumed same as above if empty)
-module_cmds=$lt_module_cmds_CXX
-module_expsym_cmds=$lt_module_expsym_cmds_CXX
-
-# Commands to strip libraries.
-old_striplib=$lt_old_striplib
-striplib=$lt_striplib
-
-# Dependencies to place before the objects being linked to create a
-# shared library.
-predep_objects=$lt_predep_objects_CXX
-
-# Dependencies to place after the objects being linked to create a
-# shared library.
-postdep_objects=$lt_postdep_objects_CXX
-
-# Dependencies to place before the objects being linked to create a
-# shared library.
-predeps=$lt_predeps_CXX
-
-# Dependencies to place after the objects being linked to create a
-# shared library.
-postdeps=$lt_postdeps_CXX
-
-# The library search path used internally by the compiler when linking
-# a shared library.
-compiler_lib_search_path=$lt_compiler_lib_search_path_CXX
-
-# Method to check whether dependent libraries are shared objects.
-deplibs_check_method=$lt_deplibs_check_method
-
-# Command to use when deplibs_check_method == file_magic.
-file_magic_cmd=$lt_file_magic_cmd
-
-# Flag that allows shared libraries with undefined symbols to be built.
-allow_undefined_flag=$lt_allow_undefined_flag_CXX
-
-# Flag that forces no undefined symbols.
-no_undefined_flag=$lt_no_undefined_flag_CXX
-
-# Commands used to finish a libtool library installation in a directory.
-finish_cmds=$lt_finish_cmds
-
-# Same as above, but a single script fragment to be evaled but not shown.
-finish_eval=$lt_finish_eval
-
-# Take the output of nm and produce a listing of raw symbols and C names.
-global_symbol_pipe=$lt_lt_cv_sys_global_symbol_pipe
-
-# Transform the output of nm in a proper C declaration
-global_symbol_to_cdecl=$lt_lt_cv_sys_global_symbol_to_cdecl
-
-# Transform the output of nm in a C name address pair
-global_symbol_to_c_name_address=$lt_lt_cv_sys_global_symbol_to_c_name_address
-
-# This is the shared library runtime path variable.
-runpath_var=$runpath_var
-
-# This is the shared library path variable.
-shlibpath_var=$shlibpath_var
-
-# Is shlibpath searched before the hard-coded library search path?
-shlibpath_overrides_runpath=$shlibpath_overrides_runpath
-
-# How to hardcode a shared library path into an executable.
-hardcode_action=$hardcode_action_CXX
-
-# Whether we should hardcode library paths into libraries.
-hardcode_into_libs=$hardcode_into_libs
-
-# Flag to hardcode \$libdir into a binary during linking.
-# This must work even if \$libdir does not exist.
-hardcode_libdir_flag_spec=$lt_hardcode_libdir_flag_spec_CXX
-
-# If ld is used when linking, flag to hardcode \$libdir into
-# a binary during linking. This must work even if \$libdir does
-# not exist.
-hardcode_libdir_flag_spec_ld=$lt_hardcode_libdir_flag_spec_ld_CXX
-
-# Whether we need a single -rpath flag with a separated argument.
-hardcode_libdir_separator=$lt_hardcode_libdir_separator_CXX
-
-# Set to yes if using DIR/libNAME${shared_ext} during linking hardcodes DIR into the
-# resulting binary.
-hardcode_direct=$hardcode_direct_CXX
-
-# Set to yes if using the -LDIR flag during linking hardcodes DIR into the
-# resulting binary.
-hardcode_minus_L=$hardcode_minus_L_CXX
-
-# Set to yes if using SHLIBPATH_VAR=DIR during linking hardcodes DIR into
-# the resulting binary.
-hardcode_shlibpath_var=$hardcode_shlibpath_var_CXX
-
-# Set to yes if building a shared library automatically hardcodes DIR into the library
-# and all subsequent libraries and executables linked against it.
-hardcode_automatic=$hardcode_automatic_CXX
-
-# Variables whose values should be saved in libtool wrapper scripts and
-# restored at relink time.
-variables_saved_for_relink="$variables_saved_for_relink"
-
-# Whether libtool must link a program against all its dependency libraries.
-link_all_deplibs=$link_all_deplibs_CXX
-
-# Compile-time system search path for libraries
-sys_lib_search_path_spec=$lt_sys_lib_search_path_spec
-
-# Run-time system search path for libraries
-sys_lib_dlsearch_path_spec=$lt_sys_lib_dlsearch_path_spec
-
-# Fix the shell variable \$srcfile for the compiler.
-fix_srcfile_path="$fix_srcfile_path_CXX"
-
-# Set to yes if exported symbols are required.
-always_export_symbols=$always_export_symbols_CXX
-
-# The commands to list exported symbols.
-export_symbols_cmds=$lt_export_symbols_cmds_CXX
-
-# The commands to extract the exported symbol list from a shared archive.
-extract_expsyms_cmds=$lt_extract_expsyms_cmds
-
-# Symbols that should not be listed in the preloaded symbols.
-exclude_expsyms=$lt_exclude_expsyms_CXX
-
-# Symbols that must always be exported.
-include_expsyms=$lt_include_expsyms_CXX
-
-# ### END LIBTOOL TAG CONFIG: $tagname
-
-__EOF__
-
-
-else
-  # If there is no Makefile yet, we rely on a make rule to execute
-  # `config.status --recheck' to rerun these tests and create the
-  # libtool script then.
-  ltmain_in=`echo $ltmain | sed -e 's/\.sh$/.in/'`
-  if test -f "$ltmain_in"; then
-    test -f Makefile && make "$ltmain"
-  fi
-fi
-
-
-ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-
-CC=$lt_save_CC
-LDCXX=$LD
-LD=$lt_save_LD
-GCC=$lt_save_GCC
-with_gnu_ldcxx=$with_gnu_ld
-with_gnu_ld=$lt_save_with_gnu_ld
-lt_cv_path_LDCXX=$lt_cv_path_LD
-lt_cv_path_LD=$lt_save_path_LD
-lt_cv_prog_gnu_ldcxx=$lt_cv_prog_gnu_ld
-lt_cv_prog_gnu_ld=$lt_save_with_gnu_ld
-
-	else
-	  tagname=""
-	fi
-	;;
-
-      F77)
-	if test -n "$F77" && test "X$F77" != "Xno"; then
-
-ac_ext=f
-ac_compile='$F77 -c $FFLAGS conftest.$ac_ext >&5'
-ac_link='$F77 -o conftest$ac_exeext $FFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_f77_compiler_gnu
-
-
-archive_cmds_need_lc_F77=no
-allow_undefined_flag_F77=
-always_export_symbols_F77=no
-archive_expsym_cmds_F77=
-export_dynamic_flag_spec_F77=
-hardcode_direct_F77=no
-hardcode_libdir_flag_spec_F77=
-hardcode_libdir_flag_spec_ld_F77=
-hardcode_libdir_separator_F77=
-hardcode_minus_L_F77=no
-hardcode_automatic_F77=no
-module_cmds_F77=
-module_expsym_cmds_F77=
-link_all_deplibs_F77=unknown
-old_archive_cmds_F77=$old_archive_cmds
-no_undefined_flag_F77=
-whole_archive_flag_spec_F77=
-enable_shared_with_static_runtimes_F77=no
-
-# Source file extension for f77 test sources.
-ac_ext=f
-
-# Object file extension for compiled f77 test sources.
-objext=o
-objext_F77=$objext
-
-# Code to be used in simple compile tests
-lt_simple_compile_test_code="      subroutine t\n      return\n      end\n"
-
-# Code to be used in simple link tests
-lt_simple_link_test_code="      program t\n      end\n"
-
-# ltmain only uses $CC for tagged configurations so make sure $CC is set.
-
-# If no C compiler was specified, use CC.
-LTCC=${LTCC-"$CC"}
-
-# Allow CC to be a program name with arguments.
-compiler=$CC
-
-
-# Allow CC to be a program name with arguments.
-lt_save_CC="$CC"
-CC=${F77-"f77"}
-compiler=$CC
-compiler_F77=$CC
-cc_basename=`$echo X"$compiler" | $Xsed -e 's%^.*/%%'`
-
-echo "$as_me:$LINENO: checking if libtool supports shared libraries" >&5
-echo $ECHO_N "checking if libtool supports shared libraries... $ECHO_C" >&6
-echo "$as_me:$LINENO: result: $can_build_shared" >&5
-echo "${ECHO_T}$can_build_shared" >&6
-
-echo "$as_me:$LINENO: checking whether to build shared libraries" >&5
-echo $ECHO_N "checking whether to build shared libraries... $ECHO_C" >&6
-test "$can_build_shared" = "no" && enable_shared=no
-
-# On AIX, shared libraries and static libraries use the same namespace, and
-# are all built from PIC.
-case "$host_os" in
-aix3*)
-  test "$enable_shared" = yes && enable_static=no
-  if test -n "$RANLIB"; then
-    archive_cmds="$archive_cmds~\$RANLIB \$lib"
-    postinstall_cmds='$RANLIB $lib'
-  fi
-  ;;
-aix4* | aix5*)
-  test "$enable_shared" = yes && enable_static=no
-  ;;
-esac
-echo "$as_me:$LINENO: result: $enable_shared" >&5
-echo "${ECHO_T}$enable_shared" >&6
-
-echo "$as_me:$LINENO: checking whether to build static libraries" >&5
-echo $ECHO_N "checking whether to build static libraries... $ECHO_C" >&6
-# Make sure either enable_shared or enable_static is yes.
-test "$enable_shared" = yes || enable_static=yes
-echo "$as_me:$LINENO: result: $enable_static" >&5
-echo "${ECHO_T}$enable_static" >&6
-
-test "$ld_shlibs_F77" = no && can_build_shared=no
-
-GCC_F77="$G77"
-LD_F77="$LD"
-
-lt_prog_compiler_wl_F77=
-lt_prog_compiler_pic_F77=
-lt_prog_compiler_static_F77=
-
-echo "$as_me:$LINENO: checking for $compiler option to produce PIC" >&5
-echo $ECHO_N "checking for $compiler option to produce PIC... $ECHO_C" >&6
-
-  if test "$GCC" = yes; then
-    lt_prog_compiler_wl_F77='-Wl,'
-    lt_prog_compiler_static_F77='-static'
-
-    case $host_os in
-      aix*)
-      # All AIX code is PIC.
-      if test "$host_cpu" = ia64; then
-	# AIX 5 now supports IA64 processor
-	lt_prog_compiler_static_F77='-Bstatic'
-      fi
-      ;;
-
-    amigaos*)
-      # FIXME: we need at least 68020 code to build shared libraries, but
-      # adding the `-m68020' flag to GCC prevents building anything better,
-      # like `-m68040'.
-      lt_prog_compiler_pic_F77='-m68020 -resident32 -malways-restore-a4'
-      ;;
-
-    beos* | cygwin* | irix5* | irix6* | nonstopux* | osf3* | osf4* | osf5*)
-      # PIC is the default for these OSes.
-      ;;
-
-    mingw* | pw32* | os2*)
-      # This hack is so that the source file can tell whether it is being
-      # built for inclusion in a dll (and should export symbols for example).
-      lt_prog_compiler_pic_F77='-DDLL_EXPORT'
-      ;;
-
-    darwin* | rhapsody*)
-      # PIC is the default on this platform
-      # Common symbols not allowed in MH_DYLIB files
-      lt_prog_compiler_pic_F77='-fno-common'
-      ;;
-
-    msdosdjgpp*)
-      # Just because we use GCC doesn't mean we suddenly get shared libraries
-      # on systems that don't support them.
-      lt_prog_compiler_can_build_shared_F77=no
-      enable_shared=no
-      ;;
-
-    sysv4*MP*)
-      if test -d /usr/nec; then
-	lt_prog_compiler_pic_F77=-Kconform_pic
-      fi
-      ;;
-
-    hpux*)
-      # PIC is the default for IA64 HP-UX and 64-bit HP-UX, but
-      # not for PA HP-UX.
-      case "$host_cpu" in
-      hppa*64*|ia64*)
-	# +Z the default
-	;;
-      *)
-	lt_prog_compiler_pic_F77='-fPIC'
-	;;
-      esac
-      ;;
-
-    *)
-      lt_prog_compiler_pic_F77='-fPIC'
-      ;;
-    esac
-  else
-    # PORTME Check for flag to pass linker flags through the system compiler.
-    case $host_os in
-    aix*)
-      lt_prog_compiler_wl_F77='-Wl,'
-      if test "$host_cpu" = ia64; then
-	# AIX 5 now supports IA64 processor
-	lt_prog_compiler_static_F77='-Bstatic'
-      else
-	lt_prog_compiler_static_F77='-bnso -bI:/lib/syscalls.exp'
-      fi
-      ;;
-
-    mingw* | pw32* | os2*)
-      # This hack is so that the source file can tell whether it is being
-      # built for inclusion in a dll (and should export symbols for example).
-      lt_prog_compiler_pic_F77='-DDLL_EXPORT'
-      ;;
-
-    hpux9* | hpux10* | hpux11*)
-      lt_prog_compiler_wl_F77='-Wl,'
-      # PIC is the default for IA64 HP-UX and 64-bit HP-UX, but
-      # not for PA HP-UX.
-      case "$host_cpu" in
-      hppa*64*|ia64*)
-	# +Z the default
-	;;
-      *)
-	lt_prog_compiler_pic_F77='+Z'
-	;;
-      esac
-      # Is there a better lt_prog_compiler_static that works with the bundled CC?
-      lt_prog_compiler_static_F77='${wl}-a ${wl}archive'
-      ;;
-
-    irix5* | irix6* | nonstopux*)
-      lt_prog_compiler_wl_F77='-Wl,'
-      # PIC (with -KPIC) is the default.
-      lt_prog_compiler_static_F77='-non_shared'
-      ;;
-
-    newsos6)
-      lt_prog_compiler_pic_F77='-KPIC'
-      lt_prog_compiler_static_F77='-Bstatic'
-      ;;
-
-    linux*)
-      case $CC in
-      icc* | ecc*)
-	lt_prog_compiler_wl_F77='-Wl,'
-	lt_prog_compiler_pic_F77='-KPIC'
-	lt_prog_compiler_static_F77='-static'
-        ;;
-      ccc*)
-        lt_prog_compiler_wl_F77='-Wl,'
-        # All Alpha code is PIC.
-        lt_prog_compiler_static_F77='-non_shared'
-        ;;
-      esac
-      ;;
-
-    osf3* | osf4* | osf5*)
-      lt_prog_compiler_wl_F77='-Wl,'
-      # All OSF/1 code is PIC.
-      lt_prog_compiler_static_F77='-non_shared'
-      ;;
-
-    sco3.2v5*)
-      lt_prog_compiler_pic_F77='-Kpic'
-      lt_prog_compiler_static_F77='-dn'
-      ;;
-
-    solaris*)
-      lt_prog_compiler_wl_F77='-Wl,'
-      lt_prog_compiler_pic_F77='-KPIC'
-      lt_prog_compiler_static_F77='-Bstatic'
-      ;;
-
-    sunos4*)
-      lt_prog_compiler_wl_F77='-Qoption ld '
-      lt_prog_compiler_pic_F77='-PIC'
-      lt_prog_compiler_static_F77='-Bstatic'
-      ;;
-
-    sysv4 | sysv4.2uw2* | sysv4.3* | sysv5*)
-      lt_prog_compiler_wl_F77='-Wl,'
-      lt_prog_compiler_pic_F77='-KPIC'
-      lt_prog_compiler_static_F77='-Bstatic'
-      ;;
-
-    sysv4*MP*)
-      if test -d /usr/nec ;then
-	lt_prog_compiler_pic_F77='-Kconform_pic'
-	lt_prog_compiler_static_F77='-Bstatic'
-      fi
-      ;;
-
-    uts4*)
-      lt_prog_compiler_pic_F77='-pic'
-      lt_prog_compiler_static_F77='-Bstatic'
-      ;;
-
-    *)
-      lt_prog_compiler_can_build_shared_F77=no
-      ;;
-    esac
-  fi
-
-echo "$as_me:$LINENO: result: $lt_prog_compiler_pic_F77" >&5
-echo "${ECHO_T}$lt_prog_compiler_pic_F77" >&6
-
-#
-# Check to make sure the PIC flag actually works.
-#
-if test -n "$lt_prog_compiler_pic_F77"; then
-
-echo "$as_me:$LINENO: checking if $compiler PIC flag $lt_prog_compiler_pic_F77 works" >&5
-echo $ECHO_N "checking if $compiler PIC flag $lt_prog_compiler_pic_F77 works... $ECHO_C" >&6
-if test "${lt_prog_compiler_pic_works_F77+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  lt_prog_compiler_pic_works_F77=no
-  ac_outfile=conftest.$ac_objext
-   printf "$lt_simple_compile_test_code" > conftest.$ac_ext
-   lt_compiler_flag="$lt_prog_compiler_pic_F77"
-   # Insert the option either (1) after the last *FLAGS variable, or
-   # (2) before a word containing "conftest.", or (3) at the end.
-   # Note that $ac_compile itself does not contain backslashes and begins
-   # with a dollar sign (not a hyphen), so the echo should work correctly.
-   # The option is referenced via a variable to avoid confusing sed.
-   lt_compile=`echo "$ac_compile" | $SED \
-   -e 's:.*FLAGS}? :&$lt_compiler_flag :; t' \
-   -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
-   -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:13568: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
-   ac_status=$?
-   cat conftest.err >&5
-   echo "$as_me:13572: \$? = $ac_status" >&5
-   if (exit $ac_status) && test -s "$ac_outfile"; then
-     # The compiler can only warn and ignore the option if not recognized
-     # So say no if there are warnings
-     if test ! -s conftest.err; then
-       lt_prog_compiler_pic_works_F77=yes
-     fi
-   fi
-   $rm conftest*
-
-fi
-echo "$as_me:$LINENO: result: $lt_prog_compiler_pic_works_F77" >&5
-echo "${ECHO_T}$lt_prog_compiler_pic_works_F77" >&6
-
-if test x"$lt_prog_compiler_pic_works_F77" = xyes; then
-    case $lt_prog_compiler_pic_F77 in
-     "" | " "*) ;;
-     *) lt_prog_compiler_pic_F77=" $lt_prog_compiler_pic_F77" ;;
-     esac
-else
-    lt_prog_compiler_pic_F77=
-     lt_prog_compiler_can_build_shared_F77=no
-fi
-
-fi
-case "$host_os" in
-  # For platforms which do not support PIC, -DPIC is meaningless:
-  *djgpp*)
-    lt_prog_compiler_pic_F77=
-    ;;
-  *)
-    lt_prog_compiler_pic_F77="$lt_prog_compiler_pic_F77"
-    ;;
-esac
-
-echo "$as_me:$LINENO: checking if $compiler supports -c -o file.$ac_objext" >&5
-echo $ECHO_N "checking if $compiler supports -c -o file.$ac_objext... $ECHO_C" >&6
-if test "${lt_cv_prog_compiler_c_o_F77+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  lt_cv_prog_compiler_c_o_F77=no
-   $rm -r conftest 2>/dev/null
-   mkdir conftest
-   cd conftest
-   mkdir out
-   printf "$lt_simple_compile_test_code" > conftest.$ac_ext
-
-   lt_compiler_flag="-o out/conftest2.$ac_objext"
-   # Insert the option either (1) after the last *FLAGS variable, or
-   # (2) before a word containing "conftest.", or (3) at the end.
-   # Note that $ac_compile itself does not contain backslashes and begins
-   # with a dollar sign (not a hyphen), so the echo should work correctly.
-   lt_compile=`echo "$ac_compile" | $SED \
-   -e 's:.*FLAGS}? :&$lt_compiler_flag :; t' \
-   -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
-   -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:13628: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
-   ac_status=$?
-   cat out/conftest.err >&5
-   echo "$as_me:13632: \$? = $ac_status" >&5
-   if (exit $ac_status) && test -s out/conftest2.$ac_objext
-   then
-     # The compiler can only warn and ignore the option if not recognized
-     # So say no if there are warnings
-     if test ! -s out/conftest.err; then
-       lt_cv_prog_compiler_c_o_F77=yes
-     fi
-   fi
-   chmod u+w .
-   $rm conftest*
-   # SGI C++ compiler will create directory out/ii_files/ for
-   # template instantiation
-   test -d out/ii_files && $rm out/ii_files/* && rmdir out/ii_files
-   $rm out/* && rmdir out
-   cd ..
-   rmdir conftest
-   $rm conftest*
-
-fi
-echo "$as_me:$LINENO: result: $lt_cv_prog_compiler_c_o_F77" >&5
-echo "${ECHO_T}$lt_cv_prog_compiler_c_o_F77" >&6
-
-
-hard_links="nottested"
-if test "$lt_cv_prog_compiler_c_o_F77" = no && test "$need_locks" != no; then
-  # do not overwrite the value of need_locks provided by the user
-  echo "$as_me:$LINENO: checking if we can lock with hard links" >&5
-echo $ECHO_N "checking if we can lock with hard links... $ECHO_C" >&6
-  hard_links=yes
-  $rm conftest*
-  ln conftest.a conftest.b 2>/dev/null && hard_links=no
-  touch conftest.a
-  ln conftest.a conftest.b 2>&5 || hard_links=no
-  ln conftest.a conftest.b 2>/dev/null && hard_links=no
-  echo "$as_me:$LINENO: result: $hard_links" >&5
-echo "${ECHO_T}$hard_links" >&6
-  if test "$hard_links" = no; then
-    { echo "$as_me:$LINENO: WARNING: \`$CC' does not support \`-c -o', so \`make -j' may be unsafe" >&5
-echo "$as_me: WARNING: \`$CC' does not support \`-c -o', so \`make -j' may be unsafe" >&2;}
-    need_locks=warn
-  fi
-else
-  need_locks=no
-fi
-
-echo "$as_me:$LINENO: checking whether the $compiler linker ($LD) supports shared libraries" >&5
-echo $ECHO_N "checking whether the $compiler linker ($LD) supports shared libraries... $ECHO_C" >&6
-
-  runpath_var=
-  allow_undefined_flag_F77=
-  enable_shared_with_static_runtimes_F77=no
-  archive_cmds_F77=
-  archive_expsym_cmds_F77=
-  old_archive_From_new_cmds_F77=
-  old_archive_from_expsyms_cmds_F77=
-  export_dynamic_flag_spec_F77=
-  whole_archive_flag_spec_F77=
-  thread_safe_flag_spec_F77=
-  hardcode_libdir_flag_spec_F77=
-  hardcode_libdir_flag_spec_ld_F77=
-  hardcode_libdir_separator_F77=
-  hardcode_direct_F77=no
-  hardcode_minus_L_F77=no
-  hardcode_shlibpath_var_F77=unsupported
-  link_all_deplibs_F77=unknown
-  hardcode_automatic_F77=no
-  module_cmds_F77=
-  module_expsym_cmds_F77=
-  always_export_symbols_F77=no
-  export_symbols_cmds_F77='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
-  # include_expsyms should be a list of space-separated symbols to be *always*
-  # included in the symbol list
-  include_expsyms_F77=
-  # exclude_expsyms can be an extended regexp of symbols to exclude
-  # it will be wrapped by ` (' and `)$', so one must not match beginning or
-  # end of line.  Example: `a|bc|.*d.*' will exclude the symbols `a' and `bc',
-  # as well as any symbol that contains `d'.
-  exclude_expsyms_F77="_GLOBAL_OFFSET_TABLE_"
-  # Although _GLOBAL_OFFSET_TABLE_ is a valid symbol C name, most a.out
-  # platforms (ab)use it in PIC code, but their linkers get confused if
-  # the symbol is explicitly referenced.  Since portable code cannot
-  # rely on this symbol name, it's probably fine to never include it in
-  # preloaded symbol tables.
-  extract_expsyms_cmds=
-
-  case $host_os in
-  cygwin* | mingw* | pw32*)
-    # FIXME: the MSVC++ port hasn't been tested in a loooong time
-    # When not using gcc, we currently assume that we are using
-    # Microsoft Visual C++.
-    if test "$GCC" != yes; then
-      with_gnu_ld=no
-    fi
-    ;;
-  openbsd*)
-    with_gnu_ld=no
-    ;;
-  esac
-
-  ld_shlibs_F77=yes
-  if test "$with_gnu_ld" = yes; then
-    # If archive_cmds runs LD, not CC, wlarc should be empty
-    wlarc='${wl}'
-
-    # See if GNU ld supports shared libraries.
-    case $host_os in
-    aix3* | aix4* | aix5*)
-      # On AIX/PPC, the GNU linker is very broken
-      if test "$host_cpu" != ia64; then
-	ld_shlibs_F77=no
-	cat <<EOF 1>&2
-
-*** Warning: the GNU linker, at least up to release 2.9.1, is reported
-*** to be unable to reliably create shared libraries on AIX.
-*** Therefore, libtool is disabling shared libraries support.  If you
-*** really care for shared libraries, you may want to modify your PATH
-*** so that a non-GNU linker is found, and then restart.
-
-EOF
-      fi
-      ;;
-
-    amigaos*)
-      archive_cmds_F77='$rm $output_objdir/a2ixlibrary.data~$echo "#define NAME $libname" > $output_objdir/a2ixlibrary.data~$echo "#define LIBRARY_ID 1" >> $output_objdir/a2ixlibrary.data~$echo "#define VERSION $major" >> $output_objdir/a2ixlibrary.data~$echo "#define REVISION $revision" >> $output_objdir/a2ixlibrary.data~$AR $AR_FLAGS $lib $libobjs~$RANLIB $lib~(cd $output_objdir && a2ixlibrary -32)'
-      hardcode_libdir_flag_spec_F77='-L$libdir'
-      hardcode_minus_L_F77=yes
-
-      # Samuel A. Falvo II <kc5tja at dolphin.openprojects.net> reports
-      # that the semantics of dynamic libraries on AmigaOS, at least up
-      # to version 4, is to share data among multiple programs linked
-      # with the same dynamic library.  Since this doesn't match the
-      # behavior of shared libraries on other platforms, we can't use
-      # them.
-      ld_shlibs_F77=no
-      ;;
-
-    beos*)
-      if $LD --help 2>&1 | grep ': supported targets:.* elf' > /dev/null; then
-	allow_undefined_flag_F77=unsupported
-	# Joseph Beckenbach <jrb3 at best.com> says some releases of gcc
-	# support --undefined.  This deserves some investigation.  FIXME
-	archive_cmds_F77='$CC -nostart $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
-      else
-	ld_shlibs_F77=no
-      fi
-      ;;
-
-    cygwin* | mingw* | pw32*)
-      # _LT_AC_TAGVAR(hardcode_libdir_flag_spec, F77) is actually meaningless,
-      # as there is no search path for DLLs.
-      hardcode_libdir_flag_spec_F77='-L$libdir'
-      allow_undefined_flag_F77=unsupported
-      always_export_symbols_F77=no
-      enable_shared_with_static_runtimes_F77=yes
-      export_symbols_cmds_F77='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGS] /s/.* \([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW] /s/.* //'\'' | sort | uniq > $export_symbols'
-
-      if $LD --help 2>&1 | grep 'auto-import' > /dev/null; then
-        archive_cmds_F77='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--image-base=0x10000000 ${wl}--out-implib,$lib'
-	# If the export-symbols file already is a .def file (1st line
-	# is EXPORTS), use it as is; otherwise, prepend...
-	archive_expsym_cmds_F77='if test "x`$SED 1q $export_symbols`" = xEXPORTS; then
-	  cp $export_symbols $output_objdir/$soname.def;
-	else
-	  echo EXPORTS > $output_objdir/$soname.def;
-	  cat $export_symbols >> $output_objdir/$soname.def;
-	fi~
-	$CC -shared $output_objdir/$soname.def $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--image-base=0x10000000  ${wl}--out-implib,$lib'
-      else
-	ld_shlibs=no
-      fi
-      ;;
-
-    netbsd* | netbsdelf*-gnu | knetbsd*-gnu)
-      if echo __ELF__ | $CC -E - | grep __ELF__ >/dev/null; then
-	archive_cmds_F77='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
-	wlarc=
-      else
-	archive_cmds_F77='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
-	archive_expsym_cmds_F77='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
-      fi
-      ;;
-
-    solaris* | sysv5*)
-      if $LD -v 2>&1 | grep 'BFD 2\.8' > /dev/null; then
-	ld_shlibs_F77=no
-	cat <<EOF 1>&2
-
-*** Warning: The releases 2.8.* of the GNU linker cannot reliably
-*** create shared libraries on Solaris systems.  Therefore, libtool
-*** is disabling shared libraries support.  We urge you to upgrade GNU
-*** binutils to release 2.9.1 or newer.  Another option is to modify
-*** your PATH or compiler configuration so that the native linker is
-*** used, and then restart.
-
-EOF
-      elif $LD --help 2>&1 | grep ': supported targets:.* elf' > /dev/null; then
-	archive_cmds_F77='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
-	archive_expsym_cmds_F77='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
-      else
-	ld_shlibs_F77=no
-      fi
-      ;;
-
-    sunos4*)
-      archive_cmds_F77='$LD -assert pure-text -Bshareable -o $lib $libobjs $deplibs $linker_flags'
-      wlarc=
-      hardcode_direct_F77=yes
-      hardcode_shlibpath_var_F77=no
-      ;;
-
-  linux*)
-    if $LD --help 2>&1 | grep ': supported targets:.* elf' > /dev/null; then
-        tmp_archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
-	archive_cmds_F77="$tmp_archive_cmds"
-      supports_anon_versioning=no
-      case `$LD -v 2>/dev/null` in
-        *\ 01.* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
-        *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
-        *\ 2.11.92.0.12\ *) supports_anon_versioning=yes ;; # Mandrake 8.2 ...
-        *\ 2.11.*) ;; # other 2.11 versions
-        *) supports_anon_versioning=yes ;;
-      esac
-      if test $supports_anon_versioning = yes; then
-        archive_expsym_cmds_F77='$echo "{ global:" > $output_objdir/$libname.ver~
-cat $export_symbols | sed -e "s/\(.*\)/\1;/" >> $output_objdir/$libname.ver~
-$echo "local: *; };" >> $output_objdir/$libname.ver~
-        $CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'
-      else
-        archive_expsym_cmds_F77="$tmp_archive_cmds"
-      fi
-      link_all_deplibs_F77=no
-    else
-      ld_shlibs_F77=no
-    fi
-    ;;
-
-    *)
-      if $LD --help 2>&1 | grep ': supported targets:.* elf' > /dev/null; then
-	archive_cmds_F77='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
-	archive_expsym_cmds_F77='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
-      else
-	ld_shlibs_F77=no
-      fi
-      ;;
-    esac
-
-    if test "$ld_shlibs_F77" = yes; then
-      runpath_var=LD_RUN_PATH
-      hardcode_libdir_flag_spec_F77='${wl}--rpath ${wl}$libdir'
-      export_dynamic_flag_spec_F77='${wl}--export-dynamic'
-      # ancient GNU ld didn't support --whole-archive et. al.
-      if $LD --help 2>&1 | grep 'no-whole-archive' > /dev/null; then
- 	whole_archive_flag_spec_F77="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
-      else
-  	whole_archive_flag_spec_F77=
-      fi
-    fi
-  else
-    # PORTME fill in a description of your system's linker (not GNU ld)
-    case $host_os in
-    aix3*)
-      allow_undefined_flag_F77=unsupported
-      always_export_symbols_F77=yes
-      archive_expsym_cmds_F77='$LD -o $output_objdir/$soname $libobjs $deplibs $linker_flags -bE:$export_symbols -T512 -H512 -bM:SRE~$AR $AR_FLAGS $lib $output_objdir/$soname'
-      # Note: this linker hardcodes the directories in LIBPATH if there
-      # are no directories specified by -L.
-      hardcode_minus_L_F77=yes
-      if test "$GCC" = yes && test -z "$link_static_flag"; then
-	# Neither direct hardcoding nor static linking is supported with a
-	# broken collect2.
-	hardcode_direct_F77=unsupported
-      fi
-      ;;
-
-    aix4* | aix5*)
-      if test "$host_cpu" = ia64; then
-	# On IA64, the linker does run time linking by default, so we don't
-	# have to do anything special.
-	aix_use_runtimelinking=no
-	exp_sym_flag='-Bexport'
-	no_entry_flag=""
-      else
-	# If we're using GNU nm, then we don't want the "-C" option.
-	# -C means demangle to AIX nm, but means don't demangle with GNU nm
-	if $NM -V 2>&1 | grep 'GNU' > /dev/null; then
-	  export_symbols_cmds_F77='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$2 == "T") || (\$2 == "D") || (\$2 == "B")) && (substr(\$3,1,1) != ".")) { print \$3 } }'\'' | sort -u > $export_symbols'
-	else
-	  export_symbols_cmds_F77='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$2 == "T") || (\$2 == "D") || (\$2 == "B")) && (substr(\$3,1,1) != ".")) { print \$3 } }'\'' | sort -u > $export_symbols'
-	fi
-	aix_use_runtimelinking=no
-
-	# Test if we are trying to use run time linking or normal
-	# AIX style linking. If -brtl is somewhere in LDFLAGS, we
-	# need to do runtime linking.
-	case $host_os in aix4.[23]|aix4.[23].*|aix5*)
-	  for ld_flag in $LDFLAGS; do
-  	  if (test $ld_flag = "-brtl" || test $ld_flag = "-Wl,-brtl"); then
-  	    aix_use_runtimelinking=yes
-  	    break
-  	  fi
-	  done
-	esac
-
-	exp_sym_flag='-bexport'
-	no_entry_flag='-bnoentry'
-      fi
-
-      # When large executables or shared objects are built, AIX ld can
-      # have problems creating the table of contents.  If linking a library
-      # or program results in "error TOC overflow" add -mminimal-toc to
-      # CXXFLAGS/CFLAGS for g++/gcc.  In the cases where that is not
-      # enough to fix the problem, add -Wl,-bbigtoc to LDFLAGS.
-
-      archive_cmds_F77=''
-      hardcode_direct_F77=yes
-      hardcode_libdir_separator_F77=':'
-      link_all_deplibs_F77=yes
-
-      if test "$GCC" = yes; then
-	case $host_os in aix4.012|aix4.012.*)
-	# We only want to do this on AIX 4.2 and lower, the check
-	# below for broken collect2 doesn't work under 4.3+
-	  collect2name=`${CC} -print-prog-name=collect2`
-	  if test -f "$collect2name" && \
-  	   strings "$collect2name" | grep resolve_lib_name >/dev/null
-	  then
-  	  # We have reworked collect2
-  	  hardcode_direct_F77=yes
-	  else
-  	  # We have old collect2
-  	  hardcode_direct_F77=unsupported
-  	  # It fails to find uninstalled libraries when the uninstalled
-  	  # path is not listed in the libpath.  Setting hardcode_minus_L
-  	  # to unsupported forces relinking
-  	  hardcode_minus_L_F77=yes
-  	  hardcode_libdir_flag_spec_F77='-L$libdir'
-  	  hardcode_libdir_separator_F77=
-	  fi
-	esac
-	shared_flag='-shared'
-      else
-	# not using gcc
-	if test "$host_cpu" = ia64; then
-  	# VisualAge C++, Version 5.5 for AIX 5L for IA-64, Beta 3 Release
-  	# chokes on -Wl,-G. The following line is correct:
-	  shared_flag='-G'
-	else
-  	if test "$aix_use_runtimelinking" = yes; then
-	    shared_flag='${wl}-G'
-	  else
-	    shared_flag='${wl}-bM:SRE'
-  	fi
-	fi
-      fi
-
-      # It seems that -bexpall does not export symbols beginning with
-      # underscore (_), so it is better to generate a list of symbols to export.
-      always_export_symbols_F77=yes
-      if test "$aix_use_runtimelinking" = yes; then
-	# Warning - without using the other runtime loading flags (-brtl),
-	# -berok will link without error, but may produce a broken library.
-	allow_undefined_flag_F77='-berok'
-       # Determine the default libpath from the value encoded in an empty executable.
-       cat >conftest.$ac_ext <<_ACEOF
-      program main
-
-      end
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_f77_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-
-aix_libpath=`dump -H conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
-}'`
-# Check for a 64-bit object if we didn't find anything.
-if test -z "$aix_libpath"; then aix_libpath=`dump -HX64 conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
-}'`; fi
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
-
-       hardcode_libdir_flag_spec_F77='${wl}-blibpath:$libdir:'"$aix_libpath"
-	archive_expsym_cmds_F77="\$CC"' -o $output_objdir/$soname $libobjs $deplibs $compiler_flags `if test "x${allow_undefined_flag}" != "x"; then echo "${wl}${allow_undefined_flag}"; else :; fi` '"\${wl}$no_entry_flag \${wl}$exp_sym_flag:\$export_symbols $shared_flag"
-       else
-	if test "$host_cpu" = ia64; then
-	  hardcode_libdir_flag_spec_F77='${wl}-R $libdir:/usr/lib:/lib'
-	  allow_undefined_flag_F77="-z nodefs"
-	  archive_expsym_cmds_F77="\$CC $shared_flag"' -o $output_objdir/$soname $libobjs $deplibs $compiler_flags ${wl}${allow_undefined_flag} '"\${wl}$no_entry_flag \${wl}$exp_sym_flag:\$export_symbols"
-	else
-	 # Determine the default libpath from the value encoded in an empty executable.
-	 cat >conftest.$ac_ext <<_ACEOF
-      program main
-
-      end
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_f77_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-
-aix_libpath=`dump -H conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
-}'`
-# Check for a 64-bit object if we didn't find anything.
-if test -z "$aix_libpath"; then aix_libpath=`dump -HX64 conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
-}'`; fi
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
-
-	 hardcode_libdir_flag_spec_F77='${wl}-blibpath:$libdir:'"$aix_libpath"
-	  # Warning - without using the other run time loading flags,
-	  # -berok will link without error, but may produce a broken library.
-	  no_undefined_flag_F77=' ${wl}-bernotok'
-	  allow_undefined_flag_F77=' ${wl}-berok'
-	  # -bexpall does not export symbols beginning with underscore (_)
-	  always_export_symbols_F77=yes
-	  # Exported symbols can be pulled into shared objects from archives
-	  whole_archive_flag_spec_F77=' '
-	  archive_cmds_need_lc_F77=yes
-	  # This is similar to how AIX traditionally builds it's shared libraries.
-	  archive_expsym_cmds_F77="\$CC $shared_flag"' -o $output_objdir/$soname $libobjs $deplibs $compiler_flags ${wl}-bE:$export_symbols ${wl}-bnoentry${allow_undefined_flag}~$AR $AR_FLAGS $output_objdir/$libname$release.a $output_objdir/$soname'
-	fi
-      fi
-      ;;
-
-    amigaos*)
-      archive_cmds_F77='$rm $output_objdir/a2ixlibrary.data~$echo "#define NAME $libname" > $output_objdir/a2ixlibrary.data~$echo "#define LIBRARY_ID 1" >> $output_objdir/a2ixlibrary.data~$echo "#define VERSION $major" >> $output_objdir/a2ixlibrary.data~$echo "#define REVISION $revision" >> $output_objdir/a2ixlibrary.data~$AR $AR_FLAGS $lib $libobjs~$RANLIB $lib~(cd $output_objdir && a2ixlibrary -32)'
-      hardcode_libdir_flag_spec_F77='-L$libdir'
-      hardcode_minus_L_F77=yes
-      # see comment about different semantics on the GNU ld section
-      ld_shlibs_F77=no
-      ;;
-
-    bsdi4*)
-      export_dynamic_flag_spec_F77=-rdynamic
-      ;;
-
-    cygwin* | mingw* | pw32*)
-      # When not using gcc, we currently assume that we are using
-      # Microsoft Visual C++.
-      # hardcode_libdir_flag_spec is actually meaningless, as there is
-      # no search path for DLLs.
-      hardcode_libdir_flag_spec_F77=' '
-      allow_undefined_flag_F77=unsupported
-      # Tell ltmain to make .lib files, not .a files.
-      libext=lib
-      # Tell ltmain to make .dll files, not .so files.
-      shrext_cmds=".dll"
-      # FIXME: Setting linknames here is a bad hack.
-      archive_cmds_F77='$CC -o $lib $libobjs $compiler_flags `echo "$deplibs" | $SED -e '\''s/ -lc$//'\''` -link -dll~linknames='
-      # The linker will automatically build a .lib file if we build a DLL.
-      old_archive_From_new_cmds_F77='true'
-      # FIXME: Should let the user specify the lib program.
-      old_archive_cmds_F77='lib /OUT:$oldlib$oldobjs$old_deplibs'
-      fix_srcfile_path='`cygpath -w "$srcfile"`'
-      enable_shared_with_static_runtimes_F77=yes
-      ;;
-
-    darwin* | rhapsody*)
-    if test "$GXX" = yes ; then
-      archive_cmds_need_lc_F77=no
-      case "$host_os" in
-      rhapsody* | darwin1.[012])
-	allow_undefined_flag_F77='-undefined suppress'
-	;;
-      *) # Darwin 1.3 on
-      if test -z ${MACOSX_DEPLOYMENT_TARGET} ; then
-      	allow_undefined_flag_F77='-flat_namespace -undefined suppress'
-      else
-        case ${MACOSX_DEPLOYMENT_TARGET} in
-          10.[012])
-            allow_undefined_flag_F77='-flat_namespace -undefined suppress'
-            ;;
-          10.*)
-            allow_undefined_flag_F77='-undefined dynamic_lookup'
-            ;;
-        esac
-      fi
-	;;
-      esac
-    	lt_int_apple_cc_single_mod=no
-    	output_verbose_link_cmd='echo'
-    	if $CC -dumpspecs 2>&1 | grep 'single_module' >/dev/null ; then
-    	  lt_int_apple_cc_single_mod=yes
-    	fi
-    	if test "X$lt_int_apple_cc_single_mod" = Xyes ; then
-    	  archive_cmds_F77='$CC -dynamiclib -single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring'
-    	else
-        archive_cmds_F77='$CC -r ${wl}-bind_at_load -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs~$CC -dynamiclib $allow_undefined_flag -o $lib ${lib}-master.o $deplibs $compiler_flags -install_name $rpath/$soname $verstring'
-      fi
-      module_cmds_F77='$CC ${wl}-bind_at_load $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
-      # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's
-        if test "X$lt_int_apple_cc_single_mod" = Xyes ; then
-          archive_expsym_cmds_F77='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -dynamiclib -single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-        else
-          archive_expsym_cmds_F77='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -r ${wl}-bind_at_load -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs~$CC -dynamiclib $allow_undefined_flag -o $lib ${lib}-master.o $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-        fi
-          module_expsym_cmds_F77='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-      hardcode_direct_F77=no
-      hardcode_automatic_F77=yes
-      hardcode_shlibpath_var_F77=unsupported
-      whole_archive_flag_spec_F77='-all_load $convenience'
-      link_all_deplibs_F77=yes
-    else
-      ld_shlibs_F77=no
-    fi
-      ;;
-
-    dgux*)
-      archive_cmds_F77='$LD -G -h $soname -o $lib $libobjs $deplibs $linker_flags'
-      hardcode_libdir_flag_spec_F77='-L$libdir'
-      hardcode_shlibpath_var_F77=no
-      ;;
-
-    freebsd1*)
-      ld_shlibs_F77=no
-      ;;
-
-    # FreeBSD 2.2.[012] allows us to include c++rt0.o to get C++ constructor
-    # support.  Future versions do this automatically, but an explicit c++rt0.o
-    # does not break anything, and helps significantly (at the cost of a little
-    # extra space).
-    freebsd2.2*)
-      archive_cmds_F77='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags /usr/lib/c++rt0.o'
-      hardcode_libdir_flag_spec_F77='-R$libdir'
-      hardcode_direct_F77=yes
-      hardcode_shlibpath_var_F77=no
-      ;;
-
-    # Unfortunately, older versions of FreeBSD 2 do not have this feature.
-    freebsd2*)
-      archive_cmds_F77='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'
-      hardcode_direct_F77=yes
-      hardcode_minus_L_F77=yes
-      hardcode_shlibpath_var_F77=no
-      ;;
-
-    # FreeBSD 3 and greater uses gcc -shared to do shared libraries.
-    freebsd* | kfreebsd*-gnu)
-      archive_cmds_F77='$CC -shared -o $lib $libobjs $deplibs $compiler_flags'
-      hardcode_libdir_flag_spec_F77='-R$libdir'
-      hardcode_direct_F77=yes
-      hardcode_shlibpath_var_F77=no
-      ;;
-
-    hpux9*)
-      if test "$GCC" = yes; then
-	archive_cmds_F77='$rm $output_objdir/$soname~$CC -shared -fPIC ${wl}+b ${wl}$install_libdir -o $output_objdir/$soname $libobjs $deplibs $compiler_flags~test $output_objdir/$soname = $lib || mv $output_objdir/$soname $lib'
-      else
-	archive_cmds_F77='$rm $output_objdir/$soname~$LD -b +b $install_libdir -o $output_objdir/$soname $libobjs $deplibs $linker_flags~test $output_objdir/$soname = $lib || mv $output_objdir/$soname $lib'
-      fi
-      hardcode_libdir_flag_spec_F77='${wl}+b ${wl}$libdir'
-      hardcode_libdir_separator_F77=:
-      hardcode_direct_F77=yes
-
-      # hardcode_minus_L: Not really in the search PATH,
-      # but as the default location of the library.
-      hardcode_minus_L_F77=yes
-      export_dynamic_flag_spec_F77='${wl}-E'
-      ;;
-
-    hpux10* | hpux11*)
-      if test "$GCC" = yes -a "$with_gnu_ld" = no; then
-	case "$host_cpu" in
-	hppa*64*|ia64*)
-	  archive_cmds_F77='$CC -shared ${wl}+h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags'
-	  ;;
-	*)
-	  archive_cmds_F77='$CC -shared -fPIC ${wl}+h ${wl}$soname ${wl}+b ${wl}$install_libdir -o $lib $libobjs $deplibs $compiler_flags'
-	  ;;
-	esac
-      else
-	case "$host_cpu" in
-	hppa*64*|ia64*)
-	  archive_cmds_F77='$LD -b +h $soname -o $lib $libobjs $deplibs $linker_flags'
-	  ;;
-	*)
-	  archive_cmds_F77='$LD -b +h $soname +b $install_libdir -o $lib $libobjs $deplibs $linker_flags'
-	  ;;
-	esac
-      fi
-      if test "$with_gnu_ld" = no; then
-	case "$host_cpu" in
-	hppa*64*)
-	  hardcode_libdir_flag_spec_F77='${wl}+b ${wl}$libdir'
-	  hardcode_libdir_flag_spec_ld_F77='+b $libdir'
-	  hardcode_libdir_separator_F77=:
-	  hardcode_direct_F77=no
-	  hardcode_shlibpath_var_F77=no
-	  ;;
-	ia64*)
-	  hardcode_libdir_flag_spec_F77='-L$libdir'
-	  hardcode_direct_F77=no
-	  hardcode_shlibpath_var_F77=no
-
-	  # hardcode_minus_L: Not really in the search PATH,
-	  # but as the default location of the library.
-	  hardcode_minus_L_F77=yes
-	  ;;
-	*)
-	  hardcode_libdir_flag_spec_F77='${wl}+b ${wl}$libdir'
-	  hardcode_libdir_separator_F77=:
-	  hardcode_direct_F77=yes
-	  export_dynamic_flag_spec_F77='${wl}-E'
-
-	  # hardcode_minus_L: Not really in the search PATH,
-	  # but as the default location of the library.
-	  hardcode_minus_L_F77=yes
-	  ;;
-	esac
-      fi
-      ;;
-
-    irix5* | irix6* | nonstopux*)
-      if test "$GCC" = yes; then
-	archive_cmds_F77='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname ${wl}$soname `test -n "$verstring" && echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${output_objdir}/so_locations -o $lib'
-      else
-	archive_cmds_F77='$LD -shared $libobjs $deplibs $linker_flags -soname $soname `test -n "$verstring" && echo -set_version $verstring` -update_registry ${output_objdir}/so_locations -o $lib'
-	hardcode_libdir_flag_spec_ld_F77='-rpath $libdir'
-      fi
-      hardcode_libdir_flag_spec_F77='${wl}-rpath ${wl}$libdir'
-      hardcode_libdir_separator_F77=:
-      link_all_deplibs_F77=yes
-      ;;
-
-    netbsd* | netbsdelf*-gnu | knetbsd*-gnu)
-      if echo __ELF__ | $CC -E - | grep __ELF__ >/dev/null; then
-	archive_cmds_F77='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
-      else
-	archive_cmds_F77='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
-      fi
-      hardcode_libdir_flag_spec_F77='-R$libdir'
-      hardcode_direct_F77=yes
-      hardcode_shlibpath_var_F77=no
-      ;;
-
-    newsos6)
-      archive_cmds_F77='$LD -G -h $soname -o $lib $libobjs $deplibs $linker_flags'
-      hardcode_direct_F77=yes
-      hardcode_libdir_flag_spec_F77='${wl}-rpath ${wl}$libdir'
-      hardcode_libdir_separator_F77=:
-      hardcode_shlibpath_var_F77=no
-      ;;
-
-    openbsd*)
-      hardcode_direct_F77=yes
-      hardcode_shlibpath_var_F77=no
-      if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
-	archive_cmds_F77='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
-	hardcode_libdir_flag_spec_F77='${wl}-rpath,$libdir'
-	export_dynamic_flag_spec_F77='${wl}-E'
-      else
-       case $host_os in
-	 openbsd[01].* | openbsd2.[0-7] | openbsd2.[0-7].*)
-	   archive_cmds_F77='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'
-	   hardcode_libdir_flag_spec_F77='-R$libdir'
-	   ;;
-	 *)
-	   archive_cmds_F77='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
-	   hardcode_libdir_flag_spec_F77='${wl}-rpath,$libdir'
-	   ;;
-       esac
-      fi
-      ;;
-
-    os2*)
-      hardcode_libdir_flag_spec_F77='-L$libdir'
-      hardcode_minus_L_F77=yes
-      allow_undefined_flag_F77=unsupported
-      archive_cmds_F77='$echo "LIBRARY $libname INITINSTANCE" > $output_objdir/$libname.def~$echo "DESCRIPTION \"$libname\"" >> $output_objdir/$libname.def~$echo DATA >> $output_objdir/$libname.def~$echo " SINGLE NONSHARED" >> $output_objdir/$libname.def~$echo EXPORTS >> $output_objdir/$libname.def~emxexp $libobjs >> $output_objdir/$libname.def~$CC -Zdll -Zcrtdll -o $lib $libobjs $deplibs $compiler_flags $output_objdir/$libname.def'
-      old_archive_From_new_cmds_F77='emximp -o $output_objdir/$libname.a $output_objdir/$libname.def'
-      ;;
-
-    osf3*)
-      if test "$GCC" = yes; then
-	allow_undefined_flag_F77=' ${wl}-expect_unresolved ${wl}\*'
-	archive_cmds_F77='$CC -shared${allow_undefined_flag} $libobjs $deplibs $compiler_flags ${wl}-soname ${wl}$soname `test -n "$verstring" && echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${output_objdir}/so_locations -o $lib'
-      else
-	allow_undefined_flag_F77=' -expect_unresolved \*'
-	archive_cmds_F77='$LD -shared${allow_undefined_flag} $libobjs $deplibs $linker_flags -soname $soname `test -n "$verstring" && echo -set_version $verstring` -update_registry ${output_objdir}/so_locations -o $lib'
-      fi
-      hardcode_libdir_flag_spec_F77='${wl}-rpath ${wl}$libdir'
-      hardcode_libdir_separator_F77=:
-      ;;
-
-    osf4* | osf5*)	# as osf3* with the addition of -msym flag
-      if test "$GCC" = yes; then
-	allow_undefined_flag_F77=' ${wl}-expect_unresolved ${wl}\*'
-	archive_cmds_F77='$CC -shared${allow_undefined_flag} $libobjs $deplibs $compiler_flags ${wl}-msym ${wl}-soname ${wl}$soname `test -n "$verstring" && echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${output_objdir}/so_locations -o $lib'
-	hardcode_libdir_flag_spec_F77='${wl}-rpath ${wl}$libdir'
-      else
-	allow_undefined_flag_F77=' -expect_unresolved \*'
-	archive_cmds_F77='$LD -shared${allow_undefined_flag} $libobjs $deplibs $linker_flags -msym -soname $soname `test -n "$verstring" && echo -set_version $verstring` -update_registry ${output_objdir}/so_locations -o $lib'
-	archive_expsym_cmds_F77='for i in `cat $export_symbols`; do printf "%s %s\\n" -exported_symbol "\$i" >> $lib.exp; done; echo "-hidden">> $lib.exp~
-	$LD -shared${allow_undefined_flag} -input $lib.exp $linker_flags $libobjs $deplibs -soname $soname `test -n "$verstring" && echo -set_version $verstring` -update_registry ${objdir}/so_locations -o $lib~$rm $lib.exp'
-
-	# Both c and cxx compiler support -rpath directly
-	hardcode_libdir_flag_spec_F77='-rpath $libdir'
-      fi
-      hardcode_libdir_separator_F77=:
-      ;;
-
-    sco3.2v5*)
-      archive_cmds_F77='$LD -G -h $soname -o $lib $libobjs $deplibs $linker_flags'
-      hardcode_shlibpath_var_F77=no
-      export_dynamic_flag_spec_F77='${wl}-Bexport'
-      runpath_var=LD_RUN_PATH
-      hardcode_runpath_var=yes
-      ;;
-
-    solaris*)
-      no_undefined_flag_F77=' -z text'
-      if test "$GCC" = yes; then
-	archive_cmds_F77='$CC -shared ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags'
-	archive_expsym_cmds_F77='$echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~$echo "local: *; };" >> $lib.exp~
-	  $CC -shared ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$rm $lib.exp'
-      else
-	archive_cmds_F77='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
-	archive_expsym_cmds_F77='$echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~$echo "local: *; };" >> $lib.exp~
-  	$LD -G${allow_undefined_flag} -M $lib.exp -h $soname -o $lib $libobjs $deplibs $linker_flags~$rm $lib.exp'
-      fi
-      hardcode_libdir_flag_spec_F77='-R$libdir'
-      hardcode_shlibpath_var_F77=no
-      case $host_os in
-      solaris2.[0-5] | solaris2.[0-5].*) ;;
-      *) # Supported since Solaris 2.6 (maybe 2.5.1?)
-	whole_archive_flag_spec_F77='-z allextract$convenience -z defaultextract' ;;
-      esac
-      link_all_deplibs_F77=yes
-      ;;
-
-    sunos4*)
-      if test "x$host_vendor" = xsequent; then
-	# Use $CC to link under sequent, because it throws in some extra .o
-	# files that make .init and .fini sections work.
-	archive_cmds_F77='$CC -G ${wl}-h $soname -o $lib $libobjs $deplibs $compiler_flags'
-      else
-	archive_cmds_F77='$LD -assert pure-text -Bstatic -o $lib $libobjs $deplibs $linker_flags'
-      fi
-      hardcode_libdir_flag_spec_F77='-L$libdir'
-      hardcode_direct_F77=yes
-      hardcode_minus_L_F77=yes
-      hardcode_shlibpath_var_F77=no
-      ;;
-
-    sysv4)
-      case $host_vendor in
-	sni)
-	  archive_cmds_F77='$LD -G -h $soname -o $lib $libobjs $deplibs $linker_flags'
-	  hardcode_direct_F77=yes # is this really true???
-	;;
-	siemens)
-	  ## LD is ld it makes a PLAMLIB
-	  ## CC just makes a GrossModule.
-	  archive_cmds_F77='$LD -G -o $lib $libobjs $deplibs $linker_flags'
-	  reload_cmds_F77='$CC -r -o $output$reload_objs'
-	  hardcode_direct_F77=no
-        ;;
-	motorola)
-	  archive_cmds_F77='$LD -G -h $soname -o $lib $libobjs $deplibs $linker_flags'
-	  hardcode_direct_F77=no #Motorola manual says yes, but my tests say they lie
-	;;
-      esac
-      runpath_var='LD_RUN_PATH'
-      hardcode_shlibpath_var_F77=no
-      ;;
-
-    sysv4.3*)
-      archive_cmds_F77='$LD -G -h $soname -o $lib $libobjs $deplibs $linker_flags'
-      hardcode_shlibpath_var_F77=no
-      export_dynamic_flag_spec_F77='-Bexport'
-      ;;
-
-    sysv4*MP*)
-      if test -d /usr/nec; then
-	archive_cmds_F77='$LD -G -h $soname -o $lib $libobjs $deplibs $linker_flags'
-	hardcode_shlibpath_var_F77=no
-	runpath_var=LD_RUN_PATH
-	hardcode_runpath_var=yes
-	ld_shlibs_F77=yes
-      fi
-      ;;
-
-    sysv4.2uw2*)
-      archive_cmds_F77='$LD -G -o $lib $libobjs $deplibs $linker_flags'
-      hardcode_direct_F77=yes
-      hardcode_minus_L_F77=no
-      hardcode_shlibpath_var_F77=no
-      hardcode_runpath_var=yes
-      runpath_var=LD_RUN_PATH
-      ;;
-
-   sysv5OpenUNIX8* | sysv5UnixWare7* |  sysv5uw[78]* | unixware7*)
-      no_undefined_flag_F77='${wl}-z ${wl}text'
-      if test "$GCC" = yes; then
-	archive_cmds_F77='$CC -shared ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags'
-      else
-	archive_cmds_F77='$CC -G ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags'
-      fi
-      runpath_var='LD_RUN_PATH'
-      hardcode_shlibpath_var_F77=no
-      ;;
-
-    sysv5*)
-      no_undefined_flag_F77=' -z text'
-      # $CC -shared without GNU ld will not create a library from C++
-      # object files and a static libstdc++, better avoid it by now
-      archive_cmds_F77='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
-      archive_expsym_cmds_F77='$echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~$echo "local: *; };" >> $lib.exp~
-  		$LD -G${allow_undefined_flag} -M $lib.exp -h $soname -o $lib $libobjs $deplibs $linker_flags~$rm $lib.exp'
-      hardcode_libdir_flag_spec_F77=
-      hardcode_shlibpath_var_F77=no
-      runpath_var='LD_RUN_PATH'
-      ;;
-
-    uts4*)
-      archive_cmds_F77='$LD -G -h $soname -o $lib $libobjs $deplibs $linker_flags'
-      hardcode_libdir_flag_spec_F77='-L$libdir'
-      hardcode_shlibpath_var_F77=no
-      ;;
-
-    *)
-      ld_shlibs_F77=no
-      ;;
-    esac
-  fi
-
-echo "$as_me:$LINENO: result: $ld_shlibs_F77" >&5
-echo "${ECHO_T}$ld_shlibs_F77" >&6
-test "$ld_shlibs_F77" = no && can_build_shared=no
-
-variables_saved_for_relink="PATH $shlibpath_var $runpath_var"
-if test "$GCC" = yes; then
-  variables_saved_for_relink="$variables_saved_for_relink GCC_EXEC_PREFIX COMPILER_PATH LIBRARY_PATH"
-fi
-
-#
-# Do we need to explicitly link libc?
-#
-case "x$archive_cmds_need_lc_F77" in
-x|xyes)
-  # Assume -lc should be added
-  archive_cmds_need_lc_F77=yes
-
-  if test "$enable_shared" = yes && test "$GCC" = yes; then
-    case $archive_cmds_F77 in
-    *'~'*)
-      # FIXME: we may have to deal with multi-command sequences.
-      ;;
-    '$CC '*)
-      # Test whether the compiler implicitly links with -lc since on some
-      # systems, -lgcc has to come before -lc. If gcc already passes -lc
-      # to ld, don't add -lc before -lgcc.
-      echo "$as_me:$LINENO: checking whether -lc should be explicitly linked in" >&5
-echo $ECHO_N "checking whether -lc should be explicitly linked in... $ECHO_C" >&6
-      $rm conftest*
-      printf "$lt_simple_compile_test_code" > conftest.$ac_ext
-
-      if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } 2>conftest.err; then
-        soname=conftest
-        lib=conftest
-        libobjs=conftest.$ac_objext
-        deplibs=
-        wl=$lt_prog_compiler_wl_F77
-        compiler_flags=-v
-        linker_flags=-v
-        verstring=
-        output_objdir=.
-        libname=conftest
-        lt_save_allow_undefined_flag=$allow_undefined_flag_F77
-        allow_undefined_flag_F77=
-        if { (eval echo "$as_me:$LINENO: \"$archive_cmds_F77 2\>\&1 \| grep \" -lc \" \>/dev/null 2\>\&1\"") >&5
-  (eval $archive_cmds_F77 2\>\&1 \| grep \" -lc \" \>/dev/null 2\>\&1) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }
-        then
-	  archive_cmds_need_lc_F77=no
-        else
-	  archive_cmds_need_lc_F77=yes
-        fi
-        allow_undefined_flag_F77=$lt_save_allow_undefined_flag
-      else
-        cat conftest.err 1>&5
-      fi
-      $rm conftest*
-      echo "$as_me:$LINENO: result: $archive_cmds_need_lc_F77" >&5
-echo "${ECHO_T}$archive_cmds_need_lc_F77" >&6
-      ;;
-    esac
-  fi
-  ;;
-esac
-
-echo "$as_me:$LINENO: checking dynamic linker characteristics" >&5
-echo $ECHO_N "checking dynamic linker characteristics... $ECHO_C" >&6
-library_names_spec=
-libname_spec='lib$name'
-soname_spec=
-shrext_cmds=".so"
-postinstall_cmds=
-postuninstall_cmds=
-finish_cmds=
-finish_eval=
-shlibpath_var=
-shlibpath_overrides_runpath=unknown
-version_type=none
-dynamic_linker="$host_os ld.so"
-sys_lib_dlsearch_path_spec="/lib /usr/lib"
-if test "$GCC" = yes; then
-  sys_lib_search_path_spec=`$CC -print-search-dirs | grep "^libraries:" | $SED -e "s/^libraries://" -e "s,=/,/,g"`
-  if echo "$sys_lib_search_path_spec" | grep ';' >/dev/null ; then
-    # if the path contains ";" then we assume it to be the separator
-    # otherwise default to the standard path separator (i.e. ":") - it is
-    # assumed that no part of a normal pathname contains ";" but that should
-    # okay in the real world where ";" in dirpaths is itself problematic.
-    sys_lib_search_path_spec=`echo "$sys_lib_search_path_spec" | $SED -e 's/;/ /g'`
-  else
-    sys_lib_search_path_spec=`echo "$sys_lib_search_path_spec" | $SED  -e "s/$PATH_SEPARATOR/ /g"`
-  fi
-else
-  sys_lib_search_path_spec="/lib /usr/lib /usr/local/lib"
-fi
-need_lib_prefix=unknown
-hardcode_into_libs=no
-
-# when you set need_version to no, make sure it does not cause -set_version
-# flags to be left without arguments
-need_version=unknown
-
-case $host_os in
-aix3*)
-  version_type=linux
-  library_names_spec='${libname}${release}${shared_ext}$versuffix $libname.a'
-  shlibpath_var=LIBPATH
-
-  # AIX 3 has no versioning support, so we append a major version to the name.
-  soname_spec='${libname}${release}${shared_ext}$major'
-  ;;
-
-aix4* | aix5*)
-  version_type=linux
-  need_lib_prefix=no
-  need_version=no
-  hardcode_into_libs=yes
-  if test "$host_cpu" = ia64; then
-    # AIX 5 supports IA64
-    library_names_spec='${libname}${release}${shared_ext}$major ${libname}${release}${shared_ext}$versuffix $libname${shared_ext}'
-    shlibpath_var=LD_LIBRARY_PATH
-  else
-    # With GCC up to 2.95.x, collect2 would create an import file
-    # for dependence libraries.  The import file would start with
-    # the line `#! .'.  This would cause the generated library to
-    # depend on `.', always an invalid library.  This was fixed in
-    # development snapshots of GCC prior to 3.0.
-    case $host_os in
-      aix4 | aix4.[01] | aix4.[01].*)
-      if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
-	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | grep yes > /dev/null; then
-	:
-      else
-	can_build_shared=no
-      fi
-      ;;
-    esac
-    # AIX (on Power*) has no versioning support, so currently we can not hardcode correct
-    # soname into executable. Probably we can add versioning support to
-    # collect2, so additional links can be useful in future.
-    if test "$aix_use_runtimelinking" = yes; then
-      # If using run time linking (on AIX 4.2 or later) use lib<name>.so
-      # instead of lib<name>.a to let people know that these are not
-      # typical AIX shared libraries.
-      library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-    else
-      # We preserve .a as extension for shared libraries through AIX4.2
-      # and later when we are not doing run time linking.
-      library_names_spec='${libname}${release}.a $libname.a'
-      soname_spec='${libname}${release}${shared_ext}$major'
-    fi
-    shlibpath_var=LIBPATH
-  fi
-  ;;
-
-amigaos*)
-  library_names_spec='$libname.ixlibrary $libname.a'
-  # Create ${libname}_ixlibrary.a entries in /sys/libs.
-  finish_eval='for lib in `ls $libdir/*.ixlibrary 2>/dev/null`; do libname=`$echo "X$lib" | $Xsed -e '\''s%^.*/\([^/]*\)\.ixlibrary$%\1%'\''`; test $rm /sys/libs/${libname}_ixlibrary.a; $show "cd /sys/libs && $LN_S $lib ${libname}_ixlibrary.a"; cd /sys/libs && $LN_S $lib ${libname}_ixlibrary.a || exit 1; done'
-  ;;
-
-beos*)
-  library_names_spec='${libname}${shared_ext}'
-  dynamic_linker="$host_os ld.so"
-  shlibpath_var=LIBRARY_PATH
-  ;;
-
-bsdi4*)
-  version_type=linux
-  need_version=no
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-  soname_spec='${libname}${release}${shared_ext}$major'
-  finish_cmds='PATH="\$PATH:/sbin" ldconfig $libdir'
-  shlibpath_var=LD_LIBRARY_PATH
-  sys_lib_search_path_spec="/shlib /usr/lib /usr/X11/lib /usr/contrib/lib /lib /usr/local/lib"
-  sys_lib_dlsearch_path_spec="/shlib /usr/lib /usr/local/lib"
-  # the default ld.so.conf also contains /usr/contrib/lib and
-  # /usr/X11R6/lib (/usr/X11 is a link to /usr/X11R6), but let us allow
-  # libtool to hard-code these into programs
-  ;;
-
-cygwin* | mingw* | pw32*)
-  version_type=windows
-  shrext_cmds=".dll"
-  need_version=no
-  need_lib_prefix=no
-
-  case $GCC,$host_os in
-  yes,cygwin* | yes,mingw* | yes,pw32*)
-    library_names_spec='$libname.dll.a'
-    # DLL is installed to $(libdir)/../bin by postinstall_cmds
-    postinstall_cmds='base_file=`basename \${file}`~
-      dlpath=`$SHELL 2>&1 -c '\''. $dir/'\''\${base_file}'\''i;echo \$dlname'\''`~
-      dldir=$destdir/`dirname \$dlpath`~
-      test -d \$dldir || mkdir -p \$dldir~
-      $install_prog $dir/$dlname \$dldir/$dlname'
-    postuninstall_cmds='dldll=`$SHELL 2>&1 -c '\''. $file; echo \$dlname'\''`~
-      dlpath=$dir/\$dldll~
-       $rm \$dlpath'
-    shlibpath_overrides_runpath=yes
-
-    case $host_os in
-    cygwin*)
-      # Cygwin DLLs use 'cyg' prefix rather than 'lib'
-      soname_spec='`echo ${libname} | sed -e 's/^lib/cyg/'``echo ${release} | $SED -e 's/[.]/-/g'`${versuffix}${shared_ext}'
-      sys_lib_search_path_spec="/usr/lib /lib/w32api /lib /usr/local/lib"
-      ;;
-    mingw*)
-      # MinGW DLLs use traditional 'lib' prefix
-      soname_spec='${libname}`echo ${release} | $SED -e 's/[.]/-/g'`${versuffix}${shared_ext}'
-      sys_lib_search_path_spec=`$CC -print-search-dirs | grep "^libraries:" | $SED -e "s/^libraries://" -e "s,=/,/,g"`
-      if echo "$sys_lib_search_path_spec" | grep ';[c-zC-Z]:/' >/dev/null; then
-        # It is most probably a Windows format PATH printed by
-        # mingw gcc, but we are running on Cygwin. Gcc prints its search
-        # path with ; separators, and with drive letters. We can handle the
-        # drive letters (cygwin fileutils understands them), so leave them,
-        # especially as we might pass files found there to a mingw objdump,
-        # which wouldn't understand a cygwinified path. Ahh.
-        sys_lib_search_path_spec=`echo "$sys_lib_search_path_spec" | $SED -e 's/;/ /g'`
-      else
-        sys_lib_search_path_spec=`echo "$sys_lib_search_path_spec" | $SED  -e "s/$PATH_SEPARATOR/ /g"`
-      fi
-      ;;
-    pw32*)
-      # pw32 DLLs use 'pw' prefix rather than 'lib'
-      library_names_spec='`echo ${libname} | sed -e 's/^lib/pw/'``echo ${release} | $SED -e 's/./-/g'`${versuffix}${shared_ext}'
-      ;;
-    esac
-    ;;
-
-  *)
-    library_names_spec='${libname}`echo ${release} | $SED -e 's/[.]/-/g'`${versuffix}${shared_ext} $libname.lib'
-    ;;
-  esac
-  dynamic_linker='Win32 ld.exe'
-  # FIXME: first we should search . and the directory the executable is in
-  shlibpath_var=PATH
-  ;;
-
-darwin* | rhapsody*)
-  dynamic_linker="$host_os dyld"
-  version_type=darwin
-  need_lib_prefix=no
-  need_version=no
-  library_names_spec='${libname}${release}${versuffix}$shared_ext ${libname}${release}${major}$shared_ext ${libname}$shared_ext'
-  soname_spec='${libname}${release}${major}$shared_ext'
-  shlibpath_overrides_runpath=yes
-  shlibpath_var=DYLD_LIBRARY_PATH
-  shrext_cmds='$(test .$module = .yes && echo .so || echo .dylib)'
-  # Apple's gcc prints 'gcc -print-search-dirs' doesn't operate the same.
-  if test "$GCC" = yes; then
-    sys_lib_search_path_spec=`$CC -print-search-dirs | tr "\n" "$PATH_SEPARATOR" | sed -e 's/libraries:/@libraries:/' | tr "@" "\n" | grep "^libraries:" | sed -e "s/^libraries://" -e "s,=/,/,g" -e "s,$PATH_SEPARATOR, ,g" -e "s,.*,& /lib /usr/lib /usr/local/lib,g"`
-  else
-    sys_lib_search_path_spec='/lib /usr/lib /usr/local/lib'
-  fi
-  sys_lib_dlsearch_path_spec='/usr/local/lib /lib /usr/lib'
-  ;;
-
-dgux*)
-  version_type=linux
-  need_lib_prefix=no
-  need_version=no
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname$shared_ext'
-  soname_spec='${libname}${release}${shared_ext}$major'
-  shlibpath_var=LD_LIBRARY_PATH
-  ;;
-
-freebsd1*)
-  dynamic_linker=no
-  ;;
-
-kfreebsd*-gnu)
-  version_type=linux
-  need_lib_prefix=no
-  need_version=no
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${shared_ext}'
-  soname_spec='${libname}${release}${shared_ext}$major'
-  shlibpath_var=LD_LIBRARY_PATH
-  shlibpath_overrides_runpath=no
-  hardcode_into_libs=yes
-  dynamic_linker='GNU ld.so'
-  ;;
-
-freebsd*)
-  objformat=`test -x /usr/bin/objformat && /usr/bin/objformat || echo aout`
-  version_type=freebsd-$objformat
-  case $version_type in
-    freebsd-elf*)
-      library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext} $libname${shared_ext}'
-      need_version=no
-      need_lib_prefix=no
-      ;;
-    freebsd-*)
-      library_names_spec='${libname}${release}${shared_ext}$versuffix $libname${shared_ext}$versuffix'
-      need_version=yes
-      ;;
-  esac
-  shlibpath_var=LD_LIBRARY_PATH
-  case $host_os in
-  freebsd2*)
-    shlibpath_overrides_runpath=yes
-    ;;
-  freebsd3.01* | freebsdelf3.01*)
-    shlibpath_overrides_runpath=yes
-    hardcode_into_libs=yes
-    ;;
-  *) # from 3.2 on
-    shlibpath_overrides_runpath=no
-    hardcode_into_libs=yes
-    ;;
-  esac
-  ;;
-
-gnu*)
-  version_type=linux
-  need_lib_prefix=no
-  need_version=no
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}${major} ${libname}${shared_ext}'
-  soname_spec='${libname}${release}${shared_ext}$major'
-  shlibpath_var=LD_LIBRARY_PATH
-  hardcode_into_libs=yes
-  ;;
-
-hpux9* | hpux10* | hpux11*)
-  # Give a soname corresponding to the major version so that dld.sl refuses to
-  # link against other versions.
-  version_type=sunos
-  need_lib_prefix=no
-  need_version=no
-  case "$host_cpu" in
-  ia64*)
-    shrext_cmds='.so'
-    hardcode_into_libs=yes
-    dynamic_linker="$host_os dld.so"
-    shlibpath_var=LD_LIBRARY_PATH
-    shlibpath_overrides_runpath=yes # Unless +noenvvar is specified.
-    library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-    soname_spec='${libname}${release}${shared_ext}$major'
-    if test "X$HPUX_IA64_MODE" = X32; then
-      sys_lib_search_path_spec="/usr/lib/hpux32 /usr/local/lib/hpux32 /usr/local/lib"
-    else
-      sys_lib_search_path_spec="/usr/lib/hpux64 /usr/local/lib/hpux64"
-    fi
-    sys_lib_dlsearch_path_spec=$sys_lib_search_path_spec
-    ;;
-   hppa*64*)
-     shrext_cmds='.sl'
-     hardcode_into_libs=yes
-     dynamic_linker="$host_os dld.sl"
-     shlibpath_var=LD_LIBRARY_PATH # How should we handle SHLIB_PATH
-     shlibpath_overrides_runpath=yes # Unless +noenvvar is specified.
-     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-     soname_spec='${libname}${release}${shared_ext}$major'
-     sys_lib_search_path_spec="/usr/lib/pa20_64 /usr/ccs/lib/pa20_64"
-     sys_lib_dlsearch_path_spec=$sys_lib_search_path_spec
-     ;;
-   *)
-    shrext_cmds='.sl'
-    dynamic_linker="$host_os dld.sl"
-    shlibpath_var=SHLIB_PATH
-    shlibpath_overrides_runpath=no # +s is required to enable SHLIB_PATH
-    library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-    soname_spec='${libname}${release}${shared_ext}$major'
-    ;;
-  esac
-  # HP-UX runs *really* slowly unless shared libraries are mode 555.
-  postinstall_cmds='chmod 555 $lib'
-  ;;
-
-irix5* | irix6* | nonstopux*)
-  case $host_os in
-    nonstopux*) version_type=nonstopux ;;
-    *)
-	if test "$lt_cv_prog_gnu_ld" = yes; then
-		version_type=linux
-	else
-		version_type=irix
-	fi ;;
-  esac
-  need_lib_prefix=no
-  need_version=no
-  soname_spec='${libname}${release}${shared_ext}$major'
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${release}${shared_ext} $libname${shared_ext}'
-  case $host_os in
-  irix5* | nonstopux*)
-    libsuff= shlibsuff=
-    ;;
-  *)
-    case $LD in # libtool.m4 will add one of these switches to LD
-    *-32|*"-32 "|*-melf32bsmip|*"-melf32bsmip ")
-      libsuff= shlibsuff= libmagic=32-bit;;
-    *-n32|*"-n32 "|*-melf32bmipn32|*"-melf32bmipn32 ")
-      libsuff=32 shlibsuff=N32 libmagic=N32;;
-    *-64|*"-64 "|*-melf64bmip|*"-melf64bmip ")
-      libsuff=64 shlibsuff=64 libmagic=64-bit;;
-    *) libsuff= shlibsuff= libmagic=never-match;;
-    esac
-    ;;
-  esac
-  shlibpath_var=LD_LIBRARY${shlibsuff}_PATH
-  shlibpath_overrides_runpath=no
-  sys_lib_search_path_spec="/usr/lib${libsuff} /lib${libsuff} /usr/local/lib${libsuff}"
-  sys_lib_dlsearch_path_spec="/usr/lib${libsuff} /lib${libsuff}"
-  hardcode_into_libs=yes
-  ;;
-
-# No shared lib support for Linux oldld, aout, or coff.
-linux*oldld* | linux*aout* | linux*coff*)
-  dynamic_linker=no
-  ;;
-
-# This must be Linux ELF.
-linux*)
-  version_type=linux
-  need_lib_prefix=no
-  need_version=no
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-  soname_spec='${libname}${release}${shared_ext}$major'
-  finish_cmds='PATH="\$PATH:/sbin" ldconfig -n $libdir'
-  shlibpath_var=LD_LIBRARY_PATH
-  shlibpath_overrides_runpath=no
-  # This implies no fast_install, which is unacceptable.
-  # Some rework will be needed to allow for fast_install
-  # before this can be enabled.
-  hardcode_into_libs=yes
-
-  # Append ld.so.conf contents to the search path
-  if test -f /etc/ld.so.conf; then
-    lt_ld_extra=`$SED -e 's/:,\t/ /g;s/=^=*$//;s/=^= * / /g' /etc/ld.so.conf | tr '\n' ' '`
-    sys_lib_dlsearch_path_spec="/lib /usr/lib $lt_ld_extra"
-  fi
-
-  # We used to test for /lib/ld.so.1 and disable shared libraries on
-  # powerpc, because MkLinux only supported shared libraries with the
-  # GNU dynamic linker.  Since this was broken with cross compilers,
-  # most powerpc-linux boxes support dynamic linking these days and
-  # people can always --disable-shared, the test was removed, and we
-  # assume the GNU/Linux dynamic linker is in use.
-  dynamic_linker='GNU/Linux ld.so'
-  ;;
-
-netbsdelf*-gnu)
-  version_type=linux
-  need_lib_prefix=no
-  need_version=no
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${shared_ext}'
-  soname_spec='${libname}${release}${shared_ext}$major'
-  shlibpath_var=LD_LIBRARY_PATH
-  shlibpath_overrides_runpath=no
-  hardcode_into_libs=yes
-  dynamic_linker='NetBSD ld.elf_so'
-  ;;
-
-knetbsd*-gnu)
-  version_type=linux
-  need_lib_prefix=no
-  need_version=no
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${shared_ext}'
-  soname_spec='${libname}${release}${shared_ext}$major'
-  shlibpath_var=LD_LIBRARY_PATH
-  shlibpath_overrides_runpath=no
-  hardcode_into_libs=yes
-  dynamic_linker='GNU ld.so'
-  ;;
-
-netbsd*)
-  version_type=sunos
-  need_lib_prefix=no
-  need_version=no
-  if echo __ELF__ | $CC -E - | grep __ELF__ >/dev/null; then
-    library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
-    finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
-    dynamic_linker='NetBSD (a.out) ld.so'
-  else
-    library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${shared_ext}'
-    soname_spec='${libname}${release}${shared_ext}$major'
-    dynamic_linker='NetBSD ld.elf_so'
-  fi
-  shlibpath_var=LD_LIBRARY_PATH
-  shlibpath_overrides_runpath=yes
-  hardcode_into_libs=yes
-  ;;
-
-newsos6)
-  version_type=linux
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-  shlibpath_var=LD_LIBRARY_PATH
-  shlibpath_overrides_runpath=yes
-  ;;
-
-nto-qnx*)
-  version_type=linux
-  need_lib_prefix=no
-  need_version=no
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-  soname_spec='${libname}${release}${shared_ext}$major'
-  shlibpath_var=LD_LIBRARY_PATH
-  shlibpath_overrides_runpath=yes
-  ;;
-
-openbsd*)
-  version_type=sunos
-  need_lib_prefix=no
-  need_version=yes
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
-  finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
-  shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
-    case $host_os in
-      openbsd2.[89] | openbsd2.[89].*)
-	shlibpath_overrides_runpath=no
-	;;
-      *)
-	shlibpath_overrides_runpath=yes
-	;;
-      esac
-  else
-    shlibpath_overrides_runpath=yes
-  fi
-  ;;
-
-os2*)
-  libname_spec='$name'
-  shrext_cmds=".dll"
-  need_lib_prefix=no
-  library_names_spec='$libname${shared_ext} $libname.a'
-  dynamic_linker='OS/2 ld.exe'
-  shlibpath_var=LIBPATH
-  ;;
-
-osf3* | osf4* | osf5*)
-  version_type=osf
-  need_lib_prefix=no
-  need_version=no
-  soname_spec='${libname}${release}${shared_ext}$major'
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-  shlibpath_var=LD_LIBRARY_PATH
-  sys_lib_search_path_spec="/usr/shlib /usr/ccs/lib /usr/lib/cmplrs/cc /usr/lib /usr/local/lib /var/shlib"
-  sys_lib_dlsearch_path_spec="$sys_lib_search_path_spec"
-  ;;
-
-sco3.2v5*)
-  version_type=osf
-  soname_spec='${libname}${release}${shared_ext}$major'
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-  shlibpath_var=LD_LIBRARY_PATH
-  ;;
-
-solaris*)
-  version_type=linux
-  need_lib_prefix=no
-  need_version=no
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-  soname_spec='${libname}${release}${shared_ext}$major'
-  shlibpath_var=LD_LIBRARY_PATH
-  shlibpath_overrides_runpath=yes
-  hardcode_into_libs=yes
-  # ldd complains unless libraries are executable
-  postinstall_cmds='chmod +x $lib'
-  ;;
-
-sunos4*)
-  version_type=sunos
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
-  finish_cmds='PATH="\$PATH:/usr/etc" ldconfig $libdir'
-  shlibpath_var=LD_LIBRARY_PATH
-  shlibpath_overrides_runpath=yes
-  if test "$with_gnu_ld" = yes; then
-    need_lib_prefix=no
-  fi
-  need_version=yes
-  ;;
-
-sysv4 | sysv4.2uw2* | sysv4.3* | sysv5*)
-  version_type=linux
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-  soname_spec='${libname}${release}${shared_ext}$major'
-  shlibpath_var=LD_LIBRARY_PATH
-  case $host_vendor in
-    sni)
-      shlibpath_overrides_runpath=no
-      need_lib_prefix=no
-      export_dynamic_flag_spec='${wl}-Blargedynsym'
-      runpath_var=LD_RUN_PATH
-      ;;
-    siemens)
-      need_lib_prefix=no
-      ;;
-    motorola)
-      need_lib_prefix=no
-      need_version=no
-      shlibpath_overrides_runpath=no
-      sys_lib_search_path_spec='/lib /usr/lib /usr/ccs/lib'
-      ;;
-  esac
-  ;;
-
-sysv4*MP*)
-  if test -d /usr/nec ;then
-    version_type=linux
-    library_names_spec='$libname${shared_ext}.$versuffix $libname${shared_ext}.$major $libname${shared_ext}'
-    soname_spec='$libname${shared_ext}.$major'
-    shlibpath_var=LD_LIBRARY_PATH
-  fi
-  ;;
-
-uts4*)
-  version_type=linux
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-  soname_spec='${libname}${release}${shared_ext}$major'
-  shlibpath_var=LD_LIBRARY_PATH
-  ;;
-
-*)
-  dynamic_linker=no
-  ;;
-esac
-echo "$as_me:$LINENO: result: $dynamic_linker" >&5
-echo "${ECHO_T}$dynamic_linker" >&6
-test "$dynamic_linker" = no && can_build_shared=no
-
-echo "$as_me:$LINENO: checking how to hardcode library paths into programs" >&5
-echo $ECHO_N "checking how to hardcode library paths into programs... $ECHO_C" >&6
-hardcode_action_F77=
-if test -n "$hardcode_libdir_flag_spec_F77" || \
-   test -n "$runpath_var F77" || \
-   test "X$hardcode_automatic_F77"="Xyes" ; then
-
-  # We can hardcode non-existant directories.
-  if test "$hardcode_direct_F77" != no &&
-     # If the only mechanism to avoid hardcoding is shlibpath_var, we
-     # have to relink, otherwise we might link with an installed library
-     # when we should be linking with a yet-to-be-installed one
-     ## test "$_LT_AC_TAGVAR(hardcode_shlibpath_var, F77)" != no &&
-     test "$hardcode_minus_L_F77" != no; then
-    # Linking always hardcodes the temporary library directory.
-    hardcode_action_F77=relink
-  else
-    # We can link without hardcoding, and we can hardcode nonexisting dirs.
-    hardcode_action_F77=immediate
-  fi
-else
-  # We cannot hardcode anything, or else we can only hardcode existing
-  # directories.
-  hardcode_action_F77=unsupported
-fi
-echo "$as_me:$LINENO: result: $hardcode_action_F77" >&5
-echo "${ECHO_T}$hardcode_action_F77" >&6
-
-if test "$hardcode_action_F77" = relink; then
-  # Fast installation is not supported
-  enable_fast_install=no
-elif test "$shlibpath_overrides_runpath" = yes ||
-     test "$enable_shared" = no; then
-  # Fast installation is not necessary
-  enable_fast_install=needless
-fi
-
-striplib=
-old_striplib=
-echo "$as_me:$LINENO: checking whether stripping libraries is possible" >&5
-echo $ECHO_N "checking whether stripping libraries is possible... $ECHO_C" >&6
-if test -n "$STRIP" && $STRIP -V 2>&1 | grep "GNU strip" >/dev/null; then
-  test -z "$old_striplib" && old_striplib="$STRIP --strip-debug"
-  test -z "$striplib" && striplib="$STRIP --strip-unneeded"
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
-else
-# FIXME - insert some real tests, host_os isn't really good enough
-  case $host_os in
-   darwin*)
-       if test -n "$STRIP" ; then
-         striplib="$STRIP -x"
-         echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
-       else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi
-       ;;
-   *)
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-    ;;
-  esac
-fi
-
-
-
-# The else clause should only fire when bootstrapping the
-# libtool distribution, otherwise you forgot to ship ltmain.sh
-# with your package, and you will get complaints that there are
-# no rules to generate ltmain.sh.
-if test -f "$ltmain"; then
-  # See if we are running on zsh, and set the options which allow our commands through
-  # without removal of \ escapes.
-  if test -n "${ZSH_VERSION+set}" ; then
-    setopt NO_GLOB_SUBST
-  fi
-  # Now quote all the things that may contain metacharacters while being
-  # careful not to overquote the AC_SUBSTed values.  We take copies of the
-  # variables and quote the copies for generation of the libtool script.
-  for var in echo old_CC old_CFLAGS AR AR_FLAGS EGREP RANLIB LN_S LTCC NM \
-    SED SHELL STRIP \
-    libname_spec library_names_spec soname_spec extract_expsyms_cmds \
-    old_striplib striplib file_magic_cmd finish_cmds finish_eval \
-    deplibs_check_method reload_flag reload_cmds need_locks \
-    lt_cv_sys_global_symbol_pipe lt_cv_sys_global_symbol_to_cdecl \
-    lt_cv_sys_global_symbol_to_c_name_address \
-    sys_lib_search_path_spec sys_lib_dlsearch_path_spec \
-    old_postinstall_cmds old_postuninstall_cmds \
-    compiler_F77 \
-    CC_F77 \
-    LD_F77 \
-    lt_prog_compiler_wl_F77 \
-    lt_prog_compiler_pic_F77 \
-    lt_prog_compiler_static_F77 \
-    lt_prog_compiler_no_builtin_flag_F77 \
-    export_dynamic_flag_spec_F77 \
-    thread_safe_flag_spec_F77 \
-    whole_archive_flag_spec_F77 \
-    enable_shared_with_static_runtimes_F77 \
-    old_archive_cmds_F77 \
-    old_archive_from_new_cmds_F77 \
-    predep_objects_F77 \
-    postdep_objects_F77 \
-    predeps_F77 \
-    postdeps_F77 \
-    compiler_lib_search_path_F77 \
-    archive_cmds_F77 \
-    archive_expsym_cmds_F77 \
-    postinstall_cmds_F77 \
-    postuninstall_cmds_F77 \
-    old_archive_from_expsyms_cmds_F77 \
-    allow_undefined_flag_F77 \
-    no_undefined_flag_F77 \
-    export_symbols_cmds_F77 \
-    hardcode_libdir_flag_spec_F77 \
-    hardcode_libdir_flag_spec_ld_F77 \
-    hardcode_libdir_separator_F77 \
-    hardcode_automatic_F77 \
-    module_cmds_F77 \
-    module_expsym_cmds_F77 \
-    lt_cv_prog_compiler_c_o_F77 \
-    exclude_expsyms_F77 \
-    include_expsyms_F77; do
-
-    case $var in
-    old_archive_cmds_F77 | \
-    old_archive_from_new_cmds_F77 | \
-    archive_cmds_F77 | \
-    archive_expsym_cmds_F77 | \
-    module_cmds_F77 | \
-    module_expsym_cmds_F77 | \
-    old_archive_from_expsyms_cmds_F77 | \
-    export_symbols_cmds_F77 | \
-    extract_expsyms_cmds | reload_cmds | finish_cmds | \
-    postinstall_cmds | postuninstall_cmds | \
-    old_postinstall_cmds | old_postuninstall_cmds | \
-    sys_lib_search_path_spec | sys_lib_dlsearch_path_spec)
-      # Double-quote double-evaled strings.
-      eval "lt_$var=\\\"\`\$echo \"X\$$var\" | \$Xsed -e \"\$double_quote_subst\" -e \"\$sed_quote_subst\" -e \"\$delay_variable_subst\"\`\\\""
-      ;;
-    *)
-      eval "lt_$var=\\\"\`\$echo \"X\$$var\" | \$Xsed -e \"\$sed_quote_subst\"\`\\\""
-      ;;
-    esac
-  done
-
-  case $lt_echo in
-  *'\$0 --fallback-echo"')
-    lt_echo=`$echo "X$lt_echo" | $Xsed -e 's/\\\\\\\$0 --fallback-echo"$/$0 --fallback-echo"/'`
-    ;;
-  esac
-
-cfgfile="$ofile"
-
-  cat <<__EOF__ >> "$cfgfile"
-# ### BEGIN LIBTOOL TAG CONFIG: $tagname
-
-# Libtool was configured on host `(hostname || uname -n) 2>/dev/null | sed 1q`:
-
-# Shell to use when invoking shell scripts.
-SHELL=$lt_SHELL
-
-# Whether or not to build shared libraries.
-build_libtool_libs=$enable_shared
-
-# Whether or not to build static libraries.
-build_old_libs=$enable_static
-
-# Whether or not to add -lc for building shared libraries.
-build_libtool_need_lc=$archive_cmds_need_lc_F77
-
-# Whether or not to disallow shared libs when runtime libs are static
-allow_libtool_libs_with_static_runtimes=$enable_shared_with_static_runtimes_F77
-
-# Whether or not to optimize for fast installation.
-fast_install=$enable_fast_install
-
-# The host system.
-host_alias=$host_alias
-host=$host
-
-# An echo program that does not interpret backslashes.
-echo=$lt_echo
-
-# The archiver.
-AR=$lt_AR
-AR_FLAGS=$lt_AR_FLAGS
-
-# A C compiler.
-LTCC=$lt_LTCC
-
-# A language-specific compiler.
-CC=$lt_compiler_F77
-
-# Is the compiler the GNU C compiler?
-with_gcc=$GCC_F77
-
-# An ERE matcher.
-EGREP=$lt_EGREP
-
-# The linker used to build libraries.
-LD=$lt_LD_F77
-
-# Whether we need hard or soft links.
-LN_S=$lt_LN_S
-
-# A BSD-compatible nm program.
-NM=$lt_NM
-
-# A symbol stripping program
-STRIP=$lt_STRIP
-
-# Used to examine libraries when file_magic_cmd begins "file"
-MAGIC_CMD=$MAGIC_CMD
-
-# Used on cygwin: DLL creation program.
-DLLTOOL="$DLLTOOL"
-
-# Used on cygwin: object dumper.
-OBJDUMP="$OBJDUMP"
-
-# Used on cygwin: assembler.
-AS="$AS"
-
-# The name of the directory that contains temporary libtool files.
-objdir=$objdir
-
-# How to create reloadable object files.
-reload_flag=$lt_reload_flag
-reload_cmds=$lt_reload_cmds
-
-# How to pass a linker flag through the compiler.
-wl=$lt_lt_prog_compiler_wl_F77
-
-# Object file suffix (normally "o").
-objext="$ac_objext"
-
-# Old archive suffix (normally "a").
-libext="$libext"
-
-# Shared library suffix (normally ".so").
-shrext_cmds='$shrext_cmds'
-
-# Executable file suffix (normally "").
-exeext="$exeext"
-
-# Additional compiler flags for building library objects.
-pic_flag=$lt_lt_prog_compiler_pic_F77
-pic_mode=$pic_mode
-
-# What is the maximum length of a command?
-max_cmd_len=$lt_cv_sys_max_cmd_len
-
-# Does compiler simultaneously support -c and -o options?
-compiler_c_o=$lt_lt_cv_prog_compiler_c_o_F77
-
-# Must we lock files when doing compilation ?
-need_locks=$lt_need_locks
-
-# Do we need the lib prefix for modules?
-need_lib_prefix=$need_lib_prefix
-
-# Do we need a version for libraries?
-need_version=$need_version
-
-# Whether dlopen is supported.
-dlopen_support=$enable_dlopen
-
-# Whether dlopen of programs is supported.
-dlopen_self=$enable_dlopen_self
-
-# Whether dlopen of statically linked programs is supported.
-dlopen_self_static=$enable_dlopen_self_static
-
-# Compiler flag to prevent dynamic linking.
-link_static_flag=$lt_lt_prog_compiler_static_F77
-
-# Compiler flag to turn off builtin functions.
-no_builtin_flag=$lt_lt_prog_compiler_no_builtin_flag_F77
-
-# Compiler flag to allow reflexive dlopens.
-export_dynamic_flag_spec=$lt_export_dynamic_flag_spec_F77
-
-# Compiler flag to generate shared objects directly from archives.
-whole_archive_flag_spec=$lt_whole_archive_flag_spec_F77
-
-# Compiler flag to generate thread-safe objects.
-thread_safe_flag_spec=$lt_thread_safe_flag_spec_F77
-
-# Library versioning type.
-version_type=$version_type
-
-# Format of library name prefix.
-libname_spec=$lt_libname_spec
-
-# List of archive names.  First name is the real one, the rest are links.
-# The last name is the one that the linker finds with -lNAME.
-library_names_spec=$lt_library_names_spec
-
-# The coded name of the library, if different from the real name.
-soname_spec=$lt_soname_spec
-
-# Commands used to build and install an old-style archive.
-RANLIB=$lt_RANLIB
-old_archive_cmds=$lt_old_archive_cmds_F77
-old_postinstall_cmds=$lt_old_postinstall_cmds
-old_postuninstall_cmds=$lt_old_postuninstall_cmds
-
-# Create an old-style archive from a shared archive.
-old_archive_from_new_cmds=$lt_old_archive_from_new_cmds_F77
-
-# Create a temporary old-style archive to link instead of a shared archive.
-old_archive_from_expsyms_cmds=$lt_old_archive_from_expsyms_cmds_F77
-
-# Commands used to build and install a shared archive.
-archive_cmds=$lt_archive_cmds_F77
-archive_expsym_cmds=$lt_archive_expsym_cmds_F77
-postinstall_cmds=$lt_postinstall_cmds
-postuninstall_cmds=$lt_postuninstall_cmds
-
-# Commands used to build a loadable module (assumed same as above if empty)
-module_cmds=$lt_module_cmds_F77
-module_expsym_cmds=$lt_module_expsym_cmds_F77
-
-# Commands to strip libraries.
-old_striplib=$lt_old_striplib
-striplib=$lt_striplib
-
-# Dependencies to place before the objects being linked to create a
-# shared library.
-predep_objects=$lt_predep_objects_F77
-
-# Dependencies to place after the objects being linked to create a
-# shared library.
-postdep_objects=$lt_postdep_objects_F77
-
-# Dependencies to place before the objects being linked to create a
-# shared library.
-predeps=$lt_predeps_F77
-
-# Dependencies to place after the objects being linked to create a
-# shared library.
-postdeps=$lt_postdeps_F77
-
-# The library search path used internally by the compiler when linking
-# a shared library.
-compiler_lib_search_path=$lt_compiler_lib_search_path_F77
-
-# Method to check whether dependent libraries are shared objects.
-deplibs_check_method=$lt_deplibs_check_method
-
-# Command to use when deplibs_check_method == file_magic.
-file_magic_cmd=$lt_file_magic_cmd
-
-# Flag that allows shared libraries with undefined symbols to be built.
-allow_undefined_flag=$lt_allow_undefined_flag_F77
-
-# Flag that forces no undefined symbols.
-no_undefined_flag=$lt_no_undefined_flag_F77
-
-# Commands used to finish a libtool library installation in a directory.
-finish_cmds=$lt_finish_cmds
-
-# Same as above, but a single script fragment to be evaled but not shown.
-finish_eval=$lt_finish_eval
-
-# Take the output of nm and produce a listing of raw symbols and C names.
-global_symbol_pipe=$lt_lt_cv_sys_global_symbol_pipe
-
-# Transform the output of nm in a proper C declaration
-global_symbol_to_cdecl=$lt_lt_cv_sys_global_symbol_to_cdecl
-
-# Transform the output of nm in a C name address pair
-global_symbol_to_c_name_address=$lt_lt_cv_sys_global_symbol_to_c_name_address
-
-# This is the shared library runtime path variable.
-runpath_var=$runpath_var
-
-# This is the shared library path variable.
-shlibpath_var=$shlibpath_var
-
-# Is shlibpath searched before the hard-coded library search path?
-shlibpath_overrides_runpath=$shlibpath_overrides_runpath
-
-# How to hardcode a shared library path into an executable.
-hardcode_action=$hardcode_action_F77
-
-# Whether we should hardcode library paths into libraries.
-hardcode_into_libs=$hardcode_into_libs
-
-# Flag to hardcode \$libdir into a binary during linking.
-# This must work even if \$libdir does not exist.
-hardcode_libdir_flag_spec=$lt_hardcode_libdir_flag_spec_F77
-
-# If ld is used when linking, flag to hardcode \$libdir into
-# a binary during linking. This must work even if \$libdir does
-# not exist.
-hardcode_libdir_flag_spec_ld=$lt_hardcode_libdir_flag_spec_ld_F77
-
-# Whether we need a single -rpath flag with a separated argument.
-hardcode_libdir_separator=$lt_hardcode_libdir_separator_F77
-
-# Set to yes if using DIR/libNAME${shared_ext} during linking hardcodes DIR into the
-# resulting binary.
-hardcode_direct=$hardcode_direct_F77
-
-# Set to yes if using the -LDIR flag during linking hardcodes DIR into the
-# resulting binary.
-hardcode_minus_L=$hardcode_minus_L_F77
-
-# Set to yes if using SHLIBPATH_VAR=DIR during linking hardcodes DIR into
-# the resulting binary.
-hardcode_shlibpath_var=$hardcode_shlibpath_var_F77
-
-# Set to yes if building a shared library automatically hardcodes DIR into the library
-# and all subsequent libraries and executables linked against it.
-hardcode_automatic=$hardcode_automatic_F77
-
-# Variables whose values should be saved in libtool wrapper scripts and
-# restored at relink time.
-variables_saved_for_relink="$variables_saved_for_relink"
-
-# Whether libtool must link a program against all its dependency libraries.
-link_all_deplibs=$link_all_deplibs_F77
-
-# Compile-time system search path for libraries
-sys_lib_search_path_spec=$lt_sys_lib_search_path_spec
-
-# Run-time system search path for libraries
-sys_lib_dlsearch_path_spec=$lt_sys_lib_dlsearch_path_spec
-
-# Fix the shell variable \$srcfile for the compiler.
-fix_srcfile_path="$fix_srcfile_path_F77"
-
-# Set to yes if exported symbols are required.
-always_export_symbols=$always_export_symbols_F77
-
-# The commands to list exported symbols.
-export_symbols_cmds=$lt_export_symbols_cmds_F77
-
-# The commands to extract the exported symbol list from a shared archive.
-extract_expsyms_cmds=$lt_extract_expsyms_cmds
-
-# Symbols that should not be listed in the preloaded symbols.
-exclude_expsyms=$lt_exclude_expsyms_F77
-
-# Symbols that must always be exported.
-include_expsyms=$lt_include_expsyms_F77
-
-# ### END LIBTOOL TAG CONFIG: $tagname
-
-__EOF__
-
-
-else
-  # If there is no Makefile yet, we rely on a make rule to execute
-  # `config.status --recheck' to rerun these tests and create the
-  # libtool script then.
-  ltmain_in=`echo $ltmain | sed -e 's/\.sh$/.in/'`
-  if test -f "$ltmain_in"; then
-    test -f Makefile && make "$ltmain"
-  fi
-fi
-
-
-ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-
-CC="$lt_save_CC"
-
-	else
-	  tagname=""
-	fi
-	;;
-
-      GCJ)
-	if test -n "$GCJ" && test "X$GCJ" != "Xno"; then
-
-
-
-# Source file extension for Java test sources.
-ac_ext=java
-
-# Object file extension for compiled Java test sources.
-objext=o
-objext_GCJ=$objext
-
-# Code to be used in simple compile tests
-lt_simple_compile_test_code="class foo {}\n"
-
-# Code to be used in simple link tests
-lt_simple_link_test_code='public class conftest { public static void main(String argv) {}; }\n'
-
-# ltmain only uses $CC for tagged configurations so make sure $CC is set.
-
-# If no C compiler was specified, use CC.
-LTCC=${LTCC-"$CC"}
-
-# Allow CC to be a program name with arguments.
-compiler=$CC
-
-
-# Allow CC to be a program name with arguments.
-lt_save_CC="$CC"
-CC=${GCJ-"gcj"}
-compiler=$CC
-compiler_GCJ=$CC
-
-# GCJ did not exist at the time GCC didn't implicitly link libc in.
-archive_cmds_need_lc_GCJ=no
-
-
-lt_prog_compiler_no_builtin_flag_GCJ=
-
-if test "$GCC" = yes; then
-  lt_prog_compiler_no_builtin_flag_GCJ=' -fno-builtin'
-
-
-echo "$as_me:$LINENO: checking if $compiler supports -fno-rtti -fno-exceptions" >&5
-echo $ECHO_N "checking if $compiler supports -fno-rtti -fno-exceptions... $ECHO_C" >&6
-if test "${lt_cv_prog_compiler_rtti_exceptions+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  lt_cv_prog_compiler_rtti_exceptions=no
-  ac_outfile=conftest.$ac_objext
-   printf "$lt_simple_compile_test_code" > conftest.$ac_ext
-   lt_compiler_flag="-fno-rtti -fno-exceptions"
-   # Insert the option either (1) after the last *FLAGS variable, or
-   # (2) before a word containing "conftest.", or (3) at the end.
-   # Note that $ac_compile itself does not contain backslashes and begins
-   # with a dollar sign (not a hyphen), so the echo should work correctly.
-   # The option is referenced via a variable to avoid confusing sed.
-   lt_compile=`echo "$ac_compile" | $SED \
-   -e 's:.*FLAGS}? :&$lt_compiler_flag :; t' \
-   -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
-   -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:15673: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
-   ac_status=$?
-   cat conftest.err >&5
-   echo "$as_me:15677: \$? = $ac_status" >&5
-   if (exit $ac_status) && test -s "$ac_outfile"; then
-     # The compiler can only warn and ignore the option if not recognized
-     # So say no if there are warnings
-     if test ! -s conftest.err; then
-       lt_cv_prog_compiler_rtti_exceptions=yes
-     fi
-   fi
-   $rm conftest*
-
-fi
-echo "$as_me:$LINENO: result: $lt_cv_prog_compiler_rtti_exceptions" >&5
-echo "${ECHO_T}$lt_cv_prog_compiler_rtti_exceptions" >&6
-
-if test x"$lt_cv_prog_compiler_rtti_exceptions" = xyes; then
-    lt_prog_compiler_no_builtin_flag_GCJ="$lt_prog_compiler_no_builtin_flag_GCJ -fno-rtti -fno-exceptions"
-else
-    :
-fi
-
-fi
-
-lt_prog_compiler_wl_GCJ=
-lt_prog_compiler_pic_GCJ=
-lt_prog_compiler_static_GCJ=
-
-echo "$as_me:$LINENO: checking for $compiler option to produce PIC" >&5
-echo $ECHO_N "checking for $compiler option to produce PIC... $ECHO_C" >&6
-
-  if test "$GCC" = yes; then
-    lt_prog_compiler_wl_GCJ='-Wl,'
-    lt_prog_compiler_static_GCJ='-static'
-
-    case $host_os in
-      aix*)
-      # All AIX code is PIC.
-      if test "$host_cpu" = ia64; then
-	# AIX 5 now supports IA64 processor
-	lt_prog_compiler_static_GCJ='-Bstatic'
-      fi
-      ;;
-
-    amigaos*)
-      # FIXME: we need at least 68020 code to build shared libraries, but
-      # adding the `-m68020' flag to GCC prevents building anything better,
-      # like `-m68040'.
-      lt_prog_compiler_pic_GCJ='-m68020 -resident32 -malways-restore-a4'
-      ;;
-
-    beos* | cygwin* | irix5* | irix6* | nonstopux* | osf3* | osf4* | osf5*)
-      # PIC is the default for these OSes.
-      ;;
-
-    mingw* | pw32* | os2*)
-      # This hack is so that the source file can tell whether it is being
-      # built for inclusion in a dll (and should export symbols for example).
-      lt_prog_compiler_pic_GCJ='-DDLL_EXPORT'
-      ;;
-
-    darwin* | rhapsody*)
-      # PIC is the default on this platform
-      # Common symbols not allowed in MH_DYLIB files
-      lt_prog_compiler_pic_GCJ='-fno-common'
-      ;;
-
-    msdosdjgpp*)
-      # Just because we use GCC doesn't mean we suddenly get shared libraries
-      # on systems that don't support them.
-      lt_prog_compiler_can_build_shared_GCJ=no
-      enable_shared=no
-      ;;
-
-    sysv4*MP*)
-      if test -d /usr/nec; then
-	lt_prog_compiler_pic_GCJ=-Kconform_pic
-      fi
-      ;;
-
-    hpux*)
-      # PIC is the default for IA64 HP-UX and 64-bit HP-UX, but
-      # not for PA HP-UX.
-      case "$host_cpu" in
-      hppa*64*|ia64*)
-	# +Z the default
-	;;
-      *)
-	lt_prog_compiler_pic_GCJ='-fPIC'
-	;;
-      esac
-      ;;
-
-    *)
-      lt_prog_compiler_pic_GCJ='-fPIC'
-      ;;
-    esac
-  else
-    # PORTME Check for flag to pass linker flags through the system compiler.
-    case $host_os in
-    aix*)
-      lt_prog_compiler_wl_GCJ='-Wl,'
-      if test "$host_cpu" = ia64; then
-	# AIX 5 now supports IA64 processor
-	lt_prog_compiler_static_GCJ='-Bstatic'
-      else
-	lt_prog_compiler_static_GCJ='-bnso -bI:/lib/syscalls.exp'
-      fi
-      ;;
-
-    mingw* | pw32* | os2*)
-      # This hack is so that the source file can tell whether it is being
-      # built for inclusion in a dll (and should export symbols for example).
-      lt_prog_compiler_pic_GCJ='-DDLL_EXPORT'
-      ;;
-
-    hpux9* | hpux10* | hpux11*)
-      lt_prog_compiler_wl_GCJ='-Wl,'
-      # PIC is the default for IA64 HP-UX and 64-bit HP-UX, but
-      # not for PA HP-UX.
-      case "$host_cpu" in
-      hppa*64*|ia64*)
-	# +Z the default
-	;;
-      *)
-	lt_prog_compiler_pic_GCJ='+Z'
-	;;
-      esac
-      # Is there a better lt_prog_compiler_static that works with the bundled CC?
-      lt_prog_compiler_static_GCJ='${wl}-a ${wl}archive'
-      ;;
-
-    irix5* | irix6* | nonstopux*)
-      lt_prog_compiler_wl_GCJ='-Wl,'
-      # PIC (with -KPIC) is the default.
-      lt_prog_compiler_static_GCJ='-non_shared'
-      ;;
-
-    newsos6)
-      lt_prog_compiler_pic_GCJ='-KPIC'
-      lt_prog_compiler_static_GCJ='-Bstatic'
-      ;;
-
-    linux*)
-      case $CC in
-      icc* | ecc*)
-	lt_prog_compiler_wl_GCJ='-Wl,'
-	lt_prog_compiler_pic_GCJ='-KPIC'
-	lt_prog_compiler_static_GCJ='-static'
-        ;;
-      ccc*)
-        lt_prog_compiler_wl_GCJ='-Wl,'
-        # All Alpha code is PIC.
-        lt_prog_compiler_static_GCJ='-non_shared'
-        ;;
-      esac
-      ;;
-
-    osf3* | osf4* | osf5*)
-      lt_prog_compiler_wl_GCJ='-Wl,'
-      # All OSF/1 code is PIC.
-      lt_prog_compiler_static_GCJ='-non_shared'
-      ;;
-
-    sco3.2v5*)
-      lt_prog_compiler_pic_GCJ='-Kpic'
-      lt_prog_compiler_static_GCJ='-dn'
-      ;;
-
-    solaris*)
-      lt_prog_compiler_wl_GCJ='-Wl,'
-      lt_prog_compiler_pic_GCJ='-KPIC'
-      lt_prog_compiler_static_GCJ='-Bstatic'
-      ;;
-
-    sunos4*)
-      lt_prog_compiler_wl_GCJ='-Qoption ld '
-      lt_prog_compiler_pic_GCJ='-PIC'
-      lt_prog_compiler_static_GCJ='-Bstatic'
-      ;;
-
-    sysv4 | sysv4.2uw2* | sysv4.3* | sysv5*)
-      lt_prog_compiler_wl_GCJ='-Wl,'
-      lt_prog_compiler_pic_GCJ='-KPIC'
-      lt_prog_compiler_static_GCJ='-Bstatic'
-      ;;
-
-    sysv4*MP*)
-      if test -d /usr/nec ;then
-	lt_prog_compiler_pic_GCJ='-Kconform_pic'
-	lt_prog_compiler_static_GCJ='-Bstatic'
-      fi
-      ;;
-
-    uts4*)
-      lt_prog_compiler_pic_GCJ='-pic'
-      lt_prog_compiler_static_GCJ='-Bstatic'
-      ;;
-
-    *)
-      lt_prog_compiler_can_build_shared_GCJ=no
-      ;;
-    esac
-  fi
-
-echo "$as_me:$LINENO: result: $lt_prog_compiler_pic_GCJ" >&5
-echo "${ECHO_T}$lt_prog_compiler_pic_GCJ" >&6
-
-#
-# Check to make sure the PIC flag actually works.
-#
-if test -n "$lt_prog_compiler_pic_GCJ"; then
-
-echo "$as_me:$LINENO: checking if $compiler PIC flag $lt_prog_compiler_pic_GCJ works" >&5
-echo $ECHO_N "checking if $compiler PIC flag $lt_prog_compiler_pic_GCJ works... $ECHO_C" >&6
-if test "${lt_prog_compiler_pic_works_GCJ+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  lt_prog_compiler_pic_works_GCJ=no
-  ac_outfile=conftest.$ac_objext
-   printf "$lt_simple_compile_test_code" > conftest.$ac_ext
-   lt_compiler_flag="$lt_prog_compiler_pic_GCJ"
-   # Insert the option either (1) after the last *FLAGS variable, or
-   # (2) before a word containing "conftest.", or (3) at the end.
-   # Note that $ac_compile itself does not contain backslashes and begins
-   # with a dollar sign (not a hyphen), so the echo should work correctly.
-   # The option is referenced via a variable to avoid confusing sed.
-   lt_compile=`echo "$ac_compile" | $SED \
-   -e 's:.*FLAGS}? :&$lt_compiler_flag :; t' \
-   -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
-   -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:15906: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>conftest.err)
-   ac_status=$?
-   cat conftest.err >&5
-   echo "$as_me:15910: \$? = $ac_status" >&5
-   if (exit $ac_status) && test -s "$ac_outfile"; then
-     # The compiler can only warn and ignore the option if not recognized
-     # So say no if there are warnings
-     if test ! -s conftest.err; then
-       lt_prog_compiler_pic_works_GCJ=yes
-     fi
-   fi
-   $rm conftest*
-
-fi
-echo "$as_me:$LINENO: result: $lt_prog_compiler_pic_works_GCJ" >&5
-echo "${ECHO_T}$lt_prog_compiler_pic_works_GCJ" >&6
-
-if test x"$lt_prog_compiler_pic_works_GCJ" = xyes; then
-    case $lt_prog_compiler_pic_GCJ in
-     "" | " "*) ;;
-     *) lt_prog_compiler_pic_GCJ=" $lt_prog_compiler_pic_GCJ" ;;
-     esac
-else
-    lt_prog_compiler_pic_GCJ=
-     lt_prog_compiler_can_build_shared_GCJ=no
-fi
-
-fi
-case "$host_os" in
-  # For platforms which do not support PIC, -DPIC is meaningless:
-  *djgpp*)
-    lt_prog_compiler_pic_GCJ=
-    ;;
-  *)
-    lt_prog_compiler_pic_GCJ="$lt_prog_compiler_pic_GCJ"
-    ;;
-esac
-
-echo "$as_me:$LINENO: checking if $compiler supports -c -o file.$ac_objext" >&5
-echo $ECHO_N "checking if $compiler supports -c -o file.$ac_objext... $ECHO_C" >&6
-if test "${lt_cv_prog_compiler_c_o_GCJ+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  lt_cv_prog_compiler_c_o_GCJ=no
-   $rm -r conftest 2>/dev/null
-   mkdir conftest
-   cd conftest
-   mkdir out
-   printf "$lt_simple_compile_test_code" > conftest.$ac_ext
-
-   lt_compiler_flag="-o out/conftest2.$ac_objext"
-   # Insert the option either (1) after the last *FLAGS variable, or
-   # (2) before a word containing "conftest.", or (3) at the end.
-   # Note that $ac_compile itself does not contain backslashes and begins
-   # with a dollar sign (not a hyphen), so the echo should work correctly.
-   lt_compile=`echo "$ac_compile" | $SED \
-   -e 's:.*FLAGS}? :&$lt_compiler_flag :; t' \
-   -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
-   -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:15966: $lt_compile\"" >&5)
-   (eval "$lt_compile" 2>out/conftest.err)
-   ac_status=$?
-   cat out/conftest.err >&5
-   echo "$as_me:15970: \$? = $ac_status" >&5
-   if (exit $ac_status) && test -s out/conftest2.$ac_objext
-   then
-     # The compiler can only warn and ignore the option if not recognized
-     # So say no if there are warnings
-     if test ! -s out/conftest.err; then
-       lt_cv_prog_compiler_c_o_GCJ=yes
-     fi
-   fi
-   chmod u+w .
-   $rm conftest*
-   # SGI C++ compiler will create directory out/ii_files/ for
-   # template instantiation
-   test -d out/ii_files && $rm out/ii_files/* && rmdir out/ii_files
-   $rm out/* && rmdir out
-   cd ..
-   rmdir conftest
-   $rm conftest*
-
-fi
-echo "$as_me:$LINENO: result: $lt_cv_prog_compiler_c_o_GCJ" >&5
-echo "${ECHO_T}$lt_cv_prog_compiler_c_o_GCJ" >&6
-
-
-hard_links="nottested"
-if test "$lt_cv_prog_compiler_c_o_GCJ" = no && test "$need_locks" != no; then
-  # do not overwrite the value of need_locks provided by the user
-  echo "$as_me:$LINENO: checking if we can lock with hard links" >&5
-echo $ECHO_N "checking if we can lock with hard links... $ECHO_C" >&6
-  hard_links=yes
-  $rm conftest*
-  ln conftest.a conftest.b 2>/dev/null && hard_links=no
-  touch conftest.a
-  ln conftest.a conftest.b 2>&5 || hard_links=no
-  ln conftest.a conftest.b 2>/dev/null && hard_links=no
-  echo "$as_me:$LINENO: result: $hard_links" >&5
-echo "${ECHO_T}$hard_links" >&6
-  if test "$hard_links" = no; then
-    { echo "$as_me:$LINENO: WARNING: \`$CC' does not support \`-c -o', so \`make -j' may be unsafe" >&5
-echo "$as_me: WARNING: \`$CC' does not support \`-c -o', so \`make -j' may be unsafe" >&2;}
-    need_locks=warn
-  fi
-else
-  need_locks=no
-fi
-
-echo "$as_me:$LINENO: checking whether the $compiler linker ($LD) supports shared libraries" >&5
-echo $ECHO_N "checking whether the $compiler linker ($LD) supports shared libraries... $ECHO_C" >&6
-
-  runpath_var=
-  allow_undefined_flag_GCJ=
-  enable_shared_with_static_runtimes_GCJ=no
-  archive_cmds_GCJ=
-  archive_expsym_cmds_GCJ=
-  old_archive_From_new_cmds_GCJ=
-  old_archive_from_expsyms_cmds_GCJ=
-  export_dynamic_flag_spec_GCJ=
-  whole_archive_flag_spec_GCJ=
-  thread_safe_flag_spec_GCJ=
-  hardcode_libdir_flag_spec_GCJ=
-  hardcode_libdir_flag_spec_ld_GCJ=
-  hardcode_libdir_separator_GCJ=
-  hardcode_direct_GCJ=no
-  hardcode_minus_L_GCJ=no
-  hardcode_shlibpath_var_GCJ=unsupported
-  link_all_deplibs_GCJ=unknown
-  hardcode_automatic_GCJ=no
-  module_cmds_GCJ=
-  module_expsym_cmds_GCJ=
-  always_export_symbols_GCJ=no
-  export_symbols_cmds_GCJ='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\''s/.* //'\'' | sort | uniq > $export_symbols'
-  # include_expsyms should be a list of space-separated symbols to be *always*
-  # included in the symbol list
-  include_expsyms_GCJ=
-  # exclude_expsyms can be an extended regexp of symbols to exclude
-  # it will be wrapped by ` (' and `)$', so one must not match beginning or
-  # end of line.  Example: `a|bc|.*d.*' will exclude the symbols `a' and `bc',
-  # as well as any symbol that contains `d'.
-  exclude_expsyms_GCJ="_GLOBAL_OFFSET_TABLE_"
-  # Although _GLOBAL_OFFSET_TABLE_ is a valid symbol C name, most a.out
-  # platforms (ab)use it in PIC code, but their linkers get confused if
-  # the symbol is explicitly referenced.  Since portable code cannot
-  # rely on this symbol name, it's probably fine to never include it in
-  # preloaded symbol tables.
-  extract_expsyms_cmds=
-
-  case $host_os in
-  cygwin* | mingw* | pw32*)
-    # FIXME: the MSVC++ port hasn't been tested in a loooong time
-    # When not using gcc, we currently assume that we are using
-    # Microsoft Visual C++.
-    if test "$GCC" != yes; then
-      with_gnu_ld=no
-    fi
-    ;;
-  openbsd*)
-    with_gnu_ld=no
-    ;;
-  esac
-
-  ld_shlibs_GCJ=yes
-  if test "$with_gnu_ld" = yes; then
-    # If archive_cmds runs LD, not CC, wlarc should be empty
-    wlarc='${wl}'
-
-    # See if GNU ld supports shared libraries.
-    case $host_os in
-    aix3* | aix4* | aix5*)
-      # On AIX/PPC, the GNU linker is very broken
-      if test "$host_cpu" != ia64; then
-	ld_shlibs_GCJ=no
-	cat <<EOF 1>&2
-
-*** Warning: the GNU linker, at least up to release 2.9.1, is reported
-*** to be unable to reliably create shared libraries on AIX.
-*** Therefore, libtool is disabling shared libraries support.  If you
-*** really care for shared libraries, you may want to modify your PATH
-*** so that a non-GNU linker is found, and then restart.
-
-EOF
-      fi
-      ;;
-
-    amigaos*)
-      archive_cmds_GCJ='$rm $output_objdir/a2ixlibrary.data~$echo "#define NAME $libname" > $output_objdir/a2ixlibrary.data~$echo "#define LIBRARY_ID 1" >> $output_objdir/a2ixlibrary.data~$echo "#define VERSION $major" >> $output_objdir/a2ixlibrary.data~$echo "#define REVISION $revision" >> $output_objdir/a2ixlibrary.data~$AR $AR_FLAGS $lib $libobjs~$RANLIB $lib~(cd $output_objdir && a2ixlibrary -32)'
-      hardcode_libdir_flag_spec_GCJ='-L$libdir'
-      hardcode_minus_L_GCJ=yes
-
-      # Samuel A. Falvo II <kc5tja at dolphin.openprojects.net> reports
-      # that the semantics of dynamic libraries on AmigaOS, at least up
-      # to version 4, is to share data among multiple programs linked
-      # with the same dynamic library.  Since this doesn't match the
-      # behavior of shared libraries on other platforms, we can't use
-      # them.
-      ld_shlibs_GCJ=no
-      ;;
-
-    beos*)
-      if $LD --help 2>&1 | grep ': supported targets:.* elf' > /dev/null; then
-	allow_undefined_flag_GCJ=unsupported
-	# Joseph Beckenbach <jrb3 at best.com> says some releases of gcc
-	# support --undefined.  This deserves some investigation.  FIXME
-	archive_cmds_GCJ='$CC -nostart $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
-      else
-	ld_shlibs_GCJ=no
-      fi
-      ;;
-
-    cygwin* | mingw* | pw32*)
-      # _LT_AC_TAGVAR(hardcode_libdir_flag_spec, GCJ) is actually meaningless,
-      # as there is no search path for DLLs.
-      hardcode_libdir_flag_spec_GCJ='-L$libdir'
-      allow_undefined_flag_GCJ=unsupported
-      always_export_symbols_GCJ=no
-      enable_shared_with_static_runtimes_GCJ=yes
-      export_symbols_cmds_GCJ='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\''/^[BCDGS] /s/.* \([^ ]*\)/\1 DATA/'\'' | $SED -e '\''/^[AITW] /s/.* //'\'' | sort | uniq > $export_symbols'
-
-      if $LD --help 2>&1 | grep 'auto-import' > /dev/null; then
-        archive_cmds_GCJ='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--image-base=0x10000000 ${wl}--out-implib,$lib'
-	# If the export-symbols file already is a .def file (1st line
-	# is EXPORTS), use it as is; otherwise, prepend...
-	archive_expsym_cmds_GCJ='if test "x`$SED 1q $export_symbols`" = xEXPORTS; then
-	  cp $export_symbols $output_objdir/$soname.def;
-	else
-	  echo EXPORTS > $output_objdir/$soname.def;
-	  cat $export_symbols >> $output_objdir/$soname.def;
-	fi~
-	$CC -shared $output_objdir/$soname.def $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--image-base=0x10000000  ${wl}--out-implib,$lib'
-      else
-	ld_shlibs=no
-      fi
-      ;;
-
-    netbsd* | netbsdelf*-gnu | knetbsd*-gnu)
-      if echo __ELF__ | $CC -E - | grep __ELF__ >/dev/null; then
-	archive_cmds_GCJ='$LD -Bshareable $libobjs $deplibs $linker_flags -o $lib'
-	wlarc=
-      else
-	archive_cmds_GCJ='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
-	archive_expsym_cmds_GCJ='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
-      fi
-      ;;
-
-    solaris* | sysv5*)
-      if $LD -v 2>&1 | grep 'BFD 2\.8' > /dev/null; then
-	ld_shlibs_GCJ=no
-	cat <<EOF 1>&2
-
-*** Warning: The releases 2.8.* of the GNU linker cannot reliably
-*** create shared libraries on Solaris systems.  Therefore, libtool
-*** is disabling shared libraries support.  We urge you to upgrade GNU
-*** binutils to release 2.9.1 or newer.  Another option is to modify
-*** your PATH or compiler configuration so that the native linker is
-*** used, and then restart.
-
-EOF
-      elif $LD --help 2>&1 | grep ': supported targets:.* elf' > /dev/null; then
-	archive_cmds_GCJ='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
-	archive_expsym_cmds_GCJ='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
-      else
-	ld_shlibs_GCJ=no
-      fi
-      ;;
-
-    sunos4*)
-      archive_cmds_GCJ='$LD -assert pure-text -Bshareable -o $lib $libobjs $deplibs $linker_flags'
-      wlarc=
-      hardcode_direct_GCJ=yes
-      hardcode_shlibpath_var_GCJ=no
-      ;;
-
-  linux*)
-    if $LD --help 2>&1 | grep ': supported targets:.* elf' > /dev/null; then
-        tmp_archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
-	archive_cmds_GCJ="$tmp_archive_cmds"
-      supports_anon_versioning=no
-      case `$LD -v 2>/dev/null` in
-        *\ 01.* | *\ 2.[0-9].* | *\ 2.10.*) ;; # catch versions < 2.11
-        *\ 2.11.93.0.2\ *) supports_anon_versioning=yes ;; # RH7.3 ...
-        *\ 2.11.92.0.12\ *) supports_anon_versioning=yes ;; # Mandrake 8.2 ...
-        *\ 2.11.*) ;; # other 2.11 versions
-        *) supports_anon_versioning=yes ;;
-      esac
-      if test $supports_anon_versioning = yes; then
-        archive_expsym_cmds_GCJ='$echo "{ global:" > $output_objdir/$libname.ver~
-cat $export_symbols | sed -e "s/\(.*\)/\1;/" >> $output_objdir/$libname.ver~
-$echo "local: *; };" >> $output_objdir/$libname.ver~
-        $CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'
-      else
-        archive_expsym_cmds_GCJ="$tmp_archive_cmds"
-      fi
-      link_all_deplibs_GCJ=no
-    else
-      ld_shlibs_GCJ=no
-    fi
-    ;;
-
-    *)
-      if $LD --help 2>&1 | grep ': supported targets:.* elf' > /dev/null; then
-	archive_cmds_GCJ='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'
-	archive_expsym_cmds_GCJ='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'
-      else
-	ld_shlibs_GCJ=no
-      fi
-      ;;
-    esac
-
-    if test "$ld_shlibs_GCJ" = yes; then
-      runpath_var=LD_RUN_PATH
-      hardcode_libdir_flag_spec_GCJ='${wl}--rpath ${wl}$libdir'
-      export_dynamic_flag_spec_GCJ='${wl}--export-dynamic'
-      # ancient GNU ld didn't support --whole-archive et. al.
-      if $LD --help 2>&1 | grep 'no-whole-archive' > /dev/null; then
- 	whole_archive_flag_spec_GCJ="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
-      else
-  	whole_archive_flag_spec_GCJ=
-      fi
-    fi
-  else
-    # PORTME fill in a description of your system's linker (not GNU ld)
-    case $host_os in
-    aix3*)
-      allow_undefined_flag_GCJ=unsupported
-      always_export_symbols_GCJ=yes
-      archive_expsym_cmds_GCJ='$LD -o $output_objdir/$soname $libobjs $deplibs $linker_flags -bE:$export_symbols -T512 -H512 -bM:SRE~$AR $AR_FLAGS $lib $output_objdir/$soname'
-      # Note: this linker hardcodes the directories in LIBPATH if there
-      # are no directories specified by -L.
-      hardcode_minus_L_GCJ=yes
-      if test "$GCC" = yes && test -z "$link_static_flag"; then
-	# Neither direct hardcoding nor static linking is supported with a
-	# broken collect2.
-	hardcode_direct_GCJ=unsupported
-      fi
-      ;;
-
-    aix4* | aix5*)
-      if test "$host_cpu" = ia64; then
-	# On IA64, the linker does run time linking by default, so we don't
-	# have to do anything special.
-	aix_use_runtimelinking=no
-	exp_sym_flag='-Bexport'
-	no_entry_flag=""
-      else
-	# If we're using GNU nm, then we don't want the "-C" option.
-	# -C means demangle to AIX nm, but means don't demangle with GNU nm
-	if $NM -V 2>&1 | grep 'GNU' > /dev/null; then
-	  export_symbols_cmds_GCJ='$NM -Bpg $libobjs $convenience | awk '\''{ if (((\$2 == "T") || (\$2 == "D") || (\$2 == "B")) && (substr(\$3,1,1) != ".")) { print \$3 } }'\'' | sort -u > $export_symbols'
-	else
-	  export_symbols_cmds_GCJ='$NM -BCpg $libobjs $convenience | awk '\''{ if (((\$2 == "T") || (\$2 == "D") || (\$2 == "B")) && (substr(\$3,1,1) != ".")) { print \$3 } }'\'' | sort -u > $export_symbols'
-	fi
-	aix_use_runtimelinking=no
-
-	# Test if we are trying to use run time linking or normal
-	# AIX style linking. If -brtl is somewhere in LDFLAGS, we
-	# need to do runtime linking.
-	case $host_os in aix4.[23]|aix4.[23].*|aix5*)
-	  for ld_flag in $LDFLAGS; do
-  	  if (test $ld_flag = "-brtl" || test $ld_flag = "-Wl,-brtl"); then
-  	    aix_use_runtimelinking=yes
-  	    break
-  	  fi
-	  done
-	esac
-
-	exp_sym_flag='-bexport'
-	no_entry_flag='-bnoentry'
-      fi
-
-      # When large executables or shared objects are built, AIX ld can
-      # have problems creating the table of contents.  If linking a library
-      # or program results in "error TOC overflow" add -mminimal-toc to
-      # CXXFLAGS/CFLAGS for g++/gcc.  In the cases where that is not
-      # enough to fix the problem, add -Wl,-bbigtoc to LDFLAGS.
-
-      archive_cmds_GCJ=''
-      hardcode_direct_GCJ=yes
-      hardcode_libdir_separator_GCJ=':'
-      link_all_deplibs_GCJ=yes
-
-      if test "$GCC" = yes; then
-	case $host_os in aix4.012|aix4.012.*)
-	# We only want to do this on AIX 4.2 and lower, the check
-	# below for broken collect2 doesn't work under 4.3+
-	  collect2name=`${CC} -print-prog-name=collect2`
-	  if test -f "$collect2name" && \
-  	   strings "$collect2name" | grep resolve_lib_name >/dev/null
-	  then
-  	  # We have reworked collect2
-  	  hardcode_direct_GCJ=yes
-	  else
-  	  # We have old collect2
-  	  hardcode_direct_GCJ=unsupported
-  	  # It fails to find uninstalled libraries when the uninstalled
-  	  # path is not listed in the libpath.  Setting hardcode_minus_L
-  	  # to unsupported forces relinking
-  	  hardcode_minus_L_GCJ=yes
-  	  hardcode_libdir_flag_spec_GCJ='-L$libdir'
-  	  hardcode_libdir_separator_GCJ=
-	  fi
-	esac
-	shared_flag='-shared'
-      else
-	# not using gcc
-	if test "$host_cpu" = ia64; then
-  	# VisualAge C++, Version 5.5 for AIX 5L for IA-64, Beta 3 Release
-  	# chokes on -Wl,-G. The following line is correct:
-	  shared_flag='-G'
-	else
-  	if test "$aix_use_runtimelinking" = yes; then
-	    shared_flag='${wl}-G'
-	  else
-	    shared_flag='${wl}-bM:SRE'
-  	fi
-	fi
-      fi
-
-      # It seems that -bexpall does not export symbols beginning with
-      # underscore (_), so it is better to generate a list of symbols to export.
-      always_export_symbols_GCJ=yes
-      if test "$aix_use_runtimelinking" = yes; then
-	# Warning - without using the other runtime loading flags (-brtl),
-	# -berok will link without error, but may produce a broken library.
-	allow_undefined_flag_GCJ='-berok'
-       # Determine the default libpath from the value encoded in an empty executable.
-       cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-
-aix_libpath=`dump -H conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
-}'`
-# Check for a 64-bit object if we didn't find anything.
-if test -z "$aix_libpath"; then aix_libpath=`dump -HX64 conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
-}'`; fi
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
-
-       hardcode_libdir_flag_spec_GCJ='${wl}-blibpath:$libdir:'"$aix_libpath"
-	archive_expsym_cmds_GCJ="\$CC"' -o $output_objdir/$soname $libobjs $deplibs $compiler_flags `if test "x${allow_undefined_flag}" != "x"; then echo "${wl}${allow_undefined_flag}"; else :; fi` '"\${wl}$no_entry_flag \${wl}$exp_sym_flag:\$export_symbols $shared_flag"
-       else
-	if test "$host_cpu" = ia64; then
-	  hardcode_libdir_flag_spec_GCJ='${wl}-R $libdir:/usr/lib:/lib'
-	  allow_undefined_flag_GCJ="-z nodefs"
-	  archive_expsym_cmds_GCJ="\$CC $shared_flag"' -o $output_objdir/$soname $libobjs $deplibs $compiler_flags ${wl}${allow_undefined_flag} '"\${wl}$no_entry_flag \${wl}$exp_sym_flag:\$export_symbols"
-	else
-	 # Determine the default libpath from the value encoded in an empty executable.
-	 cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-int
-main ()
-{
-
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-
-aix_libpath=`dump -H conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
-}'`
-# Check for a 64-bit object if we didn't find anything.
-if test -z "$aix_libpath"; then aix_libpath=`dump -HX64 conftest$ac_exeext 2>/dev/null | $SED -n -e '/Import File Strings/,/^$/ { /^0/ { s/^0  *\(.*\)$/\1/; p; }
-}'`; fi
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-if test -z "$aix_libpath"; then aix_libpath="/usr/lib:/lib"; fi
-
-	 hardcode_libdir_flag_spec_GCJ='${wl}-blibpath:$libdir:'"$aix_libpath"
-	  # Warning - without using the other run time loading flags,
-	  # -berok will link without error, but may produce a broken library.
-	  no_undefined_flag_GCJ=' ${wl}-bernotok'
-	  allow_undefined_flag_GCJ=' ${wl}-berok'
-	  # -bexpall does not export symbols beginning with underscore (_)
-	  always_export_symbols_GCJ=yes
-	  # Exported symbols can be pulled into shared objects from archives
-	  whole_archive_flag_spec_GCJ=' '
-	  archive_cmds_need_lc_GCJ=yes
-	  # This is similar to how AIX traditionally builds it's shared libraries.
-	  archive_expsym_cmds_GCJ="\$CC $shared_flag"' -o $output_objdir/$soname $libobjs $deplibs $compiler_flags ${wl}-bE:$export_symbols ${wl}-bnoentry${allow_undefined_flag}~$AR $AR_FLAGS $output_objdir/$libname$release.a $output_objdir/$soname'
-	fi
-      fi
-      ;;
-
-    amigaos*)
-      archive_cmds_GCJ='$rm $output_objdir/a2ixlibrary.data~$echo "#define NAME $libname" > $output_objdir/a2ixlibrary.data~$echo "#define LIBRARY_ID 1" >> $output_objdir/a2ixlibrary.data~$echo "#define VERSION $major" >> $output_objdir/a2ixlibrary.data~$echo "#define REVISION $revision" >> $output_objdir/a2ixlibrary.data~$AR $AR_FLAGS $lib $libobjs~$RANLIB $lib~(cd $output_objdir && a2ixlibrary -32)'
-      hardcode_libdir_flag_spec_GCJ='-L$libdir'
-      hardcode_minus_L_GCJ=yes
-      # see comment about different semantics on the GNU ld section
-      ld_shlibs_GCJ=no
-      ;;
-
-    bsdi4*)
-      export_dynamic_flag_spec_GCJ=-rdynamic
-      ;;
-
-    cygwin* | mingw* | pw32*)
-      # When not using gcc, we currently assume that we are using
-      # Microsoft Visual C++.
-      # hardcode_libdir_flag_spec is actually meaningless, as there is
-      # no search path for DLLs.
-      hardcode_libdir_flag_spec_GCJ=' '
-      allow_undefined_flag_GCJ=unsupported
-      # Tell ltmain to make .lib files, not .a files.
-      libext=lib
-      # Tell ltmain to make .dll files, not .so files.
-      shrext_cmds=".dll"
-      # FIXME: Setting linknames here is a bad hack.
-      archive_cmds_GCJ='$CC -o $lib $libobjs $compiler_flags `echo "$deplibs" | $SED -e '\''s/ -lc$//'\''` -link -dll~linknames='
-      # The linker will automatically build a .lib file if we build a DLL.
-      old_archive_From_new_cmds_GCJ='true'
-      # FIXME: Should let the user specify the lib program.
-      old_archive_cmds_GCJ='lib /OUT:$oldlib$oldobjs$old_deplibs'
-      fix_srcfile_path='`cygpath -w "$srcfile"`'
-      enable_shared_with_static_runtimes_GCJ=yes
-      ;;
-
-    darwin* | rhapsody*)
-    if test "$GXX" = yes ; then
-      archive_cmds_need_lc_GCJ=no
-      case "$host_os" in
-      rhapsody* | darwin1.[012])
-	allow_undefined_flag_GCJ='-undefined suppress'
-	;;
-      *) # Darwin 1.3 on
-      if test -z ${MACOSX_DEPLOYMENT_TARGET} ; then
-      	allow_undefined_flag_GCJ='-flat_namespace -undefined suppress'
-      else
-        case ${MACOSX_DEPLOYMENT_TARGET} in
-          10.[012])
-            allow_undefined_flag_GCJ='-flat_namespace -undefined suppress'
-            ;;
-          10.*)
-            allow_undefined_flag_GCJ='-undefined dynamic_lookup'
-            ;;
-        esac
-      fi
-	;;
-      esac
-    	lt_int_apple_cc_single_mod=no
-    	output_verbose_link_cmd='echo'
-    	if $CC -dumpspecs 2>&1 | grep 'single_module' >/dev/null ; then
-    	  lt_int_apple_cc_single_mod=yes
-    	fi
-    	if test "X$lt_int_apple_cc_single_mod" = Xyes ; then
-    	  archive_cmds_GCJ='$CC -dynamiclib -single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring'
-    	else
-        archive_cmds_GCJ='$CC -r ${wl}-bind_at_load -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs~$CC -dynamiclib $allow_undefined_flag -o $lib ${lib}-master.o $deplibs $compiler_flags -install_name $rpath/$soname $verstring'
-      fi
-      module_cmds_GCJ='$CC ${wl}-bind_at_load $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'
-      # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's
-        if test "X$lt_int_apple_cc_single_mod" = Xyes ; then
-          archive_expsym_cmds_GCJ='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -dynamiclib -single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-        else
-          archive_expsym_cmds_GCJ='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -r ${wl}-bind_at_load -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs~$CC -dynamiclib $allow_undefined_flag -o $lib ${lib}-master.o $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-        fi
-          module_expsym_cmds_GCJ='sed -e "s,#.*,," -e "s,^[    ]*,," -e "s,^\(..*\),_&," < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'
-      hardcode_direct_GCJ=no
-      hardcode_automatic_GCJ=yes
-      hardcode_shlibpath_var_GCJ=unsupported
-      whole_archive_flag_spec_GCJ='-all_load $convenience'
-      link_all_deplibs_GCJ=yes
-    else
-      ld_shlibs_GCJ=no
-    fi
-      ;;
-
-    dgux*)
-      archive_cmds_GCJ='$LD -G -h $soname -o $lib $libobjs $deplibs $linker_flags'
-      hardcode_libdir_flag_spec_GCJ='-L$libdir'
-      hardcode_shlibpath_var_GCJ=no
-      ;;
-
-    freebsd1*)
-      ld_shlibs_GCJ=no
-      ;;
-
-    # FreeBSD 2.2.[012] allows us to include c++rt0.o to get C++ constructor
-    # support.  Future versions do this automatically, but an explicit c++rt0.o
-    # does not break anything, and helps significantly (at the cost of a little
-    # extra space).
-    freebsd2.2*)
-      archive_cmds_GCJ='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags /usr/lib/c++rt0.o'
-      hardcode_libdir_flag_spec_GCJ='-R$libdir'
-      hardcode_direct_GCJ=yes
-      hardcode_shlibpath_var_GCJ=no
-      ;;
-
-    # Unfortunately, older versions of FreeBSD 2 do not have this feature.
-    freebsd2*)
-      archive_cmds_GCJ='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'
-      hardcode_direct_GCJ=yes
-      hardcode_minus_L_GCJ=yes
-      hardcode_shlibpath_var_GCJ=no
-      ;;
-
-    # FreeBSD 3 and greater uses gcc -shared to do shared libraries.
-    freebsd* | kfreebsd*-gnu)
-      archive_cmds_GCJ='$CC -shared -o $lib $libobjs $deplibs $compiler_flags'
-      hardcode_libdir_flag_spec_GCJ='-R$libdir'
-      hardcode_direct_GCJ=yes
-      hardcode_shlibpath_var_GCJ=no
-      ;;
-
-    hpux9*)
-      if test "$GCC" = yes; then
-	archive_cmds_GCJ='$rm $output_objdir/$soname~$CC -shared -fPIC ${wl}+b ${wl}$install_libdir -o $output_objdir/$soname $libobjs $deplibs $compiler_flags~test $output_objdir/$soname = $lib || mv $output_objdir/$soname $lib'
-      else
-	archive_cmds_GCJ='$rm $output_objdir/$soname~$LD -b +b $install_libdir -o $output_objdir/$soname $libobjs $deplibs $linker_flags~test $output_objdir/$soname = $lib || mv $output_objdir/$soname $lib'
-      fi
-      hardcode_libdir_flag_spec_GCJ='${wl}+b ${wl}$libdir'
-      hardcode_libdir_separator_GCJ=:
-      hardcode_direct_GCJ=yes
-
-      # hardcode_minus_L: Not really in the search PATH,
-      # but as the default location of the library.
-      hardcode_minus_L_GCJ=yes
-      export_dynamic_flag_spec_GCJ='${wl}-E'
-      ;;
-
-    hpux10* | hpux11*)
-      if test "$GCC" = yes -a "$with_gnu_ld" = no; then
-	case "$host_cpu" in
-	hppa*64*|ia64*)
-	  archive_cmds_GCJ='$CC -shared ${wl}+h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags'
-	  ;;
-	*)
-	  archive_cmds_GCJ='$CC -shared -fPIC ${wl}+h ${wl}$soname ${wl}+b ${wl}$install_libdir -o $lib $libobjs $deplibs $compiler_flags'
-	  ;;
-	esac
-      else
-	case "$host_cpu" in
-	hppa*64*|ia64*)
-	  archive_cmds_GCJ='$LD -b +h $soname -o $lib $libobjs $deplibs $linker_flags'
-	  ;;
-	*)
-	  archive_cmds_GCJ='$LD -b +h $soname +b $install_libdir -o $lib $libobjs $deplibs $linker_flags'
-	  ;;
-	esac
-      fi
-      if test "$with_gnu_ld" = no; then
-	case "$host_cpu" in
-	hppa*64*)
-	  hardcode_libdir_flag_spec_GCJ='${wl}+b ${wl}$libdir'
-	  hardcode_libdir_flag_spec_ld_GCJ='+b $libdir'
-	  hardcode_libdir_separator_GCJ=:
-	  hardcode_direct_GCJ=no
-	  hardcode_shlibpath_var_GCJ=no
-	  ;;
-	ia64*)
-	  hardcode_libdir_flag_spec_GCJ='-L$libdir'
-	  hardcode_direct_GCJ=no
-	  hardcode_shlibpath_var_GCJ=no
-
-	  # hardcode_minus_L: Not really in the search PATH,
-	  # but as the default location of the library.
-	  hardcode_minus_L_GCJ=yes
-	  ;;
-	*)
-	  hardcode_libdir_flag_spec_GCJ='${wl}+b ${wl}$libdir'
-	  hardcode_libdir_separator_GCJ=:
-	  hardcode_direct_GCJ=yes
-	  export_dynamic_flag_spec_GCJ='${wl}-E'
-
-	  # hardcode_minus_L: Not really in the search PATH,
-	  # but as the default location of the library.
-	  hardcode_minus_L_GCJ=yes
-	  ;;
-	esac
-      fi
-      ;;
-
-    irix5* | irix6* | nonstopux*)
-      if test "$GCC" = yes; then
-	archive_cmds_GCJ='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname ${wl}$soname `test -n "$verstring" && echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${output_objdir}/so_locations -o $lib'
-      else
-	archive_cmds_GCJ='$LD -shared $libobjs $deplibs $linker_flags -soname $soname `test -n "$verstring" && echo -set_version $verstring` -update_registry ${output_objdir}/so_locations -o $lib'
-	hardcode_libdir_flag_spec_ld_GCJ='-rpath $libdir'
-      fi
-      hardcode_libdir_flag_spec_GCJ='${wl}-rpath ${wl}$libdir'
-      hardcode_libdir_separator_GCJ=:
-      link_all_deplibs_GCJ=yes
-      ;;
-
-    netbsd* | netbsdelf*-gnu | knetbsd*-gnu)
-      if echo __ELF__ | $CC -E - | grep __ELF__ >/dev/null; then
-	archive_cmds_GCJ='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'  # a.out
-      else
-	archive_cmds_GCJ='$LD -shared -o $lib $libobjs $deplibs $linker_flags'      # ELF
-      fi
-      hardcode_libdir_flag_spec_GCJ='-R$libdir'
-      hardcode_direct_GCJ=yes
-      hardcode_shlibpath_var_GCJ=no
-      ;;
-
-    newsos6)
-      archive_cmds_GCJ='$LD -G -h $soname -o $lib $libobjs $deplibs $linker_flags'
-      hardcode_direct_GCJ=yes
-      hardcode_libdir_flag_spec_GCJ='${wl}-rpath ${wl}$libdir'
-      hardcode_libdir_separator_GCJ=:
-      hardcode_shlibpath_var_GCJ=no
-      ;;
-
-    openbsd*)
-      hardcode_direct_GCJ=yes
-      hardcode_shlibpath_var_GCJ=no
-      if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
-	archive_cmds_GCJ='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
-	hardcode_libdir_flag_spec_GCJ='${wl}-rpath,$libdir'
-	export_dynamic_flag_spec_GCJ='${wl}-E'
-      else
-       case $host_os in
-	 openbsd[01].* | openbsd2.[0-7] | openbsd2.[0-7].*)
-	   archive_cmds_GCJ='$LD -Bshareable -o $lib $libobjs $deplibs $linker_flags'
-	   hardcode_libdir_flag_spec_GCJ='-R$libdir'
-	   ;;
-	 *)
-	   archive_cmds_GCJ='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
-	   hardcode_libdir_flag_spec_GCJ='${wl}-rpath,$libdir'
-	   ;;
-       esac
-      fi
-      ;;
-
-    os2*)
-      hardcode_libdir_flag_spec_GCJ='-L$libdir'
-      hardcode_minus_L_GCJ=yes
-      allow_undefined_flag_GCJ=unsupported
-      archive_cmds_GCJ='$echo "LIBRARY $libname INITINSTANCE" > $output_objdir/$libname.def~$echo "DESCRIPTION \"$libname\"" >> $output_objdir/$libname.def~$echo DATA >> $output_objdir/$libname.def~$echo " SINGLE NONSHARED" >> $output_objdir/$libname.def~$echo EXPORTS >> $output_objdir/$libname.def~emxexp $libobjs >> $output_objdir/$libname.def~$CC -Zdll -Zcrtdll -o $lib $libobjs $deplibs $compiler_flags $output_objdir/$libname.def'
-      old_archive_From_new_cmds_GCJ='emximp -o $output_objdir/$libname.a $output_objdir/$libname.def'
-      ;;
-
-    osf3*)
-      if test "$GCC" = yes; then
-	allow_undefined_flag_GCJ=' ${wl}-expect_unresolved ${wl}\*'
-	archive_cmds_GCJ='$CC -shared${allow_undefined_flag} $libobjs $deplibs $compiler_flags ${wl}-soname ${wl}$soname `test -n "$verstring" && echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${output_objdir}/so_locations -o $lib'
-      else
-	allow_undefined_flag_GCJ=' -expect_unresolved \*'
-	archive_cmds_GCJ='$LD -shared${allow_undefined_flag} $libobjs $deplibs $linker_flags -soname $soname `test -n "$verstring" && echo -set_version $verstring` -update_registry ${output_objdir}/so_locations -o $lib'
-      fi
-      hardcode_libdir_flag_spec_GCJ='${wl}-rpath ${wl}$libdir'
-      hardcode_libdir_separator_GCJ=:
-      ;;
-
-    osf4* | osf5*)	# as osf3* with the addition of -msym flag
-      if test "$GCC" = yes; then
-	allow_undefined_flag_GCJ=' ${wl}-expect_unresolved ${wl}\*'
-	archive_cmds_GCJ='$CC -shared${allow_undefined_flag} $libobjs $deplibs $compiler_flags ${wl}-msym ${wl}-soname ${wl}$soname `test -n "$verstring" && echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${output_objdir}/so_locations -o $lib'
-	hardcode_libdir_flag_spec_GCJ='${wl}-rpath ${wl}$libdir'
-      else
-	allow_undefined_flag_GCJ=' -expect_unresolved \*'
-	archive_cmds_GCJ='$LD -shared${allow_undefined_flag} $libobjs $deplibs $linker_flags -msym -soname $soname `test -n "$verstring" && echo -set_version $verstring` -update_registry ${output_objdir}/so_locations -o $lib'
-	archive_expsym_cmds_GCJ='for i in `cat $export_symbols`; do printf "%s %s\\n" -exported_symbol "\$i" >> $lib.exp; done; echo "-hidden">> $lib.exp~
-	$LD -shared${allow_undefined_flag} -input $lib.exp $linker_flags $libobjs $deplibs -soname $soname `test -n "$verstring" && echo -set_version $verstring` -update_registry ${objdir}/so_locations -o $lib~$rm $lib.exp'
-
-	# Both c and cxx compiler support -rpath directly
-	hardcode_libdir_flag_spec_GCJ='-rpath $libdir'
-      fi
-      hardcode_libdir_separator_GCJ=:
-      ;;
-
-    sco3.2v5*)
-      archive_cmds_GCJ='$LD -G -h $soname -o $lib $libobjs $deplibs $linker_flags'
-      hardcode_shlibpath_var_GCJ=no
-      export_dynamic_flag_spec_GCJ='${wl}-Bexport'
-      runpath_var=LD_RUN_PATH
-      hardcode_runpath_var=yes
-      ;;
-
-    solaris*)
-      no_undefined_flag_GCJ=' -z text'
-      if test "$GCC" = yes; then
-	archive_cmds_GCJ='$CC -shared ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags'
-	archive_expsym_cmds_GCJ='$echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~$echo "local: *; };" >> $lib.exp~
-	  $CC -shared ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$rm $lib.exp'
-      else
-	archive_cmds_GCJ='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
-	archive_expsym_cmds_GCJ='$echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~$echo "local: *; };" >> $lib.exp~
-  	$LD -G${allow_undefined_flag} -M $lib.exp -h $soname -o $lib $libobjs $deplibs $linker_flags~$rm $lib.exp'
-      fi
-      hardcode_libdir_flag_spec_GCJ='-R$libdir'
-      hardcode_shlibpath_var_GCJ=no
-      case $host_os in
-      solaris2.[0-5] | solaris2.[0-5].*) ;;
-      *) # Supported since Solaris 2.6 (maybe 2.5.1?)
-	whole_archive_flag_spec_GCJ='-z allextract$convenience -z defaultextract' ;;
-      esac
-      link_all_deplibs_GCJ=yes
-      ;;
-
-    sunos4*)
-      if test "x$host_vendor" = xsequent; then
-	# Use $CC to link under sequent, because it throws in some extra .o
-	# files that make .init and .fini sections work.
-	archive_cmds_GCJ='$CC -G ${wl}-h $soname -o $lib $libobjs $deplibs $compiler_flags'
-      else
-	archive_cmds_GCJ='$LD -assert pure-text -Bstatic -o $lib $libobjs $deplibs $linker_flags'
-      fi
-      hardcode_libdir_flag_spec_GCJ='-L$libdir'
-      hardcode_direct_GCJ=yes
-      hardcode_minus_L_GCJ=yes
-      hardcode_shlibpath_var_GCJ=no
-      ;;
-
-    sysv4)
-      case $host_vendor in
-	sni)
-	  archive_cmds_GCJ='$LD -G -h $soname -o $lib $libobjs $deplibs $linker_flags'
-	  hardcode_direct_GCJ=yes # is this really true???
-	;;
-	siemens)
-	  ## LD is ld it makes a PLAMLIB
-	  ## CC just makes a GrossModule.
-	  archive_cmds_GCJ='$LD -G -o $lib $libobjs $deplibs $linker_flags'
-	  reload_cmds_GCJ='$CC -r -o $output$reload_objs'
-	  hardcode_direct_GCJ=no
-        ;;
-	motorola)
-	  archive_cmds_GCJ='$LD -G -h $soname -o $lib $libobjs $deplibs $linker_flags'
-	  hardcode_direct_GCJ=no #Motorola manual says yes, but my tests say they lie
-	;;
-      esac
-      runpath_var='LD_RUN_PATH'
-      hardcode_shlibpath_var_GCJ=no
-      ;;
-
-    sysv4.3*)
-      archive_cmds_GCJ='$LD -G -h $soname -o $lib $libobjs $deplibs $linker_flags'
-      hardcode_shlibpath_var_GCJ=no
-      export_dynamic_flag_spec_GCJ='-Bexport'
-      ;;
-
-    sysv4*MP*)
-      if test -d /usr/nec; then
-	archive_cmds_GCJ='$LD -G -h $soname -o $lib $libobjs $deplibs $linker_flags'
-	hardcode_shlibpath_var_GCJ=no
-	runpath_var=LD_RUN_PATH
-	hardcode_runpath_var=yes
-	ld_shlibs_GCJ=yes
-      fi
-      ;;
-
-    sysv4.2uw2*)
-      archive_cmds_GCJ='$LD -G -o $lib $libobjs $deplibs $linker_flags'
-      hardcode_direct_GCJ=yes
-      hardcode_minus_L_GCJ=no
-      hardcode_shlibpath_var_GCJ=no
-      hardcode_runpath_var=yes
-      runpath_var=LD_RUN_PATH
-      ;;
-
-   sysv5OpenUNIX8* | sysv5UnixWare7* |  sysv5uw[78]* | unixware7*)
-      no_undefined_flag_GCJ='${wl}-z ${wl}text'
-      if test "$GCC" = yes; then
-	archive_cmds_GCJ='$CC -shared ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags'
-      else
-	archive_cmds_GCJ='$CC -G ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags'
-      fi
-      runpath_var='LD_RUN_PATH'
-      hardcode_shlibpath_var_GCJ=no
-      ;;
-
-    sysv5*)
-      no_undefined_flag_GCJ=' -z text'
-      # $CC -shared without GNU ld will not create a library from C++
-      # object files and a static libstdc++, better avoid it by now
-      archive_cmds_GCJ='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'
-      archive_expsym_cmds_GCJ='$echo "{ global:" > $lib.exp~cat $export_symbols | $SED -e "s/\(.*\)/\1;/" >> $lib.exp~$echo "local: *; };" >> $lib.exp~
-  		$LD -G${allow_undefined_flag} -M $lib.exp -h $soname -o $lib $libobjs $deplibs $linker_flags~$rm $lib.exp'
-      hardcode_libdir_flag_spec_GCJ=
-      hardcode_shlibpath_var_GCJ=no
-      runpath_var='LD_RUN_PATH'
-      ;;
-
-    uts4*)
-      archive_cmds_GCJ='$LD -G -h $soname -o $lib $libobjs $deplibs $linker_flags'
-      hardcode_libdir_flag_spec_GCJ='-L$libdir'
-      hardcode_shlibpath_var_GCJ=no
-      ;;
-
-    *)
-      ld_shlibs_GCJ=no
-      ;;
-    esac
-  fi
-
-echo "$as_me:$LINENO: result: $ld_shlibs_GCJ" >&5
-echo "${ECHO_T}$ld_shlibs_GCJ" >&6
-test "$ld_shlibs_GCJ" = no && can_build_shared=no
-
-variables_saved_for_relink="PATH $shlibpath_var $runpath_var"
-if test "$GCC" = yes; then
-  variables_saved_for_relink="$variables_saved_for_relink GCC_EXEC_PREFIX COMPILER_PATH LIBRARY_PATH"
-fi
-
-#
-# Do we need to explicitly link libc?
-#
-case "x$archive_cmds_need_lc_GCJ" in
-x|xyes)
-  # Assume -lc should be added
-  archive_cmds_need_lc_GCJ=yes
-
-  if test "$enable_shared" = yes && test "$GCC" = yes; then
-    case $archive_cmds_GCJ in
-    *'~'*)
-      # FIXME: we may have to deal with multi-command sequences.
-      ;;
-    '$CC '*)
-      # Test whether the compiler implicitly links with -lc since on some
-      # systems, -lgcc has to come before -lc. If gcc already passes -lc
-      # to ld, don't add -lc before -lgcc.
-      echo "$as_me:$LINENO: checking whether -lc should be explicitly linked in" >&5
-echo $ECHO_N "checking whether -lc should be explicitly linked in... $ECHO_C" >&6
-      $rm conftest*
-      printf "$lt_simple_compile_test_code" > conftest.$ac_ext
-
-      if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
-  (eval $ac_compile) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } 2>conftest.err; then
-        soname=conftest
-        lib=conftest
-        libobjs=conftest.$ac_objext
-        deplibs=
-        wl=$lt_prog_compiler_wl_GCJ
-        compiler_flags=-v
-        linker_flags=-v
-        verstring=
-        output_objdir=.
-        libname=conftest
-        lt_save_allow_undefined_flag=$allow_undefined_flag_GCJ
-        allow_undefined_flag_GCJ=
-        if { (eval echo "$as_me:$LINENO: \"$archive_cmds_GCJ 2\>\&1 \| grep \" -lc \" \>/dev/null 2\>\&1\"") >&5
-  (eval $archive_cmds_GCJ 2\>\&1 \| grep \" -lc \" \>/dev/null 2\>\&1) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }
-        then
-	  archive_cmds_need_lc_GCJ=no
-        else
-	  archive_cmds_need_lc_GCJ=yes
-        fi
-        allow_undefined_flag_GCJ=$lt_save_allow_undefined_flag
-      else
-        cat conftest.err 1>&5
-      fi
-      $rm conftest*
-      echo "$as_me:$LINENO: result: $archive_cmds_need_lc_GCJ" >&5
-echo "${ECHO_T}$archive_cmds_need_lc_GCJ" >&6
-      ;;
-    esac
-  fi
-  ;;
-esac
-
-echo "$as_me:$LINENO: checking dynamic linker characteristics" >&5
-echo $ECHO_N "checking dynamic linker characteristics... $ECHO_C" >&6
-library_names_spec=
-libname_spec='lib$name'
-soname_spec=
-shrext_cmds=".so"
-postinstall_cmds=
-postuninstall_cmds=
-finish_cmds=
-finish_eval=
-shlibpath_var=
-shlibpath_overrides_runpath=unknown
-version_type=none
-dynamic_linker="$host_os ld.so"
-sys_lib_dlsearch_path_spec="/lib /usr/lib"
-if test "$GCC" = yes; then
-  sys_lib_search_path_spec=`$CC -print-search-dirs | grep "^libraries:" | $SED -e "s/^libraries://" -e "s,=/,/,g"`
-  if echo "$sys_lib_search_path_spec" | grep ';' >/dev/null ; then
-    # if the path contains ";" then we assume it to be the separator
-    # otherwise default to the standard path separator (i.e. ":") - it is
-    # assumed that no part of a normal pathname contains ";" but that should
-    # okay in the real world where ";" in dirpaths is itself problematic.
-    sys_lib_search_path_spec=`echo "$sys_lib_search_path_spec" | $SED -e 's/;/ /g'`
-  else
-    sys_lib_search_path_spec=`echo "$sys_lib_search_path_spec" | $SED  -e "s/$PATH_SEPARATOR/ /g"`
-  fi
-else
-  sys_lib_search_path_spec="/lib /usr/lib /usr/local/lib"
-fi
-need_lib_prefix=unknown
-hardcode_into_libs=no
-
-# when you set need_version to no, make sure it does not cause -set_version
-# flags to be left without arguments
-need_version=unknown
-
-case $host_os in
-aix3*)
-  version_type=linux
-  library_names_spec='${libname}${release}${shared_ext}$versuffix $libname.a'
-  shlibpath_var=LIBPATH
-
-  # AIX 3 has no versioning support, so we append a major version to the name.
-  soname_spec='${libname}${release}${shared_ext}$major'
-  ;;
-
-aix4* | aix5*)
-  version_type=linux
-  need_lib_prefix=no
-  need_version=no
-  hardcode_into_libs=yes
-  if test "$host_cpu" = ia64; then
-    # AIX 5 supports IA64
-    library_names_spec='${libname}${release}${shared_ext}$major ${libname}${release}${shared_ext}$versuffix $libname${shared_ext}'
-    shlibpath_var=LD_LIBRARY_PATH
-  else
-    # With GCC up to 2.95.x, collect2 would create an import file
-    # for dependence libraries.  The import file would start with
-    # the line `#! .'.  This would cause the generated library to
-    # depend on `.', always an invalid library.  This was fixed in
-    # development snapshots of GCC prior to 3.0.
-    case $host_os in
-      aix4 | aix4.[01] | aix4.[01].*)
-      if { echo '#if __GNUC__ > 2 || (__GNUC__ == 2 && __GNUC_MINOR__ >= 97)'
-	   echo ' yes '
-	   echo '#endif'; } | ${CC} -E - | grep yes > /dev/null; then
-	:
-      else
-	can_build_shared=no
-      fi
-      ;;
-    esac
-    # AIX (on Power*) has no versioning support, so currently we can not hardcode correct
-    # soname into executable. Probably we can add versioning support to
-    # collect2, so additional links can be useful in future.
-    if test "$aix_use_runtimelinking" = yes; then
-      # If using run time linking (on AIX 4.2 or later) use lib<name>.so
-      # instead of lib<name>.a to let people know that these are not
-      # typical AIX shared libraries.
-      library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-    else
-      # We preserve .a as extension for shared libraries through AIX4.2
-      # and later when we are not doing run time linking.
-      library_names_spec='${libname}${release}.a $libname.a'
-      soname_spec='${libname}${release}${shared_ext}$major'
-    fi
-    shlibpath_var=LIBPATH
-  fi
-  ;;
-
-amigaos*)
-  library_names_spec='$libname.ixlibrary $libname.a'
-  # Create ${libname}_ixlibrary.a entries in /sys/libs.
-  finish_eval='for lib in `ls $libdir/*.ixlibrary 2>/dev/null`; do libname=`$echo "X$lib" | $Xsed -e '\''s%^.*/\([^/]*\)\.ixlibrary$%\1%'\''`; test $rm /sys/libs/${libname}_ixlibrary.a; $show "cd /sys/libs && $LN_S $lib ${libname}_ixlibrary.a"; cd /sys/libs && $LN_S $lib ${libname}_ixlibrary.a || exit 1; done'
-  ;;
-
-beos*)
-  library_names_spec='${libname}${shared_ext}'
-  dynamic_linker="$host_os ld.so"
-  shlibpath_var=LIBRARY_PATH
-  ;;
-
-bsdi4*)
-  version_type=linux
-  need_version=no
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-  soname_spec='${libname}${release}${shared_ext}$major'
-  finish_cmds='PATH="\$PATH:/sbin" ldconfig $libdir'
-  shlibpath_var=LD_LIBRARY_PATH
-  sys_lib_search_path_spec="/shlib /usr/lib /usr/X11/lib /usr/contrib/lib /lib /usr/local/lib"
-  sys_lib_dlsearch_path_spec="/shlib /usr/lib /usr/local/lib"
-  # the default ld.so.conf also contains /usr/contrib/lib and
-  # /usr/X11R6/lib (/usr/X11 is a link to /usr/X11R6), but let us allow
-  # libtool to hard-code these into programs
-  ;;
-
-cygwin* | mingw* | pw32*)
-  version_type=windows
-  shrext_cmds=".dll"
-  need_version=no
-  need_lib_prefix=no
-
-  case $GCC,$host_os in
-  yes,cygwin* | yes,mingw* | yes,pw32*)
-    library_names_spec='$libname.dll.a'
-    # DLL is installed to $(libdir)/../bin by postinstall_cmds
-    postinstall_cmds='base_file=`basename \${file}`~
-      dlpath=`$SHELL 2>&1 -c '\''. $dir/'\''\${base_file}'\''i;echo \$dlname'\''`~
-      dldir=$destdir/`dirname \$dlpath`~
-      test -d \$dldir || mkdir -p \$dldir~
-      $install_prog $dir/$dlname \$dldir/$dlname'
-    postuninstall_cmds='dldll=`$SHELL 2>&1 -c '\''. $file; echo \$dlname'\''`~
-      dlpath=$dir/\$dldll~
-       $rm \$dlpath'
-    shlibpath_overrides_runpath=yes
-
-    case $host_os in
-    cygwin*)
-      # Cygwin DLLs use 'cyg' prefix rather than 'lib'
-      soname_spec='`echo ${libname} | sed -e 's/^lib/cyg/'``echo ${release} | $SED -e 's/[.]/-/g'`${versuffix}${shared_ext}'
-      sys_lib_search_path_spec="/usr/lib /lib/w32api /lib /usr/local/lib"
-      ;;
-    mingw*)
-      # MinGW DLLs use traditional 'lib' prefix
-      soname_spec='${libname}`echo ${release} | $SED -e 's/[.]/-/g'`${versuffix}${shared_ext}'
-      sys_lib_search_path_spec=`$CC -print-search-dirs | grep "^libraries:" | $SED -e "s/^libraries://" -e "s,=/,/,g"`
-      if echo "$sys_lib_search_path_spec" | grep ';[c-zC-Z]:/' >/dev/null; then
-        # It is most probably a Windows format PATH printed by
-        # mingw gcc, but we are running on Cygwin. Gcc prints its search
-        # path with ; separators, and with drive letters. We can handle the
-        # drive letters (cygwin fileutils understands them), so leave them,
-        # especially as we might pass files found there to a mingw objdump,
-        # which wouldn't understand a cygwinified path. Ahh.
-        sys_lib_search_path_spec=`echo "$sys_lib_search_path_spec" | $SED -e 's/;/ /g'`
-      else
-        sys_lib_search_path_spec=`echo "$sys_lib_search_path_spec" | $SED  -e "s/$PATH_SEPARATOR/ /g"`
-      fi
-      ;;
-    pw32*)
-      # pw32 DLLs use 'pw' prefix rather than 'lib'
-      library_names_spec='`echo ${libname} | sed -e 's/^lib/pw/'``echo ${release} | $SED -e 's/./-/g'`${versuffix}${shared_ext}'
-      ;;
-    esac
-    ;;
-
-  *)
-    library_names_spec='${libname}`echo ${release} | $SED -e 's/[.]/-/g'`${versuffix}${shared_ext} $libname.lib'
-    ;;
-  esac
-  dynamic_linker='Win32 ld.exe'
-  # FIXME: first we should search . and the directory the executable is in
-  shlibpath_var=PATH
-  ;;
-
-darwin* | rhapsody*)
-  dynamic_linker="$host_os dyld"
-  version_type=darwin
-  need_lib_prefix=no
-  need_version=no
-  library_names_spec='${libname}${release}${versuffix}$shared_ext ${libname}${release}${major}$shared_ext ${libname}$shared_ext'
-  soname_spec='${libname}${release}${major}$shared_ext'
-  shlibpath_overrides_runpath=yes
-  shlibpath_var=DYLD_LIBRARY_PATH
-  shrext_cmds='$(test .$module = .yes && echo .so || echo .dylib)'
-  # Apple's gcc prints 'gcc -print-search-dirs' doesn't operate the same.
-  if test "$GCC" = yes; then
-    sys_lib_search_path_spec=`$CC -print-search-dirs | tr "\n" "$PATH_SEPARATOR" | sed -e 's/libraries:/@libraries:/' | tr "@" "\n" | grep "^libraries:" | sed -e "s/^libraries://" -e "s,=/,/,g" -e "s,$PATH_SEPARATOR, ,g" -e "s,.*,& /lib /usr/lib /usr/local/lib,g"`
-  else
-    sys_lib_search_path_spec='/lib /usr/lib /usr/local/lib'
-  fi
-  sys_lib_dlsearch_path_spec='/usr/local/lib /lib /usr/lib'
-  ;;
-
-dgux*)
-  version_type=linux
-  need_lib_prefix=no
-  need_version=no
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname$shared_ext'
-  soname_spec='${libname}${release}${shared_ext}$major'
-  shlibpath_var=LD_LIBRARY_PATH
-  ;;
-
-freebsd1*)
-  dynamic_linker=no
-  ;;
-
-kfreebsd*-gnu)
-  version_type=linux
-  need_lib_prefix=no
-  need_version=no
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${shared_ext}'
-  soname_spec='${libname}${release}${shared_ext}$major'
-  shlibpath_var=LD_LIBRARY_PATH
-  shlibpath_overrides_runpath=no
-  hardcode_into_libs=yes
-  dynamic_linker='GNU ld.so'
-  ;;
-
-freebsd*)
-  objformat=`test -x /usr/bin/objformat && /usr/bin/objformat || echo aout`
-  version_type=freebsd-$objformat
-  case $version_type in
-    freebsd-elf*)
-      library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext} $libname${shared_ext}'
-      need_version=no
-      need_lib_prefix=no
-      ;;
-    freebsd-*)
-      library_names_spec='${libname}${release}${shared_ext}$versuffix $libname${shared_ext}$versuffix'
-      need_version=yes
-      ;;
-  esac
-  shlibpath_var=LD_LIBRARY_PATH
-  case $host_os in
-  freebsd2*)
-    shlibpath_overrides_runpath=yes
-    ;;
-  freebsd3.01* | freebsdelf3.01*)
-    shlibpath_overrides_runpath=yes
-    hardcode_into_libs=yes
-    ;;
-  *) # from 3.2 on
-    shlibpath_overrides_runpath=no
-    hardcode_into_libs=yes
-    ;;
-  esac
-  ;;
-
-gnu*)
-  version_type=linux
-  need_lib_prefix=no
-  need_version=no
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}${major} ${libname}${shared_ext}'
-  soname_spec='${libname}${release}${shared_ext}$major'
-  shlibpath_var=LD_LIBRARY_PATH
-  hardcode_into_libs=yes
-  ;;
-
-hpux9* | hpux10* | hpux11*)
-  # Give a soname corresponding to the major version so that dld.sl refuses to
-  # link against other versions.
-  version_type=sunos
-  need_lib_prefix=no
-  need_version=no
-  case "$host_cpu" in
-  ia64*)
-    shrext_cmds='.so'
-    hardcode_into_libs=yes
-    dynamic_linker="$host_os dld.so"
-    shlibpath_var=LD_LIBRARY_PATH
-    shlibpath_overrides_runpath=yes # Unless +noenvvar is specified.
-    library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-    soname_spec='${libname}${release}${shared_ext}$major'
-    if test "X$HPUX_IA64_MODE" = X32; then
-      sys_lib_search_path_spec="/usr/lib/hpux32 /usr/local/lib/hpux32 /usr/local/lib"
-    else
-      sys_lib_search_path_spec="/usr/lib/hpux64 /usr/local/lib/hpux64"
-    fi
-    sys_lib_dlsearch_path_spec=$sys_lib_search_path_spec
-    ;;
-   hppa*64*)
-     shrext_cmds='.sl'
-     hardcode_into_libs=yes
-     dynamic_linker="$host_os dld.sl"
-     shlibpath_var=LD_LIBRARY_PATH # How should we handle SHLIB_PATH
-     shlibpath_overrides_runpath=yes # Unless +noenvvar is specified.
-     library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-     soname_spec='${libname}${release}${shared_ext}$major'
-     sys_lib_search_path_spec="/usr/lib/pa20_64 /usr/ccs/lib/pa20_64"
-     sys_lib_dlsearch_path_spec=$sys_lib_search_path_spec
-     ;;
-   *)
-    shrext_cmds='.sl'
-    dynamic_linker="$host_os dld.sl"
-    shlibpath_var=SHLIB_PATH
-    shlibpath_overrides_runpath=no # +s is required to enable SHLIB_PATH
-    library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-    soname_spec='${libname}${release}${shared_ext}$major'
-    ;;
-  esac
-  # HP-UX runs *really* slowly unless shared libraries are mode 555.
-  postinstall_cmds='chmod 555 $lib'
-  ;;
-
-irix5* | irix6* | nonstopux*)
-  case $host_os in
-    nonstopux*) version_type=nonstopux ;;
-    *)
-	if test "$lt_cv_prog_gnu_ld" = yes; then
-		version_type=linux
-	else
-		version_type=irix
-	fi ;;
-  esac
-  need_lib_prefix=no
-  need_version=no
-  soname_spec='${libname}${release}${shared_ext}$major'
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${release}${shared_ext} $libname${shared_ext}'
-  case $host_os in
-  irix5* | nonstopux*)
-    libsuff= shlibsuff=
-    ;;
-  *)
-    case $LD in # libtool.m4 will add one of these switches to LD
-    *-32|*"-32 "|*-melf32bsmip|*"-melf32bsmip ")
-      libsuff= shlibsuff= libmagic=32-bit;;
-    *-n32|*"-n32 "|*-melf32bmipn32|*"-melf32bmipn32 ")
-      libsuff=32 shlibsuff=N32 libmagic=N32;;
-    *-64|*"-64 "|*-melf64bmip|*"-melf64bmip ")
-      libsuff=64 shlibsuff=64 libmagic=64-bit;;
-    *) libsuff= shlibsuff= libmagic=never-match;;
-    esac
-    ;;
-  esac
-  shlibpath_var=LD_LIBRARY${shlibsuff}_PATH
-  shlibpath_overrides_runpath=no
-  sys_lib_search_path_spec="/usr/lib${libsuff} /lib${libsuff} /usr/local/lib${libsuff}"
-  sys_lib_dlsearch_path_spec="/usr/lib${libsuff} /lib${libsuff}"
-  hardcode_into_libs=yes
-  ;;
-
-# No shared lib support for Linux oldld, aout, or coff.
-linux*oldld* | linux*aout* | linux*coff*)
-  dynamic_linker=no
-  ;;
-
-# This must be Linux ELF.
-linux*)
-  version_type=linux
-  need_lib_prefix=no
-  need_version=no
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-  soname_spec='${libname}${release}${shared_ext}$major'
-  finish_cmds='PATH="\$PATH:/sbin" ldconfig -n $libdir'
-  shlibpath_var=LD_LIBRARY_PATH
-  shlibpath_overrides_runpath=no
-  # This implies no fast_install, which is unacceptable.
-  # Some rework will be needed to allow for fast_install
-  # before this can be enabled.
-  hardcode_into_libs=yes
-
-  # Append ld.so.conf contents to the search path
-  if test -f /etc/ld.so.conf; then
-    lt_ld_extra=`$SED -e 's/:,\t/ /g;s/=^=*$//;s/=^= * / /g' /etc/ld.so.conf | tr '\n' ' '`
-    sys_lib_dlsearch_path_spec="/lib /usr/lib $lt_ld_extra"
-  fi
-
-  # We used to test for /lib/ld.so.1 and disable shared libraries on
-  # powerpc, because MkLinux only supported shared libraries with the
-  # GNU dynamic linker.  Since this was broken with cross compilers,
-  # most powerpc-linux boxes support dynamic linking these days and
-  # people can always --disable-shared, the test was removed, and we
-  # assume the GNU/Linux dynamic linker is in use.
-  dynamic_linker='GNU/Linux ld.so'
-  ;;
-
-netbsdelf*-gnu)
-  version_type=linux
-  need_lib_prefix=no
-  need_version=no
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${shared_ext}'
-  soname_spec='${libname}${release}${shared_ext}$major'
-  shlibpath_var=LD_LIBRARY_PATH
-  shlibpath_overrides_runpath=no
-  hardcode_into_libs=yes
-  dynamic_linker='NetBSD ld.elf_so'
-  ;;
-
-knetbsd*-gnu)
-  version_type=linux
-  need_lib_prefix=no
-  need_version=no
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${shared_ext}'
-  soname_spec='${libname}${release}${shared_ext}$major'
-  shlibpath_var=LD_LIBRARY_PATH
-  shlibpath_overrides_runpath=no
-  hardcode_into_libs=yes
-  dynamic_linker='GNU ld.so'
-  ;;
-
-netbsd*)
-  version_type=sunos
-  need_lib_prefix=no
-  need_version=no
-  if echo __ELF__ | $CC -E - | grep __ELF__ >/dev/null; then
-    library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
-    finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
-    dynamic_linker='NetBSD (a.out) ld.so'
-  else
-    library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${shared_ext}'
-    soname_spec='${libname}${release}${shared_ext}$major'
-    dynamic_linker='NetBSD ld.elf_so'
-  fi
-  shlibpath_var=LD_LIBRARY_PATH
-  shlibpath_overrides_runpath=yes
-  hardcode_into_libs=yes
-  ;;
-
-newsos6)
-  version_type=linux
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-  shlibpath_var=LD_LIBRARY_PATH
-  shlibpath_overrides_runpath=yes
-  ;;
-
-nto-qnx*)
-  version_type=linux
-  need_lib_prefix=no
-  need_version=no
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-  soname_spec='${libname}${release}${shared_ext}$major'
-  shlibpath_var=LD_LIBRARY_PATH
-  shlibpath_overrides_runpath=yes
-  ;;
-
-openbsd*)
-  version_type=sunos
-  need_lib_prefix=no
-  need_version=yes
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
-  finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
-  shlibpath_var=LD_LIBRARY_PATH
-  if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
-    case $host_os in
-      openbsd2.[89] | openbsd2.[89].*)
-	shlibpath_overrides_runpath=no
-	;;
-      *)
-	shlibpath_overrides_runpath=yes
-	;;
-      esac
-  else
-    shlibpath_overrides_runpath=yes
-  fi
-  ;;
-
-os2*)
-  libname_spec='$name'
-  shrext_cmds=".dll"
-  need_lib_prefix=no
-  library_names_spec='$libname${shared_ext} $libname.a'
-  dynamic_linker='OS/2 ld.exe'
-  shlibpath_var=LIBPATH
-  ;;
-
-osf3* | osf4* | osf5*)
-  version_type=osf
-  need_lib_prefix=no
-  need_version=no
-  soname_spec='${libname}${release}${shared_ext}$major'
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-  shlibpath_var=LD_LIBRARY_PATH
-  sys_lib_search_path_spec="/usr/shlib /usr/ccs/lib /usr/lib/cmplrs/cc /usr/lib /usr/local/lib /var/shlib"
-  sys_lib_dlsearch_path_spec="$sys_lib_search_path_spec"
-  ;;
-
-sco3.2v5*)
-  version_type=osf
-  soname_spec='${libname}${release}${shared_ext}$major'
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-  shlibpath_var=LD_LIBRARY_PATH
-  ;;
-
-solaris*)
-  version_type=linux
-  need_lib_prefix=no
-  need_version=no
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-  soname_spec='${libname}${release}${shared_ext}$major'
-  shlibpath_var=LD_LIBRARY_PATH
-  shlibpath_overrides_runpath=yes
-  hardcode_into_libs=yes
-  # ldd complains unless libraries are executable
-  postinstall_cmds='chmod +x $lib'
-  ;;
-
-sunos4*)
-  version_type=sunos
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
-  finish_cmds='PATH="\$PATH:/usr/etc" ldconfig $libdir'
-  shlibpath_var=LD_LIBRARY_PATH
-  shlibpath_overrides_runpath=yes
-  if test "$with_gnu_ld" = yes; then
-    need_lib_prefix=no
-  fi
-  need_version=yes
-  ;;
-
-sysv4 | sysv4.2uw2* | sysv4.3* | sysv5*)
-  version_type=linux
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-  soname_spec='${libname}${release}${shared_ext}$major'
-  shlibpath_var=LD_LIBRARY_PATH
-  case $host_vendor in
-    sni)
-      shlibpath_overrides_runpath=no
-      need_lib_prefix=no
-      export_dynamic_flag_spec='${wl}-Blargedynsym'
-      runpath_var=LD_RUN_PATH
-      ;;
-    siemens)
-      need_lib_prefix=no
-      ;;
-    motorola)
-      need_lib_prefix=no
-      need_version=no
-      shlibpath_overrides_runpath=no
-      sys_lib_search_path_spec='/lib /usr/lib /usr/ccs/lib'
-      ;;
-  esac
-  ;;
-
-sysv4*MP*)
-  if test -d /usr/nec ;then
-    version_type=linux
-    library_names_spec='$libname${shared_ext}.$versuffix $libname${shared_ext}.$major $libname${shared_ext}'
-    soname_spec='$libname${shared_ext}.$major'
-    shlibpath_var=LD_LIBRARY_PATH
-  fi
-  ;;
-
-uts4*)
-  version_type=linux
-  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'
-  soname_spec='${libname}${release}${shared_ext}$major'
-  shlibpath_var=LD_LIBRARY_PATH
-  ;;
-
-*)
-  dynamic_linker=no
-  ;;
-esac
-echo "$as_me:$LINENO: result: $dynamic_linker" >&5
-echo "${ECHO_T}$dynamic_linker" >&6
-test "$dynamic_linker" = no && can_build_shared=no
-
-echo "$as_me:$LINENO: checking how to hardcode library paths into programs" >&5
-echo $ECHO_N "checking how to hardcode library paths into programs... $ECHO_C" >&6
-hardcode_action_GCJ=
-if test -n "$hardcode_libdir_flag_spec_GCJ" || \
-   test -n "$runpath_var GCJ" || \
-   test "X$hardcode_automatic_GCJ"="Xyes" ; then
-
-  # We can hardcode non-existant directories.
-  if test "$hardcode_direct_GCJ" != no &&
-     # If the only mechanism to avoid hardcoding is shlibpath_var, we
-     # have to relink, otherwise we might link with an installed library
-     # when we should be linking with a yet-to-be-installed one
-     ## test "$_LT_AC_TAGVAR(hardcode_shlibpath_var, GCJ)" != no &&
-     test "$hardcode_minus_L_GCJ" != no; then
-    # Linking always hardcodes the temporary library directory.
-    hardcode_action_GCJ=relink
-  else
-    # We can link without hardcoding, and we can hardcode nonexisting dirs.
-    hardcode_action_GCJ=immediate
-  fi
-else
-  # We cannot hardcode anything, or else we can only hardcode existing
-  # directories.
-  hardcode_action_GCJ=unsupported
-fi
-echo "$as_me:$LINENO: result: $hardcode_action_GCJ" >&5
-echo "${ECHO_T}$hardcode_action_GCJ" >&6
-
-if test "$hardcode_action_GCJ" = relink; then
-  # Fast installation is not supported
-  enable_fast_install=no
-elif test "$shlibpath_overrides_runpath" = yes ||
-     test "$enable_shared" = no; then
-  # Fast installation is not necessary
-  enable_fast_install=needless
-fi
-
-striplib=
-old_striplib=
-echo "$as_me:$LINENO: checking whether stripping libraries is possible" >&5
-echo $ECHO_N "checking whether stripping libraries is possible... $ECHO_C" >&6
-if test -n "$STRIP" && $STRIP -V 2>&1 | grep "GNU strip" >/dev/null; then
-  test -z "$old_striplib" && old_striplib="$STRIP --strip-debug"
-  test -z "$striplib" && striplib="$STRIP --strip-unneeded"
-  echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
-else
-# FIXME - insert some real tests, host_os isn't really good enough
-  case $host_os in
-   darwin*)
-       if test -n "$STRIP" ; then
-         striplib="$STRIP -x"
-         echo "$as_me:$LINENO: result: yes" >&5
-echo "${ECHO_T}yes" >&6
-       else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi
-       ;;
-   *)
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-    ;;
-  esac
-fi
-
-if test "x$enable_dlopen" != xyes; then
-  enable_dlopen=unknown
-  enable_dlopen_self=unknown
-  enable_dlopen_self_static=unknown
-else
-  lt_cv_dlopen=no
-  lt_cv_dlopen_libs=
-
-  case $host_os in
-  beos*)
-    lt_cv_dlopen="load_add_on"
-    lt_cv_dlopen_libs=
-    lt_cv_dlopen_self=yes
-    ;;
-
-  mingw* | pw32*)
-    lt_cv_dlopen="LoadLibrary"
-    lt_cv_dlopen_libs=
-   ;;
-
-  cygwin*)
-    lt_cv_dlopen="dlopen"
-    lt_cv_dlopen_libs=
-   ;;
-
-  darwin*)
-  # if libdl is installed we need to link against it
-    echo "$as_me:$LINENO: checking for dlopen in -ldl" >&5
-echo $ECHO_N "checking for dlopen in -ldl... $ECHO_C" >&6
-if test "${ac_cv_lib_dl_dlopen+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  ac_check_lib_save_LIBS=$LIBS
-LIBS="-ldl  $LIBS"
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-/* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char dlopen ();
-int
-main ()
-{
-dlopen ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_lib_dl_dlopen=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_cv_lib_dl_dlopen=no
-fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_dl_dlopen" >&5
-echo "${ECHO_T}$ac_cv_lib_dl_dlopen" >&6
-if test $ac_cv_lib_dl_dlopen = yes; then
-  lt_cv_dlopen="dlopen" lt_cv_dlopen_libs="-ldl"
-else
-
-    lt_cv_dlopen="dyld"
-    lt_cv_dlopen_libs=
-    lt_cv_dlopen_self=yes
-
-fi
-
-   ;;
-
-  *)
-    echo "$as_me:$LINENO: checking for shl_load" >&5
-echo $ECHO_N "checking for shl_load... $ECHO_C" >&6
-if test "${ac_cv_func_shl_load+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-/* Define shl_load to an innocuous variant, in case <limits.h> declares shl_load.
-   For example, HP-UX 11i <limits.h> declares gettimeofday.  */
-#define shl_load innocuous_shl_load
-
-/* System header to define __stub macros and hopefully few prototypes,
-    which can conflict with char shl_load (); below.
-    Prefer <limits.h> to <assert.h> if __STDC__ is defined, since
-    <limits.h> exists even on freestanding compilers.  */
-
-#ifdef __STDC__
-# include <limits.h>
-#else
-# include <assert.h>
-#endif
-
-#undef shl_load
-
-/* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-{
-#endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char shl_load ();
-/* The GNU C library defines this for functions which it implements
-    to always fail with ENOSYS.  Some functions are actually named
-    something starting with __ and the normal name is an alias.  */
-#if defined (__stub_shl_load) || defined (__stub___shl_load)
-choke me
-#else
-char (*f) () = shl_load;
-#endif
-#ifdef __cplusplus
-}
-#endif
-
-int
-main ()
-{
-return f != shl_load;
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_func_shl_load=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_cv_func_shl_load=no
-fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-fi
-echo "$as_me:$LINENO: result: $ac_cv_func_shl_load" >&5
-echo "${ECHO_T}$ac_cv_func_shl_load" >&6
-if test $ac_cv_func_shl_load = yes; then
-  lt_cv_dlopen="shl_load"
-else
-  echo "$as_me:$LINENO: checking for shl_load in -ldld" >&5
-echo $ECHO_N "checking for shl_load in -ldld... $ECHO_C" >&6
-if test "${ac_cv_lib_dld_shl_load+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  ac_check_lib_save_LIBS=$LIBS
-LIBS="-ldld  $LIBS"
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-/* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char shl_load ();
-int
-main ()
-{
-shl_load ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_lib_dld_shl_load=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_cv_lib_dld_shl_load=no
-fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_dld_shl_load" >&5
-echo "${ECHO_T}$ac_cv_lib_dld_shl_load" >&6
-if test $ac_cv_lib_dld_shl_load = yes; then
-  lt_cv_dlopen="shl_load" lt_cv_dlopen_libs="-dld"
-else
-  echo "$as_me:$LINENO: checking for dlopen" >&5
-echo $ECHO_N "checking for dlopen... $ECHO_C" >&6
-if test "${ac_cv_func_dlopen+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-/* Define dlopen to an innocuous variant, in case <limits.h> declares dlopen.
-   For example, HP-UX 11i <limits.h> declares gettimeofday.  */
-#define dlopen innocuous_dlopen
-
-/* System header to define __stub macros and hopefully few prototypes,
-    which can conflict with char dlopen (); below.
-    Prefer <limits.h> to <assert.h> if __STDC__ is defined, since
-    <limits.h> exists even on freestanding compilers.  */
-
-#ifdef __STDC__
-# include <limits.h>
-#else
-# include <assert.h>
-#endif
-
-#undef dlopen
-
-/* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-{
-#endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char dlopen ();
-/* The GNU C library defines this for functions which it implements
-    to always fail with ENOSYS.  Some functions are actually named
-    something starting with __ and the normal name is an alias.  */
-#if defined (__stub_dlopen) || defined (__stub___dlopen)
-choke me
-#else
-char (*f) () = dlopen;
-#endif
-#ifdef __cplusplus
-}
-#endif
-
-int
-main ()
-{
-return f != dlopen;
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_func_dlopen=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_cv_func_dlopen=no
-fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-fi
-echo "$as_me:$LINENO: result: $ac_cv_func_dlopen" >&5
-echo "${ECHO_T}$ac_cv_func_dlopen" >&6
-if test $ac_cv_func_dlopen = yes; then
-  lt_cv_dlopen="dlopen"
-else
-  echo "$as_me:$LINENO: checking for dlopen in -ldl" >&5
-echo $ECHO_N "checking for dlopen in -ldl... $ECHO_C" >&6
-if test "${ac_cv_lib_dl_dlopen+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  ac_check_lib_save_LIBS=$LIBS
-LIBS="-ldl  $LIBS"
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-/* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char dlopen ();
-int
-main ()
-{
-dlopen ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_lib_dl_dlopen=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_cv_lib_dl_dlopen=no
-fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_dl_dlopen" >&5
-echo "${ECHO_T}$ac_cv_lib_dl_dlopen" >&6
-if test $ac_cv_lib_dl_dlopen = yes; then
-  lt_cv_dlopen="dlopen" lt_cv_dlopen_libs="-ldl"
-else
-  echo "$as_me:$LINENO: checking for dlopen in -lsvld" >&5
-echo $ECHO_N "checking for dlopen in -lsvld... $ECHO_C" >&6
-if test "${ac_cv_lib_svld_dlopen+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  ac_check_lib_save_LIBS=$LIBS
-LIBS="-lsvld  $LIBS"
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-/* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char dlopen ();
-int
-main ()
-{
-dlopen ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_lib_svld_dlopen=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_cv_lib_svld_dlopen=no
-fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_svld_dlopen" >&5
-echo "${ECHO_T}$ac_cv_lib_svld_dlopen" >&6
-if test $ac_cv_lib_svld_dlopen = yes; then
-  lt_cv_dlopen="dlopen" lt_cv_dlopen_libs="-lsvld"
-else
-  echo "$as_me:$LINENO: checking for dld_link in -ldld" >&5
-echo $ECHO_N "checking for dld_link in -ldld... $ECHO_C" >&6
-if test "${ac_cv_lib_dld_dld_link+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  ac_check_lib_save_LIBS=$LIBS
-LIBS="-ldld  $LIBS"
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-/* Override any gcc2 internal prototype to avoid an error.  */
-#ifdef __cplusplus
-extern "C"
-#endif
-/* We use char because int might match the return type of a gcc2
-   builtin and then its argument prototype would still apply.  */
-char dld_link ();
-int
-main ()
-{
-dld_link ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_lib_dld_dld_link=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-ac_cv_lib_dld_dld_link=no
-fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_dld_dld_link" >&5
-echo "${ECHO_T}$ac_cv_lib_dld_dld_link" >&6
-if test $ac_cv_lib_dld_dld_link = yes; then
-  lt_cv_dlopen="dld_link" lt_cv_dlopen_libs="-dld"
-fi
-
-
-fi
-
-
-fi
-
-
-fi
-
-
-fi
-
-
-fi
-
-    ;;
-  esac
-
-  if test "x$lt_cv_dlopen" != xno; then
-    enable_dlopen=yes
-  else
-    enable_dlopen=no
-  fi
-
-  case $lt_cv_dlopen in
-  dlopen)
-    save_CPPFLAGS="$CPPFLAGS"
-    test "x$ac_cv_header_dlfcn_h" = xyes && CPPFLAGS="$CPPFLAGS -DHAVE_DLFCN_H"
-
-    save_LDFLAGS="$LDFLAGS"
-    eval LDFLAGS=\"\$LDFLAGS $export_dynamic_flag_spec\"
-
-    save_LIBS="$LIBS"
-    LIBS="$lt_cv_dlopen_libs $LIBS"
-
-    echo "$as_me:$LINENO: checking whether a program can dlopen itself" >&5
-echo $ECHO_N "checking whether a program can dlopen itself... $ECHO_C" >&6
-if test "${lt_cv_dlopen_self+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  	  if test "$cross_compiling" = yes; then :
-  lt_cv_dlopen_self=cross
-else
-  lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
-  lt_status=$lt_dlunknown
-  cat > conftest.$ac_ext <<EOF
-#line 18154 "configure"
-#include "confdefs.h"
-
-#if HAVE_DLFCN_H
-#include <dlfcn.h>
-#endif
-
-#include <stdio.h>
-
-#ifdef RTLD_GLOBAL
-#  define LT_DLGLOBAL		RTLD_GLOBAL
-#else
-#  ifdef DL_GLOBAL
-#    define LT_DLGLOBAL		DL_GLOBAL
-#  else
-#    define LT_DLGLOBAL		0
-#  endif
-#endif
-
-/* We may have to define LT_DLLAZY_OR_NOW in the command line if we
-   find out it does not work in some platform. */
-#ifndef LT_DLLAZY_OR_NOW
-#  ifdef RTLD_LAZY
-#    define LT_DLLAZY_OR_NOW		RTLD_LAZY
-#  else
-#    ifdef DL_LAZY
-#      define LT_DLLAZY_OR_NOW		DL_LAZY
-#    else
-#      ifdef RTLD_NOW
-#        define LT_DLLAZY_OR_NOW	RTLD_NOW
-#      else
-#        ifdef DL_NOW
-#          define LT_DLLAZY_OR_NOW	DL_NOW
-#        else
-#          define LT_DLLAZY_OR_NOW	0
-#        endif
-#      endif
-#    endif
-#  endif
-#endif
-
-#ifdef __cplusplus
-extern "C" void exit (int);
-#endif
-
-void fnord() { int i=42;}
-int main ()
-{
-  void *self = dlopen (0, LT_DLGLOBAL|LT_DLLAZY_OR_NOW);
-  int status = $lt_dlunknown;
-
-  if (self)
-    {
-      if (dlsym (self,"fnord"))       status = $lt_dlno_uscore;
-      else if (dlsym( self,"_fnord")) status = $lt_dlneed_uscore;
-      /* dlclose (self); */
-    }
-
-    exit (status);
-}
-EOF
-  if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && test -s conftest${ac_exeext} 2>/dev/null; then
-    (./conftest; exit; ) 2>/dev/null
-    lt_status=$?
-    case x$lt_status in
-      x$lt_dlno_uscore) lt_cv_dlopen_self=yes ;;
-      x$lt_dlneed_uscore) lt_cv_dlopen_self=yes ;;
-      x$lt_unknown|x*) lt_cv_dlopen_self=no ;;
-    esac
-  else :
-    # compilation failed
-    lt_cv_dlopen_self=no
-  fi
-fi
-rm -fr conftest*
-
-
-fi
-echo "$as_me:$LINENO: result: $lt_cv_dlopen_self" >&5
-echo "${ECHO_T}$lt_cv_dlopen_self" >&6
-
-    if test "x$lt_cv_dlopen_self" = xyes; then
-      LDFLAGS="$LDFLAGS $link_static_flag"
-      echo "$as_me:$LINENO: checking whether a statically linked program can dlopen itself" >&5
-echo $ECHO_N "checking whether a statically linked program can dlopen itself... $ECHO_C" >&6
-if test "${lt_cv_dlopen_self_static+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  	  if test "$cross_compiling" = yes; then :
-  lt_cv_dlopen_self_static=cross
-else
-  lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
-  lt_status=$lt_dlunknown
-  cat > conftest.$ac_ext <<EOF
-#line 18252 "configure"
-#include "confdefs.h"
-
-#if HAVE_DLFCN_H
-#include <dlfcn.h>
-#endif
-
-#include <stdio.h>
-
-#ifdef RTLD_GLOBAL
-#  define LT_DLGLOBAL		RTLD_GLOBAL
-#else
-#  ifdef DL_GLOBAL
-#    define LT_DLGLOBAL		DL_GLOBAL
-#  else
-#    define LT_DLGLOBAL		0
-#  endif
-#endif
-
-/* We may have to define LT_DLLAZY_OR_NOW in the command line if we
-   find out it does not work in some platform. */
-#ifndef LT_DLLAZY_OR_NOW
-#  ifdef RTLD_LAZY
-#    define LT_DLLAZY_OR_NOW		RTLD_LAZY
-#  else
-#    ifdef DL_LAZY
-#      define LT_DLLAZY_OR_NOW		DL_LAZY
-#    else
-#      ifdef RTLD_NOW
-#        define LT_DLLAZY_OR_NOW	RTLD_NOW
-#      else
-#        ifdef DL_NOW
-#          define LT_DLLAZY_OR_NOW	DL_NOW
-#        else
-#          define LT_DLLAZY_OR_NOW	0
-#        endif
-#      endif
-#    endif
-#  endif
-#endif
-
-#ifdef __cplusplus
-extern "C" void exit (int);
-#endif
-
-void fnord() { int i=42;}
-int main ()
-{
-  void *self = dlopen (0, LT_DLGLOBAL|LT_DLLAZY_OR_NOW);
-  int status = $lt_dlunknown;
-
-  if (self)
-    {
-      if (dlsym (self,"fnord"))       status = $lt_dlno_uscore;
-      else if (dlsym( self,"_fnord")) status = $lt_dlneed_uscore;
-      /* dlclose (self); */
-    }
-
-    exit (status);
-}
-EOF
-  if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && test -s conftest${ac_exeext} 2>/dev/null; then
-    (./conftest; exit; ) 2>/dev/null
-    lt_status=$?
-    case x$lt_status in
-      x$lt_dlno_uscore) lt_cv_dlopen_self_static=yes ;;
-      x$lt_dlneed_uscore) lt_cv_dlopen_self_static=yes ;;
-      x$lt_unknown|x*) lt_cv_dlopen_self_static=no ;;
-    esac
-  else :
-    # compilation failed
-    lt_cv_dlopen_self_static=no
-  fi
-fi
-rm -fr conftest*
-
-
-fi
-echo "$as_me:$LINENO: result: $lt_cv_dlopen_self_static" >&5
-echo "${ECHO_T}$lt_cv_dlopen_self_static" >&6
-    fi
-
-    CPPFLAGS="$save_CPPFLAGS"
-    LDFLAGS="$save_LDFLAGS"
-    LIBS="$save_LIBS"
-    ;;
-  esac
-
-  case $lt_cv_dlopen_self in
-  yes|no) enable_dlopen_self=$lt_cv_dlopen_self ;;
-  *) enable_dlopen_self=unknown ;;
-  esac
-
-  case $lt_cv_dlopen_self_static in
-  yes|no) enable_dlopen_self_static=$lt_cv_dlopen_self_static ;;
-  *) enable_dlopen_self_static=unknown ;;
-  esac
-fi
-
-
-# The else clause should only fire when bootstrapping the
-# libtool distribution, otherwise you forgot to ship ltmain.sh
-# with your package, and you will get complaints that there are
-# no rules to generate ltmain.sh.
-if test -f "$ltmain"; then
-  # See if we are running on zsh, and set the options which allow our commands through
-  # without removal of \ escapes.
-  if test -n "${ZSH_VERSION+set}" ; then
-    setopt NO_GLOB_SUBST
-  fi
-  # Now quote all the things that may contain metacharacters while being
-  # careful not to overquote the AC_SUBSTed values.  We take copies of the
-  # variables and quote the copies for generation of the libtool script.
-  for var in echo old_CC old_CFLAGS AR AR_FLAGS EGREP RANLIB LN_S LTCC NM \
-    SED SHELL STRIP \
-    libname_spec library_names_spec soname_spec extract_expsyms_cmds \
-    old_striplib striplib file_magic_cmd finish_cmds finish_eval \
-    deplibs_check_method reload_flag reload_cmds need_locks \
-    lt_cv_sys_global_symbol_pipe lt_cv_sys_global_symbol_to_cdecl \
-    lt_cv_sys_global_symbol_to_c_name_address \
-    sys_lib_search_path_spec sys_lib_dlsearch_path_spec \
-    old_postinstall_cmds old_postuninstall_cmds \
-    compiler_GCJ \
-    CC_GCJ \
-    LD_GCJ \
-    lt_prog_compiler_wl_GCJ \
-    lt_prog_compiler_pic_GCJ \
-    lt_prog_compiler_static_GCJ \
-    lt_prog_compiler_no_builtin_flag_GCJ \
-    export_dynamic_flag_spec_GCJ \
-    thread_safe_flag_spec_GCJ \
-    whole_archive_flag_spec_GCJ \
-    enable_shared_with_static_runtimes_GCJ \
-    old_archive_cmds_GCJ \
-    old_archive_from_new_cmds_GCJ \
-    predep_objects_GCJ \
-    postdep_objects_GCJ \
-    predeps_GCJ \
-    postdeps_GCJ \
-    compiler_lib_search_path_GCJ \
-    archive_cmds_GCJ \
-    archive_expsym_cmds_GCJ \
-    postinstall_cmds_GCJ \
-    postuninstall_cmds_GCJ \
-    old_archive_from_expsyms_cmds_GCJ \
-    allow_undefined_flag_GCJ \
-    no_undefined_flag_GCJ \
-    export_symbols_cmds_GCJ \
-    hardcode_libdir_flag_spec_GCJ \
-    hardcode_libdir_flag_spec_ld_GCJ \
-    hardcode_libdir_separator_GCJ \
-    hardcode_automatic_GCJ \
-    module_cmds_GCJ \
-    module_expsym_cmds_GCJ \
-    lt_cv_prog_compiler_c_o_GCJ \
-    exclude_expsyms_GCJ \
-    include_expsyms_GCJ; do
-
-    case $var in
-    old_archive_cmds_GCJ | \
-    old_archive_from_new_cmds_GCJ | \
-    archive_cmds_GCJ | \
-    archive_expsym_cmds_GCJ | \
-    module_cmds_GCJ | \
-    module_expsym_cmds_GCJ | \
-    old_archive_from_expsyms_cmds_GCJ | \
-    export_symbols_cmds_GCJ | \
-    extract_expsyms_cmds | reload_cmds | finish_cmds | \
-    postinstall_cmds | postuninstall_cmds | \
-    old_postinstall_cmds | old_postuninstall_cmds | \
-    sys_lib_search_path_spec | sys_lib_dlsearch_path_spec)
-      # Double-quote double-evaled strings.
-      eval "lt_$var=\\\"\`\$echo \"X\$$var\" | \$Xsed -e \"\$double_quote_subst\" -e \"\$sed_quote_subst\" -e \"\$delay_variable_subst\"\`\\\""
-      ;;
-    *)
-      eval "lt_$var=\\\"\`\$echo \"X\$$var\" | \$Xsed -e \"\$sed_quote_subst\"\`\\\""
-      ;;
-    esac
-  done
-
-  case $lt_echo in
-  *'\$0 --fallback-echo"')
-    lt_echo=`$echo "X$lt_echo" | $Xsed -e 's/\\\\\\\$0 --fallback-echo"$/$0 --fallback-echo"/'`
-    ;;
-  esac
-
-cfgfile="$ofile"
-
-  cat <<__EOF__ >> "$cfgfile"
-# ### BEGIN LIBTOOL TAG CONFIG: $tagname
-
-# Libtool was configured on host `(hostname || uname -n) 2>/dev/null | sed 1q`:
-
-# Shell to use when invoking shell scripts.
-SHELL=$lt_SHELL
-
-# Whether or not to build shared libraries.
-build_libtool_libs=$enable_shared
-
-# Whether or not to build static libraries.
-build_old_libs=$enable_static
-
-# Whether or not to add -lc for building shared libraries.
-build_libtool_need_lc=$archive_cmds_need_lc_GCJ
-
-# Whether or not to disallow shared libs when runtime libs are static
-allow_libtool_libs_with_static_runtimes=$enable_shared_with_static_runtimes_GCJ
-
-# Whether or not to optimize for fast installation.
-fast_install=$enable_fast_install
-
-# The host system.
-host_alias=$host_alias
-host=$host
-
-# An echo program that does not interpret backslashes.
-echo=$lt_echo
-
-# The archiver.
-AR=$lt_AR
-AR_FLAGS=$lt_AR_FLAGS
-
-# A C compiler.
-LTCC=$lt_LTCC
-
-# A language-specific compiler.
-CC=$lt_compiler_GCJ
-
-# Is the compiler the GNU C compiler?
-with_gcc=$GCC_GCJ
-
-# An ERE matcher.
-EGREP=$lt_EGREP
-
-# The linker used to build libraries.
-LD=$lt_LD_GCJ
-
-# Whether we need hard or soft links.
-LN_S=$lt_LN_S
-
-# A BSD-compatible nm program.
-NM=$lt_NM
-
-# A symbol stripping program
-STRIP=$lt_STRIP
-
-# Used to examine libraries when file_magic_cmd begins "file"
-MAGIC_CMD=$MAGIC_CMD
-
-# Used on cygwin: DLL creation program.
-DLLTOOL="$DLLTOOL"
-
-# Used on cygwin: object dumper.
-OBJDUMP="$OBJDUMP"
-
-# Used on cygwin: assembler.
-AS="$AS"
-
-# The name of the directory that contains temporary libtool files.
-objdir=$objdir
-
-# How to create reloadable object files.
-reload_flag=$lt_reload_flag
-reload_cmds=$lt_reload_cmds
-
-# How to pass a linker flag through the compiler.
-wl=$lt_lt_prog_compiler_wl_GCJ
-
-# Object file suffix (normally "o").
-objext="$ac_objext"
-
-# Old archive suffix (normally "a").
-libext="$libext"
-
-# Shared library suffix (normally ".so").
-shrext_cmds='$shrext_cmds'
-
-# Executable file suffix (normally "").
-exeext="$exeext"
-
-# Additional compiler flags for building library objects.
-pic_flag=$lt_lt_prog_compiler_pic_GCJ
-pic_mode=$pic_mode
-
-# What is the maximum length of a command?
-max_cmd_len=$lt_cv_sys_max_cmd_len
-
-# Does compiler simultaneously support -c and -o options?
-compiler_c_o=$lt_lt_cv_prog_compiler_c_o_GCJ
-
-# Must we lock files when doing compilation ?
-need_locks=$lt_need_locks
-
-# Do we need the lib prefix for modules?
-need_lib_prefix=$need_lib_prefix
-
-# Do we need a version for libraries?
-need_version=$need_version
-
-# Whether dlopen is supported.
-dlopen_support=$enable_dlopen
-
-# Whether dlopen of programs is supported.
-dlopen_self=$enable_dlopen_self
-
-# Whether dlopen of statically linked programs is supported.
-dlopen_self_static=$enable_dlopen_self_static
-
-# Compiler flag to prevent dynamic linking.
-link_static_flag=$lt_lt_prog_compiler_static_GCJ
-
-# Compiler flag to turn off builtin functions.
-no_builtin_flag=$lt_lt_prog_compiler_no_builtin_flag_GCJ
-
-# Compiler flag to allow reflexive dlopens.
-export_dynamic_flag_spec=$lt_export_dynamic_flag_spec_GCJ
-
-# Compiler flag to generate shared objects directly from archives.
-whole_archive_flag_spec=$lt_whole_archive_flag_spec_GCJ
-
-# Compiler flag to generate thread-safe objects.
-thread_safe_flag_spec=$lt_thread_safe_flag_spec_GCJ
-
-# Library versioning type.
-version_type=$version_type
-
-# Format of library name prefix.
-libname_spec=$lt_libname_spec
-
-# List of archive names.  First name is the real one, the rest are links.
-# The last name is the one that the linker finds with -lNAME.
-library_names_spec=$lt_library_names_spec
-
-# The coded name of the library, if different from the real name.
-soname_spec=$lt_soname_spec
-
-# Commands used to build and install an old-style archive.
-RANLIB=$lt_RANLIB
-old_archive_cmds=$lt_old_archive_cmds_GCJ
-old_postinstall_cmds=$lt_old_postinstall_cmds
-old_postuninstall_cmds=$lt_old_postuninstall_cmds
-
-# Create an old-style archive from a shared archive.
-old_archive_from_new_cmds=$lt_old_archive_from_new_cmds_GCJ
-
-# Create a temporary old-style archive to link instead of a shared archive.
-old_archive_from_expsyms_cmds=$lt_old_archive_from_expsyms_cmds_GCJ
-
-# Commands used to build and install a shared archive.
-archive_cmds=$lt_archive_cmds_GCJ
-archive_expsym_cmds=$lt_archive_expsym_cmds_GCJ
-postinstall_cmds=$lt_postinstall_cmds
-postuninstall_cmds=$lt_postuninstall_cmds
-
-# Commands used to build a loadable module (assumed same as above if empty)
-module_cmds=$lt_module_cmds_GCJ
-module_expsym_cmds=$lt_module_expsym_cmds_GCJ
-
-# Commands to strip libraries.
-old_striplib=$lt_old_striplib
-striplib=$lt_striplib
-
-# Dependencies to place before the objects being linked to create a
-# shared library.
-predep_objects=$lt_predep_objects_GCJ
-
-# Dependencies to place after the objects being linked to create a
-# shared library.
-postdep_objects=$lt_postdep_objects_GCJ
-
-# Dependencies to place before the objects being linked to create a
-# shared library.
-predeps=$lt_predeps_GCJ
-
-# Dependencies to place after the objects being linked to create a
-# shared library.
-postdeps=$lt_postdeps_GCJ
-
-# The library search path used internally by the compiler when linking
-# a shared library.
-compiler_lib_search_path=$lt_compiler_lib_search_path_GCJ
-
-# Method to check whether dependent libraries are shared objects.
-deplibs_check_method=$lt_deplibs_check_method
-
-# Command to use when deplibs_check_method == file_magic.
-file_magic_cmd=$lt_file_magic_cmd
-
-# Flag that allows shared libraries with undefined symbols to be built.
-allow_undefined_flag=$lt_allow_undefined_flag_GCJ
-
-# Flag that forces no undefined symbols.
-no_undefined_flag=$lt_no_undefined_flag_GCJ
-
-# Commands used to finish a libtool library installation in a directory.
-finish_cmds=$lt_finish_cmds
-
-# Same as above, but a single script fragment to be evaled but not shown.
-finish_eval=$lt_finish_eval
-
-# Take the output of nm and produce a listing of raw symbols and C names.
-global_symbol_pipe=$lt_lt_cv_sys_global_symbol_pipe
-
-# Transform the output of nm in a proper C declaration
-global_symbol_to_cdecl=$lt_lt_cv_sys_global_symbol_to_cdecl
-
-# Transform the output of nm in a C name address pair
-global_symbol_to_c_name_address=$lt_lt_cv_sys_global_symbol_to_c_name_address
-
-# This is the shared library runtime path variable.
-runpath_var=$runpath_var
-
-# This is the shared library path variable.
-shlibpath_var=$shlibpath_var
-
-# Is shlibpath searched before the hard-coded library search path?
-shlibpath_overrides_runpath=$shlibpath_overrides_runpath
-
-# How to hardcode a shared library path into an executable.
-hardcode_action=$hardcode_action_GCJ
-
-# Whether we should hardcode library paths into libraries.
-hardcode_into_libs=$hardcode_into_libs
-
-# Flag to hardcode \$libdir into a binary during linking.
-# This must work even if \$libdir does not exist.
-hardcode_libdir_flag_spec=$lt_hardcode_libdir_flag_spec_GCJ
-
-# If ld is used when linking, flag to hardcode \$libdir into
-# a binary during linking. This must work even if \$libdir does
-# not exist.
-hardcode_libdir_flag_spec_ld=$lt_hardcode_libdir_flag_spec_ld_GCJ
-
-# Whether we need a single -rpath flag with a separated argument.
-hardcode_libdir_separator=$lt_hardcode_libdir_separator_GCJ
-
-# Set to yes if using DIR/libNAME${shared_ext} during linking hardcodes DIR into the
-# resulting binary.
-hardcode_direct=$hardcode_direct_GCJ
-
-# Set to yes if using the -LDIR flag during linking hardcodes DIR into the
-# resulting binary.
-hardcode_minus_L=$hardcode_minus_L_GCJ
-
-# Set to yes if using SHLIBPATH_VAR=DIR during linking hardcodes DIR into
-# the resulting binary.
-hardcode_shlibpath_var=$hardcode_shlibpath_var_GCJ
-
-# Set to yes if building a shared library automatically hardcodes DIR into the library
-# and all subsequent libraries and executables linked against it.
-hardcode_automatic=$hardcode_automatic_GCJ
-
-# Variables whose values should be saved in libtool wrapper scripts and
-# restored at relink time.
-variables_saved_for_relink="$variables_saved_for_relink"
-
-# Whether libtool must link a program against all its dependency libraries.
-link_all_deplibs=$link_all_deplibs_GCJ
-
-# Compile-time system search path for libraries
-sys_lib_search_path_spec=$lt_sys_lib_search_path_spec
-
-# Run-time system search path for libraries
-sys_lib_dlsearch_path_spec=$lt_sys_lib_dlsearch_path_spec
-
-# Fix the shell variable \$srcfile for the compiler.
-fix_srcfile_path="$fix_srcfile_path_GCJ"
-
-# Set to yes if exported symbols are required.
-always_export_symbols=$always_export_symbols_GCJ
-
-# The commands to list exported symbols.
-export_symbols_cmds=$lt_export_symbols_cmds_GCJ
-
-# The commands to extract the exported symbol list from a shared archive.
-extract_expsyms_cmds=$lt_extract_expsyms_cmds
-
-# Symbols that should not be listed in the preloaded symbols.
-exclude_expsyms=$lt_exclude_expsyms_GCJ
-
-# Symbols that must always be exported.
-include_expsyms=$lt_include_expsyms_GCJ
-
-# ### END LIBTOOL TAG CONFIG: $tagname
-
-__EOF__
-
-
-else
-  # If there is no Makefile yet, we rely on a make rule to execute
-  # `config.status --recheck' to rerun these tests and create the
-  # libtool script then.
-  ltmain_in=`echo $ltmain | sed -e 's/\.sh$/.in/'`
-  if test -f "$ltmain_in"; then
-    test -f Makefile && make "$ltmain"
-  fi
-fi
-
-
-ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-
-CC="$lt_save_CC"
-
-	else
-	  tagname=""
-	fi
-	;;
-
-      RC)
-
-
-
-# Source file extension for RC test sources.
-ac_ext=rc
-
-# Object file extension for compiled RC test sources.
-objext=o
-objext_RC=$objext
-
-# Code to be used in simple compile tests
-lt_simple_compile_test_code='sample MENU { MENUITEM "&Soup", 100, CHECKED }\n'
-
-# Code to be used in simple link tests
-lt_simple_link_test_code="$lt_simple_compile_test_code"
-
-# ltmain only uses $CC for tagged configurations so make sure $CC is set.
-
-# If no C compiler was specified, use CC.
-LTCC=${LTCC-"$CC"}
-
-# Allow CC to be a program name with arguments.
-compiler=$CC
-
-
-# Allow CC to be a program name with arguments.
-lt_save_CC="$CC"
-CC=${RC-"windres"}
-compiler=$CC
-compiler_RC=$CC
-lt_cv_prog_compiler_c_o_RC=yes
-
-# The else clause should only fire when bootstrapping the
-# libtool distribution, otherwise you forgot to ship ltmain.sh
-# with your package, and you will get complaints that there are
-# no rules to generate ltmain.sh.
-if test -f "$ltmain"; then
-  # See if we are running on zsh, and set the options which allow our commands through
-  # without removal of \ escapes.
-  if test -n "${ZSH_VERSION+set}" ; then
-    setopt NO_GLOB_SUBST
-  fi
-  # Now quote all the things that may contain metacharacters while being
-  # careful not to overquote the AC_SUBSTed values.  We take copies of the
-  # variables and quote the copies for generation of the libtool script.
-  for var in echo old_CC old_CFLAGS AR AR_FLAGS EGREP RANLIB LN_S LTCC NM \
-    SED SHELL STRIP \
-    libname_spec library_names_spec soname_spec extract_expsyms_cmds \
-    old_striplib striplib file_magic_cmd finish_cmds finish_eval \
-    deplibs_check_method reload_flag reload_cmds need_locks \
-    lt_cv_sys_global_symbol_pipe lt_cv_sys_global_symbol_to_cdecl \
-    lt_cv_sys_global_symbol_to_c_name_address \
-    sys_lib_search_path_spec sys_lib_dlsearch_path_spec \
-    old_postinstall_cmds old_postuninstall_cmds \
-    compiler_RC \
-    CC_RC \
-    LD_RC \
-    lt_prog_compiler_wl_RC \
-    lt_prog_compiler_pic_RC \
-    lt_prog_compiler_static_RC \
-    lt_prog_compiler_no_builtin_flag_RC \
-    export_dynamic_flag_spec_RC \
-    thread_safe_flag_spec_RC \
-    whole_archive_flag_spec_RC \
-    enable_shared_with_static_runtimes_RC \
-    old_archive_cmds_RC \
-    old_archive_from_new_cmds_RC \
-    predep_objects_RC \
-    postdep_objects_RC \
-    predeps_RC \
-    postdeps_RC \
-    compiler_lib_search_path_RC \
-    archive_cmds_RC \
-    archive_expsym_cmds_RC \
-    postinstall_cmds_RC \
-    postuninstall_cmds_RC \
-    old_archive_from_expsyms_cmds_RC \
-    allow_undefined_flag_RC \
-    no_undefined_flag_RC \
-    export_symbols_cmds_RC \
-    hardcode_libdir_flag_spec_RC \
-    hardcode_libdir_flag_spec_ld_RC \
-    hardcode_libdir_separator_RC \
-    hardcode_automatic_RC \
-    module_cmds_RC \
-    module_expsym_cmds_RC \
-    lt_cv_prog_compiler_c_o_RC \
-    exclude_expsyms_RC \
-    include_expsyms_RC; do
-
-    case $var in
-    old_archive_cmds_RC | \
-    old_archive_from_new_cmds_RC | \
-    archive_cmds_RC | \
-    archive_expsym_cmds_RC | \
-    module_cmds_RC | \
-    module_expsym_cmds_RC | \
-    old_archive_from_expsyms_cmds_RC | \
-    export_symbols_cmds_RC | \
-    extract_expsyms_cmds | reload_cmds | finish_cmds | \
-    postinstall_cmds | postuninstall_cmds | \
-    old_postinstall_cmds | old_postuninstall_cmds | \
-    sys_lib_search_path_spec | sys_lib_dlsearch_path_spec)
-      # Double-quote double-evaled strings.
-      eval "lt_$var=\\\"\`\$echo \"X\$$var\" | \$Xsed -e \"\$double_quote_subst\" -e \"\$sed_quote_subst\" -e \"\$delay_variable_subst\"\`\\\""
-      ;;
-    *)
-      eval "lt_$var=\\\"\`\$echo \"X\$$var\" | \$Xsed -e \"\$sed_quote_subst\"\`\\\""
-      ;;
-    esac
-  done
-
-  case $lt_echo in
-  *'\$0 --fallback-echo"')
-    lt_echo=`$echo "X$lt_echo" | $Xsed -e 's/\\\\\\\$0 --fallback-echo"$/$0 --fallback-echo"/'`
-    ;;
-  esac
-
-cfgfile="$ofile"
-
-  cat <<__EOF__ >> "$cfgfile"
-# ### BEGIN LIBTOOL TAG CONFIG: $tagname
-
-# Libtool was configured on host `(hostname || uname -n) 2>/dev/null | sed 1q`:
-
-# Shell to use when invoking shell scripts.
-SHELL=$lt_SHELL
-
-# Whether or not to build shared libraries.
-build_libtool_libs=$enable_shared
-
-# Whether or not to build static libraries.
-build_old_libs=$enable_static
-
-# Whether or not to add -lc for building shared libraries.
-build_libtool_need_lc=$archive_cmds_need_lc_RC
-
-# Whether or not to disallow shared libs when runtime libs are static
-allow_libtool_libs_with_static_runtimes=$enable_shared_with_static_runtimes_RC
-
-# Whether or not to optimize for fast installation.
-fast_install=$enable_fast_install
-
-# The host system.
-host_alias=$host_alias
-host=$host
-
-# An echo program that does not interpret backslashes.
-echo=$lt_echo
-
-# The archiver.
-AR=$lt_AR
-AR_FLAGS=$lt_AR_FLAGS
-
-# A C compiler.
-LTCC=$lt_LTCC
-
-# A language-specific compiler.
-CC=$lt_compiler_RC
-
-# Is the compiler the GNU C compiler?
-with_gcc=$GCC_RC
-
-# An ERE matcher.
-EGREP=$lt_EGREP
-
-# The linker used to build libraries.
-LD=$lt_LD_RC
-
-# Whether we need hard or soft links.
-LN_S=$lt_LN_S
-
-# A BSD-compatible nm program.
-NM=$lt_NM
-
-# A symbol stripping program
-STRIP=$lt_STRIP
-
-# Used to examine libraries when file_magic_cmd begins "file"
-MAGIC_CMD=$MAGIC_CMD
-
-# Used on cygwin: DLL creation program.
-DLLTOOL="$DLLTOOL"
-
-# Used on cygwin: object dumper.
-OBJDUMP="$OBJDUMP"
-
-# Used on cygwin: assembler.
-AS="$AS"
-
-# The name of the directory that contains temporary libtool files.
-objdir=$objdir
-
-# How to create reloadable object files.
-reload_flag=$lt_reload_flag
-reload_cmds=$lt_reload_cmds
-
-# How to pass a linker flag through the compiler.
-wl=$lt_lt_prog_compiler_wl_RC
-
-# Object file suffix (normally "o").
-objext="$ac_objext"
-
-# Old archive suffix (normally "a").
-libext="$libext"
-
-# Shared library suffix (normally ".so").
-shrext_cmds='$shrext_cmds'
-
-# Executable file suffix (normally "").
-exeext="$exeext"
-
-# Additional compiler flags for building library objects.
-pic_flag=$lt_lt_prog_compiler_pic_RC
-pic_mode=$pic_mode
-
-# What is the maximum length of a command?
-max_cmd_len=$lt_cv_sys_max_cmd_len
-
-# Does compiler simultaneously support -c and -o options?
-compiler_c_o=$lt_lt_cv_prog_compiler_c_o_RC
-
-# Must we lock files when doing compilation ?
-need_locks=$lt_need_locks
-
-# Do we need the lib prefix for modules?
-need_lib_prefix=$need_lib_prefix
-
-# Do we need a version for libraries?
-need_version=$need_version
-
-# Whether dlopen is supported.
-dlopen_support=$enable_dlopen
-
-# Whether dlopen of programs is supported.
-dlopen_self=$enable_dlopen_self
-
-# Whether dlopen of statically linked programs is supported.
-dlopen_self_static=$enable_dlopen_self_static
-
-# Compiler flag to prevent dynamic linking.
-link_static_flag=$lt_lt_prog_compiler_static_RC
-
-# Compiler flag to turn off builtin functions.
-no_builtin_flag=$lt_lt_prog_compiler_no_builtin_flag_RC
-
-# Compiler flag to allow reflexive dlopens.
-export_dynamic_flag_spec=$lt_export_dynamic_flag_spec_RC
-
-# Compiler flag to generate shared objects directly from archives.
-whole_archive_flag_spec=$lt_whole_archive_flag_spec_RC
-
-# Compiler flag to generate thread-safe objects.
-thread_safe_flag_spec=$lt_thread_safe_flag_spec_RC
-
-# Library versioning type.
-version_type=$version_type
-
-# Format of library name prefix.
-libname_spec=$lt_libname_spec
-
-# List of archive names.  First name is the real one, the rest are links.
-# The last name is the one that the linker finds with -lNAME.
-library_names_spec=$lt_library_names_spec
-
-# The coded name of the library, if different from the real name.
-soname_spec=$lt_soname_spec
-
-# Commands used to build and install an old-style archive.
-RANLIB=$lt_RANLIB
-old_archive_cmds=$lt_old_archive_cmds_RC
-old_postinstall_cmds=$lt_old_postinstall_cmds
-old_postuninstall_cmds=$lt_old_postuninstall_cmds
-
-# Create an old-style archive from a shared archive.
-old_archive_from_new_cmds=$lt_old_archive_from_new_cmds_RC
-
-# Create a temporary old-style archive to link instead of a shared archive.
-old_archive_from_expsyms_cmds=$lt_old_archive_from_expsyms_cmds_RC
-
-# Commands used to build and install a shared archive.
-archive_cmds=$lt_archive_cmds_RC
-archive_expsym_cmds=$lt_archive_expsym_cmds_RC
-postinstall_cmds=$lt_postinstall_cmds
-postuninstall_cmds=$lt_postuninstall_cmds
-
-# Commands used to build a loadable module (assumed same as above if empty)
-module_cmds=$lt_module_cmds_RC
-module_expsym_cmds=$lt_module_expsym_cmds_RC
-
-# Commands to strip libraries.
-old_striplib=$lt_old_striplib
-striplib=$lt_striplib
-
-# Dependencies to place before the objects being linked to create a
-# shared library.
-predep_objects=$lt_predep_objects_RC
-
-# Dependencies to place after the objects being linked to create a
-# shared library.
-postdep_objects=$lt_postdep_objects_RC
-
-# Dependencies to place before the objects being linked to create a
-# shared library.
-predeps=$lt_predeps_RC
-
-# Dependencies to place after the objects being linked to create a
-# shared library.
-postdeps=$lt_postdeps_RC
-
-# The library search path used internally by the compiler when linking
-# a shared library.
-compiler_lib_search_path=$lt_compiler_lib_search_path_RC
-
-# Method to check whether dependent libraries are shared objects.
-deplibs_check_method=$lt_deplibs_check_method
-
-# Command to use when deplibs_check_method == file_magic.
-file_magic_cmd=$lt_file_magic_cmd
-
-# Flag that allows shared libraries with undefined symbols to be built.
-allow_undefined_flag=$lt_allow_undefined_flag_RC
-
-# Flag that forces no undefined symbols.
-no_undefined_flag=$lt_no_undefined_flag_RC
-
-# Commands used to finish a libtool library installation in a directory.
-finish_cmds=$lt_finish_cmds
-
-# Same as above, but a single script fragment to be evaled but not shown.
-finish_eval=$lt_finish_eval
-
-# Take the output of nm and produce a listing of raw symbols and C names.
-global_symbol_pipe=$lt_lt_cv_sys_global_symbol_pipe
-
-# Transform the output of nm in a proper C declaration
-global_symbol_to_cdecl=$lt_lt_cv_sys_global_symbol_to_cdecl
-
-# Transform the output of nm in a C name address pair
-global_symbol_to_c_name_address=$lt_lt_cv_sys_global_symbol_to_c_name_address
-
-# This is the shared library runtime path variable.
-runpath_var=$runpath_var
-
-# This is the shared library path variable.
-shlibpath_var=$shlibpath_var
-
-# Is shlibpath searched before the hard-coded library search path?
-shlibpath_overrides_runpath=$shlibpath_overrides_runpath
-
-# How to hardcode a shared library path into an executable.
-hardcode_action=$hardcode_action_RC
-
-# Whether we should hardcode library paths into libraries.
-hardcode_into_libs=$hardcode_into_libs
-
-# Flag to hardcode \$libdir into a binary during linking.
-# This must work even if \$libdir does not exist.
-hardcode_libdir_flag_spec=$lt_hardcode_libdir_flag_spec_RC
-
-# If ld is used when linking, flag to hardcode \$libdir into
-# a binary during linking. This must work even if \$libdir does
-# not exist.
-hardcode_libdir_flag_spec_ld=$lt_hardcode_libdir_flag_spec_ld_RC
-
-# Whether we need a single -rpath flag with a separated argument.
-hardcode_libdir_separator=$lt_hardcode_libdir_separator_RC
-
-# Set to yes if using DIR/libNAME${shared_ext} during linking hardcodes DIR into the
-# resulting binary.
-hardcode_direct=$hardcode_direct_RC
-
-# Set to yes if using the -LDIR flag during linking hardcodes DIR into the
-# resulting binary.
-hardcode_minus_L=$hardcode_minus_L_RC
-
-# Set to yes if using SHLIBPATH_VAR=DIR during linking hardcodes DIR into
-# the resulting binary.
-hardcode_shlibpath_var=$hardcode_shlibpath_var_RC
-
-# Set to yes if building a shared library automatically hardcodes DIR into the library
-# and all subsequent libraries and executables linked against it.
-hardcode_automatic=$hardcode_automatic_RC
-
-# Variables whose values should be saved in libtool wrapper scripts and
-# restored at relink time.
-variables_saved_for_relink="$variables_saved_for_relink"
-
-# Whether libtool must link a program against all its dependency libraries.
-link_all_deplibs=$link_all_deplibs_RC
-
-# Compile-time system search path for libraries
-sys_lib_search_path_spec=$lt_sys_lib_search_path_spec
-
-# Run-time system search path for libraries
-sys_lib_dlsearch_path_spec=$lt_sys_lib_dlsearch_path_spec
-
-# Fix the shell variable \$srcfile for the compiler.
-fix_srcfile_path="$fix_srcfile_path_RC"
-
-# Set to yes if exported symbols are required.
-always_export_symbols=$always_export_symbols_RC
-
-# The commands to list exported symbols.
-export_symbols_cmds=$lt_export_symbols_cmds_RC
-
-# The commands to extract the exported symbol list from a shared archive.
-extract_expsyms_cmds=$lt_extract_expsyms_cmds
-
-# Symbols that should not be listed in the preloaded symbols.
-exclude_expsyms=$lt_exclude_expsyms_RC
-
-# Symbols that must always be exported.
-include_expsyms=$lt_include_expsyms_RC
-
-# ### END LIBTOOL TAG CONFIG: $tagname
-
-__EOF__
-
-
-else
-  # If there is no Makefile yet, we rely on a make rule to execute
-  # `config.status --recheck' to rerun these tests and create the
-  # libtool script then.
-  ltmain_in=`echo $ltmain | sed -e 's/\.sh$/.in/'`
-  if test -f "$ltmain_in"; then
-    test -f Makefile && make "$ltmain"
-  fi
-fi
-
-
-ac_ext=c
-ac_cpp='$CPP $CPPFLAGS'
-ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
-ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
-ac_compiler_gnu=$ac_cv_c_compiler_gnu
-
-CC="$lt_save_CC"
-
-	;;
-
-      *)
-	{ { echo "$as_me:$LINENO: error: Unsupported tag name: $tagname" >&5
-echo "$as_me: error: Unsupported tag name: $tagname" >&2;}
-   { (exit 1); exit 1; }; }
-	;;
-      esac
-
-      # Append the new tag name to the list of available tags.
-      if test -n "$tagname" ; then
-      available_tags="$available_tags $tagname"
-    fi
-    fi
-  done
-  IFS="$lt_save_ifs"
-
-  # Now substitute the updated list of available tags.
-  if eval "sed -e 's/^available_tags=.*\$/available_tags=\"$available_tags\"/' \"$ofile\" > \"${ofile}T\""; then
-    mv "${ofile}T" "$ofile"
-    chmod +x "$ofile"
-  else
-    rm -f "${ofile}T"
-    { { echo "$as_me:$LINENO: error: unable to update list of available tagged configurations." >&5
-echo "$as_me: error: unable to update list of available tagged configurations." >&2;}
-   { (exit 1); exit 1; }; }
-  fi
-fi
-
-
-
-# This can be used to rebuild libtool when needed
-LIBTOOL_DEPS="$ac_aux_dir/ltmain.sh"
-
-# Always use our own libtool.
-LIBTOOL='$(SHELL) $(top_builddir)/libtool'
-
-# Prevent multiple expansion
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-# gtk-doc
-
-
-# Check whether --with-html-dir or --without-html-dir was given.
-if test "${with_html_dir+set}" = set; then
-  withval="$with_html_dir"
-
-else
-  with_html_dir='${datadir}/gtk-doc/html'
-fi;
-  HTML_DIR="$with_html_dir"
-
-
-    # Check whether --enable-gtk-doc or --disable-gtk-doc was given.
-if test "${enable_gtk_doc+set}" = set; then
-  enableval="$enable_gtk_doc"
-
-else
-  enable_gtk_doc=no
-fi;
-
-  have_gtk_doc=no
-  if test x$enable_gtk_doc = xyes; then
-    if test -z "$PKG_CONFIG"; then
-      # Extract the first word of "pkg-config", so it can be a program name with args.
-set dummy pkg-config; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_path_PKG_CONFIG+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  case $PKG_CONFIG in
-  [\\/]* | ?:[\\/]*)
-  ac_cv_path_PKG_CONFIG="$PKG_CONFIG" # Let the user override the test with a path.
-  ;;
-  *)
-  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_path_PKG_CONFIG="$as_dir/$ac_word$ac_exec_ext"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
-  test -z "$ac_cv_path_PKG_CONFIG" && ac_cv_path_PKG_CONFIG="no"
-  ;;
-esac
-fi
-PKG_CONFIG=$ac_cv_path_PKG_CONFIG
-
-if test -n "$PKG_CONFIG"; then
-  echo "$as_me:$LINENO: result: $PKG_CONFIG" >&5
-echo "${ECHO_T}$PKG_CONFIG" >&6
-else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi
-
-    fi
-    if test "$PKG_CONFIG" != "no" && $PKG_CONFIG --exists gtk-doc; then
-      have_gtk_doc=yes
-    fi
-
-
-    if test "$have_gtk_doc" != yes; then
-      enable_gtk_doc=no
-    fi
-  fi
-
-
-
-if test x$enable_gtk_doc = xyes; then
-  ENABLE_GTK_DOC_TRUE=
-  ENABLE_GTK_DOC_FALSE='#'
-else
-  ENABLE_GTK_DOC_TRUE='#'
-  ENABLE_GTK_DOC_FALSE=
-fi
-
-
-
-if test -n "$LIBTOOL"; then
-  GTK_DOC_USE_LIBTOOL_TRUE=
-  GTK_DOC_USE_LIBTOOL_FALSE='#'
-else
-  GTK_DOC_USE_LIBTOOL_TRUE='#'
-  GTK_DOC_USE_LIBTOOL_FALSE=
-fi
-
-
-
-# glib
-# Check whether --enable-glibtest or --disable-glibtest was given.
-if test "${enable_glibtest+set}" = set; then
-  enableval="$enable_glibtest"
-
-else
-  enable_glibtest=yes
-fi;
-
-  pkg_config_args=glib-2.0
-  for module in . gmodule gobject
-  do
-      case "$module" in
-         gmodule)
-             pkg_config_args="$pkg_config_args gmodule-2.0"
-         ;;
-         gmodule-no-export)
-             pkg_config_args="$pkg_config_args gmodule-no-export-2.0"
-         ;;
-         gobject)
-             pkg_config_args="$pkg_config_args gobject-2.0"
-         ;;
-         gthread)
-             pkg_config_args="$pkg_config_args gthread-2.0"
-         ;;
-      esac
-  done
-
-  # Extract the first word of "pkg-config", so it can be a program name with args.
-set dummy pkg-config; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_path_PKG_CONFIG+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  case $PKG_CONFIG in
-  [\\/]* | ?:[\\/]*)
-  ac_cv_path_PKG_CONFIG="$PKG_CONFIG" # Let the user override the test with a path.
-  ;;
-  *)
-  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_path_PKG_CONFIG="$as_dir/$ac_word$ac_exec_ext"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
-  test -z "$ac_cv_path_PKG_CONFIG" && ac_cv_path_PKG_CONFIG="no"
-  ;;
-esac
-fi
-PKG_CONFIG=$ac_cv_path_PKG_CONFIG
-
-if test -n "$PKG_CONFIG"; then
-  echo "$as_me:$LINENO: result: $PKG_CONFIG" >&5
-echo "${ECHO_T}$PKG_CONFIG" >&6
-else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi
-
-
-  no_glib=""
-
-  if test x$PKG_CONFIG != xno ; then
-    if $PKG_CONFIG --atleast-pkgconfig-version 0.7 ; then
-      :
-    else
-      echo *** pkg-config too old; version 0.7 or better required.
-      no_glib=yes
-      PKG_CONFIG=no
-    fi
-  else
-    no_glib=yes
-  fi
-
-  min_glib_version=2.0.0
-  echo "$as_me:$LINENO: checking for GLIB - version >= $min_glib_version" >&5
-echo $ECHO_N "checking for GLIB - version >= $min_glib_version... $ECHO_C" >&6
-
-  if test x$PKG_CONFIG != xno ; then
-    ## don't try to run the test against uninstalled libtool libs
-    if $PKG_CONFIG --uninstalled $pkg_config_args; then
-	  echo "Will use uninstalled version of GLib found in PKG_CONFIG_PATH"
-	  enable_glibtest=no
-    fi
-
-    if $PKG_CONFIG --atleast-version $min_glib_version $pkg_config_args; then
-	  :
-    else
-	  no_glib=yes
-    fi
-  fi
-
-  if test x"$no_glib" = x ; then
-    GLIB_GENMARSHAL=`$PKG_CONFIG --variable=glib_genmarshal glib-2.0`
-    GOBJECT_QUERY=`$PKG_CONFIG --variable=gobject_query glib-2.0`
-    GLIB_MKENUMS=`$PKG_CONFIG --variable=glib_mkenums glib-2.0`
-
-    GLIB_CFLAGS=`$PKG_CONFIG --cflags $pkg_config_args`
-    GLIB_LIBS=`$PKG_CONFIG --libs $pkg_config_args`
-    glib_config_major_version=`$PKG_CONFIG --modversion glib-2.0 | \
-           sed 's/\([0-9]*\).\([0-9]*\).\([0-9]*\)/\1/'`
-    glib_config_minor_version=`$PKG_CONFIG --modversion glib-2.0 | \
-           sed 's/\([0-9]*\).\([0-9]*\).\([0-9]*\)/\2/'`
-    glib_config_micro_version=`$PKG_CONFIG --modversion glib-2.0 | \
-           sed 's/\([0-9]*\).\([0-9]*\).\([0-9]*\)/\3/'`
-    if test "x$enable_glibtest" = "xyes" ; then
-      ac_save_CFLAGS="$CFLAGS"
-      ac_save_LIBS="$LIBS"
-      CFLAGS="$CFLAGS $GLIB_CFLAGS"
-      LIBS="$GLIB_LIBS $LIBS"
-      rm -f conf.glibtest
-      if test "$cross_compiling" = yes; then
-  echo $ac_n "cross compiling; assumed OK... $ac_c"
-else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-#include <glib.h>
-#include <stdio.h>
-#include <stdlib.h>
-
-int
-main ()
-{
-  int major, minor, micro;
-  char *tmp_version;
-
-  system ("touch conf.glibtest");
-
-  /* HP/UX 9 (%@#!) writes to sscanf strings */
-  tmp_version = g_strdup("$min_glib_version");
-  if (sscanf(tmp_version, "%d.%d.%d", &major, &minor, &micro) != 3) {
-     printf("%s, bad version string\n", "$min_glib_version");
-     exit(1);
-   }
-
-  if ((glib_major_version != $glib_config_major_version) ||
-      (glib_minor_version != $glib_config_minor_version) ||
-      (glib_micro_version != $glib_config_micro_version))
-    {
-      printf("\n*** 'pkg-config --modversion glib-2.0' returned %d.%d.%d, but GLIB (%d.%d.%d)\n",
-             $glib_config_major_version, $glib_config_minor_version, $glib_config_micro_version,
-             glib_major_version, glib_minor_version, glib_micro_version);
-      printf ("*** was found! If pkg-config was correct, then it is best\n");
-      printf ("*** to remove the old version of GLib. You may also be able to fix the error\n");
-      printf("*** by modifying your LD_LIBRARY_PATH enviroment variable, or by editing\n");
-      printf("*** /etc/ld.so.conf. Make sure you have run ldconfig if that is\n");
-      printf("*** required on your system.\n");
-      printf("*** If pkg-config was wrong, set the environment variable PKG_CONFIG_PATH\n");
-      printf("*** to point to the correct configuration files\n");
-    }
-  else if ((glib_major_version != GLIB_MAJOR_VERSION) ||
-	   (glib_minor_version != GLIB_MINOR_VERSION) ||
-           (glib_micro_version != GLIB_MICRO_VERSION))
-    {
-      printf("*** GLIB header files (version %d.%d.%d) do not match\n",
-	     GLIB_MAJOR_VERSION, GLIB_MINOR_VERSION, GLIB_MICRO_VERSION);
-      printf("*** library (version %d.%d.%d)\n",
-	     glib_major_version, glib_minor_version, glib_micro_version);
-    }
-  else
-    {
-      if ((glib_major_version > major) ||
-        ((glib_major_version == major) && (glib_minor_version > minor)) ||
-        ((glib_major_version == major) && (glib_minor_version == minor) && (glib_micro_version >= micro)))
-      {
-        return 0;
-       }
-     else
-      {
-        printf("\n*** An old version of GLIB (%d.%d.%d) was found.\n",
-               glib_major_version, glib_minor_version, glib_micro_version);
-        printf("*** You need a version of GLIB newer than %d.%d.%d. The latest version of\n",
-	       major, minor, micro);
-        printf("*** GLIB is always available from ftp://ftp.gtk.org.\n");
-        printf("***\n");
-        printf("*** If you have already installed a sufficiently new version, this error\n");
-        printf("*** probably means that the wrong copy of the pkg-config shell script is\n");
-        printf("*** being found. The easiest way to fix this is to remove the old version\n");
-        printf("*** of GLIB, but you can also set the PKG_CONFIG environment to point to the\n");
-        printf("*** correct copy of pkg-config. (In this case, you will have to\n");
-        printf("*** modify your LD_LIBRARY_PATH enviroment variable, or edit /etc/ld.so.conf\n");
-        printf("*** so that the correct libraries are found at run-time))\n");
-      }
-    }
-  return 1;
-}
-
-_ACEOF
-rm -f conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && { ac_try='./conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  :
-else
-  echo "$as_me: program exited with status $ac_status" >&5
-echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-( exit $ac_status )
-no_glib=yes
-fi
-rm -f core *.core gmon.out bb.out conftest$ac_exeext conftest.$ac_objext conftest.$ac_ext
-fi
-       CFLAGS="$ac_save_CFLAGS"
-       LIBS="$ac_save_LIBS"
-     fi
-  fi
-  if test "x$no_glib" = x ; then
-     echo "$as_me:$LINENO: result: yes (version $glib_config_major_version.$glib_config_minor_version.$glib_config_micro_version)" >&5
-echo "${ECHO_T}yes (version $glib_config_major_version.$glib_config_minor_version.$glib_config_micro_version)" >&6
-     :
-  else
-     echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-     if test "$PKG_CONFIG" = "no" ; then
-       echo "*** A new enough version of pkg-config was not found."
-       echo "*** See http://www.freedesktop.org/software/pkgconfig/"
-     else
-       if test -f conf.glibtest ; then
-        :
-       else
-          echo "*** Could not run GLIB test program, checking why..."
-          ac_save_CFLAGS="$CFLAGS"
-          ac_save_LIBS="$LIBS"
-          CFLAGS="$CFLAGS $GLIB_CFLAGS"
-          LIBS="$LIBS $GLIB_LIBS"
-          cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-#include <glib.h>
-#include <stdio.h>
-
-int
-main ()
-{
- return ((glib_major_version) || (glib_minor_version) || (glib_micro_version));
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-   echo "*** The test program compiled, but did not run. This usually means"
-          echo "*** that the run-time linker is not finding GLIB or finding the wrong"
-          echo "*** version of GLIB. If it is not finding GLIB, you'll need to set your"
-          echo "*** LD_LIBRARY_PATH environment variable, or edit /etc/ld.so.conf to point"
-          echo "*** to the installed location  Also, make sure you have run ldconfig if that"
-          echo "*** is required on your system"
-	  echo "***"
-          echo "*** If you have an old version installed, it is best to remove it, although"
-          echo "*** you may also be able to get things to work by modifying LD_LIBRARY_PATH"
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
- echo "*** The test program failed to compile or link. See the file config.log for the"
-          echo "*** exact error that occured. This usually means GLIB is incorrectly installed."
-fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-          CFLAGS="$ac_save_CFLAGS"
-          LIBS="$ac_save_LIBS"
-       fi
-     fi
-     GLIB_CFLAGS=""
-     GLIB_LIBS=""
-     GLIB_GENMARSHAL=""
-     GOBJECT_QUERY=""
-     GLIB_MKENUMS=""
-     { { echo "$as_me:$LINENO: error: glib >= 2.0 is needed" >&5
-echo "$as_me: error: glib >= 2.0 is needed" >&2;}
-   { (exit 1); exit 1; }; }
-  fi
-
-
-
-
-
-  rm -f conf.glibtest
-
-
-# gdk-pixbuf
-# Check whether --enable-gtktest or --disable-gtktest was given.
-if test "${enable_gtktest+set}" = set; then
-  enableval="$enable_gtktest"
-
-else
-  enable_gtktest=yes
-fi;
-
-  pkg_config_args=gtk+-2.0
-  for module in .
-  do
-      case "$module" in
-         gthread)
-             pkg_config_args="$pkg_config_args gthread-2.0"
-         ;;
-      esac
-  done
-
-  no_gtk=""
-
-  # Extract the first word of "pkg-config", so it can be a program name with args.
-set dummy pkg-config; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_path_PKG_CONFIG+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  case $PKG_CONFIG in
-  [\\/]* | ?:[\\/]*)
-  ac_cv_path_PKG_CONFIG="$PKG_CONFIG" # Let the user override the test with a path.
-  ;;
-  *)
-  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_path_PKG_CONFIG="$as_dir/$ac_word$ac_exec_ext"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
-  test -z "$ac_cv_path_PKG_CONFIG" && ac_cv_path_PKG_CONFIG="no"
-  ;;
-esac
-fi
-PKG_CONFIG=$ac_cv_path_PKG_CONFIG
-
-if test -n "$PKG_CONFIG"; then
-  echo "$as_me:$LINENO: result: $PKG_CONFIG" >&5
-echo "${ECHO_T}$PKG_CONFIG" >&6
-else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi
-
-
-  if test x$PKG_CONFIG != xno ; then
-    if pkg-config --atleast-pkgconfig-version 0.7 ; then
-      :
-    else
-      echo "*** pkg-config too old; version 0.7 or better required."
-      no_gtk=yes
-      PKG_CONFIG=no
-    fi
-  else
-    no_gtk=yes
-  fi
-
-  min_gtk_version=2.0.0
-  echo "$as_me:$LINENO: checking for GTK+ - version >= $min_gtk_version" >&5
-echo $ECHO_N "checking for GTK+ - version >= $min_gtk_version... $ECHO_C" >&6
-
-  if test x$PKG_CONFIG != xno ; then
-    ## don't try to run the test against uninstalled libtool libs
-    if $PKG_CONFIG --uninstalled $pkg_config_args; then
-	  echo "Will use uninstalled version of GTK+ found in PKG_CONFIG_PATH"
-	  enable_gtktest=no
-    fi
-
-    if $PKG_CONFIG --atleast-version $min_gtk_version $pkg_config_args; then
-	  :
-    else
-	  no_gtk=yes
-    fi
-  fi
-
-  if test x"$no_gtk" = x ; then
-    GTK_CFLAGS=`$PKG_CONFIG $pkg_config_args --cflags`
-    GTK_LIBS=`$PKG_CONFIG $pkg_config_args --libs`
-    gtk_config_major_version=`$PKG_CONFIG --modversion gtk+-2.0 | \
-           sed 's/\([0-9]*\).\([0-9]*\).\([0-9]*\)/\1/'`
-    gtk_config_minor_version=`$PKG_CONFIG --modversion gtk+-2.0 | \
-           sed 's/\([0-9]*\).\([0-9]*\).\([0-9]*\)/\2/'`
-    gtk_config_micro_version=`$PKG_CONFIG --modversion gtk+-2.0 | \
-           sed 's/\([0-9]*\).\([0-9]*\).\([0-9]*\)/\3/'`
-    if test "x$enable_gtktest" = "xyes" ; then
-      ac_save_CFLAGS="$CFLAGS"
-      ac_save_LIBS="$LIBS"
-      CFLAGS="$CFLAGS $GTK_CFLAGS"
-      LIBS="$GTK_LIBS $LIBS"
-      rm -f conf.gtktest
-      if test "$cross_compiling" = yes; then
-  echo $ac_n "cross compiling; assumed OK... $ac_c"
-else
-  cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-#include <gtk/gtk.h>
-#include <stdio.h>
-#include <stdlib.h>
-
-int
-main ()
-{
-  int major, minor, micro;
-  char *tmp_version;
-
-  system ("touch conf.gtktest");
-
-  /* HP/UX 9 (%@#!) writes to sscanf strings */
-  tmp_version = g_strdup("$min_gtk_version");
-  if (sscanf(tmp_version, "%d.%d.%d", &major, &minor, &micro) != 3) {
-     printf("%s, bad version string\n", "$min_gtk_version");
-     exit(1);
-   }
-
-  if ((gtk_major_version != $gtk_config_major_version) ||
-      (gtk_minor_version != $gtk_config_minor_version) ||
-      (gtk_micro_version != $gtk_config_micro_version))
-    {
-      printf("\n*** 'pkg-config --modversion gtk+-2.0' returned %d.%d.%d, but GTK+ (%d.%d.%d)\n",
-             $gtk_config_major_version, $gtk_config_minor_version, $gtk_config_micro_version,
-             gtk_major_version, gtk_minor_version, gtk_micro_version);
-      printf ("*** was found! If pkg-config was correct, then it is best\n");
-      printf ("*** to remove the old version of GTK+. You may also be able to fix the error\n");
-      printf("*** by modifying your LD_LIBRARY_PATH enviroment variable, or by editing\n");
-      printf("*** /etc/ld.so.conf. Make sure you have run ldconfig if that is\n");
-      printf("*** required on your system.\n");
-      printf("*** If pkg-config was wrong, set the environment variable PKG_CONFIG_PATH\n");
-      printf("*** to point to the correct configuration files\n");
-    }
-  else if ((gtk_major_version != GTK_MAJOR_VERSION) ||
-	   (gtk_minor_version != GTK_MINOR_VERSION) ||
-           (gtk_micro_version != GTK_MICRO_VERSION))
-    {
-      printf("*** GTK+ header files (version %d.%d.%d) do not match\n",
-	     GTK_MAJOR_VERSION, GTK_MINOR_VERSION, GTK_MICRO_VERSION);
-      printf("*** library (version %d.%d.%d)\n",
-	     gtk_major_version, gtk_minor_version, gtk_micro_version);
-    }
-  else
-    {
-      if ((gtk_major_version > major) ||
-        ((gtk_major_version == major) && (gtk_minor_version > minor)) ||
-        ((gtk_major_version == major) && (gtk_minor_version == minor) && (gtk_micro_version >= micro)))
-      {
-        return 0;
-       }
-     else
-      {
-        printf("\n*** An old version of GTK+ (%d.%d.%d) was found.\n",
-               gtk_major_version, gtk_minor_version, gtk_micro_version);
-        printf("*** You need a version of GTK+ newer than %d.%d.%d. The latest version of\n",
-	       major, minor, micro);
-        printf("*** GTK+ is always available from ftp://ftp.gtk.org.\n");
-        printf("***\n");
-        printf("*** If you have already installed a sufficiently new version, this error\n");
-        printf("*** probably means that the wrong copy of the pkg-config shell script is\n");
-        printf("*** being found. The easiest way to fix this is to remove the old version\n");
-        printf("*** of GTK+, but you can also set the PKG_CONFIG environment to point to the\n");
-        printf("*** correct copy of pkg-config. (In this case, you will have to\n");
-        printf("*** modify your LD_LIBRARY_PATH enviroment variable, or edit /etc/ld.so.conf\n");
-        printf("*** so that the correct libraries are found at run-time))\n");
-      }
-    }
-  return 1;
-}
-
-_ACEOF
-rm -f conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } && { ac_try='./conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  :
-else
-  echo "$as_me: program exited with status $ac_status" >&5
-echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-( exit $ac_status )
-no_gtk=yes
-fi
-rm -f core *.core gmon.out bb.out conftest$ac_exeext conftest.$ac_objext conftest.$ac_ext
-fi
-       CFLAGS="$ac_save_CFLAGS"
-       LIBS="$ac_save_LIBS"
-     fi
-  fi
-  if test "x$no_gtk" = x ; then
-     echo "$as_me:$LINENO: result: yes (version $gtk_config_major_version.$gtk_config_minor_version.$gtk_config_micro_version)" >&5
-echo "${ECHO_T}yes (version $gtk_config_major_version.$gtk_config_minor_version.$gtk_config_micro_version)" >&6
-     have_gtk2=true
-  else
-     echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-     if test "$PKG_CONFIG" = "no" ; then
-       echo "*** A new enough version of pkg-config was not found."
-       echo "*** See http://pkgconfig.sourceforge.net"
-     else
-       if test -f conf.gtktest ; then
-        :
-       else
-          echo "*** Could not run GTK+ test program, checking why..."
-	  ac_save_CFLAGS="$CFLAGS"
-	  ac_save_LIBS="$LIBS"
-          CFLAGS="$CFLAGS $GTK_CFLAGS"
-          LIBS="$LIBS $GTK_LIBS"
-          cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-
-#include <gtk/gtk.h>
-#include <stdio.h>
-
-int
-main ()
-{
- return ((gtk_major_version) || (gtk_minor_version) || (gtk_micro_version));
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
-  (eval $ac_link) 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag"			 || test ! -s conftest.err'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
-  (eval $ac_try) 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-   echo "*** The test program compiled, but did not run. This usually means"
-          echo "*** that the run-time linker is not finding GTK+ or finding the wrong"
-          echo "*** version of GTK+. If it is not finding GTK+, you'll need to set your"
-          echo "*** LD_LIBRARY_PATH environment variable, or edit /etc/ld.so.conf to point"
-          echo "*** to the installed location  Also, make sure you have run ldconfig if that"
-          echo "*** is required on your system"
-	  echo "***"
-          echo "*** If you have an old version installed, it is best to remove it, although"
-          echo "*** you may also be able to get things to work by modifying LD_LIBRARY_PATH"
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
- echo "*** The test program failed to compile or link. See the file config.log for the"
-          echo "*** exact error that occured. This usually means GTK+ is incorrectly installed."
-fi
-rm -f conftest.err conftest.$ac_objext \
-      conftest$ac_exeext conftest.$ac_ext
-          CFLAGS="$ac_save_CFLAGS"
-          LIBS="$ac_save_LIBS"
-       fi
-     fi
-     GTK_CFLAGS=""
-     GTK_LIBS=""
-     :
-  fi
-
-
-  rm -f conf.gtktest
-
-if test "x$have_gtk2" = "xtrue" ; then
-GDKPIXBUF_CFLAGS=$GTK_CFLAGS
-GDKPIXBUF_LIBS=$GTK_LIBS
-
-
-fi
-
-
-if test "x$have_gtk2" = "xtrue"; then
-  HAVE_GDKPIXBUF_TRUE=
-  HAVE_GDKPIXBUF_FALSE='#'
-else
-  HAVE_GDKPIXBUF_TRUE='#'
-  HAVE_GDKPIXBUF_FALSE=
-fi
-
-
-# Debug level (verbosity & optimization)
-echo "$as_me:$LINENO: checking for debug level" >&5
-echo $ECHO_N "checking for debug level... $ECHO_C" >&6
-# Check whether --enable-debug or --disable-debug was given.
-if test "${enable_debug+set}" = set; then
-  enableval="$enable_debug"
-  if test "$enableval" = "yes" ; then DEBUG=1; else DEBUG=$enableval; fi
-else
-  DEBUG=0
-fi;
-echo "$as_me:$LINENO: result: $DEBUG" >&5
-echo "${ECHO_T}$DEBUG" >&6
-
-
-if test "$DEBUG" = "0"; then
-	DBG_CFLAGS="-O2"
-else
-	DBG_CFLAGS="-g"
-fi
-
-
-# plugin directories
-
-  test "x$prefix" = xNONE && prefix="$ac_default_prefix"
-  test "x$exec_prefix" = xNONE && exec_prefix='${prefix}'
-  ac_define_dir=`eval echo $libdir/$PACKAGE/plugins`
-  ac_define_dir=`eval echo $ac_define_dir`
-
-cat >>confdefs.h <<_ACEOF
-#define PLUGIN_DIR "$ac_define_dir"
-_ACEOF
-
-
-
-PLUGINS_LDFLAGS="-avoid-version -export-dynamic"
-
-
-                                                                                                                        ac_config_files="$ac_config_files Makefile doc/Makefile doc/api/Makefile include/Makefile include/g3d/Makefile m4/Makefile plugins/Makefile plugins/image/Makefile plugins/import/Makefile src/Makefile tests/Makefile libg3d.pc"
-cat >confcache <<\_ACEOF
-# This file is a shell script that caches the results of configure
-# tests run on this system so they can be shared between configure
-# scripts and configure runs, see configure's option --config-cache.
-# It is not useful on other systems.  If it contains results you don't
-# want to keep, you may remove or edit it.
-#
-# config.status only pays attention to the cache file if you give it
-# the --recheck option to rerun configure.
-#
-# `ac_cv_env_foo' variables (set or unset) will be overridden when
-# loading this file, other *unset* `ac_cv_foo' will be assigned the
-# following values.
-
-_ACEOF
-
-# The following way of writing the cache mishandles newlines in values,
-# but we know of no workaround that is simple, portable, and efficient.
-# So, don't put newlines in cache variables' values.
-# Ultrix sh set writes to stderr and can't be redirected directly,
-# and sets the high bit in the cache file unless we assign to the vars.
-{
-  (set) 2>&1 |
-    case `(ac_space=' '; set | grep ac_space) 2>&1` in
-    *ac_space=\ *)
-      # `set' does not quote correctly, so add quotes (double-quote
-      # substitution turns \\\\ into \\, and sed turns \\ into \).
-      sed -n \
-	"s/'/'\\\\''/g;
-	  s/^\\([_$as_cr_alnum]*_cv_[_$as_cr_alnum]*\\)=\\(.*\\)/\\1='\\2'/p"
-      ;;
-    *)
-      # `set' quotes correctly as required by POSIX, so do not add quotes.
-      sed -n \
-	"s/^\\([_$as_cr_alnum]*_cv_[_$as_cr_alnum]*\\)=\\(.*\\)/\\1=\\2/p"
-      ;;
-    esac;
-} |
-  sed '
-     t clear
-     : clear
-     s/^\([^=]*\)=\(.*[{}].*\)$/test "${\1+set}" = set || &/
-     t end
-     /^ac_cv_env/!s/^\([^=]*\)=\(.*\)$/\1=${\1=\2}/
-     : end' >>confcache
-if diff $cache_file confcache >/dev/null 2>&1; then :; else
-  if test -w $cache_file; then
-    test "x$cache_file" != "x/dev/null" && echo "updating cache $cache_file"
-    cat confcache >$cache_file
-  else
-    echo "not updating unwritable cache $cache_file"
-  fi
-fi
-rm -f confcache
-
-test "x$prefix" = xNONE && prefix=$ac_default_prefix
-# Let make expand exec_prefix.
-test "x$exec_prefix" = xNONE && exec_prefix='${prefix}'
-
-# VPATH may cause trouble with some makes, so we remove $(srcdir),
-# ${srcdir} and @srcdir@ from VPATH if srcdir is ".", strip leading and
-# trailing colons and then remove the whole line if VPATH becomes empty
-# (actually we leave an empty line to preserve line numbers).
-if test "x$srcdir" = x.; then
-  ac_vpsub='/^[	 ]*VPATH[	 ]*=/{
-s/:*\$(srcdir):*/:/;
-s/:*\${srcdir}:*/:/;
-s/:*@srcdir@:*/:/;
-s/^\([^=]*=[	 ]*\):*/\1/;
-s/:*$//;
-s/^[^=]*=[	 ]*$//;
-}'
-fi
-
-DEFS=-DHAVE_CONFIG_H
-
-ac_libobjs=
-ac_ltlibobjs=
-for ac_i in : $LIBOBJS; do test "x$ac_i" = x: && continue
-  # 1. Remove the extension, and $U if already installed.
-  ac_i=`echo "$ac_i" |
-	 sed 's/\$U\././;s/\.o$//;s/\.obj$//'`
-  # 2. Add them.
-  ac_libobjs="$ac_libobjs $ac_i\$U.$ac_objext"
-  ac_ltlibobjs="$ac_ltlibobjs $ac_i"'$U.lo'
-done
-LIBOBJS=$ac_libobjs
-
-LTLIBOBJS=$ac_ltlibobjs
-
-
-if test -z "${AMDEP_TRUE}" && test -z "${AMDEP_FALSE}"; then
-  { { echo "$as_me:$LINENO: error: conditional \"AMDEP\" was never defined.
-Usually this means the macro was only invoked conditionally." >&5
-echo "$as_me: error: conditional \"AMDEP\" was never defined.
-Usually this means the macro was only invoked conditionally." >&2;}
-   { (exit 1); exit 1; }; }
-fi
-if test -z "${am__fastdepCC_TRUE}" && test -z "${am__fastdepCC_FALSE}"; then
-  { { echo "$as_me:$LINENO: error: conditional \"am__fastdepCC\" was never defined.
-Usually this means the macro was only invoked conditionally." >&5
-echo "$as_me: error: conditional \"am__fastdepCC\" was never defined.
-Usually this means the macro was only invoked conditionally." >&2;}
-   { (exit 1); exit 1; }; }
-fi
-if test -z "${am__fastdepCXX_TRUE}" && test -z "${am__fastdepCXX_FALSE}"; then
-  { { echo "$as_me:$LINENO: error: conditional \"am__fastdepCXX\" was never defined.
-Usually this means the macro was only invoked conditionally." >&5
-echo "$as_me: error: conditional \"am__fastdepCXX\" was never defined.
-Usually this means the macro was only invoked conditionally." >&2;}
-   { (exit 1); exit 1; }; }
-fi
-if test -z "${ENABLE_GTK_DOC_TRUE}" && test -z "${ENABLE_GTK_DOC_FALSE}"; then
-  { { echo "$as_me:$LINENO: error: conditional \"ENABLE_GTK_DOC\" was never defined.
-Usually this means the macro was only invoked conditionally." >&5
-echo "$as_me: error: conditional \"ENABLE_GTK_DOC\" was never defined.
-Usually this means the macro was only invoked conditionally." >&2;}
-   { (exit 1); exit 1; }; }
-fi
-if test -z "${GTK_DOC_USE_LIBTOOL_TRUE}" && test -z "${GTK_DOC_USE_LIBTOOL_FALSE}"; then
-  { { echo "$as_me:$LINENO: error: conditional \"GTK_DOC_USE_LIBTOOL\" was never defined.
-Usually this means the macro was only invoked conditionally." >&5
-echo "$as_me: error: conditional \"GTK_DOC_USE_LIBTOOL\" was never defined.
-Usually this means the macro was only invoked conditionally." >&2;}
-   { (exit 1); exit 1; }; }
-fi
-if test -z "${HAVE_GDKPIXBUF_TRUE}" && test -z "${HAVE_GDKPIXBUF_FALSE}"; then
-  { { echo "$as_me:$LINENO: error: conditional \"HAVE_GDKPIXBUF\" was never defined.
-Usually this means the macro was only invoked conditionally." >&5
-echo "$as_me: error: conditional \"HAVE_GDKPIXBUF\" was never defined.
-Usually this means the macro was only invoked conditionally." >&2;}
-   { (exit 1); exit 1; }; }
-fi
-
-: ${CONFIG_STATUS=./config.status}
-ac_clean_files_save=$ac_clean_files
-ac_clean_files="$ac_clean_files $CONFIG_STATUS"
-{ echo "$as_me:$LINENO: creating $CONFIG_STATUS" >&5
-echo "$as_me: creating $CONFIG_STATUS" >&6;}
-cat >$CONFIG_STATUS <<_ACEOF
-#! $SHELL
-# Generated by $as_me.
-# Run this file to recreate the current configuration.
-# Compiler output produced by configure, useful for debugging
-# configure, is in config.log if it exists.
-
-debug=false
-ac_cs_recheck=false
-ac_cs_silent=false
-SHELL=\${CONFIG_SHELL-$SHELL}
-_ACEOF
-
-cat >>$CONFIG_STATUS <<\_ACEOF
-## --------------------- ##
-## M4sh Initialization.  ##
-## --------------------- ##
-
-# Be Bourne compatible
-if test -n "${ZSH_VERSION+set}" && (emulate sh) >/dev/null 2>&1; then
-  emulate sh
-  NULLCMD=:
-  # Zsh 3.x and 4.x performs word splitting on ${1+"$@"}, which
-  # is contrary to our usage.  Disable this feature.
-  alias -g '${1+"$@"}'='"$@"'
-elif test -n "${BASH_VERSION+set}" && (set -o posix) >/dev/null 2>&1; then
-  set -o posix
-fi
-DUALCASE=1; export DUALCASE # for MKS sh
-
-# Support unset when possible.
-if ( (MAIL=60; unset MAIL) || exit) >/dev/null 2>&1; then
-  as_unset=unset
-else
-  as_unset=false
-fi
-
-
-# Work around bugs in pre-3.0 UWIN ksh.
-$as_unset ENV MAIL MAILPATH
-PS1='$ '
-PS2='> '
-PS4='+ '
-
-# NLS nuisances.
-for as_var in \
-  LANG LANGUAGE LC_ADDRESS LC_ALL LC_COLLATE LC_CTYPE LC_IDENTIFICATION \
-  LC_MEASUREMENT LC_MESSAGES LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER \
-  LC_TELEPHONE LC_TIME
-do
-  if (set +x; test -z "`(eval $as_var=C; export $as_var) 2>&1`"); then
-    eval $as_var=C; export $as_var
-  else
-    $as_unset $as_var
-  fi
-done
-
-# Required to use basename.
-if expr a : '\(a\)' >/dev/null 2>&1; then
-  as_expr=expr
-else
-  as_expr=false
-fi
-
-if (basename /) >/dev/null 2>&1 && test "X`basename / 2>&1`" = "X/"; then
-  as_basename=basename
-else
-  as_basename=false
-fi
-
-
-# Name of the executable.
-as_me=`$as_basename "$0" ||
-$as_expr X/"$0" : '.*/\([^/][^/]*\)/*$' \| \
-	 X"$0" : 'X\(//\)$' \| \
-	 X"$0" : 'X\(/\)$' \| \
-	 .     : '\(.\)' 2>/dev/null ||
-echo X/"$0" |
-    sed '/^.*\/\([^/][^/]*\)\/*$/{ s//\1/; q; }
-  	  /^X\/\(\/\/\)$/{ s//\1/; q; }
-  	  /^X\/\(\/\).*/{ s//\1/; q; }
-  	  s/.*/./; q'`
-
-
-# PATH needs CR, and LINENO needs CR and PATH.
-# Avoid depending upon Character Ranges.
-as_cr_letters='abcdefghijklmnopqrstuvwxyz'
-as_cr_LETTERS='ABCDEFGHIJKLMNOPQRSTUVWXYZ'
-as_cr_Letters=$as_cr_letters$as_cr_LETTERS
-as_cr_digits='0123456789'
-as_cr_alnum=$as_cr_Letters$as_cr_digits
-
-# The user is always right.
-if test "${PATH_SEPARATOR+set}" != set; then
-  echo "#! /bin/sh" >conf$$.sh
-  echo  "exit 0"   >>conf$$.sh
-  chmod +x conf$$.sh
-  if (PATH="/nonexistent;."; conf$$.sh) >/dev/null 2>&1; then
-    PATH_SEPARATOR=';'
-  else
-    PATH_SEPARATOR=:
-  fi
-  rm -f conf$$.sh
-fi
-
-
-  as_lineno_1=$LINENO
-  as_lineno_2=$LINENO
-  as_lineno_3=`(expr $as_lineno_1 + 1) 2>/dev/null`
-  test "x$as_lineno_1" != "x$as_lineno_2" &&
-  test "x$as_lineno_3"  = "x$as_lineno_2"  || {
-  # Find who we are.  Look in the path if we contain no path at all
-  # relative or not.
-  case $0 in
-    *[\\/]* ) as_myself=$0 ;;
-    *) as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  test -r "$as_dir/$0" && as_myself=$as_dir/$0 && break
-done
-
-       ;;
-  esac
-  # We did not find ourselves, most probably we were run as `sh COMMAND'
-  # in which case we are not to be found in the path.
-  if test "x$as_myself" = x; then
-    as_myself=$0
-  fi
-  if test ! -f "$as_myself"; then
-    { { echo "$as_me:$LINENO: error: cannot find myself; rerun with an absolute path" >&5
-echo "$as_me: error: cannot find myself; rerun with an absolute path" >&2;}
-   { (exit 1); exit 1; }; }
-  fi
-  case $CONFIG_SHELL in
-  '')
-    as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in /bin$PATH_SEPARATOR/usr/bin$PATH_SEPARATOR$PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for as_base in sh bash ksh sh5; do
-	 case $as_dir in
-	 /*)
-	   if ("$as_dir/$as_base" -c '
-  as_lineno_1=$LINENO
-  as_lineno_2=$LINENO
-  as_lineno_3=`(expr $as_lineno_1 + 1) 2>/dev/null`
-  test "x$as_lineno_1" != "x$as_lineno_2" &&
-  test "x$as_lineno_3"  = "x$as_lineno_2" ') 2>/dev/null; then
-	     $as_unset BASH_ENV || test "${BASH_ENV+set}" != set || { BASH_ENV=; export BASH_ENV; }
-	     $as_unset ENV || test "${ENV+set}" != set || { ENV=; export ENV; }
-	     CONFIG_SHELL=$as_dir/$as_base
-	     export CONFIG_SHELL
-	     exec "$CONFIG_SHELL" "$0" ${1+"$@"}
-	   fi;;
-	 esac
-       done
-done
-;;
-  esac
-
-  # Create $as_me.lineno as a copy of $as_myself, but with $LINENO
-  # uniformly replaced by the line number.  The first 'sed' inserts a
-  # line-number line before each line; the second 'sed' does the real
-  # work.  The second script uses 'N' to pair each line-number line
-  # with the numbered line, and appends trailing '-' during
-  # substitution so that $LINENO is not a special case at line end.
-  # (Raja R Harinath suggested sed '=', and Paul Eggert wrote the
-  # second 'sed' script.  Blame Lee E. McMahon for sed's syntax.  :-)
-  sed '=' <$as_myself |
-    sed '
-      N
-      s,$,-,
-      : loop
-      s,^\(['$as_cr_digits']*\)\(.*\)[$]LINENO\([^'$as_cr_alnum'_]\),\1\2\1\3,
-      t loop
-      s,-$,,
-      s,^['$as_cr_digits']*\n,,
-    ' >$as_me.lineno &&
-  chmod +x $as_me.lineno ||
-    { { echo "$as_me:$LINENO: error: cannot create $as_me.lineno; rerun with a POSIX shell" >&5
-echo "$as_me: error: cannot create $as_me.lineno; rerun with a POSIX shell" >&2;}
-   { (exit 1); exit 1; }; }
-
-  # Don't try to exec as it changes $[0], causing all sort of problems
-  # (the dirname of $[0] is not the place where we might find the
-  # original and so on.  Autoconf is especially sensible to this).
-  . ./$as_me.lineno
-  # Exit status is that of the last command.
-  exit
-}
-
-
-case `echo "testing\c"; echo 1,2,3`,`echo -n testing; echo 1,2,3` in
-  *c*,-n*) ECHO_N= ECHO_C='
-' ECHO_T='	' ;;
-  *c*,*  ) ECHO_N=-n ECHO_C= ECHO_T= ;;
-  *)       ECHO_N= ECHO_C='\c' ECHO_T= ;;
-esac
-
-if expr a : '\(a\)' >/dev/null 2>&1; then
-  as_expr=expr
-else
-  as_expr=false
-fi
-
-rm -f conf$$ conf$$.exe conf$$.file
-echo >conf$$.file
-if ln -s conf$$.file conf$$ 2>/dev/null; then
-  # We could just check for DJGPP; but this test a) works b) is more generic
-  # and c) will remain valid once DJGPP supports symlinks (DJGPP 2.04).
-  if test -f conf$$.exe; then
-    # Don't use ln at all; we don't have any links
-    as_ln_s='cp -p'
-  else
-    as_ln_s='ln -s'
-  fi
-elif ln conf$$.file conf$$ 2>/dev/null; then
-  as_ln_s=ln
-else
-  as_ln_s='cp -p'
-fi
-rm -f conf$$ conf$$.exe conf$$.file
-
-if mkdir -p . 2>/dev/null; then
-  as_mkdir_p=:
-else
-  test -d ./-p && rmdir ./-p
-  as_mkdir_p=false
-fi
-
-as_executable_p="test -f"
-
-# Sed expression to map a string onto a valid CPP name.
-as_tr_cpp="eval sed 'y%*$as_cr_letters%P$as_cr_LETTERS%;s%[^_$as_cr_alnum]%_%g'"
-
-# Sed expression to map a string onto a valid variable name.
-as_tr_sh="eval sed 'y%*+%pp%;s%[^_$as_cr_alnum]%_%g'"
-
-
-# IFS
-# We need space, tab and new line, in precisely that order.
-as_nl='
-'
-IFS=" 	$as_nl"
-
-# CDPATH.
-$as_unset CDPATH
-
-exec 6>&1
-
-# Open the log real soon, to keep \$[0] and so on meaningful, and to
-# report actual input values of CONFIG_FILES etc. instead of their
-# values after options handling.  Logging --version etc. is OK.
-exec 5>>config.log
-{
-  echo
-  sed 'h;s/./-/g;s/^.../## /;s/...$/ ##/;p;x;p;x' <<_ASBOX
-## Running $as_me. ##
-_ASBOX
-} >&5
-cat >&5 <<_CSEOF
-
-This file was extended by $as_me, which was
-generated by GNU Autoconf 2.59.  Invocation command line was
-
-  CONFIG_FILES    = $CONFIG_FILES
-  CONFIG_HEADERS  = $CONFIG_HEADERS
-  CONFIG_LINKS    = $CONFIG_LINKS
-  CONFIG_COMMANDS = $CONFIG_COMMANDS
-  $ $0 $@
-
-_CSEOF
-echo "on `(hostname || uname -n) 2>/dev/null | sed 1q`" >&5
-echo >&5
-_ACEOF
-
-# Files that config.status was made for.
-if test -n "$ac_config_files"; then
-  echo "config_files=\"$ac_config_files\"" >>$CONFIG_STATUS
-fi
-
-if test -n "$ac_config_headers"; then
-  echo "config_headers=\"$ac_config_headers\"" >>$CONFIG_STATUS
-fi
-
-if test -n "$ac_config_links"; then
-  echo "config_links=\"$ac_config_links\"" >>$CONFIG_STATUS
-fi
-
-if test -n "$ac_config_commands"; then
-  echo "config_commands=\"$ac_config_commands\"" >>$CONFIG_STATUS
-fi
-
-cat >>$CONFIG_STATUS <<\_ACEOF
-
-ac_cs_usage="\
-\`$as_me' instantiates files from templates according to the
-current configuration.
-
-Usage: $0 [OPTIONS] [FILE]...
-
-  -h, --help       print this help, then exit
-  -V, --version    print version number, then exit
-  -q, --quiet      do not print progress messages
-  -d, --debug      don't remove temporary files
-      --recheck    update $as_me by reconfiguring in the same conditions
-  --file=FILE[:TEMPLATE]
-		   instantiate the configuration file FILE
-  --header=FILE[:TEMPLATE]
-		   instantiate the configuration header FILE
-
-Configuration files:
-$config_files
-
-Configuration headers:
-$config_headers
-
-Configuration commands:
-$config_commands
-
-Report bugs to <bug-autoconf at gnu.org>."
-_ACEOF
-
-cat >>$CONFIG_STATUS <<_ACEOF
-ac_cs_version="\\
-config.status
-configured by $0, generated by GNU Autoconf 2.59,
-  with options \\"`echo "$ac_configure_args" | sed 's/[\\""\`\$]/\\\\&/g'`\\"
-
-Copyright (C) 2003 Free Software Foundation, Inc.
-This config.status script is free software; the Free Software Foundation
-gives unlimited permission to copy, distribute and modify it."
-srcdir=$srcdir
-INSTALL="$INSTALL"
-_ACEOF
-
-cat >>$CONFIG_STATUS <<\_ACEOF
-# If no file are specified by the user, then we need to provide default
-# value.  By we need to know if files were specified by the user.
-ac_need_defaults=:
-while test $# != 0
-do
-  case $1 in
-  --*=*)
-    ac_option=`expr "x$1" : 'x\([^=]*\)='`
-    ac_optarg=`expr "x$1" : 'x[^=]*=\(.*\)'`
-    ac_shift=:
-    ;;
-  -*)
-    ac_option=$1
-    ac_optarg=$2
-    ac_shift=shift
-    ;;
-  *) # This is not an option, so the user has probably given explicit
-     # arguments.
-     ac_option=$1
-     ac_need_defaults=false;;
-  esac
-
-  case $ac_option in
-  # Handling of the options.
-_ACEOF
-cat >>$CONFIG_STATUS <<\_ACEOF
-  -recheck | --recheck | --rechec | --reche | --rech | --rec | --re | --r)
-    ac_cs_recheck=: ;;
-  --version | --vers* | -V )
-    echo "$ac_cs_version"; exit 0 ;;
-  --he | --h)
-    # Conflict between --help and --header
-    { { echo "$as_me:$LINENO: error: ambiguous option: $1
-Try \`$0 --help' for more information." >&5
-echo "$as_me: error: ambiguous option: $1
-Try \`$0 --help' for more information." >&2;}
-   { (exit 1); exit 1; }; };;
-  --help | --hel | -h )
-    echo "$ac_cs_usage"; exit 0 ;;
-  --debug | --d* | -d )
-    debug=: ;;
-  --file | --fil | --fi | --f )
-    $ac_shift
-    CONFIG_FILES="$CONFIG_FILES $ac_optarg"
-    ac_need_defaults=false;;
-  --header | --heade | --head | --hea )
-    $ac_shift
-    CONFIG_HEADERS="$CONFIG_HEADERS $ac_optarg"
-    ac_need_defaults=false;;
-  -q | -quiet | --quiet | --quie | --qui | --qu | --q \
-  | -silent | --silent | --silen | --sile | --sil | --si | --s)
-    ac_cs_silent=: ;;
-
-  # This is an error.
-  -*) { { echo "$as_me:$LINENO: error: unrecognized option: $1
-Try \`$0 --help' for more information." >&5
-echo "$as_me: error: unrecognized option: $1
-Try \`$0 --help' for more information." >&2;}
-   { (exit 1); exit 1; }; } ;;
-
-  *) ac_config_targets="$ac_config_targets $1" ;;
-
-  esac
-  shift
-done
-
-ac_configure_extra_args=
-
-if $ac_cs_silent; then
-  exec 6>/dev/null
-  ac_configure_extra_args="$ac_configure_extra_args --silent"
-fi
-
-_ACEOF
-cat >>$CONFIG_STATUS <<_ACEOF
-if \$ac_cs_recheck; then
-  echo "running $SHELL $0 " $ac_configure_args \$ac_configure_extra_args " --no-create --no-recursion" >&6
-  exec $SHELL $0 $ac_configure_args \$ac_configure_extra_args --no-create --no-recursion
-fi
-
-_ACEOF
-
-cat >>$CONFIG_STATUS <<_ACEOF
-#
-# INIT-COMMANDS section.
-#
-
-AMDEP_TRUE="$AMDEP_TRUE" ac_aux_dir="$ac_aux_dir"
-
-_ACEOF
-
-
-
-cat >>$CONFIG_STATUS <<\_ACEOF
-for ac_config_target in $ac_config_targets
-do
-  case "$ac_config_target" in
-  # Handling of arguments.
-  "Makefile" ) CONFIG_FILES="$CONFIG_FILES Makefile" ;;
-  "doc/Makefile" ) CONFIG_FILES="$CONFIG_FILES doc/Makefile" ;;
-  "doc/api/Makefile" ) CONFIG_FILES="$CONFIG_FILES doc/api/Makefile" ;;
-  "include/Makefile" ) CONFIG_FILES="$CONFIG_FILES include/Makefile" ;;
-  "include/g3d/Makefile" ) CONFIG_FILES="$CONFIG_FILES include/g3d/Makefile" ;;
-  "m4/Makefile" ) CONFIG_FILES="$CONFIG_FILES m4/Makefile" ;;
-  "plugins/Makefile" ) CONFIG_FILES="$CONFIG_FILES plugins/Makefile" ;;
-  "plugins/image/Makefile" ) CONFIG_FILES="$CONFIG_FILES plugins/image/Makefile" ;;
-  "plugins/import/Makefile" ) CONFIG_FILES="$CONFIG_FILES plugins/import/Makefile" ;;
-  "src/Makefile" ) CONFIG_FILES="$CONFIG_FILES src/Makefile" ;;
-  "tests/Makefile" ) CONFIG_FILES="$CONFIG_FILES tests/Makefile" ;;
-  "libg3d.pc" ) CONFIG_FILES="$CONFIG_FILES libg3d.pc" ;;
-  "depfiles" ) CONFIG_COMMANDS="$CONFIG_COMMANDS depfiles" ;;
-  "include/g3d/config.h" ) CONFIG_HEADERS="$CONFIG_HEADERS include/g3d/config.h" ;;
-  *) { { echo "$as_me:$LINENO: error: invalid argument: $ac_config_target" >&5
-echo "$as_me: error: invalid argument: $ac_config_target" >&2;}
-   { (exit 1); exit 1; }; };;
-  esac
-done
-
-# If the user did not use the arguments to specify the items to instantiate,
-# then the envvar interface is used.  Set only those that are not.
-# We use the long form for the default assignment because of an extremely
-# bizarre bug on SunOS 4.1.3.
-if $ac_need_defaults; then
-  test "${CONFIG_FILES+set}" = set || CONFIG_FILES=$config_files
-  test "${CONFIG_HEADERS+set}" = set || CONFIG_HEADERS=$config_headers
-  test "${CONFIG_COMMANDS+set}" = set || CONFIG_COMMANDS=$config_commands
-fi
-
-# Have a temporary directory for convenience.  Make it in the build tree
-# simply because there is no reason to put it here, and in addition,
-# creating and moving files from /tmp can sometimes cause problems.
-# Create a temporary directory, and hook for its removal unless debugging.
-$debug ||
-{
-  trap 'exit_status=$?; rm -rf $tmp && exit $exit_status' 0
-  trap '{ (exit 1); exit 1; }' 1 2 13 15
-}
-
-# Create a (secure) tmp directory for tmp files.
-
-{
-  tmp=`(umask 077 && mktemp -d -q "./confstatXXXXXX") 2>/dev/null` &&
-  test -n "$tmp" && test -d "$tmp"
-}  ||
-{
-  tmp=./confstat$$-$RANDOM
-  (umask 077 && mkdir $tmp)
-} ||
-{
-   echo "$me: cannot create a temporary directory in ." >&2
-   { (exit 1); exit 1; }
-}
-
-_ACEOF
-
-cat >>$CONFIG_STATUS <<_ACEOF
-
-#
-# CONFIG_FILES section.
-#
-
-# No need to generate the scripts if there are no CONFIG_FILES.
-# This happens for instance when ./config.status config.h
-if test -n "\$CONFIG_FILES"; then
-  # Protect against being on the right side of a sed subst in config.status.
-  sed 's/,@/@@/; s/@,/@@/; s/,;t t\$/@;t t/; /@;t t\$/s/[\\\\&,]/\\\\&/g;
-   s/@@/,@/; s/@@/@,/; s/@;t t\$/,;t t/' >\$tmp/subs.sed <<\\CEOF
-s, at SHELL@,$SHELL,;t t
-s, at PATH_SEPARATOR@,$PATH_SEPARATOR,;t t
-s, at PACKAGE_NAME@,$PACKAGE_NAME,;t t
-s, at PACKAGE_TARNAME@,$PACKAGE_TARNAME,;t t
-s, at PACKAGE_VERSION@,$PACKAGE_VERSION,;t t
-s, at PACKAGE_STRING@,$PACKAGE_STRING,;t t
-s, at PACKAGE_BUGREPORT@,$PACKAGE_BUGREPORT,;t t
-s, at exec_prefix@,$exec_prefix,;t t
-s, at prefix@,$prefix,;t t
-s, at program_transform_name@,$program_transform_name,;t t
-s, at bindir@,$bindir,;t t
-s, at sbindir@,$sbindir,;t t
-s, at libexecdir@,$libexecdir,;t t
-s, at datadir@,$datadir,;t t
-s, at sysconfdir@,$sysconfdir,;t t
-s, at sharedstatedir@,$sharedstatedir,;t t
-s, at localstatedir@,$localstatedir,;t t
-s, at libdir@,$libdir,;t t
-s, at includedir@,$includedir,;t t
-s, at oldincludedir@,$oldincludedir,;t t
-s, at infodir@,$infodir,;t t
-s, at mandir@,$mandir,;t t
-s, at build_alias@,$build_alias,;t t
-s, at host_alias@,$host_alias,;t t
-s, at target_alias@,$target_alias,;t t
-s, at DEFS@,$DEFS,;t t
-s, at ECHO_C@,$ECHO_C,;t t
-s, at ECHO_N@,$ECHO_N,;t t
-s, at ECHO_T@,$ECHO_T,;t t
-s, at LIBS@,$LIBS,;t t
-s, at INSTALL_PROGRAM@,$INSTALL_PROGRAM,;t t
-s, at INSTALL_SCRIPT@,$INSTALL_SCRIPT,;t t
-s, at INSTALL_DATA@,$INSTALL_DATA,;t t
-s, at CYGPATH_W@,$CYGPATH_W,;t t
-s, at PACKAGE@,$PACKAGE,;t t
-s, at VERSION@,$VERSION,;t t
-s, at ACLOCAL@,$ACLOCAL,;t t
-s, at AUTOCONF@,$AUTOCONF,;t t
-s, at AUTOMAKE@,$AUTOMAKE,;t t
-s, at AUTOHEADER@,$AUTOHEADER,;t t
-s, at MAKEINFO@,$MAKEINFO,;t t
-s, at AMTAR@,$AMTAR,;t t
-s, at install_sh@,$install_sh,;t t
-s, at STRIP@,$STRIP,;t t
-s, at ac_ct_STRIP@,$ac_ct_STRIP,;t t
-s, at INSTALL_STRIP_PROGRAM@,$INSTALL_STRIP_PROGRAM,;t t
-s, at AWK@,$AWK,;t t
-s, at SET_MAKE@,$SET_MAKE,;t t
-s, at am__leading_dot@,$am__leading_dot,;t t
-s, at CC@,$CC,;t t
-s, at CFLAGS@,$CFLAGS,;t t
-s, at LDFLAGS@,$LDFLAGS,;t t
-s, at CPPFLAGS@,$CPPFLAGS,;t t
-s, at ac_ct_CC@,$ac_ct_CC,;t t
-s, at EXEEXT@,$EXEEXT,;t t
-s, at OBJEXT@,$OBJEXT,;t t
-s, at DEPDIR@,$DEPDIR,;t t
-s, at am__include@,$am__include,;t t
-s, at am__quote@,$am__quote,;t t
-s, at AMDEP_TRUE@,$AMDEP_TRUE,;t t
-s, at AMDEP_FALSE@,$AMDEP_FALSE,;t t
-s, at AMDEPBACKSLASH@,$AMDEPBACKSLASH,;t t
-s, at CCDEPMODE@,$CCDEPMODE,;t t
-s, at am__fastdepCC_TRUE@,$am__fastdepCC_TRUE,;t t
-s, at am__fastdepCC_FALSE@,$am__fastdepCC_FALSE,;t t
-s, at LEX@,$LEX,;t t
-s, at LEXLIB@,$LEXLIB,;t t
-s, at LEX_OUTPUT_ROOT@,$LEX_OUTPUT_ROOT,;t t
-s, at CPP@,$CPP,;t t
-s, at EGREP@,$EGREP,;t t
-s, at build@,$build,;t t
-s, at build_cpu@,$build_cpu,;t t
-s, at build_vendor@,$build_vendor,;t t
-s, at build_os@,$build_os,;t t
-s, at host@,$host,;t t
-s, at host_cpu@,$host_cpu,;t t
-s, at host_vendor@,$host_vendor,;t t
-s, at host_os@,$host_os,;t t
-s, at LN_S@,$LN_S,;t t
-s, at ECHO@,$ECHO,;t t
-s, at AR@,$AR,;t t
-s, at ac_ct_AR@,$ac_ct_AR,;t t
-s, at RANLIB@,$RANLIB,;t t
-s, at ac_ct_RANLIB@,$ac_ct_RANLIB,;t t
-s, at CXX@,$CXX,;t t
-s, at CXXFLAGS@,$CXXFLAGS,;t t
-s, at ac_ct_CXX@,$ac_ct_CXX,;t t
-s, at CXXDEPMODE@,$CXXDEPMODE,;t t
-s, at am__fastdepCXX_TRUE@,$am__fastdepCXX_TRUE,;t t
-s, at am__fastdepCXX_FALSE@,$am__fastdepCXX_FALSE,;t t
-s, at CXXCPP@,$CXXCPP,;t t
-s, at F77@,$F77,;t t
-s, at FFLAGS@,$FFLAGS,;t t
-s, at ac_ct_F77@,$ac_ct_F77,;t t
-s, at LIBTOOL@,$LIBTOOL,;t t
-s, at HTML_DIR@,$HTML_DIR,;t t
-s, at PKG_CONFIG@,$PKG_CONFIG,;t t
-s, at ENABLE_GTK_DOC_TRUE@,$ENABLE_GTK_DOC_TRUE,;t t
-s, at ENABLE_GTK_DOC_FALSE@,$ENABLE_GTK_DOC_FALSE,;t t
-s, at GTK_DOC_USE_LIBTOOL_TRUE@,$GTK_DOC_USE_LIBTOOL_TRUE,;t t
-s, at GTK_DOC_USE_LIBTOOL_FALSE@,$GTK_DOC_USE_LIBTOOL_FALSE,;t t
-s, at GLIB_CFLAGS@,$GLIB_CFLAGS,;t t
-s, at GLIB_LIBS@,$GLIB_LIBS,;t t
-s, at GLIB_GENMARSHAL@,$GLIB_GENMARSHAL,;t t
-s, at GOBJECT_QUERY@,$GOBJECT_QUERY,;t t
-s, at GLIB_MKENUMS@,$GLIB_MKENUMS,;t t
-s, at GTK_CFLAGS@,$GTK_CFLAGS,;t t
-s, at GTK_LIBS@,$GTK_LIBS,;t t
-s, at GDKPIXBUF_CFLAGS@,$GDKPIXBUF_CFLAGS,;t t
-s, at GDKPIXBUF_LIBS@,$GDKPIXBUF_LIBS,;t t
-s, at HAVE_GDKPIXBUF_TRUE@,$HAVE_GDKPIXBUF_TRUE,;t t
-s, at HAVE_GDKPIXBUF_FALSE@,$HAVE_GDKPIXBUF_FALSE,;t t
-s, at DEBUG@,$DEBUG,;t t
-s, at DBG_CFLAGS@,$DBG_CFLAGS,;t t
-s, at PLUGINS_LDFLAGS@,$PLUGINS_LDFLAGS,;t t
-s, at LIBOBJS@,$LIBOBJS,;t t
-s, at LTLIBOBJS@,$LTLIBOBJS,;t t
-CEOF
-
-_ACEOF
-
-  cat >>$CONFIG_STATUS <<\_ACEOF
-  # Split the substitutions into bite-sized pieces for seds with
-  # small command number limits, like on Digital OSF/1 and HP-UX.
-  ac_max_sed_lines=48
-  ac_sed_frag=1 # Number of current file.
-  ac_beg=1 # First line for current file.
-  ac_end=$ac_max_sed_lines # Line after last line for current file.
-  ac_more_lines=:
-  ac_sed_cmds=
-  while $ac_more_lines; do
-    if test $ac_beg -gt 1; then
-      sed "1,${ac_beg}d; ${ac_end}q" $tmp/subs.sed >$tmp/subs.frag
-    else
-      sed "${ac_end}q" $tmp/subs.sed >$tmp/subs.frag
-    fi
-    if test ! -s $tmp/subs.frag; then
-      ac_more_lines=false
-    else
-      # The purpose of the label and of the branching condition is to
-      # speed up the sed processing (if there are no `@' at all, there
-      # is no need to browse any of the substitutions).
-      # These are the two extra sed commands mentioned above.
-      (echo ':t
-  /@[a-zA-Z_][a-zA-Z_0-9]*@/!b' && cat $tmp/subs.frag) >$tmp/subs-$ac_sed_frag.sed
-      if test -z "$ac_sed_cmds"; then
-	ac_sed_cmds="sed -f $tmp/subs-$ac_sed_frag.sed"
-      else
-	ac_sed_cmds="$ac_sed_cmds | sed -f $tmp/subs-$ac_sed_frag.sed"
-      fi
-      ac_sed_frag=`expr $ac_sed_frag + 1`
-      ac_beg=$ac_end
-      ac_end=`expr $ac_end + $ac_max_sed_lines`
-    fi
-  done
-  if test -z "$ac_sed_cmds"; then
-    ac_sed_cmds=cat
-  fi
-fi # test -n "$CONFIG_FILES"
-
-_ACEOF
-cat >>$CONFIG_STATUS <<\_ACEOF
-for ac_file in : $CONFIG_FILES; do test "x$ac_file" = x: && continue
-  # Support "outfile[:infile[:infile...]]", defaulting infile="outfile.in".
-  case $ac_file in
-  - | *:- | *:-:* ) # input from stdin
-	cat >$tmp/stdin
-	ac_file_in=`echo "$ac_file" | sed 's,[^:]*:,,'`
-	ac_file=`echo "$ac_file" | sed 's,:.*,,'` ;;
-  *:* ) ac_file_in=`echo "$ac_file" | sed 's,[^:]*:,,'`
-	ac_file=`echo "$ac_file" | sed 's,:.*,,'` ;;
-  * )   ac_file_in=$ac_file.in ;;
-  esac
-
-  # Compute @srcdir@, @top_srcdir@, and @INSTALL@ for subdirectories.
-  ac_dir=`(dirname "$ac_file") 2>/dev/null ||
-$as_expr X"$ac_file" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
-	 X"$ac_file" : 'X\(//\)[^/]' \| \
-	 X"$ac_file" : 'X\(//\)$' \| \
-	 X"$ac_file" : 'X\(/\)' \| \
-	 .     : '\(.\)' 2>/dev/null ||
-echo X"$ac_file" |
-    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{ s//\1/; q; }
-  	  /^X\(\/\/\)[^/].*/{ s//\1/; q; }
-  	  /^X\(\/\/\)$/{ s//\1/; q; }
-  	  /^X\(\/\).*/{ s//\1/; q; }
-  	  s/.*/./; q'`
-  { if $as_mkdir_p; then
-    mkdir -p "$ac_dir"
-  else
-    as_dir="$ac_dir"
-    as_dirs=
-    while test ! -d "$as_dir"; do
-      as_dirs="$as_dir $as_dirs"
-      as_dir=`(dirname "$as_dir") 2>/dev/null ||
-$as_expr X"$as_dir" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
-	 X"$as_dir" : 'X\(//\)[^/]' \| \
-	 X"$as_dir" : 'X\(//\)$' \| \
-	 X"$as_dir" : 'X\(/\)' \| \
-	 .     : '\(.\)' 2>/dev/null ||
-echo X"$as_dir" |
-    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{ s//\1/; q; }
-  	  /^X\(\/\/\)[^/].*/{ s//\1/; q; }
-  	  /^X\(\/\/\)$/{ s//\1/; q; }
-  	  /^X\(\/\).*/{ s//\1/; q; }
-  	  s/.*/./; q'`
-    done
-    test ! -n "$as_dirs" || mkdir $as_dirs
-  fi || { { echo "$as_me:$LINENO: error: cannot create directory \"$ac_dir\"" >&5
-echo "$as_me: error: cannot create directory \"$ac_dir\"" >&2;}
-   { (exit 1); exit 1; }; }; }
-
-  ac_builddir=.
-
-if test "$ac_dir" != .; then
-  ac_dir_suffix=/`echo "$ac_dir" | sed 's,^\.[\\/],,'`
-  # A "../" for each directory in $ac_dir_suffix.
-  ac_top_builddir=`echo "$ac_dir_suffix" | sed 's,/[^\\/]*,../,g'`
-else
-  ac_dir_suffix= ac_top_builddir=
-fi
-
-case $srcdir in
-  .)  # No --srcdir option.  We are building in place.
-    ac_srcdir=.
-    if test -z "$ac_top_builddir"; then
-       ac_top_srcdir=.
-    else
-       ac_top_srcdir=`echo $ac_top_builddir | sed 's,/$,,'`
-    fi ;;
-  [\\/]* | ?:[\\/]* )  # Absolute path.
-    ac_srcdir=$srcdir$ac_dir_suffix;
-    ac_top_srcdir=$srcdir ;;
-  *) # Relative path.
-    ac_srcdir=$ac_top_builddir$srcdir$ac_dir_suffix
-    ac_top_srcdir=$ac_top_builddir$srcdir ;;
-esac
-
-# Do not use `cd foo && pwd` to compute absolute paths, because
-# the directories may not exist.
-case `pwd` in
-.) ac_abs_builddir="$ac_dir";;
-*)
-  case "$ac_dir" in
-  .) ac_abs_builddir=`pwd`;;
-  [\\/]* | ?:[\\/]* ) ac_abs_builddir="$ac_dir";;
-  *) ac_abs_builddir=`pwd`/"$ac_dir";;
-  esac;;
-esac
-case $ac_abs_builddir in
-.) ac_abs_top_builddir=${ac_top_builddir}.;;
-*)
-  case ${ac_top_builddir}. in
-  .) ac_abs_top_builddir=$ac_abs_builddir;;
-  [\\/]* | ?:[\\/]* ) ac_abs_top_builddir=${ac_top_builddir}.;;
-  *) ac_abs_top_builddir=$ac_abs_builddir/${ac_top_builddir}.;;
-  esac;;
-esac
-case $ac_abs_builddir in
-.) ac_abs_srcdir=$ac_srcdir;;
-*)
-  case $ac_srcdir in
-  .) ac_abs_srcdir=$ac_abs_builddir;;
-  [\\/]* | ?:[\\/]* ) ac_abs_srcdir=$ac_srcdir;;
-  *) ac_abs_srcdir=$ac_abs_builddir/$ac_srcdir;;
-  esac;;
-esac
-case $ac_abs_builddir in
-.) ac_abs_top_srcdir=$ac_top_srcdir;;
-*)
-  case $ac_top_srcdir in
-  .) ac_abs_top_srcdir=$ac_abs_builddir;;
-  [\\/]* | ?:[\\/]* ) ac_abs_top_srcdir=$ac_top_srcdir;;
-  *) ac_abs_top_srcdir=$ac_abs_builddir/$ac_top_srcdir;;
-  esac;;
-esac
-
-
-  case $INSTALL in
-  [\\/$]* | ?:[\\/]* ) ac_INSTALL=$INSTALL ;;
-  *) ac_INSTALL=$ac_top_builddir$INSTALL ;;
-  esac
-
-  # Let's still pretend it is `configure' which instantiates (i.e., don't
-  # use $as_me), people would be surprised to read:
-  #    /* config.h.  Generated by config.status.  */
-  if test x"$ac_file" = x-; then
-    configure_input=
-  else
-    configure_input="$ac_file.  "
-  fi
-  configure_input=$configure_input"Generated from `echo $ac_file_in |
-				     sed 's,.*/,,'` by configure."
-
-  # First look for the input files in the build tree, otherwise in the
-  # src tree.
-  ac_file_inputs=`IFS=:
-    for f in $ac_file_in; do
-      case $f in
-      -) echo $tmp/stdin ;;
-      [\\/$]*)
-	 # Absolute (can't be DOS-style, as IFS=:)
-	 test -f "$f" || { { echo "$as_me:$LINENO: error: cannot find input file: $f" >&5
-echo "$as_me: error: cannot find input file: $f" >&2;}
-   { (exit 1); exit 1; }; }
-	 echo "$f";;
-      *) # Relative
-	 if test -f "$f"; then
-	   # Build tree
-	   echo "$f"
-	 elif test -f "$srcdir/$f"; then
-	   # Source tree
-	   echo "$srcdir/$f"
-	 else
-	   # /dev/null tree
-	   { { echo "$as_me:$LINENO: error: cannot find input file: $f" >&5
-echo "$as_me: error: cannot find input file: $f" >&2;}
-   { (exit 1); exit 1; }; }
-	 fi;;
-      esac
-    done` || { (exit 1); exit 1; }
-
-  if test x"$ac_file" != x-; then
-    { echo "$as_me:$LINENO: creating $ac_file" >&5
-echo "$as_me: creating $ac_file" >&6;}
-    rm -f "$ac_file"
-  fi
-_ACEOF
-cat >>$CONFIG_STATUS <<_ACEOF
-  sed "$ac_vpsub
-$extrasub
-_ACEOF
-cat >>$CONFIG_STATUS <<\_ACEOF
-:t
-/@[a-zA-Z_][a-zA-Z_0-9]*@/!b
-s, at configure_input@,$configure_input,;t t
-s, at srcdir@,$ac_srcdir,;t t
-s, at abs_srcdir@,$ac_abs_srcdir,;t t
-s, at top_srcdir@,$ac_top_srcdir,;t t
-s, at abs_top_srcdir@,$ac_abs_top_srcdir,;t t
-s, at builddir@,$ac_builddir,;t t
-s, at abs_builddir@,$ac_abs_builddir,;t t
-s, at top_builddir@,$ac_top_builddir,;t t
-s, at abs_top_builddir@,$ac_abs_top_builddir,;t t
-s, at INSTALL@,$ac_INSTALL,;t t
-" $ac_file_inputs | (eval "$ac_sed_cmds") >$tmp/out
-  rm -f $tmp/stdin
-  if test x"$ac_file" != x-; then
-    mv $tmp/out $ac_file
-  else
-    cat $tmp/out
-    rm -f $tmp/out
-  fi
-
-done
-_ACEOF
-cat >>$CONFIG_STATUS <<\_ACEOF
-
-#
-# CONFIG_HEADER section.
-#
-
-# These sed commands are passed to sed as "A NAME B NAME C VALUE D", where
-# NAME is the cpp macro being defined and VALUE is the value it is being given.
-#
-# ac_d sets the value in "#define NAME VALUE" lines.
-ac_dA='s,^\([	 ]*\)#\([	 ]*define[	 ][	 ]*\)'
-ac_dB='[	 ].*$,\1#\2'
-ac_dC=' '
-ac_dD=',;t'
-# ac_u turns "#undef NAME" without trailing blanks into "#define NAME VALUE".
-ac_uA='s,^\([	 ]*\)#\([	 ]*\)undef\([	 ][	 ]*\)'
-ac_uB='$,\1#\2define\3'
-ac_uC=' '
-ac_uD=',;t'
-
-for ac_file in : $CONFIG_HEADERS; do test "x$ac_file" = x: && continue
-  # Support "outfile[:infile[:infile...]]", defaulting infile="outfile.in".
-  case $ac_file in
-  - | *:- | *:-:* ) # input from stdin
-	cat >$tmp/stdin
-	ac_file_in=`echo "$ac_file" | sed 's,[^:]*:,,'`
-	ac_file=`echo "$ac_file" | sed 's,:.*,,'` ;;
-  *:* ) ac_file_in=`echo "$ac_file" | sed 's,[^:]*:,,'`
-	ac_file=`echo "$ac_file" | sed 's,:.*,,'` ;;
-  * )   ac_file_in=$ac_file.in ;;
-  esac
-
-  test x"$ac_file" != x- && { echo "$as_me:$LINENO: creating $ac_file" >&5
-echo "$as_me: creating $ac_file" >&6;}
-
-  # First look for the input files in the build tree, otherwise in the
-  # src tree.
-  ac_file_inputs=`IFS=:
-    for f in $ac_file_in; do
-      case $f in
-      -) echo $tmp/stdin ;;
-      [\\/$]*)
-	 # Absolute (can't be DOS-style, as IFS=:)
-	 test -f "$f" || { { echo "$as_me:$LINENO: error: cannot find input file: $f" >&5
-echo "$as_me: error: cannot find input file: $f" >&2;}
-   { (exit 1); exit 1; }; }
-	 # Do quote $f, to prevent DOS paths from being IFS'd.
-	 echo "$f";;
-      *) # Relative
-	 if test -f "$f"; then
-	   # Build tree
-	   echo "$f"
-	 elif test -f "$srcdir/$f"; then
-	   # Source tree
-	   echo "$srcdir/$f"
-	 else
-	   # /dev/null tree
-	   { { echo "$as_me:$LINENO: error: cannot find input file: $f" >&5
-echo "$as_me: error: cannot find input file: $f" >&2;}
-   { (exit 1); exit 1; }; }
-	 fi;;
-      esac
-    done` || { (exit 1); exit 1; }
-  # Remove the trailing spaces.
-  sed 's/[	 ]*$//' $ac_file_inputs >$tmp/in
-
-_ACEOF
-
-# Transform confdefs.h into two sed scripts, `conftest.defines' and
-# `conftest.undefs', that substitutes the proper values into
-# config.h.in to produce config.h.  The first handles `#define'
-# templates, and the second `#undef' templates.
-# And first: Protect against being on the right side of a sed subst in
-# config.status.  Protect against being in an unquoted here document
-# in config.status.
-rm -f conftest.defines conftest.undefs
-# Using a here document instead of a string reduces the quoting nightmare.
-# Putting comments in sed scripts is not portable.
-#
-# `end' is used to avoid that the second main sed command (meant for
-# 0-ary CPP macros) applies to n-ary macro definitions.
-# See the Autoconf documentation for `clear'.
-cat >confdef2sed.sed <<\_ACEOF
-s/[\\&,]/\\&/g
-s,[\\$`],\\&,g
-t clear
-: clear
-s,^[	 ]*#[	 ]*define[	 ][	 ]*\([^	 (][^	 (]*\)\(([^)]*)\)[	 ]*\(.*\)$,${ac_dA}\1${ac_dB}\1\2${ac_dC}\3${ac_dD},gp
-t end
-s,^[	 ]*#[	 ]*define[	 ][	 ]*\([^	 ][^	 ]*\)[	 ]*\(.*\)$,${ac_dA}\1${ac_dB}\1${ac_dC}\2${ac_dD},gp
-: end
-_ACEOF
-# If some macros were called several times there might be several times
-# the same #defines, which is useless.  Nevertheless, we may not want to
-# sort them, since we want the *last* AC-DEFINE to be honored.
-uniq confdefs.h | sed -n -f confdef2sed.sed >conftest.defines
-sed 's/ac_d/ac_u/g' conftest.defines >conftest.undefs
-rm -f confdef2sed.sed
-
-# This sed command replaces #undef with comments.  This is necessary, for
-# example, in the case of _POSIX_SOURCE, which is predefined and required
-# on some systems where configure will not decide to define it.
-cat >>conftest.undefs <<\_ACEOF
-s,^[	 ]*#[	 ]*undef[	 ][	 ]*[a-zA-Z_][a-zA-Z_0-9]*,/* & */,
-_ACEOF
-
-# Break up conftest.defines because some shells have a limit on the size
-# of here documents, and old seds have small limits too (100 cmds).
-echo '  # Handle all the #define templates only if necessary.' >>$CONFIG_STATUS
-echo '  if grep "^[	 ]*#[	 ]*define" $tmp/in >/dev/null; then' >>$CONFIG_STATUS
-echo '  # If there are no defines, we may have an empty if/fi' >>$CONFIG_STATUS
-echo '  :' >>$CONFIG_STATUS
-rm -f conftest.tail
-while grep . conftest.defines >/dev/null
-do
-  # Write a limited-size here document to $tmp/defines.sed.
-  echo '  cat >$tmp/defines.sed <<CEOF' >>$CONFIG_STATUS
-  # Speed up: don't consider the non `#define' lines.
-  echo '/^[	 ]*#[	 ]*define/!b' >>$CONFIG_STATUS
-  # Work around the forget-to-reset-the-flag bug.
-  echo 't clr' >>$CONFIG_STATUS
-  echo ': clr' >>$CONFIG_STATUS
-  sed ${ac_max_here_lines}q conftest.defines >>$CONFIG_STATUS
-  echo 'CEOF
-  sed -f $tmp/defines.sed $tmp/in >$tmp/out
-  rm -f $tmp/in
-  mv $tmp/out $tmp/in
-' >>$CONFIG_STATUS
-  sed 1,${ac_max_here_lines}d conftest.defines >conftest.tail
-  rm -f conftest.defines
-  mv conftest.tail conftest.defines
-done
-rm -f conftest.defines
-echo '  fi # grep' >>$CONFIG_STATUS
-echo >>$CONFIG_STATUS
-
-# Break up conftest.undefs because some shells have a limit on the size
-# of here documents, and old seds have small limits too (100 cmds).
-echo '  # Handle all the #undef templates' >>$CONFIG_STATUS
-rm -f conftest.tail
-while grep . conftest.undefs >/dev/null
-do
-  # Write a limited-size here document to $tmp/undefs.sed.
-  echo '  cat >$tmp/undefs.sed <<CEOF' >>$CONFIG_STATUS
-  # Speed up: don't consider the non `#undef'
-  echo '/^[	 ]*#[	 ]*undef/!b' >>$CONFIG_STATUS
-  # Work around the forget-to-reset-the-flag bug.
-  echo 't clr' >>$CONFIG_STATUS
-  echo ': clr' >>$CONFIG_STATUS
-  sed ${ac_max_here_lines}q conftest.undefs >>$CONFIG_STATUS
-  echo 'CEOF
-  sed -f $tmp/undefs.sed $tmp/in >$tmp/out
-  rm -f $tmp/in
-  mv $tmp/out $tmp/in
-' >>$CONFIG_STATUS
-  sed 1,${ac_max_here_lines}d conftest.undefs >conftest.tail
-  rm -f conftest.undefs
-  mv conftest.tail conftest.undefs
-done
-rm -f conftest.undefs
-
-cat >>$CONFIG_STATUS <<\_ACEOF
-  # Let's still pretend it is `configure' which instantiates (i.e., don't
-  # use $as_me), people would be surprised to read:
-  #    /* config.h.  Generated by config.status.  */
-  if test x"$ac_file" = x-; then
-    echo "/* Generated by configure.  */" >$tmp/config.h
-  else
-    echo "/* $ac_file.  Generated by configure.  */" >$tmp/config.h
-  fi
-  cat $tmp/in >>$tmp/config.h
-  rm -f $tmp/in
-  if test x"$ac_file" != x-; then
-    if diff $ac_file $tmp/config.h >/dev/null 2>&1; then
-      { echo "$as_me:$LINENO: $ac_file is unchanged" >&5
-echo "$as_me: $ac_file is unchanged" >&6;}
-    else
-      ac_dir=`(dirname "$ac_file") 2>/dev/null ||
-$as_expr X"$ac_file" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
-	 X"$ac_file" : 'X\(//\)[^/]' \| \
-	 X"$ac_file" : 'X\(//\)$' \| \
-	 X"$ac_file" : 'X\(/\)' \| \
-	 .     : '\(.\)' 2>/dev/null ||
-echo X"$ac_file" |
-    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{ s//\1/; q; }
-  	  /^X\(\/\/\)[^/].*/{ s//\1/; q; }
-  	  /^X\(\/\/\)$/{ s//\1/; q; }
-  	  /^X\(\/\).*/{ s//\1/; q; }
-  	  s/.*/./; q'`
-      { if $as_mkdir_p; then
-    mkdir -p "$ac_dir"
-  else
-    as_dir="$ac_dir"
-    as_dirs=
-    while test ! -d "$as_dir"; do
-      as_dirs="$as_dir $as_dirs"
-      as_dir=`(dirname "$as_dir") 2>/dev/null ||
-$as_expr X"$as_dir" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
-	 X"$as_dir" : 'X\(//\)[^/]' \| \
-	 X"$as_dir" : 'X\(//\)$' \| \
-	 X"$as_dir" : 'X\(/\)' \| \
-	 .     : '\(.\)' 2>/dev/null ||
-echo X"$as_dir" |
-    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{ s//\1/; q; }
-  	  /^X\(\/\/\)[^/].*/{ s//\1/; q; }
-  	  /^X\(\/\/\)$/{ s//\1/; q; }
-  	  /^X\(\/\).*/{ s//\1/; q; }
-  	  s/.*/./; q'`
-    done
-    test ! -n "$as_dirs" || mkdir $as_dirs
-  fi || { { echo "$as_me:$LINENO: error: cannot create directory \"$ac_dir\"" >&5
-echo "$as_me: error: cannot create directory \"$ac_dir\"" >&2;}
-   { (exit 1); exit 1; }; }; }
-
-      rm -f $ac_file
-      mv $tmp/config.h $ac_file
-    fi
-  else
-    cat $tmp/config.h
-    rm -f $tmp/config.h
-  fi
-# Compute $ac_file's index in $config_headers.
-_am_stamp_count=1
-for _am_header in $config_headers :; do
-  case $_am_header in
-    $ac_file | $ac_file:* )
-      break ;;
-    * )
-      _am_stamp_count=`expr $_am_stamp_count + 1` ;;
-  esac
-done
-echo "timestamp for $ac_file" >`(dirname $ac_file) 2>/dev/null ||
-$as_expr X$ac_file : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
-	 X$ac_file : 'X\(//\)[^/]' \| \
-	 X$ac_file : 'X\(//\)$' \| \
-	 X$ac_file : 'X\(/\)' \| \
-	 .     : '\(.\)' 2>/dev/null ||
-echo X$ac_file |
-    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{ s//\1/; q; }
-  	  /^X\(\/\/\)[^/].*/{ s//\1/; q; }
-  	  /^X\(\/\/\)$/{ s//\1/; q; }
-  	  /^X\(\/\).*/{ s//\1/; q; }
-  	  s/.*/./; q'`/stamp-h$_am_stamp_count
-done
-_ACEOF
-cat >>$CONFIG_STATUS <<\_ACEOF
-
-#
-# CONFIG_COMMANDS section.
-#
-for ac_file in : $CONFIG_COMMANDS; do test "x$ac_file" = x: && continue
-  ac_dest=`echo "$ac_file" | sed 's,:.*,,'`
-  ac_source=`echo "$ac_file" | sed 's,[^:]*:,,'`
-  ac_dir=`(dirname "$ac_dest") 2>/dev/null ||
-$as_expr X"$ac_dest" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
-	 X"$ac_dest" : 'X\(//\)[^/]' \| \
-	 X"$ac_dest" : 'X\(//\)$' \| \
-	 X"$ac_dest" : 'X\(/\)' \| \
-	 .     : '\(.\)' 2>/dev/null ||
-echo X"$ac_dest" |
-    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{ s//\1/; q; }
-  	  /^X\(\/\/\)[^/].*/{ s//\1/; q; }
-  	  /^X\(\/\/\)$/{ s//\1/; q; }
-  	  /^X\(\/\).*/{ s//\1/; q; }
-  	  s/.*/./; q'`
-  { if $as_mkdir_p; then
-    mkdir -p "$ac_dir"
-  else
-    as_dir="$ac_dir"
-    as_dirs=
-    while test ! -d "$as_dir"; do
-      as_dirs="$as_dir $as_dirs"
-      as_dir=`(dirname "$as_dir") 2>/dev/null ||
-$as_expr X"$as_dir" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
-	 X"$as_dir" : 'X\(//\)[^/]' \| \
-	 X"$as_dir" : 'X\(//\)$' \| \
-	 X"$as_dir" : 'X\(/\)' \| \
-	 .     : '\(.\)' 2>/dev/null ||
-echo X"$as_dir" |
-    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{ s//\1/; q; }
-  	  /^X\(\/\/\)[^/].*/{ s//\1/; q; }
-  	  /^X\(\/\/\)$/{ s//\1/; q; }
-  	  /^X\(\/\).*/{ s//\1/; q; }
-  	  s/.*/./; q'`
-    done
-    test ! -n "$as_dirs" || mkdir $as_dirs
-  fi || { { echo "$as_me:$LINENO: error: cannot create directory \"$ac_dir\"" >&5
-echo "$as_me: error: cannot create directory \"$ac_dir\"" >&2;}
-   { (exit 1); exit 1; }; }; }
-
-  ac_builddir=.
-
-if test "$ac_dir" != .; then
-  ac_dir_suffix=/`echo "$ac_dir" | sed 's,^\.[\\/],,'`
-  # A "../" for each directory in $ac_dir_suffix.
-  ac_top_builddir=`echo "$ac_dir_suffix" | sed 's,/[^\\/]*,../,g'`
-else
-  ac_dir_suffix= ac_top_builddir=
-fi
-
-case $srcdir in
-  .)  # No --srcdir option.  We are building in place.
-    ac_srcdir=.
-    if test -z "$ac_top_builddir"; then
-       ac_top_srcdir=.
-    else
-       ac_top_srcdir=`echo $ac_top_builddir | sed 's,/$,,'`
-    fi ;;
-  [\\/]* | ?:[\\/]* )  # Absolute path.
-    ac_srcdir=$srcdir$ac_dir_suffix;
-    ac_top_srcdir=$srcdir ;;
-  *) # Relative path.
-    ac_srcdir=$ac_top_builddir$srcdir$ac_dir_suffix
-    ac_top_srcdir=$ac_top_builddir$srcdir ;;
-esac
-
-# Do not use `cd foo && pwd` to compute absolute paths, because
-# the directories may not exist.
-case `pwd` in
-.) ac_abs_builddir="$ac_dir";;
-*)
-  case "$ac_dir" in
-  .) ac_abs_builddir=`pwd`;;
-  [\\/]* | ?:[\\/]* ) ac_abs_builddir="$ac_dir";;
-  *) ac_abs_builddir=`pwd`/"$ac_dir";;
-  esac;;
-esac
-case $ac_abs_builddir in
-.) ac_abs_top_builddir=${ac_top_builddir}.;;
-*)
-  case ${ac_top_builddir}. in
-  .) ac_abs_top_builddir=$ac_abs_builddir;;
-  [\\/]* | ?:[\\/]* ) ac_abs_top_builddir=${ac_top_builddir}.;;
-  *) ac_abs_top_builddir=$ac_abs_builddir/${ac_top_builddir}.;;
-  esac;;
-esac
-case $ac_abs_builddir in
-.) ac_abs_srcdir=$ac_srcdir;;
-*)
-  case $ac_srcdir in
-  .) ac_abs_srcdir=$ac_abs_builddir;;
-  [\\/]* | ?:[\\/]* ) ac_abs_srcdir=$ac_srcdir;;
-  *) ac_abs_srcdir=$ac_abs_builddir/$ac_srcdir;;
-  esac;;
-esac
-case $ac_abs_builddir in
-.) ac_abs_top_srcdir=$ac_top_srcdir;;
-*)
-  case $ac_top_srcdir in
-  .) ac_abs_top_srcdir=$ac_abs_builddir;;
-  [\\/]* | ?:[\\/]* ) ac_abs_top_srcdir=$ac_top_srcdir;;
-  *) ac_abs_top_srcdir=$ac_abs_builddir/$ac_top_srcdir;;
-  esac;;
-esac
-
-
-  { echo "$as_me:$LINENO: executing $ac_dest commands" >&5
-echo "$as_me: executing $ac_dest commands" >&6;}
-  case $ac_dest in
-    depfiles ) test x"$AMDEP_TRUE" != x"" || for mf in $CONFIG_FILES; do
-  # Strip MF so we end up with the name of the file.
-  mf=`echo "$mf" | sed -e 's/:.*$//'`
-  # Check whether this is an Automake generated Makefile or not.
-  # We used to match only the files named `Makefile.in', but
-  # some people rename them; so instead we look at the file content.
-  # Grep'ing the first line is not enough: some people post-process
-  # each Makefile.in and add a new line on top of each file to say so.
-  # So let's grep whole file.
-  if grep '^#.*generated by automake' $mf > /dev/null 2>&1; then
-    dirpart=`(dirname "$mf") 2>/dev/null ||
-$as_expr X"$mf" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
-	 X"$mf" : 'X\(//\)[^/]' \| \
-	 X"$mf" : 'X\(//\)$' \| \
-	 X"$mf" : 'X\(/\)' \| \
-	 .     : '\(.\)' 2>/dev/null ||
-echo X"$mf" |
-    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{ s//\1/; q; }
-  	  /^X\(\/\/\)[^/].*/{ s//\1/; q; }
-  	  /^X\(\/\/\)$/{ s//\1/; q; }
-  	  /^X\(\/\).*/{ s//\1/; q; }
-  	  s/.*/./; q'`
-  else
-    continue
-  fi
-  grep '^DEP_FILES *= *[^ #]' < "$mf" > /dev/null || continue
-  # Extract the definition of DEP_FILES from the Makefile without
-  # running `make'.
-  DEPDIR=`sed -n -e '/^DEPDIR = / s///p' < "$mf"`
-  test -z "$DEPDIR" && continue
-  # When using ansi2knr, U may be empty or an underscore; expand it
-  U=`sed -n -e '/^U = / s///p' < "$mf"`
-  test -d "$dirpart/$DEPDIR" || mkdir "$dirpart/$DEPDIR"
-  # We invoke sed twice because it is the simplest approach to
-  # changing $(DEPDIR) to its actual value in the expansion.
-  for file in `sed -n -e '
-    /^DEP_FILES = .*\\\\$/ {
-      s/^DEP_FILES = //
-      :loop
-	s/\\\\$//
-	p
-	n
-	/\\\\$/ b loop
-      p
-    }
-    /^DEP_FILES = / s/^DEP_FILES = //p' < "$mf" | \
-       sed -e 's/\$(DEPDIR)/'"$DEPDIR"'/g' -e 's/\$U/'"$U"'/g'`; do
-    # Make sure the directory exists.
-    test -f "$dirpart/$file" && continue
-    fdir=`(dirname "$file") 2>/dev/null ||
-$as_expr X"$file" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
-	 X"$file" : 'X\(//\)[^/]' \| \
-	 X"$file" : 'X\(//\)$' \| \
-	 X"$file" : 'X\(/\)' \| \
-	 .     : '\(.\)' 2>/dev/null ||
-echo X"$file" |
-    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{ s//\1/; q; }
-  	  /^X\(\/\/\)[^/].*/{ s//\1/; q; }
-  	  /^X\(\/\/\)$/{ s//\1/; q; }
-  	  /^X\(\/\).*/{ s//\1/; q; }
-  	  s/.*/./; q'`
-    { if $as_mkdir_p; then
-    mkdir -p $dirpart/$fdir
-  else
-    as_dir=$dirpart/$fdir
-    as_dirs=
-    while test ! -d "$as_dir"; do
-      as_dirs="$as_dir $as_dirs"
-      as_dir=`(dirname "$as_dir") 2>/dev/null ||
-$as_expr X"$as_dir" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
-	 X"$as_dir" : 'X\(//\)[^/]' \| \
-	 X"$as_dir" : 'X\(//\)$' \| \
-	 X"$as_dir" : 'X\(/\)' \| \
-	 .     : '\(.\)' 2>/dev/null ||
-echo X"$as_dir" |
-    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{ s//\1/; q; }
-  	  /^X\(\/\/\)[^/].*/{ s//\1/; q; }
-  	  /^X\(\/\/\)$/{ s//\1/; q; }
-  	  /^X\(\/\).*/{ s//\1/; q; }
-  	  s/.*/./; q'`
-    done
-    test ! -n "$as_dirs" || mkdir $as_dirs
-  fi || { { echo "$as_me:$LINENO: error: cannot create directory $dirpart/$fdir" >&5
-echo "$as_me: error: cannot create directory $dirpart/$fdir" >&2;}
-   { (exit 1); exit 1; }; }; }
-
-    # echo "creating $dirpart/$file"
-    echo '# dummy' > "$dirpart/$file"
-  done
-done
- ;;
-  esac
-done
-_ACEOF
-
-cat >>$CONFIG_STATUS <<\_ACEOF
-
-{ (exit 0); exit 0; }
-_ACEOF
-chmod +x $CONFIG_STATUS
-ac_clean_files=$ac_clean_files_save
-
-
-# configure is writing to config.log, and then calls config.status.
-# config.status does its own redirection, appending to config.log.
-# Unfortunately, on DOS this fails, as config.log is still kept open
-# by configure, so config.status won't be able to write to it; its
-# output is simply discarded.  So we exec the FD to /dev/null,
-# effectively closing config.log, so it can be properly (re)opened and
-# appended to by config.status.  When coming back to configure, we
-# need to make the FD available again.
-if test "$no_create" != yes; then
-  ac_cs_success=:
-  ac_config_status_args=
-  test "$silent" = yes &&
-    ac_config_status_args="$ac_config_status_args --quiet"
-  exec 5>/dev/null
-  $SHELL $CONFIG_STATUS $ac_config_status_args || ac_cs_success=false
-  exec 5>>config.log
-  # Use ||, not &&, to avoid exiting from the if with $? = 1, which
-  # would make configure fail if this is the last instruction.
-  $ac_cs_success || { (exit 1); exit 1; }
-fi
-
-



From marec at berlios.de  Tue Jun 27 02:01:28 2006
From: marec at berlios.de (marec at BerliOS)
Date: Tue, 27 Jun 2006 02:01:28 +0200
Subject: [S3d-svn] r361 - trunk/example
Message-ID: <200606270001.k5R01Sii022894@sheep.berlios.de>

Author: marec
Date: 2006-06-27 02:01:05 +0200 (Tue, 27 Jun 2006)
New Revision: 361

Modified:
   trunk/example/3dsloader_g3d.c
Log:
- s3d import vertices fixed
- s3d import texture coordinates fixed
- s3d import pixeldata fixed
=> it is quite usable now - ready for 0.2  ;-)


Modified: trunk/example/3dsloader_g3d.c
===================================================================
--- trunk/example/3dsloader_g3d.c	2006-06-25 12:11:51 UTC (rev 360)
+++ trunk/example/3dsloader_g3d.c	2006-06-27 00:01:05 UTC (rev 361)
@@ -1,7 +1,8 @@
 /*
- * 3dsloader.c
+ * 3dsloader_g3d.c
  *
  * Copyright (C) 2004-2006 Simon Wunderlich <dotslash at packetmixer.de>
+ *                         Marek Lindner <lindner_marek at yahoo.de>
  *
  * This file is part of s3d, a 3d network display server.
  * See http://s3d.berlios.de/ for more updates.
@@ -103,7 +104,8 @@
 	G3DFace *face;
 	GSList *oitem, *oface;
 	struct material2texture *mat2tex;
-	int j, material_count, texture_count;
+	int j, k, material_count, texture_count;
+	unsigned char *s3d_pixeldata = NULL;
 
 	if (argc<2) {
 		printf("usage: %s [somefile.3ds]\n",argv[0]);
@@ -130,7 +132,8 @@
 
 				/* push vertices */
 				for ( j = 0; j < object->vertex_count; j++ ) {
-					s3d_push_vertex( obj_id, object->vertex_data[j * 3], object->vertex_data[j * 3 + 1], object->vertex_data[j * 3 + 2] );
+					/* 3. and 4. param have to change places otherwise the object will be turned */
+					s3d_push_vertex( obj_id, object->vertex_data[j * 3], object->vertex_data[j * 3 + 2], object->vertex_data[j * 3 + 1] );
 				}
 
 
@@ -144,7 +147,7 @@
 
 					if ( mat2tex->material_id == -1 ) {
 
-						printf( "push material: %i\n", material_count );
+						/* printf( "push material: %i\n", material_count ); */
 
 						s3d_push_material_a( obj_id, face->material->r, face->material->g, face->material->b, face->material->a, face->material->specular[0], face->material->specular[1], face->material->specular[2], face->material->specular[3], face->material->r, face->material->g, face->material->b, face->material->a );
 
@@ -153,9 +156,32 @@
 
 						if ( face->tex_image != NULL ) {
 
+							/* reorder pixeldata - s3d wants rgba */
+							if ( s3d_pixeldata != NULL ) free( s3d_pixeldata );
+
+							s3d_pixeldata = malloc( sizeof( unsigned char ) * face->tex_image->width * face->tex_image->height * 32 );
+
+							if ( s3d_pixeldata == NULL ) {
+								printf( "Sorry - you ran out of memory !\n" );
+								exit(8);
+							}
+
+							for ( j = ( face->tex_image->height - 1 ); j >= 0; j-- ) {
+
+								for ( k = 0; k < face->tex_image->width; k++ ) {
+
+									s3d_pixeldata[ ( j * face->tex_image->width + k ) * 4 + 0 ] = face->tex_image->pixeldata[ ( j * face->tex_image->width + k ) * 4 + 2 ];
+									s3d_pixeldata[ ( j * face->tex_image->width + k ) * 4 + 1 ] = face->tex_image->pixeldata[ ( j * face->tex_image->width + k ) * 4 + 1 ];
+									s3d_pixeldata[ ( j * face->tex_image->width + k ) * 4 + 2 ] = face->tex_image->pixeldata[ ( j * face->tex_image->width + k ) * 4 + 0 ];
+									s3d_pixeldata[ ( j * face->tex_image->width + k ) * 4 + 3 ] = face->tex_image->pixeldata[ ( j * face->tex_image->width + k ) * 4 + 3 ];
+
+								}
+
+							}
+
 							s3d_push_texture( obj_id, face->tex_image->width, face->tex_image->height );
 							s3d_pep_material_texture( obj_id, texture_count );
-							s3d_load_texture( obj_id, texture_count, 0, 0, face->tex_image->width, face->tex_image->height, face->tex_image->pixeldata );
+							s3d_load_texture( obj_id, texture_count, 0, 0, face->tex_image->width, face->tex_image->height, s3d_pixeldata );
 
 							mat2tex->texture_id = texture_count;
 							texture_count++;
@@ -164,7 +190,7 @@
 
 					}
 
-					printf( "push polygone with material: %i\n", mat2tex->material_id );
+					/* printf( "push polygone with material: %i\n", mat2tex->material_id ); */
 
 					/* push polygones */
 					s3d_push_polygon( obj_id, face->vertex_indices[0], face->vertex_indices[1], face->vertex_indices[2], mat2tex->material_id );
@@ -175,11 +201,8 @@
 					/* face with texture */
 					if ( ( mat2tex->texture_id != -1 ) && ( face->flags & G3D_FLAG_FAC_TEXMAP ) ) {
 
-						printf( "neues face: %i\n", face->tex_vertex_count );
-/* 						for ( j = 0; j < face->tex_vertex_count; j++ ) {
- 							printf( "%i -> %f\n", j, face->tex_vertex_data[j] ); */
-							s3d_pep_polygon_tex_coord( obj_id, face->tex_vertex_data[0], face->tex_vertex_data[1], face->tex_vertex_data[2], face->tex_vertex_data[3], face->tex_vertex_data[4], face->tex_vertex_data[5] );
-/* 						} */
+						/* printf( "neues face: %i\n", face->tex_vertex_count ); */
+						s3d_pep_polygon_tex_coord( obj_id, face->tex_vertex_data[5], face->tex_vertex_data[4], face->tex_vertex_data[3], face->tex_vertex_data[2], face->tex_vertex_data[1], face->tex_vertex_data[0] );
 
 					}
 



From dotslash at berlios.de  Tue Jun 27 08:14:29 2006
From: dotslash at berlios.de (dotslash at BerliOS)
Date: Tue, 27 Jun 2006 08:14:29 +0200
Subject: [S3d-svn] r362 - in trunk: . Documentation/libs3d
Message-ID: <200606270614.k5R6ETNP011835@sheep.berlios.de>

Author: dotslash
Date: 2006-06-27 08:14:19 +0200 (Tue, 27 Jun 2006)
New Revision: 362

Modified:
   trunk/
   trunk/Documentation/libs3d/libs3d.docbook
Log:
 r844 at balthasar:  dotslash | 2006-06-27 08:14:12 +0200
 - typo



Property changes on: trunk
___________________________________________________________________
Name: svk:merge
   - bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:827
   + bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:844

Modified: trunk/Documentation/libs3d/libs3d.docbook
===================================================================
--- trunk/Documentation/libs3d/libs3d.docbook	2006-06-27 00:01:05 UTC (rev 361)
+++ trunk/Documentation/libs3d/libs3d.docbook	2006-06-27 06:14:19 UTC (rev 362)
@@ -840,7 +840,7 @@
 unsigned short <parameter>ypos</parameter>,
 unsigned short <parameter>w</parameter>,
 unsigned short <parameter>h</parameter>,
-unsgined char *<parameter>data</parameter>
+unsigned char *<parameter>data</parameter>
 </paramdef>
 </funcprototype>
 </funcsynopsis>



From dotslash at berlios.de  Tue Jun 27 10:24:43 2006
From: dotslash at berlios.de (dotslash at BerliOS)
Date: Tue, 27 Jun 2006 10:24:43 +0200
Subject: [S3d-svn] r363 - trunk/example
Message-ID: <200606270824.k5R8OhEp032525@sheep.berlios.de>

Author: dotslash
Date: 2006-06-27 10:24:42 +0200 (Tue, 27 Jun 2006)
New Revision: 363

Modified:
   trunk/example/3dsloader_g3d.c
Log:
- 3dsloader multiple objects to one object: use vertex offset

Modified: trunk/example/3dsloader_g3d.c
===================================================================
--- trunk/example/3dsloader_g3d.c	2006-06-27 06:14:19 UTC (rev 362)
+++ trunk/example/3dsloader_g3d.c	2006-06-27 08:24:42 UTC (rev 363)
@@ -104,7 +104,8 @@
 	G3DFace *face;
 	GSList *oitem, *oface;
 	struct material2texture *mat2tex;
-	int j, k, material_count, texture_count;
+	int j, k, material_count, texture_count, voff;
+	int polys=0;
 	unsigned char *s3d_pixeldata = NULL;
 
 	if (argc<2) {
@@ -124,12 +125,12 @@
 
 			oitem = model->objects;
 			obj_id = s3d_new_object();
-			material_count = texture_count = 0;
+			material_count = texture_count = voff = 0;
 
 			while ( oitem ) {
 
 				object = (G3DObject *)oitem->data;
-
+				
 				/* push vertices */
 				for ( j = 0; j < object->vertex_count; j++ ) {
 					/* 3. and 4. param have to change places otherwise the object will be turned */
@@ -193,7 +194,7 @@
 					/* printf( "push polygone with material: %i\n", mat2tex->material_id ); */
 
 					/* push polygones */
-					s3d_push_polygon( obj_id, face->vertex_indices[0], face->vertex_indices[1], face->vertex_indices[2], mat2tex->material_id );
+					s3d_push_polygon( obj_id, face->vertex_indices[0] + voff, face->vertex_indices[1] + voff , face->vertex_indices[2] + voff, mat2tex->material_id );
 
 					/* has polygone normals */
 					if ( face->flags & G3D_FLAG_FAC_NORMALS ) s3d_pep_polygon_normals( obj_id, face->normals, 1 );
@@ -211,11 +212,11 @@
 
 				}
 
-				s3d_flags_on( obj_id, S3D_OF_VISIBLE|S3D_OF_SELECTABLE );
-
+				voff += object->vertex_count; /* increase vertex offset */
 				oitem = oitem->next;
 
 			}
+			s3d_flags_on( obj_id, S3D_OF_VISIBLE|S3D_OF_SELECTABLE );
 
 			s3d_mainloop(mainloop);
 



From dotslash at berlios.de  Tue Jun 27 18:54:58 2006
From: dotslash at berlios.de (dotslash at BerliOS)
Date: Tue, 27 Jun 2006 18:54:58 +0200
Subject: [S3d-svn] r364 - trunk/libs3d
Message-ID: <200606271654.k5RGswrZ025579@sheep.berlios.de>

Author: dotslash
Date: 2006-06-27 18:54:56 +0200 (Tue, 27 Jun 2006)
New Revision: 364

Modified:
   trunk/libs3d/event.c
   trunk/libs3d/io.c
   trunk/libs3d/network.c
   trunk/libs3d/object_queue.c
   trunk/libs3d/proto_in.c
   trunk/libs3d/s3dlib.h
Log:
- locking before we got an "init" signal from the server - no insane recursions ;)
- some cleanup

Modified: trunk/libs3d/event.c
===================================================================
--- trunk/libs3d/event.c	2006-06-27 08:24:42 UTC (rev 363)
+++ trunk/libs3d/event.c	2006-06-27 16:54:56 UTC (rev 364)
@@ -28,7 +28,7 @@
 #include <stdlib.h>		 /*  malloc(), free() */
 
 struct s3d_evt *s3d_stack;
-static int cb_lock=0;	 /*  callback lock */
+int cb_lock=0;	 /*  callback lock */
 void s3d_push_event(struct s3d_evt *newevt)
 {
 	struct s3d_evt *p;

Modified: trunk/libs3d/io.c
===================================================================
--- trunk/libs3d/io.c	2006-06-27 08:24:42 UTC (rev 363)
+++ trunk/libs3d/io.c	2006-06-27 16:54:56 UTC (rev 364)
@@ -44,6 +44,7 @@
 
 static char				*url=NULL;
 extern int 				con_type;
+extern int 				cb_lock;
 /*  this file is the client-lib-implementation which holds the function to connect and control the server. */
 #ifdef SIGS
 int _s3d_sigio=0;
@@ -149,8 +150,8 @@
 	}
 	strncpy(buf,name,256);  /*  copy the name ... */
 	net_send(S3D_P_C_INIT,buf,strlen(buf));
+	cb_lock=2;
 
-	 /*  TODO: we should wait for the INIT-event here before proceeding. */
 	_queue_init();
 #ifdef SIGS
     if (signal(SIGINT, (sig_t)sigint_handler) == SIG_ERR)

Modified: trunk/libs3d/network.c
===================================================================
--- trunk/libs3d/network.c	2006-06-27 08:24:42 UTC (rev 363)
+++ trunk/libs3d/network.c	2006-06-27 16:54:56 UTC (rev 364)
@@ -41,11 +41,12 @@
 {
 	char *ptr;
 /* 	char *buff; */
-	char buff[65536];  /*  unsigned short really shouldn't be bigger ;) */
+	char buff[65539];  /*  unsigned short really shouldn't be bigger ;) */
 	*(buff)=opcode; 
 	ptr=buff+1;
 	*((unsigned short *) ptr)=htons(length);
-	memcpy(buff+3,buf,length);
+	if (length!=0)
+		memcpy(buff+3,buf,length);
 	switch (con_type)
 	{
 #ifdef SHM

Modified: trunk/libs3d/object_queue.c
===================================================================
--- trunk/libs3d/object_queue.c	2006-06-27 08:24:42 UTC (rev 363)
+++ trunk/libs3d/object_queue.c	2006-06-27 16:54:56 UTC (rev 364)
@@ -88,28 +88,29 @@
 unsigned int _queue_want_object()
 {
 	unsigned int ret;
-	int i;
+	int i,j;
+	j=0;
 	do {
-	for (i=0;i<queue_size;i++)
-		if (queue[i]!=Q_UNUSED)
+		for (i=0;i<queue_size;i++)
+			if (queue[i]!=Q_UNUSED)
+			{
+				ret=queue[i];
+				queue[i]=Q_UNUSED;
+				net_send(S3D_P_C_NEW_OBJ,NULL,0);  /*  we already can request a new one. */
+				return(ret);
+			}
+		 /*  if we reach this point, our queue is empty. */
+		 /*  as other request should have sent S3D_P_C_NEW_OBJ-requests,  */
+		 /*  we request one more object than needed to satisfy more load in future. */
+		if (queue_size==0) return(-1);  /*  already quit. */
+		if (requested<MAX_REQ)
 		{
-			ret=queue[i];
-			queue[i]=Q_UNUSED;
-			net_send(S3D_P_C_NEW_OBJ,NULL,0);  /*  we already can request a new one. */
-			return(ret);
+			net_send(S3D_P_C_NEW_OBJ,NULL,0);
+			requested++;
 		}
-	 /*  if we reach this point, our queue is empty. */
-	 /*  as other request should have sent S3D_P_C_NEW_OBJ-requests,  */
-	 /*  we request one more object than needed to satisfy more load in future. */
-	if (queue_size==0) return(-1);  /*  already quit. */
-	if (requested<MAX_REQ)
-	{
-		net_send(S3D_P_C_NEW_OBJ,NULL,0);
-		requested++;
-	}
-	s3d_net_check();
-	nanosleep(&t,NULL); 
-	} while(i++<TIMEOUT);
+		s3d_net_check();
+		nanosleep(&t,NULL); 
+	} while(j++<TIMEOUT);
 
 	errds(LOW,"_queue_want_object()","timeout is reached. server is extremly slow/laggy or dead");	
 	return(-1);

Modified: trunk/libs3d/proto_in.c
===================================================================
--- trunk/libs3d/proto_in.c	2006-06-27 08:24:42 UTC (rev 363)
+++ trunk/libs3d/proto_in.c	2006-06-27 16:54:56 UTC (rev 364)
@@ -28,7 +28,7 @@
 #include <netinet/in.h>  /*  htons(),htonl() */
 #include <errno.h>		 /*  errno */
 #include <stdlib.h>		 /*  malloc(), free() */
-
+extern int cb_lock;
 /*  this proccesses the commands and pushes s3d-events, or does other things ;) */
 int net_prot_in(uint8_t opcode, uint16_t length, char *buf)
 {
@@ -40,6 +40,7 @@
 	{
 		case S3D_P_S_INIT:
 			s3dprintf(MED,"S3D_P_S_INIT: init!!");
+			cb_lock=0;
 			break;
 		case S3D_P_S_QUIT:
 			s3dprintf(MED,"S3D_P_S_QUIT: server wants us to go. well ...");

Modified: trunk/libs3d/s3dlib.h
===================================================================
--- trunk/libs3d/s3dlib.h	2006-06-27 08:24:42 UTC (rev 363)
+++ trunk/libs3d/s3dlib.h	2006-06-27 16:54:56 UTC (rev 364)
@@ -35,7 +35,7 @@
 #define OF_TURN_ON 		1		 /*  logical or */
 #define OF_TURN_OFF 	2		 /*  logical ?! */
 #define OF_TURN_SWAP 	3		 /*  logical ?! */
-#define TIMEOUT			1000
+#define TIMEOUT			100000
 #define MAX_CB			256		 /*  as much as there are callbacks */
 #ifndef NULL
 	#define NULL	0



From dotslash at berlios.de  Tue Jun 27 19:32:50 2006
From: dotslash at berlios.de (dotslash at BerliOS)
Date: Tue, 27 Jun 2006 19:32:50 +0200
Subject: [S3d-svn] r365 - in trunk: example libs3dw
Message-ID: <200606271732.k5RHWoVf005721@sheep.berlios.de>

Author: dotslash
Date: 2006-06-27 19:32:46 +0200 (Tue, 27 Jun 2006)
New Revision: 365

Modified:
   trunk/example/widgets.c
   trunk/libs3dw/Makefile.am
   trunk/libs3dw/animate.c
   trunk/libs3dw/arrange.c
   trunk/libs3dw/event.c
   trunk/libs3dw/root.c
   trunk/libs3dw/s3dw.h
   trunk/libs3dw/s3dw_int.h
Log:
- widgets are turning to user (not really yet, but it's funny :D)
- s3dw_object_info(), so s3dw will get info about the objects
- widgets move away from camera (no ugly clipping effects)

Modified: trunk/example/widgets.c
===================================================================
--- trunk/example/widgets.c	2006-06-27 16:54:56 UTC (rev 364)
+++ trunk/example/widgets.c	2006-06-27 17:32:46 UTC (rev 365)
@@ -132,6 +132,7 @@
 	{
 		s3d_set_callback(S3D_EVENT_OBJ_CLICK,click);
 		s3d_set_callback(S3D_EVENT_KEY,key);
+		s3d_set_callback(S3D_EVENT_OBJ_INFO,s3dw_object_info);
 		/* this creates the "window" */
 		surface=s3dw_surface_new("Hello World",20,10);
 		

Modified: trunk/libs3dw/Makefile.am
===================================================================
--- trunk/libs3dw/Makefile.am	2006-06-27 16:54:56 UTC (rev 364)
+++ trunk/libs3dw/Makefile.am	2006-06-27 17:32:46 UTC (rev 365)
@@ -1,6 +1,6 @@
 lib_LTLIBRARIES=	libs3dw.la
 
-libs3dw_la_SOURCES=	button.c surface.c widget.c style.c event.c animate.c label.c input.c root.c arrange.c
+libs3dw_la_SOURCES=	button.c surface.c widget.c style.c event.c animate.c label.c input.c root.c arrange.c 
 			
 include_HEADERS= 	s3dw.h
 noinst_HEADERS=		s3dw_int.h

Modified: trunk/libs3dw/animate.c
===================================================================
--- trunk/libs3dw/animate.c	2006-06-27 16:54:56 UTC (rev 364)
+++ trunk/libs3dw/animate.c	2006-06-27 17:32:46 UTC (rev 365)
@@ -81,6 +81,9 @@
 	f->ax= f->x;
 	f->ay= f->y;
 	f->az= f->z;
+	f->arx= f->rx;
+	f->ary= f->ry;
+	f->arz= f->rz;
 	f->as= f->s;
 	s3dw_ani_doit(f);
 	if (i!=-1)
@@ -91,6 +94,9 @@
 	f->ax=(f->x + f->ax*ZOOMS)/(ZOOMS+1);
 	f->ay=(f->y + f->ay*ZOOMS)/(ZOOMS+1);
 	f->az=(f->z + f->az*ZOOMS)/(ZOOMS+1);
+	f->arx=(f->rx + f->arx*ZOOMS)/(ZOOMS+1);
+	f->ary=(f->ry + f->ary*ZOOMS)/(ZOOMS+1);
+	f->arz=(f->rz + f->arz*ZOOMS)/(ZOOMS+1);
 	f->as=(f->s + f->as*ZOOMS)/(ZOOMS+1);
 
 }
@@ -98,11 +104,15 @@
 /* checks if f is good enough */
 int s3dw_ani_check(s3dw_widget *f)
 {
-	float x,y,z;
+	float x,y,z,rx,ry,rz;
 	x=f->ax - f->x;
 	y=f->ay - f->y;
 	z=f->az - f->z;
-	if (((fabs(f->as - f->s)/f->s)>0.01) || (sqrt(x*x+y*y+z*z) > 0.01))
+	rx=f->arx - f->rx;
+	ry=f->ary - f->ry;
+	rz=f->arz - f->rz;
+
+	if (((fabs(f->as - f->s)/f->s)>0.01) || (sqrt(x*x+y*y+z*z) > 0.01) || (sqrt(rx*rx+ry*ry+rz*rz) > 0.01))
 		return(0);
 	return(1);
 }

Modified: trunk/libs3dw/arrange.c
===================================================================
--- trunk/libs3dw/arrange.c	2006-06-27 16:54:56 UTC (rev 364)
+++ trunk/libs3dw/arrange.c	2006-06-27 17:32:46 UTC (rev 365)
@@ -25,12 +25,14 @@
 #include <s3dw.h>
 #include <s3dw_int.h>
 #include <stdlib.h> /* rand(), RAND_MAX */
+#include <math.h>	/* M_PI */
+s3dw_widget *cam=NULL;
 
 void s3dw_arr_widgetcenter(s3dw_widget *widget, float *center)
 {
-	center[0]=widget->width/2;
-	center[1]=-widget->height/2+0.5;
-	center[2]=0.5;
+	center[0]=widget->s*widget->width/2;
+	center[1]=widget->s*-widget->height/2+0.5;
+	center[2]=widget->s*0.5;
 	
 }
 void s3dw_arr_normdir(float *dir)
@@ -47,6 +49,34 @@
 	dir[1]/=dirlen;
 	dir[2]/=dirlen;
 }
+void s3dw_turn()
+{
+	s3dw_widget *w,*root=s3dw_getroot();
+	int i;
+	float a[3],b[3],ry,rz;
+	a[0]=0;
+	a[1]=0;
+	a[2]=1;
+	for (i=0;i<root->nobj;i++)
+	{
+		w=root->pobj[i];
+		if (w->oid!=0)
+		{
+			/* horizontal movement */
+			b[0]=w->x   - cam->x;
+			b[1]=0;
+			b[2]=w->z   - cam->z;
+			ry=180*s3d_vector_angle(a,b)/M_PI;
+			b[0]=w->x   - cam->x;
+			b[1]=0;
+			b[2]=w->z   - cam->z;
+			rz=180*s3d_vector_angle(a,b)/M_PI;
+			w->ry=ry;
+			w->rz=rz;
+			s3dprintf(MED,"turn %03.3f, %03.3f",ry,rz);
+		}
+	}
+}
 void s3dw_arrange()
 {
 	s3dw_widget *w1,*w2,*root=s3dw_getroot();
@@ -60,11 +90,13 @@
 	for (i=0;i<root->nobj;i++)
 		if (!(root->pobj[i]->flags&S3DW_ARRANGED)) arranged=0;
 	if (arranged) return; /* no arrangement necceasary .... */
-
+/*	if (cam->flags|S3DW_*/
+		
 	if (root->nobj==1)
 	{
 		w1=root->pobj[0];
 		w1->flags|=S3DW_ARRANGED; /* done */
+		return;
 	}
 	for (i=0;i<root->nobj;i++)
 	{
@@ -92,15 +124,29 @@
 					tomove=((len1+len2+1)-dirlen);
 					move1=len1/(len1+len2);
 					move2=len2/(len1+len2);
-					w1->x += tomove * move1 *  dir[0];
-					w1->y += tomove * move1 *  dir[1];
-					w1->z += tomove * move1 *  dir[2];
-					w2->x += tomove * move2 * -dir[0];
-					w2->y += tomove * move2 * -dir[1];
-					w2->z += tomove * move2 * -dir[2];
+					if (w1->oid!=0)
+					{
+						w1->x += tomove * move1 *  dir[0];
+						w1->y += tomove * move1 *  dir[1];
+						w1->z += tomove * move1 *  dir[2];
+						s3dw_ani_add(w1);
+					} else {
+						w2->x += tomove * move2 * -dir[0];
+						w2->y += tomove * move2 * -dir[1];
+						w2->z += tomove * move2 * -dir[2];
 
-					s3dw_ani_add(w1);
-					s3dw_ani_add(w2);
+					}
+					if (w2->oid!=0)
+					{
+						w2->x += tomove * move2 * -dir[0];
+						w2->y += tomove * move2 * -dir[1];
+						w2->z += tomove * move2 * -dir[2];
+						s3dw_ani_add(w2);
+					} else {
+						w1->x += tomove * move1 *  dir[0];
+						w1->y += tomove * move1 *  dir[1];
+						w1->z += tomove * move1 *  dir[2];
+					}
 				}
 			}
 		if (arranged)

Modified: trunk/libs3dw/event.c
===================================================================
--- trunk/libs3dw/event.c	2006-06-27 16:54:56 UTC (rev 364)
+++ trunk/libs3dw/event.c	2006-06-27 17:32:46 UTC (rev 365)
@@ -24,8 +24,8 @@
 #include <s3d.h>
 #include <s3dw.h>
 #include <s3dw_int.h>
-int modkey;
-
+static int modkey;
+extern s3dw_widget *cam;
 void s3dw_handle_click(struct s3d_evt *evt)
 {
 	unsigned long oid=*((unsigned long *)evt->buf);
@@ -36,3 +36,18 @@
 	struct s3d_key_event *keys=(struct s3d_key_event *)evt->buf;
 	s3dw_widget_event_key(s3dw_getroot(),keys);
 }
+
+void s3dw_object_info(struct s3d_evt *evt)
+{
+	struct s3d_obj_info *info=(struct s3d_obj_info *)evt->buf;
+	if (info->object==0) /* the cam */
+	{
+		if (cam==NULL)	s3dw_getroot(); /* init, get cam */
+		cam->ax=cam->x=info->trans_x;
+		cam->ay=cam->y=info->trans_y;
+		cam->az=cam->z=info->trans_z;
+		cam->flags&=~S3DW_ARRANGED;
+		s3dw_arrange();
+		s3dw_turn();
+	}
+}

Modified: trunk/libs3dw/root.c
===================================================================
--- trunk/libs3dw/root.c	2006-06-27 16:54:56 UTC (rev 364)
+++ trunk/libs3dw/root.c	2006-06-27 17:32:46 UTC (rev 365)
@@ -25,7 +25,9 @@
 #include <s3dw.h>
 #include <s3dw_int.h>
 #include <stdlib.h> /* malloc() */
-static s3dw_widget *root;
+#include <stdio.h>   /* printf() */
+static s3dw_widget *root=NULL;
+extern s3dw_widget *cam;
 
 /* just destroy the widget */
 void s3dw_root_destroy(s3dw_widget *widget)
@@ -36,16 +38,15 @@
 void s3dw_nothing(s3dw_widget *widget)
 {
 }
-/* dummy handler */
-int s3dw_root_event_click(s3dw_widget *widget,unsigned long oid)
+int s3dw_click_nothing(s3dw_widget *widget, unsigned long dummy)
 {
 	return(0);
 }
-/* dummy handler */
-int s3dw_root_event_key(s3dw_widget *widget,struct s3d_key_event *keys)
+int s3dw_key_nothing(s3dw_widget *widget, struct s3d_key_event *dummy)
 {
 	return(0);
 }
+
 /* get the root .... if it's NULL, the lib is not initialized, so do this too ... */
 s3dw_widget *s3dw_getroot()
 {
@@ -57,8 +58,20 @@
 		root->oid=s3d_new_object();
 		root->style=&def_style;
 		root->flags=S3DW_VISIBLE|S3DW_ACTIVE;
+		cam=(s3dw_widget *)malloc(sizeof(s3dw_widget));
+		s3dw_widget_new(cam);
+		cam->type=S3DW_TCAM;
+		cam->oid=0;
+		cam->style=&def_style;
+		cam->s=10;
+		cam->width=1;
+		cam->height=0;
+		cam->flags=S3DW_VISIBLE|S3DW_ACTIVE;
+
+		s3dw_widget_append(root, cam);
 		/* setup callback tables */
 		s3dwcb_show[S3DW_TROOT]=		s3dw_nothing;
+		s3dwcb_show[S3DW_TCAM]=			s3dw_nothing;
 		s3dwcb_show[S3DW_TSURFACE]=		s3dw_surface_show;
 		s3dwcb_show[S3DW_TBUTTON]=		s3dw_button_show;
 		s3dwcb_show[S3DW_TLABEL]=		s3dw_label_show;
@@ -70,18 +83,21 @@
 		s3dwcb_hide[S3DW_TINPUT]=		s3dw_input_hide;
 		
 		s3dwcb_destroy[S3DW_TROOT]=		s3dw_root_destroy;
+		s3dwcb_destroy[S3DW_TCAM]=		s3dw_root_destroy;
 		s3dwcb_destroy[S3DW_TSURFACE]=	s3dw_surface_destroy;
 		s3dwcb_destroy[S3DW_TBUTTON]=	s3dw_button_destroy;
 		s3dwcb_destroy[S3DW_TLABEL]=	s3dw_label_destroy;
 		s3dwcb_destroy[S3DW_TINPUT]=	s3dw_input_destroy;
 
-		s3dwcb_click[S3DW_TROOT]=		s3dw_root_event_click;
+		s3dwcb_click[S3DW_TROOT]=		s3dw_click_nothing;
+		s3dwcb_click[S3DW_TCAM]=		s3dw_click_nothing;
 		s3dwcb_click[S3DW_TSURFACE]=	s3dw_surface_event_click;
 		s3dwcb_click[S3DW_TBUTTON]=		s3dw_button_event_click;
 		s3dwcb_click[S3DW_TLABEL]=		s3dw_label_event_click;
 		s3dwcb_click[S3DW_TINPUT]=		s3dw_input_event_click;
 
-		s3dwcb_key[S3DW_TROOT]=			s3dw_root_event_key;
+		s3dwcb_key[S3DW_TROOT]=			s3dw_key_nothing;
+		s3dwcb_key[S3DW_TCAM]=			s3dw_key_nothing;
 		s3dwcb_key[S3DW_TSURFACE]=		s3dw_surface_event_key;
 		s3dwcb_key[S3DW_TBUTTON]=		s3dw_button_event_key;
 		s3dwcb_key[S3DW_TLABEL]=		s3dw_label_event_key;

Modified: trunk/libs3dw/s3dw.h
===================================================================
--- trunk/libs3dw/s3dw.h	2006-06-27 16:54:56 UTC (rev 364)
+++ trunk/libs3dw/s3dw.h	2006-06-27 17:32:46 UTC (rev 365)
@@ -32,11 +32,16 @@
 #define		S3DW_ONSCREEN	256
 /* if the surface (or widget) is already properly arranged */
 #define 	S3DW_ARRANGED	512
+/* follow the camera */
+#define 	S3DW_FOLLOW_CAM	1024
+/* turn to the camera */
+#define 	S3DW_TURN_CAM	2048
 /* just a typecaster to beatify code. use it if you like */
 #define 	S3DWIDGET(x)	((s3dw_widget *)x)
 
 enum {
 	S3DW_TROOT,
+	S3DW_TCAM,
 	S3DW_TSURFACE,
 	S3DW_TBUTTON,
 	S3DW_TLABEL,
@@ -134,5 +139,6 @@
 
 void 				 s3dw_handle_click(struct s3d_evt *evt);
 void 				 s3dw_handle_key(struct s3d_evt *evt);
+void 				 s3dw_object_info(struct s3d_evt *evt);
 
 void 				 s3dw_ani_mate();

Modified: trunk/libs3dw/s3dw_int.h
===================================================================
--- trunk/libs3dw/s3dw_int.h	2006-06-27 16:54:56 UTC (rev 364)
+++ trunk/libs3dw/s3dw_int.h	2006-06-27 17:32:46 UTC (rev 365)
@@ -36,9 +36,9 @@
 /* root.c */
 s3dw_widget *s3dw_getroot();
 void s3dw_nothing(s3dw_widget *widget);
+int s3dw_click_nothing(s3dw_widget *widget, unsigned long dummy);
+int s3dw_key_nothing(s3dw_widget *widget, struct s3d_key_event *dummy);
 void s3dw_root_destroy(s3dw_widget *widget);
-int s3dw_root_event_click(s3dw_widget *widget, unsigned long oid);
-int s3dw_root_event_key(s3dw_widget *widget, struct s3d_key_event *keys);
 /* widget.c */
 s3dw_widget *s3dw_widget_new();
 void s3dw_widget_append(s3dw_widget *parent, s3dw_widget *widget);
@@ -95,3 +95,4 @@
 void s3dw_arrange();
 void s3dw_arr_widgetcenter(s3dw_widget *widget, float *center);
 void s3dw_arr_normdir(float *dir);
+void s3dw_turn();



From dotslash at berlios.de  Thu Jun 29 22:12:39 2006
From: dotslash at berlios.de (dotslash at BerliOS)
Date: Thu, 29 Jun 2006 22:12:39 +0200
Subject: [S3d-svn] r366 - in trunk: . libs3dw
Message-ID: <200606292012.k5TKCdUg029734@sheep.berlios.de>

Author: dotslash
Date: 2006-06-29 22:12:38 +0200 (Thu, 29 Jun 2006)
New Revision: 366

Modified:
   trunk/
   trunk/libs3dw/arrange.c
Log:
 r863 at balthasar:  dotslash | 2006-06-29 22:12:03 +0200
 - windows turning to teh user~



Property changes on: trunk
___________________________________________________________________
Name: svk:merge
   - bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:844
   + bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:863

Modified: trunk/libs3dw/arrange.c
===================================================================
--- trunk/libs3dw/arrange.c	2006-06-27 17:32:46 UTC (rev 365)
+++ trunk/libs3dw/arrange.c	2006-06-29 20:12:38 UTC (rev 366)
@@ -26,14 +26,29 @@
 #include <s3dw_int.h>
 #include <stdlib.h> /* rand(), RAND_MAX */
 #include <math.h>	/* M_PI */
+#define R2D		(180/M_PI)
 s3dw_widget *cam=NULL;
 
 void s3dw_arr_widgetcenter(s3dw_widget *widget, float *center)
 {
-	center[0]=widget->s*widget->width/2;
-	center[1]=widget->s*-widget->height/2+0.5;
-	center[2]=widget->s*0.5;
+	float x,y,z,xt,yt,zt;
+	x=widget->s*widget->width/2;
+	y=widget->s*-widget->height/2+0.5;
+	z=widget->s*0.5;
+	/* calc back rotation */
+	/* around the y axis (horizontal direction) */
+	xt= cos(widget->ry/R2D)*x + sin(widget->ry/R2D) *z;
+	yt=y;
+	zt=-sin(widget->ry/R2D)*x + cos(widget->ry/R2D) *z;
 	
+	/* around the x axis (vertical direction) */
+	x=xt;
+	y= cos(widget->rx/R2D)*yt + sin(widget->rx/R2D) *zt;
+	z=-sin(widget->rx/R2D)*yt + cos(widget->rx/R2D) *zt;
+	
+	center[0]=x;
+	center[1]=y;
+	center[2]=z;
 }
 void s3dw_arr_normdir(float *dir)
 {
@@ -49,31 +64,49 @@
 	dir[1]/=dirlen;
 	dir[2]/=dirlen;
 }
+int al=0;
 void s3dw_turn()
 {
 	s3dw_widget *w,*root=s3dw_getroot();
 	int i;
-	float a[3],b[3],ry,rz;
+	float a[3],b[3],rx,ry;
+	float op[3],np[3];
 	a[0]=0;
 	a[1]=0;
 	a[2]=1;
+	al++;
 	for (i=0;i<root->nobj;i++)
 	{
 		w=root->pobj[i];
 		if (w->oid!=0)
 		{
+			s3dw_arr_widgetcenter(w,op);
 			/* horizontal movement */
-			b[0]=w->x   - cam->x;
+			b[0]=w->x + op[0]  - cam->x;
 			b[1]=0;
-			b[2]=w->z   - cam->z;
+			b[2]=w->z + op[2]  - cam->z;
 			ry=180*s3d_vector_angle(a,b)/M_PI;
-			b[0]=w->x   - cam->x;
-			b[1]=0;
-			b[2]=w->z   - cam->z;
-			rz=180*s3d_vector_angle(a,b)/M_PI;
+			/* correct acos incompletness */
+			if (b[0]<0) ry=180-ry;
+			else 		ry=180+ry;
+			b[0]=0;
+			b[1]=w->y + op[1]   - cam->y;
+			b[2]=w->z + op[2]   - cam->z;
+			rx=180*s3d_vector_angle(a,b)/M_PI;
+			if (b[1]>0) rx=180-rx;
+			else 		rx=180+rx;
+			if ((rx>90) && (rx<=180)) 
+				rx=180 - rx;
+			else if ((rx>=180) && (rx<270))  rx=540 - rx ;
+
+			w->rx=rx;
 			w->ry=ry;
-			w->rz=rz;
-			s3dprintf(MED,"turn %03.3f, %03.3f",ry,rz);
+			s3dw_arr_widgetcenter(w,np);
+			w->x-=np[0] - op[0];
+			w->y-=np[1] - op[1];
+			w->z-=np[2] - op[2];
+
+			s3dw_ani_add(w);
 		}
 	}
 }



From dotslash at berlios.de  Thu Jun 29 23:03:58 2006
From: dotslash at berlios.de (dotslash at BerliOS)
Date: Thu, 29 Jun 2006 23:03:58 +0200
Subject: [S3d-svn] r367 - in trunk: . libs3dw
Message-ID: <200606292103.k5TL3wUW003258@sheep.berlios.de>

Author: dotslash
Date: 2006-06-29 23:03:58 +0200 (Thu, 29 Jun 2006)
New Revision: 367

Modified:
   trunk/
   trunk/libs3dw/animate.c
   trunk/libs3dw/arrange.c
   trunk/libs3dw/event.c
   trunk/libs3dw/s3dw_int.h
   trunk/libs3dw/surface.c
Log:
 r865 at balthasar:  dotslash | 2006-06-29 23:03:53 +0200
 - some improvements for smoother window movement ....



Property changes on: trunk
___________________________________________________________________
Name: svk:merge
   - bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:863
   + bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:865

Modified: trunk/libs3dw/animate.c
===================================================================
--- trunk/libs3dw/animate.c	2006-06-29 20:12:38 UTC (rev 366)
+++ trunk/libs3dw/animate.c	2006-06-29 21:03:58 UTC (rev 367)
@@ -30,6 +30,7 @@
 static s3dw_widget *ani_s[MAXANI];
 static int ani_n=0;
 static int animation_on=0;
+int ani_need_arr=0;
 
 /* is item f already on stack? */
 int s3dw_ani_onstack(s3dw_widget *f)
@@ -116,12 +117,23 @@
 		return(0);
 	return(1);
 }
+/* need an arrangement ... */
+void s3dw_ani_needarr()
+{
+	ani_need_arr=1;
+	if (!animation_on)	
+	{
+		while (ani_need_arr) s3dw_arrange();
+	}
+		
+}
 /* doing the whole animation thing */
 void s3dw_ani_mate()
 {
 	int i;
 	s3dw_widget *f;
 	animation_on=1;			/* animation is activated */
+	if (ani_need_arr) s3dw_arrange();
 	for (i=0;i<ani_n;i++)
 	{
 		f=ani_s[i];

Modified: trunk/libs3dw/arrange.c
===================================================================
--- trunk/libs3dw/arrange.c	2006-06-29 20:12:38 UTC (rev 366)
+++ trunk/libs3dw/arrange.c	2006-06-29 21:03:58 UTC (rev 367)
@@ -28,6 +28,7 @@
 #include <math.h>	/* M_PI */
 #define R2D		(180/M_PI)
 s3dw_widget *cam=NULL;
+extern int ani_need_arr;
 
 void s3dw_arr_widgetcenter(s3dw_widget *widget, float *center)
 {
@@ -113,13 +114,14 @@
 void s3dw_arrange()
 {
 	s3dw_widget *w1,*w2,*root=s3dw_getroot();
-	int i,j,arranged;
+	int i,j,arranged,allarr;
 	float len1,len2, dirlen;
 	float tomove, move1, move2;
 	float f1[3],f2[3],dir[3];
 
 	/* test if there is anything to arrange ... */
 	arranged=1;
+	ani_need_arr=0;
 	for (i=0;i<root->nobj;i++)
 		if (!(root->pobj[i]->flags&S3DW_ARRANGED)) arranged=0;
 	if (arranged) return; /* no arrangement necceasary .... */
@@ -131,6 +133,7 @@
 		w1->flags|=S3DW_ARRANGED; /* done */
 		return;
 	}
+	allarr=1;
 	for (i=0;i<root->nobj;i++)
 	{
 		w1=root->pobj[i];
@@ -149,6 +152,7 @@
 				dirlen=s3d_vector_length(dir);
 				if (dirlen<(len1+len2))
 				{
+					allarr=0;
 					arranged=0;
 					w1->flags&=~S3DW_ARRANGED;
 					w2->flags&=~S3DW_ARRANGED;
@@ -185,4 +189,6 @@
 		if (arranged)
 			w1->flags|=S3DW_ARRANGED;
 	}
+	if (allarr)	ani_need_arr=0;
+	s3dw_turn();
 }

Modified: trunk/libs3dw/event.c
===================================================================
--- trunk/libs3dw/event.c	2006-06-29 20:12:38 UTC (rev 366)
+++ trunk/libs3dw/event.c	2006-06-29 21:03:58 UTC (rev 367)
@@ -47,7 +47,6 @@
 		cam->ay=cam->y=info->trans_y;
 		cam->az=cam->z=info->trans_z;
 		cam->flags&=~S3DW_ARRANGED;
-		s3dw_arrange();
-		s3dw_turn();
+		s3dw_ani_needarr();
 	}
 }

Modified: trunk/libs3dw/s3dw_int.h
===================================================================
--- trunk/libs3dw/s3dw_int.h	2006-06-29 20:12:38 UTC (rev 366)
+++ trunk/libs3dw/s3dw_int.h	2006-06-29 21:03:58 UTC (rev 367)
@@ -90,6 +90,7 @@
 void s3dw_ani_doit(s3dw_widget *f);
 void s3dw_ani_finish(s3dw_widget *f, int i);
 void s3dw_ani_iterate(s3dw_widget *f);
+void s3dw_ani_needarr();
 int  s3dw_ani_check(s3dw_widget *f);
 /* arrange.c */
 void s3dw_arrange();

Modified: trunk/libs3dw/surface.c
===================================================================
--- trunk/libs3dw/surface.c	2006-06-29 20:12:38 UTC (rev 366)
+++ trunk/libs3dw/surface.c	2006-06-29 21:03:58 UTC (rev 367)
@@ -145,7 +145,7 @@
 	widget->z=-f1[2];
 	s3dw_widget_append(s3dw_getroot(),widget);
 	s3dw_surface_draw(widget);
-	s3dw_arrange();
+	s3dw_ani_needarr();
 	s3dw_ani_add(widget);
 	return(surface);
 }



From dotslash at berlios.de  Fri Jun 30 22:28:30 2006
From: dotslash at berlios.de (dotslash at BerliOS)
Date: Fri, 30 Jun 2006 22:28:30 +0200
Subject: [S3d-svn] r368 - in trunk: . libs3d
Message-ID: <200606302028.k5UKSUqb025853@sheep.berlios.de>

Author: dotslash
Date: 2006-06-30 22:28:30 +0200 (Fri, 30 Jun 2006)
New Revision: 368

Modified:
   trunk/
   trunk/libs3d/proto_in.c
Log:
 r867 at balthasar:  dotslash | 2006-06-30 22:28:22 +0200
 - process events sent before the init



Property changes on: trunk
___________________________________________________________________
Name: svk:merge
   - bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:865
   + bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:867

Modified: trunk/libs3d/proto_in.c
===================================================================
--- trunk/libs3d/proto_in.c	2006-06-29 21:03:58 UTC (rev 367)
+++ trunk/libs3d/proto_in.c	2006-06-30 20:28:30 UTC (rev 368)
@@ -40,6 +40,7 @@
 	{
 		case S3D_P_S_INIT:
 			s3dprintf(MED,"S3D_P_S_INIT: init!!");
+			s3d_process_stack();
 			cb_lock=0;
 			break;
 		case S3D_P_S_QUIT:



From dotslash at berlios.de  Fri Jun 30 23:27:59 2006
From: dotslash at berlios.de (dotslash at BerliOS)
Date: Fri, 30 Jun 2006 23:27:59 +0200
Subject: [S3d-svn] r369 - in trunk: . libs3d
Message-ID: <200606302127.k5ULRwbD031210@sheep.berlios.de>

Author: dotslash
Date: 2006-06-30 23:27:58 +0200 (Fri, 30 Jun 2006)
New Revision: 369

Modified:
   trunk/
   trunk/libs3d/event.c
   trunk/libs3d/io.c
   trunk/libs3d/object_queue.c
   trunk/libs3d/proto_in.c
Log:
 r869 at balthasar:  dotslash | 2006-06-30 23:16:16 +0200
 - some more recursion avoidance ...



Property changes on: trunk
___________________________________________________________________
Name: svk:merge
   - bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:867
   + bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:869

Modified: trunk/libs3d/event.c
===================================================================
--- trunk/libs3d/event.c	2006-06-30 20:28:30 UTC (rev 368)
+++ trunk/libs3d/event.c	2006-06-30 21:27:58 UTC (rev 369)
@@ -28,11 +28,13 @@
 #include <stdlib.h>		 /*  malloc(), free() */
 
 struct s3d_evt *s3d_stack;
-int cb_lock=0;	 /*  callback lock */
+int cb_lock=2;	 /*  callback lock */
 void s3d_push_event(struct s3d_evt *newevt)
 {
 	struct s3d_evt *p;
 	s3d_cb cb;
+
+	s3dprintf(MED,"pushed event %d",newevt->event);
 	 /*  this will always be called for S3D_EVENT_NEW_OBJECT!! */
 	if (newevt->event==S3D_EVENT_NEW_OBJECT)
 	{
@@ -47,8 +49,10 @@
 			cb_lock=1;		 /*  on our way! lock it.. */
 			cb(newevt);		 /*  .. and call it! */
 			if (cb_lock==2)  /*  there were other callbacks? we process: */
+			{
+				cb_lock=0;
 				s3d_process_stack();
-			cb_lock=0;
+			}
 			free(newevt);
 			return;
 		}
@@ -110,12 +114,20 @@
 	s3d_cb cb;
 	p=s3d_stack;
 	pre=NULL;
+	if (cb_lock!=0) /* can't do that now. */
+	{
+		cb_lock=2; /* request later processing */
+		return;
+	}
+	s3dprintf(LOW,"processing stack ...");
 	while (p!=NULL)
 	{
 		
 		if ((cb=s3d_get_callback(p->event))!=NULL)
 		{
+			cb_lock=1;
 			cb(p);
+			cb_lock=0;
 			if (pre!=NULL)   /*  there is a previous element */
 				pre->next=p->next;
 			else			 /*  it's the first element */

Modified: trunk/libs3d/io.c
===================================================================
--- trunk/libs3d/io.c	2006-06-30 20:28:30 UTC (rev 368)
+++ trunk/libs3d/io.c	2006-06-30 21:27:58 UTC (rev 369)
@@ -108,19 +108,7 @@
 	char 				*s;
 	char 				 urlc[256];		 /*  this should be enough for an url */
 	char 				 buf[258]; 		 /*  server buffer */
-/*	int 				 i;*/
-	 /*  null the callback table */
-/*	for (i=0;i<MAX_CB;i++)
-	{
-		s3d_cb_list[i]=NULL;
-	}*/
-	/* ignore some things ... */
-	/*
-	s3d_ignore_callback(S3D_EVENT_KEY);
-	s3d_ignore_callback(S3D_EVENT_OBJ_CLICK);
-	s3d_ignore_callback(S3D_EVENT_OBJ_INFO);
-	s3d_ignore_callback(S3D_EVENT_NEW_OBJECT);
-*/
+
 	if (NULL!=(s=getenv("S3D")))
 	{
 		s3dprintf(VLOW,"at least we have the enviroment variable ... %s",s);
@@ -193,6 +181,12 @@
 		if (f!=NULL)
 			f();
 		s3d_net_check();
+		if (cb_lock==2)  /*  there were other callbacks? we process: */
+		{
+			cb_lock=0;
+			s3d_process_stack();
+		}
+
 	}
 	return(0);
 }

Modified: trunk/libs3d/object_queue.c
===================================================================
--- trunk/libs3d/object_queue.c	2006-06-30 20:28:30 UTC (rev 368)
+++ trunk/libs3d/object_queue.c	2006-06-30 21:27:58 UTC (rev 369)
@@ -39,6 +39,7 @@
 static int requested;				 	/*  counter of how many addtional */
 									 	/*  objects have been requested */
 static struct timespec t={0,10*1000};	/* 10 micro seconds */
+extern int cb_lock;
 /*  initializes the object queue */
 int _queue_init()
 {
@@ -108,6 +109,8 @@
 			net_send(S3D_P_C_NEW_OBJ,NULL,0);
 			requested++;
 		}
+		if (!cb_lock)
+			cb_lock=1; /* please, no callbacks now. */
 		s3d_net_check();
 		nanosleep(&t,NULL); 
 	} while(j++<TIMEOUT);

Modified: trunk/libs3d/proto_in.c
===================================================================
--- trunk/libs3d/proto_in.c	2006-06-30 20:28:30 UTC (rev 368)
+++ trunk/libs3d/proto_in.c	2006-06-30 21:27:58 UTC (rev 369)
@@ -40,8 +40,8 @@
 	{
 		case S3D_P_S_INIT:
 			s3dprintf(MED,"S3D_P_S_INIT: init!!");
-			s3d_process_stack();
 			cb_lock=0;
+/*			s3d_process_stack();*/
 			break;
 		case S3D_P_S_QUIT:
 			s3dprintf(MED,"S3D_P_S_QUIT: server wants us to go. well ...");
@@ -65,13 +65,16 @@
 			if (length==4) 
 			{
 				oid=ntohl(*((uint32_t *)buf));
+				_queue_new_object(oid);	
+				/*
 				if (NULL!=(s3devt=malloc(sizeof(struct s3d_evt))))
 				{
-					*((uint32_t *)buf)=oid;  /*  reuse buffer ... */
+					*((uint32_t *)buf)=oid;  / *  reuse buffer ... * /
 					s3devt->event=S3D_EVENT_NEW_OBJECT;
 					s3devt->length=4;
 					s3devt->buf=buf;
-				}
+					_queue_new_object(*((unsigned int *)newevt->buf));	
+				}*/
 				s3dprintf(VLOW,"S3D_P_S_NEWOBJ: new object %d",oid);
 			}
 			break;



From dotslash at berlios.de  Fri Jun 30 23:28:01 2006
From: dotslash at berlios.de (dotslash at BerliOS)
Date: Fri, 30 Jun 2006 23:28:01 +0200
Subject: [S3d-svn] r370 - in trunk: . libs3d libs3dw
Message-ID: <200606302128.k5ULS1Wa031268@sheep.berlios.de>

Author: dotslash
Date: 2006-06-30 23:28:01 +0200 (Fri, 30 Jun 2006)
New Revision: 370

Modified:
   trunk/
   trunk/libs3d/event.c
   trunk/libs3dw/arrange.c
   trunk/libs3dw/surface.c
Log:
 r870 at balthasar:  dotslash | 2006-06-30 23:27:52 +0200
 - autofollow mode added



Property changes on: trunk
___________________________________________________________________
Name: svk:merge
   - bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:869
   + bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:870

Modified: trunk/libs3d/event.c
===================================================================
--- trunk/libs3d/event.c	2006-06-30 21:27:58 UTC (rev 369)
+++ trunk/libs3d/event.c	2006-06-30 21:28:01 UTC (rev 370)
@@ -34,7 +34,7 @@
 	struct s3d_evt *p;
 	s3d_cb cb;
 
-	s3dprintf(MED,"pushed event %d",newevt->event);
+	s3dprintf(VLOW,"pushed event %d",newevt->event);
 	 /*  this will always be called for S3D_EVENT_NEW_OBJECT!! */
 	if (newevt->event==S3D_EVENT_NEW_OBJECT)
 	{
@@ -119,7 +119,7 @@
 		cb_lock=2; /* request later processing */
 		return;
 	}
-	s3dprintf(LOW,"processing stack ...");
+	s3dprintf(VLOW,"processing stack ...");
 	while (p!=NULL)
 	{
 		

Modified: trunk/libs3dw/arrange.c
===================================================================
--- trunk/libs3dw/arrange.c	2006-06-30 21:27:58 UTC (rev 369)
+++ trunk/libs3dw/arrange.c	2006-06-30 21:28:01 UTC (rev 370)
@@ -65,7 +65,6 @@
 	dir[1]/=dirlen;
 	dir[2]/=dirlen;
 }
-int al=0;
 void s3dw_turn()
 {
 	s3dw_widget *w,*root=s3dw_getroot();
@@ -75,11 +74,10 @@
 	a[0]=0;
 	a[1]=0;
 	a[2]=1;
-	al++;
 	for (i=0;i<root->nobj;i++)
 	{
 		w=root->pobj[i];
-		if (w->oid!=0)
+		if ((w->oid!=0) && (w->flags&S3DW_TURN_CAM))
 		{
 			s3dw_arr_widgetcenter(w,op);
 			/* horizontal movement */
@@ -111,6 +109,40 @@
 		}
 	}
 }
+#define DIST	60.0
+void s3dw_follow()
+{
+	s3dw_widget *w,*root=s3dw_getroot();
+	int i;
+	float b[3];
+	float op[3];
+	float lsqr,l;
+	for (i=0;i<root->nobj;i++)
+	{
+		w=root->pobj[i];
+		if ((w->oid!=0) && (w->flags&S3DW_FOLLOW_CAM))
+				
+		{
+			s3dw_arr_widgetcenter(w,op);
+			/* horizontal movement */
+			b[0]=cam->x - (w->x + op[0]);
+			b[1]=cam->y - (w->y + op[1]);
+			b[2]=cam->z - (w->z + op[2]);
+			if ((lsqr=(b[0]*b[0] + b[1]*b[1] + b[2]*b[2])) > (DIST * DIST))
+			{
+				/* need to adjust ... */
+				l=sqrt(lsqr);
+				w->x+= b[0]-b[0]*DIST/l;
+				w->y+= b[1]-b[1]*DIST/l;
+				w->z+= b[2]-b[2]*DIST/l;
+				w->flags&=~S3DW_ARRANGED;
+				ani_need_arr=1;
+				s3dw_ani_add(w);
+				
+			}
+		}
+	}
+}
 void s3dw_arrange()
 {
 	s3dw_widget *w1,*w2,*root=s3dw_getroot();
@@ -121,12 +153,11 @@
 
 	/* test if there is anything to arrange ... */
 	arranged=1;
-	ani_need_arr=0;
 	for (i=0;i<root->nobj;i++)
 		if (!(root->pobj[i]->flags&S3DW_ARRANGED)) arranged=0;
-	if (arranged) return; /* no arrangement necceasary .... */
-/*	if (cam->flags|S3DW_*/
+	if (arranged && !ani_need_arr) return; /* no arrangement necceasary .... */
 		
+	ani_need_arr=0;
 	if (root->nobj==1)
 	{
 		w1=root->pobj[0];
@@ -191,4 +222,5 @@
 	}
 	if (allarr)	ani_need_arr=0;
 	s3dw_turn();
+	s3dw_follow();
 }

Modified: trunk/libs3dw/surface.c
===================================================================
--- trunk/libs3dw/surface.c	2006-06-30 21:27:58 UTC (rev 369)
+++ trunk/libs3dw/surface.c	2006-06-30 21:28:01 UTC (rev 370)
@@ -143,6 +143,7 @@
 	widget->x=-f1[0];
 	widget->y=-f1[1];
 	widget->z=-f1[2];
+	widget->flags|=S3DW_FOLLOW_CAM|S3DW_TURN_CAM;
 	s3dw_widget_append(s3dw_getroot(),widget);
 	s3dw_surface_draw(widget);
 	s3dw_ani_needarr();



From dotslash at berlios.de  Fri Jun 30 23:45:37 2006
From: dotslash at berlios.de (dotslash at BerliOS)
Date: Fri, 30 Jun 2006 23:45:37 +0200
Subject: [S3d-svn] r371 - in trunk: . apps/s3dfm example libs3dw
Message-ID: <200606302145.k5ULjbYe032588@sheep.berlios.de>

Author: dotslash
Date: 2006-06-30 23:45:36 +0200 (Fri, 30 Jun 2006)
New Revision: 371

Modified:
   trunk/
   trunk/apps/s3dfm/animation.c
   trunk/apps/s3dfm/fs.c
   trunk/apps/s3dfm/main.c
   trunk/example/widgets.c
   trunk/libs3dw/arrange.c
   trunk/libs3dw/event.c
   trunk/libs3dw/root.c
Log:
 r873 at balthasar:  dotslash | 2006-06-30 23:45:07 +0200
 - s3dfm widget fix ( extern symbol cam -> _s3dw_cam)



Property changes on: trunk
___________________________________________________________________
Name: svk:merge
   - bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:870
   + bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:873

Modified: trunk/apps/s3dfm/animation.c
===================================================================
--- trunk/apps/s3dfm/animation.c	2006-06-30 21:28:01 UTC (rev 370)
+++ trunk/apps/s3dfm/animation.c	2006-06-30 21:45:36 UTC (rev 371)
@@ -155,6 +155,7 @@
 {
 	int i;
 	t_item *f;
+	s3dw_ani_mate();
 	for (i=0;i<ani_n;i++)
 	{
 		f=ani_s[i];

Modified: trunk/apps/s3dfm/fs.c
===================================================================
--- trunk/apps/s3dfm/fs.c	2006-06-30 21:28:01 UTC (rev 370)
+++ trunk/apps/s3dfm/fs.c	2006-06-30 21:45:36 UTC (rev 371)
@@ -102,7 +102,7 @@
 	*dirs=	sdirs=	0;
 	*bytes=	sbytes=	0;
 
-	printf("start: %d files, %d dirs, %d bytes in %s\n",*files,*dirs,*bytes,source);
+/*	printf("start: %d files, %d dirs, %d bytes in %s\n",*files,*dirs,*bytes,source);*/
 	if (-1==stat(source,&s))
 		return;
 /*	printf("%s: %08x (%db)\n",source,s.st_mode,(int)s.st_size);*/
@@ -113,7 +113,7 @@
 		if (fl->n>0)
 			fs_fl_approx(fl,&sfiles,&sdirs,&sbytes);
 		fl_del(fl);
-		printf("%d files, %d dirs, %d bytes in %s\n",sfiles,sdirs,sbytes,source);
+/*		printf("%d files, %d dirs, %d bytes in %s\n",sfiles,sdirs,sbytes,source);*/
 
 		*files=		sfiles;
 		*bytes+=	sbytes;
@@ -122,7 +122,7 @@
 	} else 
 		*files=		1;
 	*bytes+=s.st_size;
-	printf("end: %d files, %d dirs, %d bytes in %s\n",*files,*dirs,*bytes,source);
+/*	printf("end: %d files, %d dirs, %d bytes in %s\n",*files,*dirs,*bytes,source);*/
 }
 /* approximate the heaviness of our source ...*/
 void fs_fl_approx(filelist *fl, int *files, int *dirs, int *bytes)

Modified: trunk/apps/s3dfm/main.c
===================================================================
--- trunk/apps/s3dfm/main.c	2006-06-30 21:28:01 UTC (rev 370)
+++ trunk/apps/s3dfm/main.c	2006-06-30 21:45:36 UTC (rev 371)
@@ -153,7 +153,7 @@
 		cam.dpy=inf->trans_y;
 		cam.dpz=inf->trans_z;
 	}
-
+	s3dw_object_info(hrmz);
 }
 void mainloop()
 {

Modified: trunk/example/widgets.c
===================================================================
--- trunk/example/widgets.c	2006-06-30 21:28:01 UTC (rev 370)
+++ trunk/example/widgets.c	2006-06-30 21:45:36 UTC (rev 371)
@@ -62,14 +62,17 @@
 	/* okay, that's a little bit insane ... ;) 
 	 * we create some little windows with the actual key pressed. */
 
-	miniwin=s3dw_surface_new("Key",6,6);
-	sprintf(string,"%c",key->unicode);
-	s3dw_label_new(miniwin,string,1,2);
-	button=s3dw_button_new(miniwin,"OK",2,4);
-	/* clicking on the button will exit ... */
-	button->onclick=key_button;
-	/* of couse, show it */
-	s3dw_show(S3DWIDGET(miniwin));
+	if (key->unicode!=0)
+	{
+		miniwin=s3dw_surface_new("Key",6,6);
+		sprintf(string,"%c",key->unicode);
+		s3dw_label_new(miniwin,string,1,2);
+		button=s3dw_button_new(miniwin,"OK",2,4);
+		/* clicking on the button will exit ... */
+		button->onclick=key_button;
+		/* of couse, show it */
+		s3dw_show(S3DWIDGET(miniwin));
+	}
 
 }
 

Modified: trunk/libs3dw/arrange.c
===================================================================
--- trunk/libs3dw/arrange.c	2006-06-30 21:28:01 UTC (rev 370)
+++ trunk/libs3dw/arrange.c	2006-06-30 21:45:36 UTC (rev 371)
@@ -27,7 +27,7 @@
 #include <stdlib.h> /* rand(), RAND_MAX */
 #include <math.h>	/* M_PI */
 #define R2D		(180/M_PI)
-s3dw_widget *cam=NULL;
+s3dw_widget *_s3dw_cam=NULL;
 extern int ani_need_arr;
 
 void s3dw_arr_widgetcenter(s3dw_widget *widget, float *center)
@@ -81,16 +81,16 @@
 		{
 			s3dw_arr_widgetcenter(w,op);
 			/* horizontal movement */
-			b[0]=w->x + op[0]  - cam->x;
+			b[0]=w->x + op[0]  - _s3dw_cam->x;
 			b[1]=0;
-			b[2]=w->z + op[2]  - cam->z;
+			b[2]=w->z + op[2]  - _s3dw_cam->z;
 			ry=180*s3d_vector_angle(a,b)/M_PI;
 			/* correct acos incompletness */
 			if (b[0]<0) ry=180-ry;
 			else 		ry=180+ry;
 			b[0]=0;
-			b[1]=w->y + op[1]   - cam->y;
-			b[2]=w->z + op[2]   - cam->z;
+			b[1]=w->y + op[1]   - _s3dw_cam->y;
+			b[2]=w->z + op[2]   - _s3dw_cam->z;
 			rx=180*s3d_vector_angle(a,b)/M_PI;
 			if (b[1]>0) rx=180-rx;
 			else 		rx=180+rx;
@@ -125,9 +125,9 @@
 		{
 			s3dw_arr_widgetcenter(w,op);
 			/* horizontal movement */
-			b[0]=cam->x - (w->x + op[0]);
-			b[1]=cam->y - (w->y + op[1]);
-			b[2]=cam->z - (w->z + op[2]);
+			b[0]=_s3dw_cam->x - (w->x + op[0]);
+			b[1]=_s3dw_cam->y - (w->y + op[1]);
+			b[2]=_s3dw_cam->z - (w->z + op[2]);
 			if ((lsqr=(b[0]*b[0] + b[1]*b[1] + b[2]*b[2])) > (DIST * DIST))
 			{
 				/* need to adjust ... */

Modified: trunk/libs3dw/event.c
===================================================================
--- trunk/libs3dw/event.c	2006-06-30 21:28:01 UTC (rev 370)
+++ trunk/libs3dw/event.c	2006-06-30 21:45:36 UTC (rev 371)
@@ -25,7 +25,7 @@
 #include <s3dw.h>
 #include <s3dw_int.h>
 static int modkey;
-extern s3dw_widget *cam;
+extern s3dw_widget *_s3dw_cam;
 void s3dw_handle_click(struct s3d_evt *evt)
 {
 	unsigned long oid=*((unsigned long *)evt->buf);
@@ -40,13 +40,13 @@
 void s3dw_object_info(struct s3d_evt *evt)
 {
 	struct s3d_obj_info *info=(struct s3d_obj_info *)evt->buf;
-	if (info->object==0) /* the cam */
+	if (info->object==0) /* the _s3dw_cam */
 	{
-		if (cam==NULL)	s3dw_getroot(); /* init, get cam */
-		cam->ax=cam->x=info->trans_x;
-		cam->ay=cam->y=info->trans_y;
-		cam->az=cam->z=info->trans_z;
-		cam->flags&=~S3DW_ARRANGED;
+		if (_s3dw_cam==NULL)	s3dw_getroot(); /* init, get _s3dw_cam */
+		_s3dw_cam->ax=_s3dw_cam->x=info->trans_x;
+		_s3dw_cam->ay=_s3dw_cam->y=info->trans_y;
+		_s3dw_cam->az=_s3dw_cam->z=info->trans_z;
+		_s3dw_cam->flags&=~S3DW_ARRANGED;
 		s3dw_ani_needarr();
 	}
 }

Modified: trunk/libs3dw/root.c
===================================================================
--- trunk/libs3dw/root.c	2006-06-30 21:28:01 UTC (rev 370)
+++ trunk/libs3dw/root.c	2006-06-30 21:45:36 UTC (rev 371)
@@ -27,7 +27,7 @@
 #include <stdlib.h> /* malloc() */
 #include <stdio.h>   /* printf() */
 static s3dw_widget *root=NULL;
-extern s3dw_widget *cam;
+extern s3dw_widget *_s3dw_cam;
 
 /* just destroy the widget */
 void s3dw_root_destroy(s3dw_widget *widget)
@@ -58,17 +58,17 @@
 		root->oid=s3d_new_object();
 		root->style=&def_style;
 		root->flags=S3DW_VISIBLE|S3DW_ACTIVE;
-		cam=(s3dw_widget *)malloc(sizeof(s3dw_widget));
-		s3dw_widget_new(cam);
-		cam->type=S3DW_TCAM;
-		cam->oid=0;
-		cam->style=&def_style;
-		cam->s=10;
-		cam->width=1;
-		cam->height=0;
-		cam->flags=S3DW_VISIBLE|S3DW_ACTIVE;
+		_s3dw_cam=(s3dw_widget *)malloc(sizeof(s3dw_widget));
+		s3dw_widget_new(_s3dw_cam);
+		_s3dw_cam->type=S3DW_TCAM;
+		_s3dw_cam->oid=0;
+		_s3dw_cam->style=&def_style;
+		_s3dw_cam->s=10;
+		_s3dw_cam->width=1;
+		_s3dw_cam->height=0;
+		_s3dw_cam->flags=S3DW_VISIBLE|S3DW_ACTIVE;
 
-		s3dw_widget_append(root, cam);
+		s3dw_widget_append(root, _s3dw_cam);
 		/* setup callback tables */
 		s3dwcb_show[S3DW_TROOT]=		s3dw_nothing;
 		s3dwcb_show[S3DW_TCAM]=			s3dw_nothing;



