<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [S3d-svn] r446 - in trunk: . apps/dot_mcp apps/olsrs3d apps/s3dfm	libs3d libs3dw server
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/s3d-svn/2006-October/index.html" >
   <LINK REL="made" HREF="mailto:s3d-svn%40lists.berlios.de?Subject=Re%3A%20%5BS3d-svn%5D%20r446%20-%20in%20trunk%3A%20.%20apps/dot_mcp%20apps/olsrs3d%20apps/s3dfm%0A%09libs3d%20libs3dw%20server&In-Reply-To=%3C200610151814.k9FIEobo027871%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000438.html">
   <LINK REL="Next"  HREF="000440.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[S3d-svn] r446 - in trunk: . apps/dot_mcp apps/olsrs3d apps/s3dfm	libs3d libs3dw server</H1>
    <B>dotslash at BerliOS</B> 
    <A HREF="mailto:s3d-svn%40lists.berlios.de?Subject=Re%3A%20%5BS3d-svn%5D%20r446%20-%20in%20trunk%3A%20.%20apps/dot_mcp%20apps/olsrs3d%20apps/s3dfm%0A%09libs3d%20libs3dw%20server&In-Reply-To=%3C200610151814.k9FIEobo027871%40sheep.berlios.de%3E"
       TITLE="[S3d-svn] r446 - in trunk: . apps/dot_mcp apps/olsrs3d apps/s3dfm	libs3d libs3dw server">dotslash at mail.berlios.de
       </A><BR>
    <I>Sun Oct 15 20:14:50 CEST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="000438.html">[S3d-svn] r445 - in trunk: . apps/s3dfm
</A></li>
        <LI>Next message: <A HREF="000440.html">[S3d-svn] r447 - in trunk: . swig
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#439">[ date ]</a>
              <a href="thread.html#439">[ thread ]</a>
              <a href="subject.html#439">[ subject ]</a>
              <a href="author.html#439">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: dotslash
Date: 2006-10-15 20:14:48 +0200 (Sun, 15 Oct 2006)
New Revision: 446

Modified:
   trunk/
   trunk/INSTALL
   trunk/TODO
   trunk/apps/dot_mcp/main.c
   trunk/apps/olsrs3d/main.c
   trunk/apps/s3dfm/box.c
   trunk/apps/s3dfm/event.c
   trunk/apps/s3dfm/icon.c
   trunk/apps/s3dfm/s3dfm.h
   trunk/configure.ac
   trunk/libs3d/callback.c
   trunk/libs3d/event.c
   trunk/libs3d/freetype.c
   trunk/libs3d/modelread.c
   trunk/libs3d/network.c
   trunk/libs3d/proto_in.c
   trunk/libs3d/proto_out.c
   trunk/libs3d/s3d.h
   trunk/libs3d/s3dlib.h
   trunk/libs3d/shm.c
   trunk/libs3d/tcp.c
   trunk/libs3dw/button.c
   trunk/libs3dw/event.c
   trunk/libs3dw/input.c
   trunk/libs3dw/label.c
   trunk/libs3dw/root.c
   trunk/libs3dw/s3dw.h
   trunk/libs3dw/s3dw_int.h
   trunk/libs3dw/surface.c
   trunk/libs3dw/widget.c
   trunk/server/Makefile.am
   trunk/server/global.h
   trunk/server/mcp.c
   trunk/server/object.c
   trunk/server/shm_ringbuf.c
   trunk/server/user.c
   trunk/server/user_glut.c
Log:
 <A HREF="https://lists.berlios.de/mailman/listinfo/s3d-svn">r1084 at kero</A>:  dotslash | 2006-10-15 20:12:22 +0200
 - &quot;port&quot; to amd64 (proper types from stdint.h)



Property changes on: trunk
___________________________________________________________________
Name: svk:merge
   - bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:1080
   + bf2c72c7-850b-0410-b9e4-c1fddb578f10:/s3d-trunk:1084

Modified: trunk/INSTALL
===================================================================
--- trunk/INSTALL	2006-10-01 20:09:26 UTC (rev 445)
+++ trunk/INSTALL	2006-10-15 18:14:48 UTC (rev 446)
@@ -29,7 +29,7 @@
 
 * automake 1.9 (1.4 is too old!)
 * autoconf 2.59 
-* libtool
+* libtool 1.5
 
 are available and installed into a directory listed in the $PATH
 environment variable.

Modified: trunk/TODO
===================================================================
--- trunk/TODO	2006-10-01 20:09:26 UTC (rev 445)
+++ trunk/TODO	2006-10-15 18:14:48 UTC (rev 446)
@@ -6,8 +6,9 @@
 	* OBJECTPATH for finding the object?
 	* ./configure: line 23422: HAVE_PTHREAD: command not found &lt; huh?
 	* ./configure: line 22373: MDL_HAVE_OPENGL: command not found
-
-	* Apple todo: won't find -lX11 (for s3d_x11gate) while compiling
+	* Build the documentation (to html at least) if the user has
+	  docbook stuff installed.
+	* hand down DEBUG-flag to libg3d if available
 	* &quot;-Wall -pedantic&quot; default in CFLAGS? (if possible)
 	* --enable-debug not honored when CFLAGS is set?
 	* We should perhaps check for the correct versions of
@@ -15,7 +16,4 @@
 	  At the time of writing, supported are:
 	   automake 1.9, autoconf 2.59, libtool 1.5
 	* verify the autogenerated s3drc.
-Documentation:
-	* Build the documentation (to html at least) if the user has
-	  docbook stuff installed.
-
+	* Apple todo: won't find -lX11 (for s3d_x11gate) while compiling

Modified: trunk/apps/dot_mcp/main.c
===================================================================
--- trunk/apps/dot_mcp/main.c	2006-10-01 20:09:26 UTC (rev 445)
+++ trunk/apps/dot_mcp/main.c	2006-10-15 18:14:48 UTC (rev 446)
@@ -25,6 +25,7 @@
 #include &lt;s3d.h&gt;
 #include &lt;s3d_keysym.h&gt;
 #include &quot;dot_mcp.h&quot;
+#include &lt;stdint.h&gt;	 /*  uint32_t */
 #include &lt;unistd.h&gt;  /*  sleep() */
 #include &lt;stdlib.h&gt;  /*  free(), malloc() */
 #include &lt;string.h&gt;  /*  strncpy() */
@@ -76,7 +77,7 @@
 	float ia,ja,iap,jap;
 	float v[SIDES*RINGS*3];
 	float n[SIDES*12]; /* normals */
-	unsigned long l[SIDES*RINGS*6];
+	uint32_t l[SIDES*RINGS*6];
 	o=s3d_new_object();
 	R=100; /* outer radius */
 	r=100; /* inner radius */

Modified: trunk/apps/olsrs3d/main.c
===================================================================
--- trunk/apps/olsrs3d/main.c	2006-10-01 20:09:26 UTC (rev 445)
+++ trunk/apps/olsrs3d/main.c	2006-10-15 18:14:48 UTC (rev 446)
@@ -35,6 +35,7 @@
 #include &lt;math.h&gt;		 /* sqrt() */
 #include &lt;getopt.h&gt;		 /* getopt() */
 #include &lt;stdlib.h&gt;		 /* exit() */
+#include &lt;stdint.h&gt;		 /* uintXX_t */
 #include &quot;olsrs3d.h&quot;
 #include &quot;search.h&quot;
 
@@ -905,7 +906,7 @@
 		return;
 	}*/
 
-	oid=(int)*((unsigned long *)evt-&gt;buf);
+	oid=(int)*((uint32_t *)evt-&gt;buf);
 
 
 	if ( ( get_search_status() != FOLLOW ) &amp;&amp; ( Last_Click_Oid == oid ) &amp;&amp; ( Last_Click_Time + 250 &gt; get_time() ) ) {

Modified: trunk/apps/s3dfm/box.c
===================================================================
--- trunk/apps/s3dfm/box.c	2006-10-01 20:09:26 UTC (rev 445)
+++ trunk/apps/s3dfm/box.c	2006-10-15 18:14:48 UTC (rev 446)
@@ -133,7 +133,7 @@
 			  0.6, BHH    , 1.0,
 			  0.6, BHH-0.2, 1.0
 			 };
-	unsigned long bar_poly[]={
+	uint32_t bar_poly[]={
 		4,5,6,0,
 		4,6,7,0,
 		3,7,4,0,
@@ -197,7 +197,7 @@
 						0.5,0.3,0.3
 					);
 	s3d_push_vertices(dir-&gt;objs.close,xvertices,sizeof(xvertices)/(3*sizeof(float)));
-	s3d_push_polygons(dir-&gt;objs.close,bar_poly,sizeof(bar_poly)/(sizeof(unsigned long)*4));
+	s3d_push_polygons(dir-&gt;objs.close,bar_poly,sizeof(bar_poly)/(sizeof(uint32_t)*4));
 	s3d_link(dir-&gt;objs.close,dir-&gt;oid);
 	
 	dir-&gt;objs.select=s3d_new_object();
@@ -207,7 +207,7 @@
 						0.1,0.1,0.3
 					);
 	s3d_push_vertices(dir-&gt;objs.select,svertices,sizeof(svertices)/(3*sizeof(float)));
-	s3d_push_polygons(dir-&gt;objs.select,bar_poly,sizeof(bar_poly)/(sizeof(unsigned long)*4));
+	s3d_push_polygons(dir-&gt;objs.select,bar_poly,sizeof(bar_poly)/(sizeof(uint32_t)*4));
 	s3d_link(dir-&gt;objs.select,dir-&gt;oid);
 	
 	/* draw the title string */
@@ -219,7 +219,7 @@
 						0.3,0.3,0.3
 					);
 	s3d_push_vertices(dir-&gt;objs.title,tvertices,sizeof(tvertices)/(3*sizeof(float)));
-	s3d_push_polygons(dir-&gt;objs.title,bar_poly,sizeof(bar_poly)/(sizeof(unsigned long)*4));
+	s3d_push_polygons(dir-&gt;objs.title,bar_poly,sizeof(bar_poly)/(sizeof(uint32_t)*4));
 	s3d_link(dir-&gt;objs.title,dir-&gt;oid);
 	dir-&gt;objs.titlestr=s3d_draw_string(dots_at_start(fullname,30,dir),&amp;len);
 	if (len&gt;(1.6*5.0))		s3d_scale(dir-&gt;objs.titlestr,1.6/len);

Modified: trunk/apps/s3dfm/event.c
===================================================================
--- trunk/apps/s3dfm/event.c	2006-10-01 20:09:26 UTC (rev 445)
+++ trunk/apps/s3dfm/event.c	2006-10-15 18:14:48 UTC (rev 446)
@@ -124,7 +124,7 @@
 	int oid;
 	t_node *f;
 	s3dw_handle_click(evt);
-	oid=(int)*((unsigned long *)evt-&gt;buf);
+	oid=(int)*((u_int32_t *)evt-&gt;buf);
 	if (NULL!=(f=node_getbyoid(&amp;root,oid)))
 	{
 		if (f-&gt;objs.close==oid)

Modified: trunk/apps/s3dfm/icon.c
===================================================================
--- trunk/apps/s3dfm/icon.c	2006-10-01 20:09:26 UTC (rev 445)
+++ trunk/apps/s3dfm/icon.c	2006-10-15 18:14:48 UTC (rev 446)
@@ -60,7 +60,7 @@
 						-1, 0.5,-1,
 						 1, 0.5,-1,
 						 1,-0.5,-1};
-	unsigned long polys[]={
+	uint32_t polys[]={
 				1,3,0,0,				2,3,1,0,
 				5,6,2,0,				1,5,2,0,
 				2,6,7,0,				2,7,3,0,

Modified: trunk/apps/s3dfm/s3dfm.h
===================================================================
--- trunk/apps/s3dfm/s3dfm.h	2006-10-01 20:09:26 UTC (rev 445)
+++ trunk/apps/s3dfm/s3dfm.h	2006-10-15 18:14:48 UTC (rev 446)
@@ -24,6 +24,7 @@
 
 #include &lt;s3d.h&gt;
 #include &lt;s3dw.h&gt;
+#include &lt;stdlib.h&gt;		/* uintXX_t */
 #define T_DUNO		0
 #define T_FOLDER	1
 #define T_TYPENUM	2

Modified: trunk/configure.ac
===================================================================
--- trunk/configure.ac	2006-10-01 20:09:26 UTC (rev 445)
+++ trunk/configure.ac	2006-10-15 18:14:48 UTC (rev 446)
@@ -44,7 +44,7 @@
 AC_CHECK_FUNCS([select socket strerror strtod strtol shmget signal]) # XXX: the previous test should have established the existence of signal() already. just be safe here.
 
 WARNS=&quot;&quot;
-CFLAGS=&quot;$CFLAGS $X_CFLAGS&quot;
+CFLAGS=&quot;$CFLAGS $X_CFLAGS -Wall -pedantic&quot;
 LIBS=&quot;$X_PRE_LIBS $X_LIBS $X_EXTRA_LIBS $LIBS&quot;
 
 ###
@@ -55,7 +55,7 @@
 # XXX: switch default and help string for releases.
 AC_ARG_ENABLE([devel], AS_HELP_STRING([--disable-debug],[Disables debugging flags]), [enable_debug=$enableval], [enable_debug=yes])
 if test x$enable_debug = xyes; then
-	DEVEL_CFLAGS=&quot;$DEVEL_CFLAGS -Wall -pedantic -ansi -ggdb&quot;
+	DEVEL_CFLAGS=&quot;$DEVEL_CFLAGS -ggdb -DDEBUG=LOW&quot;
 	DEVEL_LDFLAGS=&quot;$DEVEL_LDFLAGS -ggdb&quot;
 fi
 
@@ -65,8 +65,10 @@
 	DEVEL_LDFLAGS=&quot;$DEVEL_LDFLAGS -pg&quot;
 fi
 
-AC_SUBST(DEVEL_CFLAGS)
-AC_SUBST(DEVEL_LDFLAGS)
+CFLAGS=&quot;$CFLAGS $DEVEL_CFLAGS&quot;
+LDFLAGS=&quot;$LDFLAGS $DEVEL_LDFLAGS&quot;
+dnl AC_SUBST(DEVEL_CFLAGS)
+dnl AC_SUBST(DEVEL_LDFLAGS)
 dnl ##################################### SERVER #######################################
 AC_CHECK_LIBM
 AC_SUBST(LIBM)

Modified: trunk/libs3d/callback.c
===================================================================
--- trunk/libs3d/callback.c	2006-10-01 20:09:26 UTC (rev 445)
+++ trunk/libs3d/callback.c	2006-10-15 18:14:48 UTC (rev 446)
@@ -55,22 +55,22 @@
 	/* do plain nothing */
 }
 /*  sets a callback */
-void s3d_set_callback(unsigned char event, s3d_cb func)
+void s3d_set_callback(uint8_t event, s3d_cb func)
 {
 	s3d_cb_list[(int)event]=func;
 	s3d_process_stack();
 }
 /*  clears a callback, same as s3d_set_callback(event, (s3d_cb) NULL); */
-void s3d_clear_callback(unsigned char event)
+void s3d_clear_callback(uint8_t event)
 {
 	s3d_cb_list[(int)event]=NULL;
 }
 /* ignores an event ... */
-void s3d_ignore_callback(unsigned char event)
+void s3d_ignore_callback(uint8_t event)
 {
 	s3d_set_callback(event,_s3d_ignore);
 }
-s3d_cb s3d_get_callback(unsigned char event)
+s3d_cb s3d_get_callback(uint8_t event)
 {
 	return(s3d_cb_list[(int)event]);
 }

Modified: trunk/libs3d/event.c
===================================================================
--- trunk/libs3d/event.c	2006-10-01 20:09:26 UTC (rev 445)
+++ trunk/libs3d/event.c	2006-10-15 18:14:48 UTC (rev 446)
@@ -72,7 +72,7 @@
 		s3d_stack=s3d_stack-&gt;next;
 	return ret;
 }
-struct s3d_evt *s3d_find_event(unsigned char event)
+struct s3d_evt *s3d_find_event(u_int8_t event)
 {
 	struct s3d_evt *p;
 	p=s3d_stack;

Modified: trunk/libs3d/freetype.c
===================================================================
--- trunk/libs3d/freetype.c	2006-10-01 20:09:26 UTC (rev 445)
+++ trunk/libs3d/freetype.c	2006-10-15 18:14:48 UTC (rev 446)
@@ -87,7 +87,7 @@
 		return(-1);
 	}
 	face_init=0;
-	error= FT_New_Memory_Face(library,(unsigned char *)memory_font,memory_font_size,0,&amp;face);
+	error= FT_New_Memory_Face(library,(uint8_t *)memory_font,memory_font_size,0,&amp;face);
 	if (error)
 	{
 		errds(VHIGH,&quot;s3d_ft_load_font():FT_New_Memory_Face&quot;,&quot;can't load font : (%d) %s&quot;,ft_errors[error].err_code,ft_errors[error].err_msg);
@@ -119,7 +119,7 @@
 
 /* renders a character with seidels algorithm and stores it in the tess_buf for later
  * usage */
-int _s3d_add_tessbuf(unsigned short a)
+int _s3d_add_tessbuf(uint16_t a)
 {
 	float norm,ar,xa,ya;
 	int i,j,k,c,n,start,outl,s,e;
@@ -255,7 +255,7 @@
 			ncntr[c]=cntr[perm[c]];
 		}
 		n=0;
-		tess_buf[a].pbuf=malloc(sizeof(unsigned long)*4*(face-&gt;glyph-&gt;outline.n_points+2*face-&gt;glyph-&gt;outline.n_contours)); 
+		tess_buf[a].pbuf=malloc(sizeof(uint32_t)*4*(face-&gt;glyph-&gt;outline.n_points+2*face-&gt;glyph-&gt;outline.n_contours)); 
 		k=0;
 		for (c=ncontours-1;c&gt;=0;c--)
 		{
@@ -281,17 +281,17 @@
 	return(0);
 }
 
-int _s3d_draw_tessbuf(int oid,unsigned short a,int *voff, float *xoff)
+int _s3d_draw_tessbuf(int oid,uint16_t a,int *voff, float *xoff)
 {
 	float *vbuf;
-	unsigned long *pbuf;
+	uint32_t *pbuf;
 	int i;
 	if (!(tess_buf[a].vbuf &amp;&amp; tess_buf[a].pbuf))
 		_s3d_add_tessbuf(a);
 	vbuf=malloc(sizeof(float)*3*tess_buf[a].vn);
-	pbuf=malloc(sizeof(unsigned long)*4*tess_buf[a].pn);
+	pbuf=malloc(sizeof(uint32_t)*4*tess_buf[a].pn);
 	memcpy(vbuf,tess_buf[a].vbuf,sizeof(float)*3*tess_buf[a].vn);
-	memcpy(pbuf,tess_buf[a].pbuf,sizeof(unsigned long)*4*tess_buf[a].pn);
+	memcpy(pbuf,tess_buf[a].pbuf,sizeof(uint32_t)*4*tess_buf[a].pn);
 	 /*  prepare the buffs ... */
 /* 	s3dprintf(LOW,&quot;drawing [%c] (%d vertices, %d polys&quot;,a,tess_buf[a].vn,tess_buf[a].pn); */
 	for (i=0;i&lt;tess_buf[a].vn;i++)
@@ -383,7 +383,7 @@
 	voff=0; 
 	len=strlen(str);
 	for (i=0;i&lt;len; i++)
-		_s3d_draw_tessbuf(f_oid,(unsigned char )str[i],&amp;voff,&amp;xoff);
+		_s3d_draw_tessbuf(f_oid,(uint8_t )str[i],&amp;voff,&amp;xoff);
 	 /*  s3d_ft_quit(); */
 	if (xlen!=NULL) *xlen=xoff;
 	return(f_oid);

Modified: trunk/libs3d/modelread.c
===================================================================
--- trunk/libs3d/modelread.c	2006-10-01 20:09:26 UTC (rev 445)
+++ trunk/libs3d/modelread.c	2006-10-15 18:14:48 UTC (rev 446)
@@ -128,10 +128,10 @@
 	struct material2texture *mat2tex;
 	int						 i, j, k, material_count, texture_count, voff,obj_id;
 #define 					PMAX	100
-	unsigned long 			 polybuf[PMAX * 4],npoly,oldflags;
+	uint32_t 			 polybuf[PMAX * 4],npoly,oldflags;
 	float					 normalbuf[PMAX * 9],texcoordbuf[PMAX * 6];
 	float 					 swaph;				/* swap helper */
-	unsigned char 			*s3d_pixeldata = NULL;
+	uint8_t 			*s3d_pixeldata = NULL;
 
 	context = g3d_context_new();
 	obj_id=-1;
@@ -181,7 +181,7 @@
 						/* reorder pixeldata - s3d wants rgba */
 						if ( s3d_pixeldata != NULL ) free( s3d_pixeldata );
 
-						s3d_pixeldata = malloc( sizeof( unsigned char ) * face-&gt;tex_image-&gt;width * face-&gt;tex_image-&gt;height * 32 );
+						s3d_pixeldata = malloc( sizeof( uint8_t ) * face-&gt;tex_image-&gt;width * face-&gt;tex_image-&gt;height * 32 );
 
 						if ( s3d_pixeldata == NULL ) {
 							errs(&quot;model_load()&quot;, &quot;Sorry - you ran out of memory !\n&quot; );

Modified: trunk/libs3d/network.c
===================================================================
--- trunk/libs3d/network.c	2006-10-01 20:09:26 UTC (rev 445)
+++ trunk/libs3d/network.c	2006-10-15 18:14:48 UTC (rev 446)
@@ -37,14 +37,14 @@
 static int _s3d_net_receive();
 #endif
 
-int net_send(unsigned char opcode, char *buf, unsigned short length)
+int net_send(u_int8_t opcode, char *buf, u_int16_t length)
 {
 	char *ptr;
 /* 	char *buff; */
-	char buff[65539];  /*  unsigned short really shouldn't be bigger ;) */
+	char buff[65539];  /*  u_int16_t really shouldn't be bigger ;) */
 	*(buff)=opcode; 
 	ptr=buff+1;
-	*((unsigned short *) ptr)=htons(length);
+	*((u_int16_t *) ptr)=htons(length);
 	if (length!=0)
 		memcpy(buff+3,buf,length);
 	switch (con_type)

Modified: trunk/libs3d/proto_in.c
===================================================================
--- trunk/libs3d/proto_in.c	2006-10-01 20:09:26 UTC (rev 445)
+++ trunk/libs3d/proto_in.c	2006-10-15 18:14:48 UTC (rev 446)
@@ -111,10 +111,10 @@
 		case S3D_P_MCP_OBJECT:
 			if (length==sizeof(struct mcp_object))
 			{
-/* 				oid=htonl(*((unsigned long *)buf)); */
+/* 				oid=htonl(*((uint32_t *)buf)); */
 				if (NULL!=(s3devt=malloc(sizeof(struct s3d_evt))))
 				{
-/* 					*((unsigned long *)buf)=oid;  / *  reuse buffer ... * / */
+/* 					*((uint32_t *)buf)=oid;  / *  reuse buffer ... * / */
 					s3devt-&gt;event=S3D_MCP_OBJECT;
 					s3devt-&gt;length=length;
 					mo=(struct mcp_object *)buf;
@@ -131,10 +131,10 @@
 		case S3D_P_S_OINFO:
 			if (length==sizeof(struct s3d_obj_info))
 			{
-/* 				oid=htonl(*((unsigned long *)buf)); */
+/* 				oid=htonl(*((uint32_t *)buf)); */
 				if (NULL!=(s3devt=malloc(sizeof(struct s3d_evt))))
 				{
-/* 					*((unsigned long *)buf)=oid;  / *  reuse buffer ... * / */
+/* 					*((uint32_t *)buf)=oid;  / *  reuse buffer ... * / */
 					s3devt-&gt;event=S3D_EVENT_OBJ_INFO;
 					s3devt-&gt;length=length;
 					oi=(struct s3d_obj_info *)buf;

Modified: trunk/libs3d/proto_out.c
===================================================================
--- trunk/libs3d/proto_out.c	2006-10-01 20:09:26 UTC (rev 445)
+++ trunk/libs3d/proto_out.c	2006-10-15 18:14:48 UTC (rev 446)
@@ -31,7 +31,7 @@
 #include &lt;unistd.h&gt;		 /*  select() */
 #include &lt;stdlib.h&gt;		 /*  getenv(),atoi(), malloc() */
 #ifdef WIN32
-	#define uint32_t unsigned long  /*  sohn */
+	#define uint32_t uint32_t  /*  sohn */
 #else
 	#include &lt;netdb.h&gt;		 /*  gethostbyname()  */
 #endif
@@ -104,7 +104,7 @@
 }
 /*  like vertex add, but you can add a lot of vertices with this. */
 /*  it's to be used for file readers or fast coders :) */
-int s3d_push_vertices(int object, float *vbuf, unsigned short n)
+int s3d_push_vertices(int object, float *vbuf, uint16_t n)
 {
 	char				buf[MF_LEN+4],*ptr;
 	int					f,i,len=n*4*3;
@@ -189,7 +189,7 @@
 	return(0);  /*  nothing yet */
 }
 /*  push a material array (with alpha information!) */
-int s3d_push_materials_a(int object, float *mbuf, unsigned short n)
+int s3d_push_materials_a(int object, float *mbuf, uint16_t n)
 {
 	char				buf[MF_LEN+4],*ptr;
 	int					f,i,len=n*4*12;
@@ -213,7 +213,7 @@
 /* 	free(buf); */
 	return(0);
 }
-int s3d_push_polygon(int object, unsigned long v1, unsigned long v2, unsigned long v3, unsigned long material)
+int s3d_push_polygon(int object, uint32_t v1, uint32_t v2, uint32_t v3, uint32_t material)
 {
 	char				buf[4+4*4],*ptr;
 	int					len=4+4*4;
@@ -227,7 +227,7 @@
 	net_send(S3D_P_C_PUSH_POLY,buf,len);
 	return(0);
 }
-int s3d_push_line(int object, unsigned long v1, unsigned long v2, unsigned long material)
+int s3d_push_line(int object, uint32_t v1, uint32_t v2, uint32_t material)
 {
 	char				buf[4+3*4],*ptr;
 	int					len=4+3*4;
@@ -243,10 +243,10 @@
 
 /*  this is the polygon array version */
 /*  assumes to have a list of polys which consists of v1,v2,v3,material */
-int s3d_push_polygons(int object, unsigned long *pbuf, unsigned short n)
+int s3d_push_polygons(int object, uint32_t *pbuf, uint16_t n)
 {
-	unsigned long		buf[(MF_LEN+4)/4];
-	unsigned long		*s,*d;
+	uint32_t		buf[(MF_LEN+4)/4];
+	uint32_t		*s,*d;
 	int					f,i,j,len=n*4*4;
 	int					flen,stepl;
 	if (n&lt;1)
@@ -268,10 +268,10 @@
 	}
 	return(0);
 }
-int s3d_push_lines(int object, unsigned long *lbuf, unsigned short n)
+int s3d_push_lines(int object, uint32_t *lbuf, uint16_t n)
 {
-	unsigned long		buf[(MF_LEN+4)/4];
-	unsigned long		*s,*d;
+	uint32_t		buf[(MF_LEN+4)/4];
+	uint32_t		*s,*d;
 	int					f,i,j,len=n*4*3;
 	int					flen,stepl;
 	if (n&lt;1)
@@ -295,7 +295,7 @@
 	}
 	return(0);
 }
-int s3d_push_texture(int object, unsigned short w, unsigned short h)
+int s3d_push_texture(int object, uint16_t w, uint16_t h)
 {
 	char				buf[4+2*2],*ptr;
 	int					len=4+2*2;
@@ -307,10 +307,10 @@
 	net_send(S3D_P_C_PUSH_TEX,buf,len);
 	return(0);
 }
-int s3d_push_textures(int object, unsigned short *tbuf, unsigned short n)
+int s3d_push_textures(int object, uint16_t *tbuf, uint16_t n)
 {
-	unsigned short		buf[(MF_LEN+4)/2];
-	unsigned short		*s,*d;
+	uint16_t		buf[(MF_LEN+4)/2];
+	uint16_t		*s,*d;
 
 	int					f,i,j,len=n*2*2;
 	int					flen,stepl;
@@ -319,7 +319,7 @@
 	stepl=((int)((MF_LEN-4)/(2*2)))*(2*2);
 	f=len/(MF_LEN-4)+1;  /*  how many fragments? */
 
-	*((unsigned long *)buf)=htonl(object);
+	*((uint32_t *)buf)=htonl(object);
 	d=buf+2;
 
 	for (i=0;i&lt;f;i++)
@@ -337,7 +337,7 @@
 /*  popping functions  */
 
 /*  delete n vertices */
-int s3d_pop_vertex(int object, unsigned long n)
+int s3d_pop_vertex(int object, uint32_t n)
 {
 	uint32_t		buf[2];
 	buf[0]=htonl(object);
@@ -347,7 +347,7 @@
 	
 }
 /*  delete n materials */
-int s3d_pop_material(int object, unsigned long n)
+int s3d_pop_material(int object, uint32_t n)
 {
 	uint32_t		buf[2];
 	buf[0]=htonl(object);
@@ -357,7 +357,7 @@
 	
 }
 /*  delete n polygons */
-int s3d_pop_polygon(int object, unsigned long n)
+int s3d_pop_polygon(int object, uint32_t n)
 {
 	uint32_t		buf[2];
 	buf[0]=htonl(object);
@@ -367,7 +367,7 @@
 	
 }
 /*  delete n lines */
-int s3d_pop_line(int object, unsigned long n)
+int s3d_pop_line(int object, uint32_t n)
 {
 	uint32_t		buf[2];
 	buf[0]=htonl(object);
@@ -377,7 +377,7 @@
 	
 }
 /*  delete n polygons */
-int s3d_pop_texture(int object, unsigned long n)
+int s3d_pop_texture(int object, uint32_t n)
 {
 	uint32_t		buf[2];
 	buf[0]=htonl(object);
@@ -446,7 +446,7 @@
 	net_send(S3D_P_C_PEP_MAT,buf,len);
 	return(0);  /*  nothing yet */
 }
-int s3d_pep_materials_a(int object, float *mbuf, unsigned short n)
+int s3d_pep_materials_a(int object, float *mbuf, uint16_t n)
 {
 	char				buf[MF_LEN+4];
 	if ((n*12*sizeof(float)+4)&gt;MF_LEN)
@@ -461,9 +461,9 @@
 }
 
 /*  adds normal information to the last n polygons. */
-int s3d_pep_polygon_normals(int object, float *nbuf,unsigned short n)
+int s3d_pep_polygon_normals(int object, float *nbuf,uint16_t n)
 {
-	unsigned char buf[MF_LEN+4];
+	uint8_t buf[MF_LEN+4];
 	if ((n*9*sizeof(float)+4)&gt;MF_LEN) 
 	{
 		errds(MED,&quot;s3d_pep_polygon_normals()&quot;,&quot;too much data&quot;);
@@ -476,9 +476,9 @@
 	
 }
 /*  adds normal information to the last n line. */
-int s3d_pep_line_normals(int object, float *nbuf,unsigned short n)
+int s3d_pep_line_normals(int object, float *nbuf,uint16_t n)
 {
-	unsigned char buf[MF_LEN+4];
+	uint8_t buf[MF_LEN+4];
 	if ((n*9*sizeof(float)+4)&gt;MF_LEN) 
 	{
 		errds(MED,&quot;s3d_pep_line_normals()&quot;,&quot;too much data&quot;);
@@ -521,9 +521,9 @@
 
 
 /*  replaces the last n lines. */
-int s3d_pep_lines(int object, unsigned long *lbuf,unsigned short n)
+int s3d_pep_lines(int object, uint32_t *lbuf,uint16_t n)
 {
-	unsigned long 	buf[MF_LEN+4];
+	uint32_t 	buf[MF_LEN+4];
 	int				i;
 	if ((n*3*4+4)&gt;MF_LEN) 
 	{
@@ -538,9 +538,9 @@
 	
 }
 /*  replaces the last n vertices. */
-int s3d_pep_vertices(int object, float *vbuf,unsigned short n)
+int s3d_pep_vertices(int object, float *vbuf,uint16_t n)
 {
-	unsigned char buf[MF_LEN+4];
+	uint8_t buf[MF_LEN+4];
 	if ((n*3*sizeof(float)+4)&gt;MF_LEN) 
 	{
 		errds(MED,&quot;s3d_pep_vertices()&quot;,&quot;too much data&quot;);
@@ -568,7 +568,7 @@
 	return(0);
 }
 /*  adds texture coordinates to the last n polygons. */
-int s3d_pep_polygon_tex_coords(int object, float *tbuf,unsigned short n)
+int s3d_pep_polygon_tex_coords(int object, float *tbuf,uint16_t n)
 {
 	char buf[MF_LEN+4];
 	if ((n*6*sizeof(float))&gt;MF_LEN) 
@@ -582,7 +582,7 @@
 	return(0);
 }
 /*  adds normal information to the last n polygons. */
-int s3d_load_polygon_normals(int object, float *nbuf,unsigned long start, unsigned short n)
+int s3d_load_polygon_normals(int object, float *nbuf,uint32_t start, uint16_t n)
 {
 	char				buf[MF_LEN+4],*ptr;
 	int					f,i,len=n*9*4;
@@ -609,7 +609,7 @@
 	return(0);
 }
 /*  adds normal information to the last n polygons. */
-int s3d_load_line_normals(int object, float *nbuf,unsigned long start, unsigned short n)
+int s3d_load_line_normals(int object, float *nbuf,uint32_t start, uint16_t n)
 {
 	char				buf[MF_LEN+4],*ptr;
 	int					f,i,len=n*6*4;
@@ -636,7 +636,7 @@
 	return(0);
 }
 /*  adds texture coordinates to the last n polygons. */
-int s3d_load_polygon_tex_coords(int object, float *tbuf, unsigned long start, unsigned short n)
+int s3d_load_polygon_tex_coords(int object, float *tbuf, uint32_t start, uint16_t n)
 {
 	char				buf[MF_LEN+4],*ptr;
 	int					f,i,len=n*6*4;
@@ -663,7 +663,7 @@
 	return(0);
 }
 /*  load n materials at position start, overwriting old ones */
-int s3d_load_materials_a(int object, float *mbuf, unsigned long start, unsigned short n)
+int s3d_load_materials_a(int object, float *mbuf, uint32_t start, uint16_t n)
 {
 	char				buf[MF_LEN+4],*ptr;
 	int					f,i,len=n*12*4;
@@ -689,7 +689,7 @@
 	}
 	return(0);
 }
-int s3d_pep_material_texture(int object, unsigned long tex)
+int s3d_pep_material_texture(int object, uint32_t tex)
 {
 	char				buf[4*2],*ptr;
 	ptr=buf;
@@ -699,7 +699,7 @@
 	return(0);
 }
 /*  load data (which has width w and height h) into object, texture tex at position (xpos,ypos) */
-int s3d_load_texture(int object, unsigned long tex, unsigned short xpos, unsigned short ypos, unsigned short w, unsigned short h, unsigned char *data)
+int s3d_load_texture(int object, uint32_t tex, uint16_t xpos, uint16_t ypos, uint16_t w, uint16_t h, uint8_t *data)
 {
 	char				buf[MF_LEN+4],*ptr;
 	int 				linestep,lines,i;
@@ -722,7 +722,7 @@
 	}
 	return(0);
 }
-int s3d_flags_on(int object, unsigned long flags)
+int s3d_flags_on(int object, uint32_t flags)
 {
 	char				buf[4+1+4],*ptr;
 	int					len=4+1+4;
@@ -734,7 +734,7 @@
 	net_send(S3D_P_C_TOGGLE_FLAGS,buf,len);
 	return(0);
 }
-int s3d_flags_off(int object, unsigned long flags)
+int s3d_flags_off(int object, uint32_t flags)
 {
 	char				buf[4+1+4],*ptr;
 	int					len=4+1+4;

Modified: trunk/libs3d/s3d.h
===================================================================
--- trunk/libs3d/s3d.h	2006-10-01 20:09:26 UTC (rev 445)
+++ trunk/libs3d/s3d.h	2006-10-15 18:14:48 UTC (rev 446)
@@ -21,9 +21,10 @@
  * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
  */
 
+#include &lt;stdint.h&gt;  /* [u]intXX_t type definitions*/
 /* definitions */
 struct s3d_evt {
-	unsigned char event;
+	uint8_t event;
 	int length;
 	char *buf;
 	struct s3d_evt *next;
@@ -52,7 +53,7 @@
 #define S3D_OF_POINTABLE		0x00000004
 struct mcp_object 
 {
-	unsigned long object;
+	uint32_t object;
 	float trans_x,trans_y,trans_z;
 	float r;
 #define MCP_NEW_OBJECT	1
@@ -60,8 +61,8 @@
 };
 struct s3d_obj_info 
 {
-	unsigned long object;
-	unsigned long flags;
+	uint32_t object;
+	uint32_t flags;
 	float trans_x,trans_y,trans_z;
 	float rot_x,rot_y,rot_z;
 	float scale;
@@ -70,15 +71,15 @@
 };
 struct s3d_but_info
 {
-	unsigned char button; /* 0 = left, 1 = middle, 2 = right */
-	unsigned char state;  /* 0 = down, 1 = up, 2 = moving */
+	uint8_t button; /* 0 = left, 1 = middle, 2 = right */
+	uint8_t state;  /* 0 = down, 1 = up, 2 = moving */
 };
 struct s3d_key_event
 {
-	unsigned short keysym;		/* the symbol, use this with s3d_keysym.h */
-	unsigned short unicode;		/* the unicode or &quot;actually typed&quot; character */
-	unsigned short modifier;	/* any modifiers involved */
-	unsigned short state;		/* 0 = pressed, 1 = released */
+	uint16_t keysym;		/* the symbol, use this with s3d_keysym.h */
+	uint16_t unicode;		/* the unicode or &quot;actually typed&quot; character */
+	uint16_t modifier;	/* any modifiers involved */
+	uint16_t state;		/* 0 = pressed, 1 = released */
 };
 /* framework functions */
 void s3d_usage();
@@ -88,7 +89,7 @@
 
 /* object manipulations */
 int s3d_push_vertex(int object, float x, float y, float z);
-int s3d_push_vertices(int object, float *vbuf, unsigned short n);
+int s3d_push_vertices(int object, float *vbuf, uint16_t n);
 int s3d_push_material( int object, 
 						float amb_r, float amb_g, float amb_b,
 						float spec_r, float spec_g, float spec_b,
@@ -101,39 +102,39 @@
 						float amb_r, float amb_g, float amb_b, float amb_a,
 						float spec_r, float spec_g, float spec_b, float spec_a,
 						float diff_r, float diff_g, float diff_b, float diff_a);
-int s3d_push_materials_a(int object, float *mbuf, unsigned short n);
+int s3d_push_materials_a(int object, float *mbuf, uint16_t n);
 int s3d_pep_material_a( int object, 
 						float amb_r, float amb_g, float amb_b, float amb_a,
 						float spec_r, float spec_g, float spec_b, float spec_a,
 						float diff_r, float diff_g, float diff_b, float diff_a);
 
-int s3d_pep_materials_a(int object, float *mbuf, unsigned short n);
-int s3d_load_materials_a(int object, float *mbuf, unsigned long start, unsigned short n);
-int s3d_push_polygon(int object, unsigned long v1, unsigned long v2, unsigned long v3, unsigned long material);
-int s3d_push_polygons(int object, unsigned long *pbuf, unsigned short n);
-int s3d_push_line(int object, unsigned long v1, unsigned long v2, unsigned long material);
-int s3d_push_lines(int object, unsigned long *lbuf, unsigned short n);
-int s3d_push_texture(int object, unsigned short w, unsigned short h);
-int s3d_push_textures(int object, unsigned short *tbuf, unsigned short n);
-int s3d_pop_vertex(int object, unsigned long n);
-int s3d_pop_polygon(int object, unsigned long n);
-int s3d_pop_material(int object, unsigned long n);
-int s3d_pop_texture(int object, unsigned long n);
-int s3d_pop_polygon(int object, unsigned long n);
-int s3d_pop_line(int object, unsigned long n);
-int s3d_pep_line_normals(int object, float *nbuf,unsigned short n);
-int s3d_pep_polygon_normals(int object, float *nbuf,unsigned short n);
+int s3d_pep_materials_a(int object, float *mbuf, uint16_t n);
+int s3d_load_materials_a(int object, float *mbuf, uint32_t start, uint16_t n);
+int s3d_push_polygon(int object, uint32_t v1, uint32_t v2, uint32_t v3, uint32_t material);
+int s3d_push_polygons(int object, uint32_t *pbuf, uint16_t n);
+int s3d_push_line(int object, uint32_t v1, uint32_t v2, uint32_t material);
+int s3d_push_lines(int object, uint32_t *lbuf, uint16_t n);
+int s3d_push_texture(int object, uint16_t w, uint16_t h);
+int s3d_push_textures(int object, uint16_t *tbuf, uint16_t n);
+int s3d_pop_vertex(int object, uint32_t n);
+int s3d_pop_polygon(int object, uint32_t n);
+int s3d_pop_material(int object, uint32_t n);
+int s3d_pop_texture(int object, uint32_t n);
+int s3d_pop_polygon(int object, uint32_t n);
+int s3d_pop_line(int object, uint32_t n);
+int s3d_pep_line_normals(int object, float *nbuf,uint16_t n);
+int s3d_pep_polygon_normals(int object, float *nbuf,uint16_t n);
 int s3d_pep_polygon_tex_coord(int object, float x1, float y1, float x2, float y2, float x3, float y3);
-int s3d_pep_polygon_tex_coords(int object, float *tbuf,unsigned short n);
-int s3d_pep_material_texture(int object, unsigned long tex);
+int s3d_pep_polygon_tex_coords(int object, float *tbuf,uint16_t n);
+int s3d_pep_material_texture(int object, uint32_t tex);
 int s3d_pep_vertex(int object, float x, float y, float z);
-int s3d_pep_vertices(int object, float *vbuf,unsigned short n);
+int s3d_pep_vertices(int object, float *vbuf,uint16_t n);
 int s3d_pep_line(int object, int v1, int v2, int material);
-int s3d_pep_lines(int object, unsigned long *lbuf,unsigned short n);
-int s3d_load_line_normals(int object, float *nbuf,unsigned long start, unsigned short n);
-int s3d_load_polygon_normals(int object, float *nbuf,unsigned long start, unsigned short n);
-int s3d_load_polygon_tex_coords(int object, float *tbuf, unsigned long start, unsigned short n);
-int s3d_load_texture(int object, unsigned long tex, unsigned short xpos, unsigned short ypos, unsigned short w, unsigned short h, unsigned char *data);
+int s3d_pep_lines(int object, uint32_t *lbuf,uint16_t n);
+int s3d_load_line_normals(int object, float *nbuf,uint32_t start, uint16_t n);
+int s3d_load_polygon_normals(int object, float *nbuf,uint32_t start, uint16_t n);
+int s3d_load_polygon_tex_coords(int object, float *tbuf, uint32_t start, uint16_t n);
+int s3d_load_texture(int object, uint32_t tex, uint16_t xpos, uint16_t ypos, uint16_t w, uint16_t h, uint8_t *data);
 
 int s3d_new_object();
 int s3d_del_object(int oid);
@@ -144,8 +145,8 @@
 int s3d_link(int oid_from, int oid_to);
 int s3d_unlink(int oid);
 
-int s3d_flags_on(int object, unsigned long flags);
-int s3d_flags_off(int object, unsigned long flags);
+int s3d_flags_on(int object, uint32_t flags);
+int s3d_flags_off(int object, uint32_t flags);
 int s3d_translate(int object, float x, float y, float z);
 int s3d_rotate(int object, float x, float y, float z);
 int s3d_scale(int object, float s);
@@ -166,13 +167,13 @@
 /* event handlers */
 void s3d_push_event(struct s3d_evt *newevt);
 struct s3d_evt *s3d_pop_event();
-struct s3d_evt *s3d_find_event(unsigned char event);
+struct s3d_evt *s3d_find_event(uint8_t event);
 int s3d_delete_event(struct s3d_evt *devt);
 
-void s3d_set_callback(unsigned char event, s3d_cb func);
-void s3d_clear_callback(unsigned char event);
-void s3d_ignore_callback(unsigned char event);
-s3d_cb s3d_get_callback(unsigned char event);
+void s3d_set_callback(uint8_t event, s3d_cb func);
+void s3d_clear_callback(uint8_t event);
+void s3d_ignore_callback(uint8_t event);
+s3d_cb s3d_get_callback(uint8_t event);
 void s3d_process_stack();
 
 /* mcp special */

Modified: trunk/libs3d/s3dlib.h
===================================================================
--- trunk/libs3d/s3dlib.h	2006-10-01 20:09:26 UTC (rev 445)
+++ trunk/libs3d/s3dlib.h	2006-10-15 18:14:48 UTC (rev 446)
@@ -65,7 +65,7 @@
 unsigned int _queue_want_object();
 int _queue_quit();
 /*  network.c */
-int net_send(unsigned char opcode, char *buf, unsigned short length);
+int net_send(uint8_t opcode, char *buf, uint16_t length);
 int s3d_net_init(char *urlc);
 #ifdef TCP
 /* tcp.c */
@@ -94,7 +94,7 @@
 struct t_buf
 {
 	float *vbuf;
-	unsigned long *pbuf;
+	uint32_t *pbuf;
 	int pn,vn;
 	float xoff;
 };

Modified: trunk/libs3d/shm.c
===================================================================
--- trunk/libs3d/shm.c	2006-10-01 20:09:26 UTC (rev 445)
+++ trunk/libs3d/shm.c	2006-10-15 18:14:48 UTC (rev 446)
@@ -165,7 +165,7 @@
 {
 	int 				 found=0;
 	char				 opcode,*buf;
-	unsigned short		 length;
+	u_int16_t		 length;
 	struct shmid_ds		 d;
 	
 	if (data_in==NULL)

Modified: trunk/libs3d/tcp.c
===================================================================
--- trunk/libs3d/tcp.c	2006-10-01 20:09:26 UTC (rev 445)
+++ trunk/libs3d/tcp.c	2006-10-15 18:14:48 UTC (rev 446)
@@ -145,7 +145,7 @@
 	struct timeval		 tv;		 /*  time structure */
 	int 				 found=0;
 	char				 opcode,*buf;
-	unsigned short		 length;
+	u_int16_t		 length;
 	
 	
 	if (s3d_socket!=-1)

Modified: trunk/libs3dw/button.c
===================================================================
--- trunk/libs3dw/button.c	2006-10-01 20:09:26 UTC (rev 445)
+++ trunk/libs3dw/button.c	2006-10-15 18:14:48 UTC (rev 446)
@@ -33,7 +33,7 @@
 	s3dw_button *button=(s3dw_button *)widget;
 	float length;
 	float vertices[8*3];
-	unsigned long polygons[10*4]={
+	u_int32_t polygons[10*4]={
 			0,4,5,0,
 			0,5,1,0,
 			1,5,6,0,
@@ -125,7 +125,7 @@
 }
 
 /* handle click on a button */
-int s3dw_button_event_click(s3dw_widget *widget, unsigned long oid)
+int s3dw_button_event_click(s3dw_widget *widget, u_int32_t oid)
 {
 	s3dw_button *button=(s3dw_button *)widget;
 	if ((button-&gt;oid_text==oid) || (widget-&gt;oid==oid))

Modified: trunk/libs3dw/event.c
===================================================================
--- trunk/libs3dw/event.c	2006-10-01 20:09:26 UTC (rev 445)
+++ trunk/libs3dw/event.c	2006-10-15 18:14:48 UTC (rev 446)
@@ -27,7 +27,7 @@
 extern s3dw_widget *_s3dw_cam;
 int s3dw_handle_click(struct s3d_evt *evt)
 {
-	unsigned long oid=*((unsigned long *)evt-&gt;buf);
+	uint32_t oid=*((uint32_t *)evt-&gt;buf);
 	return(s3dw_widget_event_click(s3dw_getroot(),oid));
 }
 int s3dw_handle_key(struct s3d_evt *evt)

Modified: trunk/libs3dw/input.c
===================================================================
--- trunk/libs3dw/input.c	2006-10-01 20:09:26 UTC (rev 445)
+++ trunk/libs3dw/input.c	2006-10-15 18:14:48 UTC (rev 446)
@@ -30,10 +30,10 @@
 #include &lt;string.h&gt; /* strdup(),strlen() */
 #include &lt;ctype.h&gt;	/* isprint */
 
-unsigned long s3dw_input_draw_string(s3dw_widget *widget)
+uint32_t s3dw_input_draw_string(s3dw_widget *widget)
 {
 	s3dw_input *input=(s3dw_input *)widget;
-	unsigned long oid_text;
+	uint32_t oid_text;
 	int i;
 	float tlen;
 	if (widget-&gt;width&lt;1) return(-1);
@@ -53,7 +53,7 @@
 	s3dw_input *input=(s3dw_input *)widget;
 	float length;
 	float vertices[12*3];
-	unsigned long polygons[18*4]={
+	uint32_t polygons[18*4]={
 			0,4,5,1,
 			0,5,1,1,
 			1,5,6,1,
@@ -155,7 +155,7 @@
 void s3dw_input_change_text(s3dw_input *input, char *text)
 {
 	s3dw_widget *widget=(s3dw_widget *)input;
-	unsigned long oid_text;
+	uint32_t oid_text;
 	/* redraw the text ... */
 	free(input-&gt;text);
 	input-&gt;text=strdup(text);
@@ -205,7 +205,7 @@
 }
 
 
-int s3dw_input_event_click(s3dw_widget *widget, unsigned long oid)
+int s3dw_input_event_click(s3dw_widget *widget, uint32_t oid)
 {
 	s3dw_input *input=(s3dw_input *)widget;
 	if ((input-&gt;oid_text==oid) || (widget-&gt;oid==oid))

Modified: trunk/libs3dw/label.c
===================================================================
--- trunk/libs3dw/label.c	2006-10-01 20:09:26 UTC (rev 445)
+++ trunk/libs3dw/label.c	2006-10-15 18:14:48 UTC (rev 446)
@@ -85,7 +85,7 @@
 	return(0);
 }
 /* handle click events */
-int s3dw_label_event_click(s3dw_widget *widget, unsigned long oid)
+int s3dw_label_event_click(s3dw_widget *widget, uint32_t oid)
 {
 	s3dw_label *label=(s3dw_label *)widget;
 	if (widget-&gt;oid==oid)

Modified: trunk/libs3dw/root.c
===================================================================
--- trunk/libs3dw/root.c	2006-10-01 20:09:26 UTC (rev 445)
+++ trunk/libs3dw/root.c	2006-10-15 18:14:48 UTC (rev 446)
@@ -38,7 +38,7 @@
 void s3dw_nothing(s3dw_widget *widget)
 {
 }
-int s3dw_click_nothing(s3dw_widget *widget, unsigned long dummy)
+int s3dw_click_nothing(s3dw_widget *widget, uint32_t dummy)
 {
 	return(0);
 }

Modified: trunk/libs3dw/s3dw.h
===================================================================
--- trunk/libs3dw/s3dw.h	2006-10-01 20:09:26 UTC (rev 445)
+++ trunk/libs3dw/s3dw.h	2006-10-15 18:14:48 UTC (rev 446)
@@ -21,6 +21,7 @@
  * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
  */
 
+#include &lt;stdint.h&gt;  /* [u]intXX_t type definitions*/
 
 /* we want this widget visible, as long as the widgets below are also visible. 
  * on for all widgets, except surfaces which have to be switched visible 
@@ -70,7 +71,7 @@
 	float 		 as;			/* current scale factor */
 	float 		 arx,ary,arz;   /* current rotation */
 	float 		 width,height;	/* width and height of the widget, outer size */
-	unsigned long oid;			/* the main object which is used for transformations etc ...*/
+	uint32_t	 oid;			/* the main object which is used for transformations etc ...*/
 	/* public */
 	float 		 x,y,z;			/* position, relative to the surface usually */
 	float 		 s;				/* scale factor */
@@ -82,7 +83,7 @@
 	/* private */
 	s3dw_widget 	 widget;
 	char 			*text;
-	unsigned long    oid_text;
+	uint32_t  		  oid_text;
 	/* public */
 	s3dw_callback 	 onclick;
 };
@@ -98,7 +99,7 @@
 	/* private */
 	s3dw_widget 	 widget;
 	char 			*text;
-	unsigned long    oid_text;
+	uint32_t   	 oid_text;
 	/* public */
 	s3dw_callback 	 onclick;
 	s3dw_callback 	 onedit;
@@ -107,8 +108,8 @@
 struct _s3dw_surface {
 	/* private */
 	s3dw_widget 		  widget;
-	unsigned long		  oid_title;
-	unsigned long		  oid_tbar;
+	uint32_t			  oid_title;
+	uint32_t			  oid_tbar;
 	char				 *title;
 };
 

Modified: trunk/libs3dw/s3dw_int.h
===================================================================
--- trunk/libs3dw/s3dw_int.h	2006-10-01 20:09:26 UTC (rev 445)
+++ trunk/libs3dw/s3dw_int.h	2006-10-15 18:14:48 UTC (rev 446)
@@ -25,7 +25,7 @@
 #define MAXANI		128
 #define ZOOMS		5
 /* constructor and handler callbacks */
-typedef int (*s3dw_click_callback)(s3dw_widget *, unsigned long);
+typedef int (*s3dw_click_callback)(s3dw_widget *, uint32_t);
 typedef int (*s3dw_key_callback)(  s3dw_widget *, struct s3d_key_event *);
 s3dw_callback 		s3dwcb_show[S3DW_NTYPES];
 s3dw_callback 		s3dwcb_hide[S3DW_NTYPES];
@@ -36,14 +36,14 @@
 /* root.c */
 s3dw_widget *s3dw_getroot();
 void s3dw_nothing(s3dw_widget *widget);
-int s3dw_click_nothing(s3dw_widget *widget, unsigned long dummy);
+int s3dw_click_nothing(s3dw_widget *widget, uint32_t dummy);
 int s3dw_key_nothing(s3dw_widget *widget, struct s3d_key_event *dummy);
 void s3dw_root_destroy(s3dw_widget *widget);
 /* widget.c */
 s3dw_widget *s3dw_widget_new();
 void s3dw_widget_append(s3dw_widget *parent, s3dw_widget *widget);
 void s3dw_widget_visible(s3dw_widget *widget);
-int s3dw_widget_event_click(s3dw_widget *widget, unsigned long oid);
+int s3dw_widget_event_click(s3dw_widget *widget, uint32_t oid);
 int s3dw_widget_event_key(s3dw_widget *widget, struct s3d_key_event *keys);
 /* surface.c */
 void s3dw_surface_destroy(s3dw_widget *widget);
@@ -51,7 +51,7 @@
 void s3dw_surface_erase(s3dw_widget *widget);
 void s3dw_surface_show(s3dw_widget *widget);
 void s3dw_surface_hide(s3dw_widget *widget);
-int s3dw_surface_event_click(s3dw_widget *widget, unsigned long oid);
+int s3dw_surface_event_click(s3dw_widget *widget, uint32_t oid);
 int s3dw_surface_event_key(s3dw_widget *widget, struct s3d_key_event *keys);
 /* button.c */
 void s3dw_button_destroy(s3dw_widget *widget);
@@ -59,7 +59,7 @@
 void s3dw_button_erase(s3dw_widget *widget);
 void s3dw_button_show(s3dw_widget *widget);
 void s3dw_button_hide(s3dw_widget *widget);
-int s3dw_button_event_click(s3dw_widget *widget, unsigned long oid);
+int s3dw_button_event_click(s3dw_widget *widget, uint32_t oid);
 int s3dw_button_event_key(s3dw_widget *widget, struct s3d_key_event *keys);
 
 /* label.c */
@@ -68,7 +68,7 @@
 void s3dw_label_erase(s3dw_widget *widget);
 void s3dw_label_show(s3dw_widget *widget);
 void s3dw_label_hide(s3dw_widget *widget);
-int s3dw_label_event_click(s3dw_widget *widget, unsigned long oid);
+int s3dw_label_event_click(s3dw_widget *widget, uint32_t oid);
 int s3dw_label_event_key(s3dw_widget *widget, struct s3d_key_event *keys);
 
 /* input.c */
@@ -77,8 +77,8 @@
 void s3dw_input_erase(s3dw_widget *widget);
 void s3dw_input_show(s3dw_widget *widget);
 void s3dw_input_hide(s3dw_widget *widget);
-unsigned long s3dw_input_draw_string(s3dw_widget *widget);
-int s3dw_input_event_click(s3dw_widget *widget, unsigned long oid);
+uint32_t s3dw_input_draw_string(s3dw_widget *widget);
+int s3dw_input_event_click(s3dw_widget *widget, uint32_t oid);
 int s3dw_input_event_key(s3dw_widget *widget, struct s3d_key_event *keys);
 
 /* style.c */

Modified: trunk/libs3dw/surface.c
===================================================================
--- trunk/libs3dw/surface.c	2006-10-01 20:09:26 UTC (rev 445)
+++ trunk/libs3dw/surface.c	2006-10-15 18:14:48 UTC (rev 446)
@@ -46,7 +46,7 @@
 		0,1,1
 	};
 	float sver[8*3], tver[8*3];
-	unsigned long polygon[10*4]={
+	uint32_t polygon[10*4]={
 		0,1,2,0,
 		0,2,3,0,
 		1,5,6,0,
@@ -58,7 +58,7 @@
 		5,4,7,0,
 		5,7,6,0
 	};
-	unsigned long tpol[10*4];
+	uint32_t tpol[10*4];
 	int i;
 
 	widget-&gt;oid=s3d_new_object();
@@ -180,7 +180,7 @@
 	return(0);
 }
 /* test widgets of the surface for clicks */
-int s3dw_surface_event_click(s3dw_widget *widget, unsigned long oid)
+int s3dw_surface_event_click(s3dw_widget *widget, uint32_t oid)
 {
 	s3dw_surface *surface=(s3dw_surface *)widget;
 	if (widget-&gt;oid==oid)

Modified: trunk/libs3dw/widget.c
===================================================================
--- trunk/libs3dw/widget.c	2006-10-01 20:09:26 UTC (rev 445)
+++ trunk/libs3dw/widget.c	2006-10-15 18:14:48 UTC (rev 446)
@@ -47,7 +47,7 @@
 	return(widget);
 }
 /* widget clicked, call specific function and check kids */
-int s3dw_widget_event_click(s3dw_widget *widget, unsigned long oid)
+int s3dw_widget_event_click(s3dw_widget *widget, uint32_t oid)
 {
 	int i;
 	s3dprintf(VLOW,&quot;processing click event for widget %010p of type %d, oid %d (%d), subobjects: %d&quot;,widget,widget-&gt;type, widget-&gt;oid, oid, widget-&gt;nobj);

Modified: trunk/server/Makefile.am
===================================================================
--- trunk/server/Makefile.am	2006-10-01 20:09:26 UTC (rev 445)
+++ trunk/server/Makefile.am	2006-10-15 18:14:48 UTC (rev 446)
@@ -19,6 +19,6 @@
 	shm.c shm_ringbuf.c tcp.c user.c
 
 s3d_LDADD=	@LIBM@ @GL_LIBS@ ${MAYBE_SDL_LIBS} ${MAYBE_GLUT_LIBS}
-s3d_CFLAGS=	@GL_CFLAGS@ ${MAYBE_SDL_CFLAGS} ${MAYBE_GLUT_CFLAGS} -I$(top_srcdir)/libs3d
+s3d_CFLAGS=	@GL_CFLAGS@ ${MAYBE_SDL_CFLAGS} ${MAYBE_GLUT_CFLAGS} ${DEVEL_CFLAGS} -I$(top_srcdir)/libs3d
 
 noinst_HEADERS=	config.h global.h proto.h

Modified: trunk/server/global.h
===================================================================
--- trunk/server/global.h	2006-10-01 20:09:26 UTC (rev 445)
+++ trunk/server/global.h	2006-10-15 18:14:48 UTC (rev 446)
@@ -228,7 +228,7 @@
 int shm_readn(struct buf_t *rb,uint8_t *buf, int n);
 int shm_prot_com_in(struct t_process *p);
 /* shm_ringbuf.c */
-void ringbuf_init(char *data,unsigned long init_size);
+void ringbuf_init(char *data,uint32_t init_size);
 int shm_write(struct buf_t *rb,char *buf, int n);
 int shm_read(struct buf_t *rb,char *buf, int n);
 /*  proto.c */

Modified: trunk/server/mcp.c
===================================================================
--- trunk/server/mcp.c	2006-10-01 20:09:26 UTC (rev 445)
+++ trunk/server/mcp.c	2006-10-15 18:14:48 UTC (rev 446)
@@ -87,7 +87,7 @@
 /* tells the mcp that some program vanished ... */
 int mcp_del_object(uint32_t mcp_oid)
 {
-	unsigned long oid=htonl(mcp_oid);
+	uint32_t oid=htonl(mcp_oid);
 	if (mcp_oid==focus_oid)
 	{
 		s3dprintf(MED,&quot;lost the focus of mcp-oid %d&quot;,mcp_oid);

Modified: trunk/server/object.c
===================================================================
--- trunk/server/object.c	2006-10-01 20:09:26 UTC (rev 445)
+++ trunk/server/object.c	2006-10-15 18:14:48 UTC (rev 446)
@@ -36,7 +36,7 @@
 extern int focus_oid;
 
 
-static void obj_update_tex(struct t_tex *tex,unsigned short x,unsigned short y,unsigned short w,unsigned short h,unsigned char *pixbuf);
+static void obj_update_tex(struct t_tex *tex,u_int16_t x,u_int16_t y,u_int16_t w,u_int16_t h,u_int8_t *pixbuf);
 void obj_sys_update(struct t_process *p, uint32_t oid);
 
 /*  debugging function for objects, prints out some stuff known about it... */
@@ -871,7 +871,7 @@
 	return(0);
 }
 /* the interal texture updating function ... this is for opengl*/
-static void obj_update_tex(struct t_tex *tex,unsigned short x,unsigned short y,unsigned short w,unsigned short h,unsigned char *pixbuf)
+static void obj_update_tex(struct t_tex *tex,u_int16_t x,u_int16_t y,u_int16_t w,u_int16_t h,u_int8_t *pixbuf)
 {
 	GLuint t;
 	if ((t=tex-&gt;gl_texnum)!=-1)

Modified: trunk/server/shm_ringbuf.c
===================================================================
--- trunk/server/shm_ringbuf.c	2006-10-01 20:09:26 UTC (rev 445)
+++ trunk/server/shm_ringbuf.c	2006-10-15 18:14:48 UTC (rev 446)
@@ -101,7 +101,7 @@
 	if (rb-&gt;start&gt;=rb-&gt;bufsize) rb-&gt;start-=rb-&gt;bufsize;
 	return(mn);
 }
-void ringbuf_init(char *data,unsigned long init_size)
+void ringbuf_init(char *data,uint32_t init_size)
 {
 	struct buf_t *ringbuf=(struct buf_t *)data;
 /*	ringbuf=malloc(init_size); */

Modified: trunk/server/user.c
===================================================================
--- trunk/server/user.c	2006-10-01 20:09:26 UTC (rev 445)
+++ trunk/server/user.c	2006-10-15 18:14:48 UTC (rev 446)
@@ -55,7 +55,7 @@
 	}
 	return(0);
 }
-void user_key(unsigned short key, unsigned short unicode, unsigned short mod, int state)
+void user_key(uint16_t key, uint16_t unicode, uint16_t mod, int state)
 {
 	event_key_pressed(key,unicode,mod,state);
 }

Modified: trunk/server/user_glut.c
===================================================================
--- trunk/server/user_glut.c	2006-10-01 20:09:26 UTC (rev 445)
+++ trunk/server/user_glut.c	2006-10-15 18:14:48 UTC (rev 446)
@@ -26,7 +26,7 @@
 #include &lt;GL/glut.h&gt; 	 /*  all the glut functions */
 #include &lt;s3d_keysym.h&gt; /* our very own (haha) keysyms */
 /*  local prototypes */
-void keyboard(unsigned char key, int x, int y);
+void keyboard(uint8_t key, int x, int y);
 void special(int skey, int x, int y);
 void mouse_motion(int x, int y);
 void passive_mouse_motion(int x, int y);
@@ -43,14 +43,14 @@
 	return(0);
 }
 
-void keyboard(unsigned char key, int x, int y)
+void keyboard(uint8_t key, int x, int y)
 {
 	user_key(key,key,0,0);
 	user_key(key,key,0,1);
 }
 void special(int skey, int x, int y)
 {
-	unsigned short mkey;
+	uint16_t mkey;
 	switch (skey) /* handle special keys */
 	{
 		case GLUT_KEY_F1:		mkey=S3DK_F1;	break;


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000438.html">[S3d-svn] r445 - in trunk: . apps/s3dfm
</A></li>
	<LI>Next message: <A HREF="000440.html">[S3d-svn] r447 - in trunk: . swig
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#439">[ date ]</a>
              <a href="thread.html#439">[ thread ]</a>
              <a href="subject.html#439">[ subject ]</a>
              <a href="author.html#439">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/s3d-svn">More information about the S3d-svn
mailing list</a><br>
</body></html>
